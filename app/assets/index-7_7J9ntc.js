const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./GitStatusController-f_qnadiG.js","./react-vendor-P8ZuH1e3.js","./monaco-editor-BYMRfcD5.js","./monaco-editor-C3yYqDe4.css","./GitBranchController-CvyWl29Z.js","./GitLogController-DjeBCuO2.js","./event-DjZVAIBO.js","./core-DhEqZVGG.js","./GitPanelViewPresenter-7iOiv9vY.js","./AIChatPanelViewPresenter-qNDKKcIx.js","./SettingsDialogViewPresenter-DKTTQDJP.js","./GoToLineDialogViewPresenter-tS6scjju.js","./AboutDialogViewPresenter-B1ObHtVD.js","./RunCommandDialogViewPresenter-C8oedrh3.js","./ColumnEditorDialogViewPresenter-BtI_5Cdk.js","./SummaryDialogViewPresenter-C4tXO6s6.js","./CharInRangeDialogViewPresenter-DTCM-ZKH.js","./ShortcutMapperDialogViewPresenter-CGZoCVGe.js","./ShortcutConfig-CNB-8NLK.js","./CommandPaletteViewPresenter-DkLpXWBr.js","./FuzzySearchHelpers-xz3AmAn2.js","./QuickOpenViewPresenter-EL7cO8SX.js","./DiffViewerViewPresenter-Ckhmvfb4.js","./SnippetManagerViewPresenter-CmkzyxMC.js","./TerminalPanelViewPresenter-C4dkvg4A.js","./CloneRepositoryViewPresenter-CtGDRk_f.js","./GitSettingsViewPresenter-BjByPNMg.js","./AISettingsViewPresenter-B5bxd65I.js"])))=>i.map(i=>d[i]);
var Yp=Object.defineProperty;var Jp=(e,n,r)=>n in e?Yp(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r;var Lc=(e,n,r)=>Jp(e,typeof n!="symbol"?n+"":n,r);import{r as Fi,g as qn,a as Qp,c as Ai,b as eg}from"./react-vendor-P8ZuH1e3.js";import{_ as ht}from"./monaco-editor-BYMRfcD5.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const u of l)if(u.type==="childList")for(const p of u.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function r(l){const u={};return l.integrity&&(u.integrity=l.integrity),l.referrerPolicy&&(u.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?u.credentials="include":l.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(l){if(l.ep)return;l.ep=!0;const u=r(l);fetch(l.href,u)}})();var fa={exports:{}},Pn={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $c;function tg(){if($c)return Pn;$c=1;var e=Fi(),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function p(f,h,x){var _,y={},O=null,R=null;x!==void 0&&(O=""+x),h.key!==void 0&&(O=""+h.key),h.ref!==void 0&&(R=h.ref);for(_ in h)o.call(h,_)&&!u.hasOwnProperty(_)&&(y[_]=h[_]);if(f&&f.defaultProps)for(_ in h=f.defaultProps,h)y[_]===void 0&&(y[_]=h[_]);return{$$typeof:n,type:f,key:O,ref:R,props:y,_owner:l.current}}return Pn.Fragment=r,Pn.jsx=p,Pn.jsxs=p,Pn}var Nc;function rg(){return Nc||(Nc=1,fa.exports=tg()),fa.exports}var E=rg(),de=Fi();const St=qn(de);var di={},Uc;function ng(){if(Uc)return di;Uc=1;var e=Qp();return di.createRoot=e.createRoot,di.hydrateRoot=e.hydrateRoot,di}var ig=ng();const ag=qn(ig),og={},zc=e=>{let n;const r=new Set,o=(_,y)=>{const O=typeof _=="function"?_(n):_;if(!Object.is(O,n)){const R=n;n=y??(typeof O!="object"||O===null)?O:Object.assign({},n,O),r.forEach(z=>z(n,R))}},l=()=>n,h={setState:o,getState:l,getInitialState:()=>x,subscribe:_=>(r.add(_),()=>r.delete(_)),destroy:()=>{r.clear()}},x=n=e(o,l,h);return h},sg=e=>e?zc(e):zc;var da={exports:{}},ha={},pa={exports:{}},ga={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gc;function lg(){if(Gc)return ga;Gc=1;var e=Fi();function n(y,O){return y===O&&(y!==0||1/y===1/O)||y!==y&&O!==O}var r=typeof Object.is=="function"?Object.is:n,o=e.useState,l=e.useEffect,u=e.useLayoutEffect,p=e.useDebugValue;function f(y,O){var R=O(),z=o({inst:{value:R,getSnapshot:O}}),N=z[0].inst,L=z[1];return u(function(){N.value=R,N.getSnapshot=O,h(N)&&L({inst:N})},[y,R,O]),l(function(){return h(N)&&L({inst:N}),y(function(){h(N)&&L({inst:N})})},[y]),p(R),R}function h(y){var O=y.getSnapshot;y=y.value;try{var R=O();return!r(y,R)}catch{return!0}}function x(y,O){return O()}var _=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?x:f;return ga.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:_,ga}var Hc;function cg(){return Hc||(Hc=1,pa.exports=lg()),pa.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wc;function ug(){if(Wc)return ha;Wc=1;var e=Fi(),n=cg();function r(x,_){return x===_&&(x!==0||1/x===1/_)||x!==x&&_!==_}var o=typeof Object.is=="function"?Object.is:r,l=n.useSyncExternalStore,u=e.useRef,p=e.useEffect,f=e.useMemo,h=e.useDebugValue;return ha.useSyncExternalStoreWithSelector=function(x,_,y,O,R){var z=u(null);if(z.current===null){var N={hasValue:!1,value:null};z.current=N}else N=z.current;z=f(function(){function D(Y){if(!U){if(U=!0,G=Y,Y=O(Y),R!==void 0&&N.hasValue){var B=N.value;if(R(B,Y))return X=B}return X=Y}if(B=X,o(G,Y))return B;var K=O(Y);return R!==void 0&&R(B,K)?(G=Y,B):(G=Y,X=K)}var U=!1,G,X,q=y===void 0?null:y;return[function(){return D(_())},q===null?void 0:function(){return D(q())}]},[_,y,O,R]);var L=l(x,z[0],z[1]);return p(function(){N.hasValue=!0,N.value=L},[L]),h(L),L},ha}var qc;function fg(){return qc||(qc=1,da.exports=ug()),da.exports}var dg=fg();const hg=qn(dg),gd={},{useDebugValue:pg}=St,{useSyncExternalStoreWithSelector:gg}=hg;let Vc=!1;const mg=e=>e;function wg(e,n=mg,r){(gd?"production":void 0)!=="production"&&r&&!Vc&&(Vc=!0);const o=gg(e.subscribe,e.getState,e.getServerState||e.getInitialState,n,r);return pg(o),o}const yg=e=>{const n=typeof e=="function"?sg(e):e,r=(o,l)=>wg(n,o,l);return Object.assign(r,n),r},bg=e=>yg;var md=Symbol.for("immer-nothing"),Zc=Symbol.for("immer-draftable"),qt=Symbol.for("immer-state");function nr(e,...n){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var zn=Object.getPrototypeOf;function on(e){return!!e&&!!e[qt]}function Dr(e){var n;return e?wd(e)||Array.isArray(e)||!!e[Zc]||!!((n=e.constructor)!=null&&n[Zc])||Vn(e)||Li(e):!1}var vg=Object.prototype.constructor.toString(),Kc=new WeakMap;function wd(e){if(!e||typeof e!="object")return!1;const n=Object.getPrototypeOf(e);if(n===null||n===Object.prototype)return!0;const r=Object.hasOwnProperty.call(n,"constructor")&&n.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let o=Kc.get(r);return o===void 0&&(o=Function.toString.call(r),Kc.set(r,o)),o===vg}function Ii(e,n,r=!0){Di(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(l=>{n(l,e[l],e)}):e.forEach((o,l)=>n(l,o,e))}function Di(e){const n=e[qt];return n?n.type_:Array.isArray(e)?1:Vn(e)?2:Li(e)?3:0}function fs(e,n){return Di(e)===2?e.has(n):Object.prototype.hasOwnProperty.call(e,n)}function yd(e,n,r){const o=Di(e);o===2?e.set(n,r):o===3?e.add(r):e[n]=r}function xg(e,n){return e===n?e!==0||1/e===1/n:e!==e&&n!==n}function Vn(e){return e instanceof Map}function Li(e){return e instanceof Set}function jr(e){return e.copy_||e.base_}function ds(e,n){if(Vn(e))return new Map(e);if(Li(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=wd(e);if(n===!0||n==="class_only"&&!r){const o=Object.getOwnPropertyDescriptors(e);delete o[qt];let l=Reflect.ownKeys(o);for(let u=0;u<l.length;u++){const p=l[u],f=o[p];f.writable===!1&&(f.writable=!0,f.configurable=!0),(f.get||f.set)&&(o[p]={configurable:!0,writable:!0,enumerable:f.enumerable,value:e[p]})}return Object.create(zn(e),o)}else{const o=zn(e);if(o!==null&&r)return{...e};const l=Object.create(o);return Object.assign(l,e)}}function ys(e,n=!1){return $i(e)||on(e)||!Dr(e)||(Di(e)>1&&Object.defineProperties(e,{set:hi,add:hi,clear:hi,delete:hi}),Object.freeze(e),n&&Object.values(e).forEach(r=>ys(r,!0))),e}function _g(){nr(2)}var hi={value:_g};function $i(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var Sg={};function Lr(e){const n=Sg[e];return n||nr(0,e),n}var Gn;function bd(){return Gn}function kg(e,n){return{drafts_:[],parent_:e,immer_:n,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Xc(e,n){n&&(Lr("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=n)}function hs(e){ps(e),e.drafts_.forEach(Eg),e.drafts_=null}function ps(e){e===Gn&&(Gn=e.parent_)}function Yc(e){return Gn=kg(Gn,e)}function Eg(e){const n=e[qt];n.type_===0||n.type_===1?n.revoke_():n.revoked_=!0}function Jc(e,n){n.unfinalizedDrafts_=n.drafts_.length;const r=n.drafts_[0];return e!==void 0&&e!==r?(r[qt].modified_&&(hs(n),nr(4)),Dr(e)&&(e=Ti(n,e),n.parent_||Ci(n,e)),n.patches_&&Lr("Patches").generateReplacementPatches_(r[qt].base_,e,n.patches_,n.inversePatches_)):e=Ti(n,r,[]),hs(n),n.patches_&&n.patchListener_(n.patches_,n.inversePatches_),e!==md?e:void 0}function Ti(e,n,r){if($i(n))return n;const o=e.immer_.shouldUseStrictIteration(),l=n[qt];if(!l)return Ii(n,(u,p)=>Qc(e,l,n,u,p,r),o),n;if(l.scope_!==e)return n;if(!l.modified_)return Ci(e,l.base_,!0),l.base_;if(!l.finalized_){l.finalized_=!0,l.scope_.unfinalizedDrafts_--;const u=l.copy_;let p=u,f=!1;l.type_===3&&(p=new Set(u),u.clear(),f=!0),Ii(p,(h,x)=>Qc(e,l,u,h,x,r,f),o),Ci(e,u,!1),r&&e.patches_&&Lr("Patches").generatePatches_(l,r,e.patches_,e.inversePatches_)}return l.copy_}function Qc(e,n,r,o,l,u,p){if(l==null||typeof l!="object"&&!p)return;const f=$i(l);if(!(f&&!p)){if(on(l)){const h=u&&n&&n.type_!==3&&!fs(n.assigned_,o)?u.concat(o):void 0,x=Ti(e,l,h);if(yd(r,o,x),on(x))e.canAutoFreeze_=!1;else return}else p&&r.add(l);if(Dr(l)&&!f){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||n&&n.base_&&n.base_[o]===l&&f)return;Ti(e,l),(!n||!n.scope_.parent_)&&typeof o!="symbol"&&(Vn(r)?r.has(o):Object.prototype.propertyIsEnumerable.call(r,o))&&Ci(e,l)}}}function Ci(e,n,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&ys(n,r)}function Ag(e,n){const r=Array.isArray(e),o={type_:r?1:0,scope_:n?n.scope_:bd(),modified_:!1,finalized_:!1,assigned_:{},parent_:n,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let l=o,u=bs;r&&(l=[o],u=Hn);const{revoke:p,proxy:f}=Proxy.revocable(l,u);return o.draft_=f,o.revoke_=p,f}var bs={get(e,n){if(n===qt)return e;const r=jr(e);if(!fs(r,n))return Ig(e,r,n);const o=r[n];return e.finalized_||!Dr(o)?o:o===ma(e.base_,n)?(wa(e),e.copy_[n]=ms(o,e)):o},has(e,n){return n in jr(e)},ownKeys(e){return Reflect.ownKeys(jr(e))},set(e,n,r){const o=vd(jr(e),n);if(o!=null&&o.set)return o.set.call(e.draft_,r),!0;if(!e.modified_){const l=ma(jr(e),n),u=l==null?void 0:l[qt];if(u&&u.base_===r)return e.copy_[n]=r,e.assigned_[n]=!1,!0;if(xg(r,l)&&(r!==void 0||fs(e.base_,n)))return!0;wa(e),gs(e)}return e.copy_[n]===r&&(r!==void 0||n in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[n])||(e.copy_[n]=r,e.assigned_[n]=!0),!0},deleteProperty(e,n){return ma(e.base_,n)!==void 0||n in e.base_?(e.assigned_[n]=!1,wa(e),gs(e)):delete e.assigned_[n],e.copy_&&delete e.copy_[n],!0},getOwnPropertyDescriptor(e,n){const r=jr(e),o=Reflect.getOwnPropertyDescriptor(r,n);return o&&{writable:!0,configurable:e.type_!==1||n!=="length",enumerable:o.enumerable,value:r[n]}},defineProperty(){nr(11)},getPrototypeOf(e){return zn(e.base_)},setPrototypeOf(){nr(12)}},Hn={};Ii(bs,(e,n)=>{Hn[e]=function(){return arguments[0]=arguments[0][0],n.apply(this,arguments)}});Hn.deleteProperty=function(e,n){return Hn.set.call(this,e,n,void 0)};Hn.set=function(e,n,r){return bs.set.call(this,e[0],n,r,e[0])};function ma(e,n){const r=e[qt];return(r?jr(r):e)[n]}function Ig(e,n,r){var l;const o=vd(n,r);return o?"value"in o?o.value:(l=o.get)==null?void 0:l.call(e.draft_):void 0}function vd(e,n){if(!(n in e))return;let r=zn(e);for(;r;){const o=Object.getOwnPropertyDescriptor(r,n);if(o)return o;r=zn(r)}}function gs(e){e.modified_||(e.modified_=!0,e.parent_&&gs(e.parent_))}function wa(e){e.copy_||(e.copy_=ds(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Tg=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(n,r,o)=>{if(typeof n=="function"&&typeof r!="function"){const u=r;r=n;const p=this;return function(h=u,...x){return p.produce(h,_=>r.call(this,_,...x))}}typeof r!="function"&&nr(6),o!==void 0&&typeof o!="function"&&nr(7);let l;if(Dr(n)){const u=Yc(this),p=ms(n,void 0);let f=!0;try{l=r(p),f=!1}finally{f?hs(u):ps(u)}return Xc(u,o),Jc(l,u)}else if(!n||typeof n!="object"){if(l=r(n),l===void 0&&(l=n),l===md&&(l=void 0),this.autoFreeze_&&ys(l,!0),o){const u=[],p=[];Lr("Patches").generateReplacementPatches_(n,l,u,p),o(u,p)}return l}else nr(1,n)},this.produceWithPatches=(n,r)=>{if(typeof n=="function")return(p,...f)=>this.produceWithPatches(p,h=>n(h,...f));let o,l;return[this.produce(n,r,(p,f)=>{o=p,l=f}),o,l]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Dr(e)||nr(8),on(e)&&(e=Cg(e));const n=Yc(this),r=ms(e,void 0);return r[qt].isManual_=!0,ps(n),r}finishDraft(e,n){const r=e&&e[qt];(!r||!r.isManual_)&&nr(9);const{scope_:o}=r;return Xc(o,n),Jc(void 0,o)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,n){let r;for(r=n.length-1;r>=0;r--){const l=n[r];if(l.path.length===0&&l.op==="replace"){e=l.value;break}}r>-1&&(n=n.slice(r+1));const o=Lr("Patches").applyPatches_;return on(e)?o(e,n):this.produce(e,l=>o(l,n))}};function ms(e,n){const r=Vn(e)?Lr("MapSet").proxyMap_(e,n):Li(e)?Lr("MapSet").proxySet_(e,n):Ag(e,n);return(n?n.scope_:bd()).drafts_.push(r),r}function Cg(e){return on(e)||nr(10,e),xd(e)}function xd(e){if(!Dr(e)||$i(e))return e;const n=e[qt];let r,o=!0;if(n){if(!n.modified_)return n.base_;n.finalized_=!0,r=ds(e,n.scope_.immer_.useStrictShallowCopy_),o=n.scope_.immer_.shouldUseStrictIteration()}else r=ds(e,!0);return Ii(r,(l,u)=>{yd(r,l,xd(u))},o),n&&(n.finalized_=!1),r}var Rg=new Tg,tt=Rg.produce;const Og={".js":"javascript",".jsx":"javascript",".ts":"typescript",".tsx":"typescript",".py":"python",".rb":"ruby",".go":"go",".rs":"rust",".c":"c",".h":"c",".cpp":"cpp",".cc":"cpp",".cxx":"cpp",".hpp":"cpp",".cs":"csharp",".java":"java",".swift":"swift",".kt":"kotlin",".php":"php",".html":"html",".htm":"html",".css":"css",".scss":"scss",".less":"less",".json":"json",".xml":"xml",".yaml":"yaml",".yml":"yaml",".md":"markdown",".sql":"sql",".sh":"shell",".bash":"shell",".zsh":"shell",".ps1":"powershell",".r":"r",".lua":"lua",".pl":"perl",".pm":"perl",".dart":"dart",".ex":"elixir",".exs":"elixir",".erl":"erlang",".hs":"haskell",".scala":"scala",".clj":"clojure",".coffee":"coffeescript",".bat":"bat",".cmd":"bat",".ini":"ini",".toml":"ini",".dockerfile":"dockerfile",".graphql":"graphql",".gql":"graphql",".vue":"html",".svelte":"html",".log":"plaintext",".txt":"plaintext",".env":"plaintext",".gitignore":"plaintext",".makefile":"plaintext"};function sr(e){if(!e)return"plaintext";const n=e.toLowerCase();if(n==="dockerfile")return"dockerfile";if(n==="makefile")return"makefile";if(n==="cmakelists.txt")return"cmake";const r=n.lastIndexOf(".");if(r===-1)return"plaintext";const o=n.substring(r);return Og[o]||"plaintext"}function br(e){const n=(e.match(/\r\n/g)||[]).length,r=(e.match(new RegExp("(?<!\\r)\\n","g"))||[]).length,o=(e.match(/\r(?!\n)/g)||[]).length;return n>=r&&n>=o?"CRLF":o>r?"CR":"LF"}function vr(){return Math.random().toString(36).substring(2,11)+Date.now().toString(36)}const eu="3.1.0",pi="SavedSnippets",tu={1:"#ff4444",2:"#44ff44",3:"#4488ff",4:"#ff44ff",5:"#ffaa00"},ru={none:"transparent",color1:"#ff4444",color2:"#44bb44",color3:"#4488ff",color4:"#ff8800",color5:"#cc44cc"},Mg=14,Pg=4,jg="'SF Mono', 'Menlo', 'Monaco', 'Courier New', monospace",Bg=5e3,Fg="https://www.google.com/search?q=",Dg="yyyy-MM-dd HH:mm:ss",Lg=20,$g=20,Ng=50,Ug=-5,zg=10,Gg=200,Hg=100,Wg=600,gi="GitCredentials",ya="GitAuthor",ba="GitSettings",mi="BrowserWorkspaces",Av=50,_d="https://cors.isomorphic-git.org",qg="Notemac++ User",Vg="user@notemac.app",nu="AIProviders",tr="AICredentials",va="AISettings",iu="AIConversations",Sd=500,Zg=8e3,Kg=.3,Xg=.7,au=50,Yg=256,wi=2e3,Jg=256,Qg=.3,em=72,kd="2023-06-01",yi=24,Iv=8,Tv="Iv1.CONFIGURE_YOUR_APP",tm=150,rm=500,xa=36,nm=100,im=200,ou=18,am=32,om=300,Cv=560,Rv=420,Ov=80,sm=4,lm=9998,cm=9999,Ed=1e4,Mv=2e3,Pv=5,jv=60,Bv=3600,Fv=86400,Dv=604800,um=(e,n)=>({tabs:[],activeTabId:null,closedTabs:[],recentFiles:[],addTab:r=>{const o=vr(),l={id:o,name:(r==null?void 0:r.name)||`new ${n().tabs.length+1}`,path:(r==null?void 0:r.path)||null,content:(r==null?void 0:r.content)||"",originalContent:(r==null?void 0:r.content)||"",language:(r==null?void 0:r.language)||sr((r==null?void 0:r.name)||""),encoding:(r==null?void 0:r.encoding)||"utf-8",lineEnding:(r==null?void 0:r.lineEnding)||"LF",isModified:!1,isReadOnly:(r==null?void 0:r.isReadOnly)||!1,isPinned:!1,tabColor:"none",cursorLine:1,cursorColumn:1,scrollTop:0,bookmarks:[],marks:[],hiddenLines:[],isMonitoring:!1};return e(tt(u=>{u.tabs.push(l),u.activeTabId=o})),o},closeTab:r=>{e(tt(o=>{const l=o.tabs.findIndex(u=>u.id===r);if(l!==-1&&(o.closedTabs.push({...o.tabs[l]}),o.closedTabs.length>Lg&&o.closedTabs.shift(),o.tabs.splice(l,1),o.activeTabId===r))if(0<o.tabs.length){const u=Math.min(l,o.tabs.length-1);o.activeTabId=o.tabs[u].id}else o.activeTabId=null}))},closeAllTabs:()=>{const r=n().tabs;e(tt(o=>{o.closedTabs.push(...r),o.tabs=[],o.activeTabId=null}))},closeOtherTabs:r=>{e(tt(o=>{const l=o.tabs.filter(u=>u.id!==r);o.closedTabs.push(...l),o.tabs=o.tabs.filter(u=>u.id===r),o.activeTabId=r}))},closeTabsToLeft:r=>{e(tt(o=>{const l=o.tabs.findIndex(p=>p.id===r);if(0>=l)return;const u=o.tabs.splice(0,l);o.closedTabs.push(...u)}))},closeTabsToRight:r=>{e(tt(o=>{const l=o.tabs.findIndex(p=>p.id===r);if(l===-1||l>=o.tabs.length-1)return;const u=o.tabs.splice(l+1);o.closedTabs.push(...u)}))},closeUnchangedTabs:()=>{e(tt(r=>{const o=r.tabs.filter(l=>!l.isModified);r.closedTabs.push(...o),r.tabs=r.tabs.filter(l=>l.isModified),0<r.tabs.length&&!r.tabs.find(l=>l.id===r.activeTabId)?r.activeTabId=r.tabs[0].id:r.tabs.length===0&&(r.activeTabId=null)}))},closeAllButPinned:()=>{e(tt(r=>{const o=r.tabs.filter(l=>!l.isPinned);r.closedTabs.push(...o),r.tabs=r.tabs.filter(l=>l.isPinned),0<r.tabs.length&&!r.tabs.find(l=>l.id===r.activeTabId)?r.activeTabId=r.tabs[0].id:r.tabs.length===0&&(r.activeTabId=null)}))},restoreLastClosedTab:()=>{e(tt(r=>{if(r.closedTabs.length===0)return;const o=r.closedTabs.pop();o.id=vr(),r.tabs.push(o),r.activeTabId=o.id}))},setActiveTab:r=>e({activeTabId:r}),updateTab:(r,o)=>{e(tt(l=>{const u=l.tabs.find(p=>p.id===r);u&&Object.assign(u,o)}))},updateTabContent:(r,o)=>{e(tt(l=>{const u=l.tabs.find(p=>p.id===r);u&&(u.content=o,u.isModified=o!==u.originalContent)}))},togglePinTab:r=>{e(tt(o=>{const l=o.tabs.find(u=>u.id===r);l&&(l.isPinned=!l.isPinned)}))},setTabColor:(r,o)=>{e(tt(l=>{const u=l.tabs.find(p=>p.id===r);u&&(u.tabColor=o)}))},moveTab:(r,o)=>{e(tt(l=>{const[u]=l.tabs.splice(r,1);l.tabs.splice(o,0,u)}))},nextTab:()=>{const{tabs:r,activeTabId:o}=n();if(1>=r.length)return;const u=(r.findIndex(p=>p.id===o)+1)%r.length;e({activeTabId:r[u].id})},prevTab:()=>{const{tabs:r,activeTabId:o}=n();if(1>=r.length)return;const u=(r.findIndex(p=>p.id===o)-1+r.length)%r.length;e({activeTabId:r[u].id})},goToTab:r=>{const{tabs:o}=n();0<=r&&r<o.length&&e({activeTabId:o[r].id})},moveTabForward:()=>{const{tabs:r,activeTabId:o}=n(),l=r.findIndex(u=>u.id===o);l<r.length-1&&e(tt(u=>{const[p]=u.tabs.splice(l,1);u.tabs.splice(l+1,0,p)}))},moveTabBackward:()=>{const{tabs:r,activeTabId:o}=n(),l=r.findIndex(u=>u.id===o);0<l&&e(tt(u=>{const[p]=u.tabs.splice(l,1);u.tabs.splice(l-1,0,p)}))},addRecentFile:(r,o)=>{e(tt(l=>{l.recentFiles=l.recentFiles.filter(u=>u.path!==r),l.recentFiles.unshift({path:r,name:o}),l.recentFiles.length>$g&&l.recentFiles.pop()}))}}),fm={query:"",replaceText:"",isRegex:!1,isCaseSensitive:!1,isWholeWord:!1,searchInSelection:!1,wrapAround:!0},dm=(e,n)=>({showFindReplace:!1,findReplaceMode:"find",searchOptions:{...fm},searchResults:[],showIncrementalSearch:!1,setShowFindReplace:(r,o)=>e({showFindReplace:r,findReplaceMode:o||n().findReplaceMode}),updateSearchOptions:r=>{e(o=>({searchOptions:{...o.searchOptions,...r}}))},setShowIncrementalSearch:r=>e({showIncrementalSearch:r})}),hm=(e,n)=>({isRecordingMacro:!1,currentMacroActions:[],savedMacros:[],startRecordingMacro:()=>e({isRecordingMacro:!0,currentMacroActions:[]}),stopRecordingMacro:()=>e({isRecordingMacro:!1}),addMacroAction:r=>{n().isRecordingMacro&&e(tt(o=>{o.currentMacroActions.push(r)}))},saveMacro:r=>{const o=n().currentMacroActions;o.length!==0&&e(tt(l=>{l.savedMacros.push({id:vr(),name:r,actions:[...o]})}))}}),pm={theme:"mac-glass",customThemeBase:"mac-glass",customThemeColors:{},fontSize:Mg,fontFamily:jg,tabSize:Pg,insertSpaces:!0,wordWrap:!1,showWhitespace:!1,showLineNumbers:!0,showMinimap:!0,showIndentGuides:!0,showEOL:!1,showNonPrintable:!1,showWrapSymbol:!1,autoSave:!1,autoSaveDelay:Bg,highlightCurrentLine:!0,matchBrackets:!0,autoCloseBrackets:!0,autoCloseQuotes:!0,autoIndent:!0,smoothScrolling:!0,cursorBlinking:"blink",cursorStyle:"line",renderWhitespace:"none",virtualSpace:!1,alwaysOnTop:!1,distractionFreeMode:!1,darkMode:!0,syncScrollVertical:!1,syncScrollHorizontal:!1,rememberLastSession:!0,searchEngine:Fg,dateTimeFormat:Dg};function gm(){return{...pm}}const mm=(e,n)=>({sidebarPanel:null,sidebarWidth:260,showStatusBar:!0,showToolbar:!0,splitView:"none",splitTabId:null,zoomLevel:0,foldAllState:!1,clipboardHistory:[],settings:gm(),showSettings:!1,showGoToLine:!1,showAbout:!1,showRunCommand:!1,showColumnEditor:!1,showSummary:!1,showCharInRange:!1,showShortcutMapper:!1,showCommandPalette:!1,showQuickOpen:!1,showDiffViewer:!1,showSnippetManager:!1,showTerminalPanel:!1,terminalHeight:Gg,showCloneDialog:!1,showGitSettings:!1,setSidebarPanel:r=>e({sidebarPanel:r}),toggleSidebar:()=>{const r=n().sidebarPanel;e({sidebarPanel:r?null:"explorer"})},setZoomLevel:r=>e({zoomLevel:Math.max(Ug,Math.min(zg,r))}),setSplitView:(r,o)=>e({splitView:r,splitTabId:o||null}),addClipboardEntry:r=>{e(tt(o=>{o.clipboardHistory.unshift({text:r,timestamp:Date.now()}),o.clipboardHistory.length>Ng&&o.clipboardHistory.pop()}))},updateSettings:r=>{e(tt(o=>{Object.assign(o.settings,r)}))},setShowSettings:r=>e({showSettings:r}),setShowGoToLine:r=>e({showGoToLine:r}),setShowAbout:r=>e({showAbout:r}),setShowRunCommand:r=>e({showRunCommand:r}),setShowColumnEditor:r=>e({showColumnEditor:r}),setShowSummary:r=>e({showSummary:r}),setShowCharInRange:r=>e({showCharInRange:r}),setShowShortcutMapper:r=>e({showShortcutMapper:r}),setShowCommandPalette:r=>e({showCommandPalette:r}),setShowQuickOpen:r=>e({showQuickOpen:r}),setShowDiffViewer:r=>e({showDiffViewer:r}),setShowSnippetManager:r=>e({showSnippetManager:r}),setShowTerminalPanel:r=>e({showTerminalPanel:r}),setShowCloneDialog:r=>e({showCloneDialog:r}),setShowGitSettings:r=>e({showGitSettings:r}),setTerminalHeight:r=>e({terminalHeight:Math.max(Hg,Math.min(Wg,r))}),saveSession:()=>{const r=n();return{tabs:r.tabs.map(o=>({path:o.path,name:o.name,language:o.language,cursorLine:o.cursorLine,cursorColumn:o.cursorColumn,scrollTop:o.scrollTop,content:o.path?void 0:o.content})),activeTabIndex:r.tabs.findIndex(o=>o.id===r.activeTabId),sidebarPanel:r.sidebarPanel}},loadSession:r=>{var l,u;const o=r.tabs.map(p=>({id:vr(),name:p.name,path:p.path,content:p.content||"",originalContent:p.content||"",language:p.language,encoding:"utf-8",lineEnding:"LF",isModified:!1,isReadOnly:!1,isPinned:!1,tabColor:"none",cursorLine:p.cursorLine,cursorColumn:p.cursorColumn,scrollTop:p.scrollTop,bookmarks:[],marks:[],hiddenLines:[],isMonitoring:!1}));e({tabs:o,activeTabId:((l=o[r.activeTabIndex])==null?void 0:l.id)||((u=o[0])==null?void 0:u.id)||null,sidebarPanel:r.sidebarPanel})}}),wm=e=>({fileTree:[],workspacePath:null,setFileTree:n=>e({fileTree:n}),setWorkspacePath:n=>e({workspacePath:n}),toggleTreeNode:n=>{e(tt(r=>{const o=l=>{for(const u of l){if(u.path===n)return u.isExpanded=!u.isExpanded,!0;if(u.children&&o(u.children))return!0}return!1};o(r.fileTree)}))}});function ur(e,n){try{const r=localStorage.getItem(e);return r===null?n??null:JSON.parse(r)}catch{return null}}function jt(e,n){try{localStorage.setItem(e,JSON.stringify(n))}catch{}}function ym(e){try{localStorage.removeItem(e)}catch{}}const bm=(e,n)=>({savedSnippets:[],addSnippet:r=>{e(tt(o=>{const l={...r,id:vr()};o.savedSnippets.push(l)})),jt(pi,n().savedSnippets)},removeSnippet:r=>{e(tt(o=>{const l=o.savedSnippets.findIndex(u=>u.id===r);l!==-1&&o.savedSnippets.splice(l,1)})),jt(pi,n().savedSnippets)},updateSnippet:(r,o)=>{e(tt(l=>{const u=l.savedSnippets.find(p=>p.id===r);u&&Object.assign(u,o)})),jt(pi,n().savedSnippets)},loadSnippets:()=>{const r=ur(pi);r&&e({savedSnippets:r})}});function su(){return{autoFetch:!0,autoFetchInterval:3e5,showUntracked:!0,showIgnored:!1,corsProxy:_d}}function lu(){return{name:qg,email:Vg}}const vm=(e,n)=>({isRepoInitialized:!1,currentBranch:"main",branches:[],remotes:[],gitStatus:null,commitLog:[],gitCredentials:null,gitAuthor:lu(),gitSettings:su(),isBrowserWorkspace:!1,browserWorkspaces:[],isGitOperationInProgress:!1,currentGitOperation:null,gitOperationProgress:0,gitOperationError:null,SetRepoInitialized:r=>e({isRepoInitialized:r}),SetCurrentBranch:r=>e({currentBranch:r}),SetBranches:r=>e({branches:r}),SetRemotes:r=>e({remotes:r}),SetGitStatus:r=>e({gitStatus:r}),SetCommitLog:r=>e({commitLog:r}),SetGitCredentials:r=>{e({gitCredentials:r}),r!==null?jt(gi,{type:r.type,username:r.username}):jt(gi,null)},SetGitAuthor:r=>{e({gitAuthor:r}),jt(ya,r)},UpdateGitSettings:r=>{e(tt(l=>{Object.assign(l.gitSettings,r)}));const o=n().gitSettings;jt(ba,o)},SetIsBrowserWorkspace:r=>e({isBrowserWorkspace:r}),AddBrowserWorkspace:r=>{e(tt(o=>{const l=o.browserWorkspaces.findIndex(u=>u.id===r.id);l!==-1?o.browserWorkspaces[l]=r:o.browserWorkspaces.push(r)})),jt(mi,n().browserWorkspaces)},RemoveBrowserWorkspace:r=>{e(tt(o=>{const l=o.browserWorkspaces.findIndex(u=>u.id===r);l!==-1&&o.browserWorkspaces.splice(l,1)})),jt(mi,n().browserWorkspaces)},SetGitOperationInProgress:r=>e({isGitOperationInProgress:r}),SetCurrentGitOperation:r=>e({currentGitOperation:r}),SetGitOperationProgress:r=>e({gitOperationProgress:r}),SetGitOperationError:r=>e({gitOperationError:r}),LoadGitState:()=>{const r=ur(gi),o=ur(ya),l=ur(ba),u=ur(mi);e({gitCredentials:r||null,gitAuthor:o||lu(),gitSettings:l||su(),browserWorkspaces:u||[]})},SaveGitState:()=>{const r=n();r.gitCredentials!==null&&jt(gi,{type:r.gitCredentials.type,username:r.gitCredentials.username}),jt(ya,r.gitAuthor),jt(ba,r.gitSettings),jt(mi,r.browserWorkspaces)},GetStagedFileCount:()=>{var r;return((r=n().gitStatus)==null?void 0:r.stagedFiles.length)||0},GetChangedFileCount:()=>{const r=n().gitStatus;return r===null?0:r.stagedFiles.length+r.unstagedFiles.length+r.untrackedFiles.length}});function cu(){return{inlineCompletionEnabled:!0,inlineDebounceMs:Sd,inlineMaxTokens:Yg,chatTemperature:Xg,codeTemperature:Kg,maxContextTokens:Zg,systemPrompt:"",showAiStatusIndicator:!0}}function uu(){return[{id:"openai",name:"OpenAI",type:"openai",baseUrl:"https://api.openai.com",isBuiltIn:!0,models:xm()},{id:"anthropic",name:"Anthropic",type:"anthropic",baseUrl:"https://api.anthropic.com",isBuiltIn:!0,models:_m()},{id:"google",name:"Google AI",type:"google",baseUrl:"https://generativelanguage.googleapis.com",isBuiltIn:!0,models:Sm()}]}function xm(){return[{id:"gpt-5.2",name:"GPT-5.2",providerId:"openai",contextWindow:1047576,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-5.2-pro",name:"GPT-5.2 Pro",providerId:"openai",contextWindow:1047576,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-4.1",name:"GPT-4.1",providerId:"openai",contextWindow:1047576,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-4.1-mini",name:"GPT-4.1 Mini",providerId:"openai",contextWindow:1047576,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-4.1-nano",name:"GPT-4.1 Nano",providerId:"openai",contextWindow:1047576,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-4o",name:"GPT-4o",providerId:"openai",contextWindow:128e3,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-4o-mini",name:"GPT-4o Mini",providerId:"openai",contextWindow:128e3,supportsStreaming:!0,supportsFIM:!1},{id:"o3",name:"o3",providerId:"openai",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1},{id:"o4-mini",name:"o4-mini",providerId:"openai",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1}]}function _m(){return[{id:"claude-opus-4-6",name:"Claude Opus 4.6",providerId:"anthropic",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1},{id:"claude-sonnet-4-6",name:"Claude Sonnet 4.6",providerId:"anthropic",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1},{id:"claude-opus-4-5-20251101",name:"Claude Opus 4.5",providerId:"anthropic",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1},{id:"claude-sonnet-4-5-20250929",name:"Claude Sonnet 4.5",providerId:"anthropic",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1},{id:"claude-haiku-4-5-20251001",name:"Claude Haiku 4.5",providerId:"anthropic",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1}]}function Sm(){return[{id:"gemini-2.5-pro",name:"Gemini 2.5 Pro",providerId:"google",contextWindow:1048576,supportsStreaming:!0,supportsFIM:!1},{id:"gemini-2.5-flash",name:"Gemini 2.5 Flash",providerId:"google",contextWindow:1048576,supportsStreaming:!0,supportsFIM:!1},{id:"gemini-2.5-flash-lite",name:"Gemini 2.5 Flash Lite",providerId:"google",contextWindow:1048576,supportsStreaming:!0,supportsFIM:!1}]}function Lv(e,n,r,o){return{id:e,name:n,type:"custom",baseUrl:r,isBuiltIn:!1,models:o}}function $v(e,n,r,o=8192){return{id:e,name:n,providerId:r,contextWindow:o,supportsStreaming:!0,supportsFIM:!1}}function Ad(){return typeof window<"u"&&window.__TAURI__?"tauri":typeof window<"u"&&window.electronAPI?"electron":"web"}function km(){return Ad()!=="web"}function Zn(){return Ad()==="tauri"}function Ni(){const e=window.electronAPI;return e==null||typeof e.safeStorageEncrypt!="function"?null:e}let bi=null;async function vs(){if(bi!==null)return bi;try{return bi=(await ht(()=>import("./core-DhEqZVGG.js"),[],import.meta.url)).invoke,bi}catch{return null}}function Em(){return Ni()!==null||Zn()}async function Am(){if(Zn())try{const n=await vs();return n===null?!1:await n("is_safe_storage_available")}catch{return!1}const e=Ni();if(e===null)return!1;try{return await e.isSafeStorageAvailable()}catch{return!1}}async function Im(e){if(Zn()){const r=await vs();if(r===null)throw new Error("Tauri safe storage not available");return await r("safe_storage_encrypt",{plaintext:e})}const n=Ni();if(n===null)throw new Error("Safe storage not available");return await n.safeStorageEncrypt(e)}async function Tm(e){if(Zn()){const r=await vs();if(r===null)throw new Error("Tauri safe storage not available");return await r("safe_storage_decrypt",{encrypted:e})}const n=Ni();if(n===null)throw new Error("Safe storage not available");return await n.safeStorageDecrypt(e)}const Cm="NotemacKeyStore",sn="keys",Id="NotemacCryptoKey_v1",xs="AES-GCM",Rm=256,$n=12;let Jr=null;function _s(){return typeof crypto<"u"&&crypto.subtle!==null&&typeof crypto.subtle<"u"}function Td(){return new Promise((e,n)=>{const r=indexedDB.open(Cm,1);r.onupgradeneeded=()=>{const o=r.result;o.objectStoreNames.contains(sn)||o.createObjectStore(sn,{keyPath:"id"})},r.onsuccess=()=>e(r.result),r.onerror=()=>n(r.error)})}async function Om(){try{const e=await Td();return new Promise(n=>{const l=e.transaction(sn,"readonly").objectStore(sn).get(Id);l.onsuccess=()=>{const u=l.result;n(u!=null?u.key:null)},l.onerror=()=>n(null)})}catch{return null}}async function Mm(e){try{const n=await Td();return new Promise((r,o)=>{const l=n.transaction(sn,"readwrite");l.objectStore(sn).put({id:Id,key:e}),l.oncomplete=()=>r(),l.onerror=()=>o(l.error)})}catch{}}async function Cd(){if(Jr!==null)return Jr;const e=await Om();if(e!==null)return Jr=e,Jr;const n=await crypto.subtle.generateKey({name:xs,length:Rm},!1,["encrypt","decrypt"]);return await Mm(n),Jr=n,Jr}async function Pm(e){if(!_s())return e;try{const n=await Cd(),r=crypto.getRandomValues(new Uint8Array($n)),l=new TextEncoder().encode(e),u=await crypto.subtle.encrypt({name:xs,iv:r},n,l),p=new Uint8Array($n+u.byteLength);p.set(r,0),p.set(new Uint8Array(u),$n);let f="";const h=p.byteLength;for(let x=0;x<h;x++)f+=String.fromCharCode(p[x]);return btoa(f)}catch{return e}}async function jm(e){if(!_s())return e;try{const n=await Cd(),r=atob(e),o=new Uint8Array(r.length);for(let h=0,x=r.length;h<x;h++)o[h]=r.charCodeAt(h);const l=o.slice(0,$n),u=o.slice($n),p=await crypto.subtle.decrypt({name:xs,iv:l},n,u);return new TextDecoder().decode(p)}catch{return e}}const Bm="SecureCred_",Ri=new Map;function Oi(e){return`${Bm}${e}`}async function Fm(){return Em()&&await Am()?"safeStorage":_s()?"cryptoSubtle":"none"}async function Dm(e,n){return n==="safeStorage"?await Im(e):n==="cryptoSubtle"?await Pm(e):e}async function Lm(e,n){return n==="safeStorage"?await Tm(e):n==="cryptoSubtle"?await jm(e):e}function $m(e){return e.expiresAt===null?!1:Date.now()>e.expiresAt}async function jn(e,n,r){if(r===0){Ri.set(e,n);return}try{const o=await Fm(),u={encrypted:await Dm(n,o),method:o,storedAt:Date.now(),expiresAt:r!=null?Date.now()+r*1e3:null};localStorage.setItem(Oi(e),JSON.stringify(u))}catch{Ri.set(e,n)}}async function Nm(e){const n=Ri.get(e);if(n!==void 0)return n;try{const r=localStorage.getItem(Oi(e));if(r===null)return null;const o=JSON.parse(r);return $m(o)?(localStorage.removeItem(Oi(e)),null):await Lm(o.encrypted,o.method)}catch{return null}}function _a(e){Ri.delete(e);try{localStorage.removeItem(Oi(e))}catch{}}function Rd(){return Me.getState()}let nn=null;function Od(e,n,r){return{model:n,messages:e,temperature:r.temperature??.7,max_tokens:r.maxTokens??4096,stream:r.stream??!0}}function Md(e,n,r){const o=[],l=[];for(let u=0,p=e.length;u<p;u++)e[u].role==="system"?o.push(e[u].content):l.push(e[u]);return{model:n,system:0<o.length?o.join(`
`):void 0,messages:l.map(u=>({role:u.role,content:u.content})),max_tokens:r.maxTokens??4096,temperature:r.temperature??.7,stream:r.stream??!0}}function Pd(e,n){const r=e.filter(l=>l.role!=="system").map(l=>({role:l.role==="assistant"?"model":"user",parts:[{text:l.content}]})),o=e.find(l=>l.role==="system");return{contents:r,systemInstruction:o?{parts:[{text:o.content}]}:void 0,generationConfig:{temperature:n.temperature??.7,maxOutputTokens:n.maxTokens??4096}}}function jd(e,n,r){if(e.type==="anthropic")return`${e.baseUrl}/v1/messages`;if(e.type==="google"){const o=r?"?alt=sse":"";return`${e.baseUrl}/v1beta/models/${n}:${r?"streamGenerateContent":"generateContent"}${o}`}return`${e.baseUrl}/v1/chat/completions`}function Bd(e,n){const r={"Content-Type":"application/json"};return e.type==="anthropic"?(r["x-api-key"]=n.apiKey,r["anthropic-version"]=kd,r["anthropic-dangerous-direct-browser-access"]="true"):e.type==="google"?r["x-goog-api-key"]=n.apiKey:r.Authorization=`Bearer ${n.apiKey}`,r}function Um(e){var r,o,l;if(!e.startsWith("data: "))return null;const n=e.slice(6).trim();if(n==="[DONE]")return null;try{return((l=(o=(r=JSON.parse(n).choices)==null?void 0:r[0])==null?void 0:o.delta)==null?void 0:l.content)||null}catch{return null}}function zm(e){var r;if(!e.startsWith("data: "))return null;const n=e.slice(6).trim();try{const o=JSON.parse(n);return o.type==="content_block_delta"&&((r=o.delta)==null?void 0:r.text)||null}catch{return null}}function Gm(e){var r,o,l,u,p;if(!e.startsWith("data: "))return null;const n=e.slice(6).trim();try{return((p=(u=(l=(o=(r=JSON.parse(n).candidates)==null?void 0:r[0])==null?void 0:o.content)==null?void 0:l.parts)==null?void 0:u[0])==null?void 0:p.text)||null}catch{return null}}function fu(e,n){return e==="anthropic"?zm(n):e==="google"?Gm(n):Um(n)}async function Ui(e,n={},r,o,l){var N,L,D,U,G,X,q,Y,B,K,se;const u=Rd(),p=u.GetActiveProvider();if(p===null){const S="No active AI provider configured";throw l==null||l(S),new Error(S)}const f=u.GetCredentialForProvider(p.id);if(f===null){const S=`No API key configured for ${p.name}`;throw l==null||l(S),new Error(S)}const h=u.activeModelId,x=n.stream!==!1,_=[...e];n.systemPrompt&&!_.some(S=>S.role==="system")&&_.unshift({role:"system",content:n.systemPrompt});const y=u.aiSettings.systemPrompt;y&&!_.some(S=>S.role==="system")&&_.unshift({role:"system",content:y});let O;p.type==="anthropic"?O=Md(_,h,{...n,stream:x}):p.type==="google"?O=Pd(_,{...n}):O=Od(_,h,{...n,stream:x});const R=jd(p,h,x),z=Bd(p,f);qm(),nn=new AbortController;try{const S=await fetch(R,{method:"POST",headers:z,body:JSON.stringify(O),signal:nn.signal});if(!S.ok){const ne=await S.text();let Q=`API error ${S.status}`;try{const oe=JSON.parse(ne);Q=((N=oe.error)==null?void 0:N.message)||oe.message||Q}catch{}throw l==null||l(Q),new Error(Q)}if(x&&S.body)return await Hm(S.body,p.type,r,o);{const ne=await S.json();let Q="";return p.type==="anthropic"?Q=((D=(L=ne.content)==null?void 0:L[0])==null?void 0:D.text)||"":p.type==="google"?Q=((Y=(q=(X=(G=(U=ne.candidates)==null?void 0:U[0])==null?void 0:G.content)==null?void 0:X.parts)==null?void 0:q[0])==null?void 0:Y.text)||"":Q=((se=(K=(B=ne.choices)==null?void 0:B[0])==null?void 0:K.message)==null?void 0:se.content)||"",o==null||o(Q),Q}}catch(S){if(S instanceof Error&&S.name==="AbortError")return o==null||o(""),"";const ne=S instanceof Error?S.message:String(S);throw l==null||l(ne),S}finally{nn=null}}async function Hm(e,n,r,o){const l=e.getReader(),u=new TextDecoder;let p="",f="";try{for(;;){const{done:h,value:x}=await l.read();if(h)break;f+=u.decode(x,{stream:!0});const _=f.split(`
`);f=_.pop()||"";const y=_.length;for(let O=0;O<y;O++){const R=_[O].trim();if(R.length===0)continue;const z=fu(n,R);z!==null&&0<z.length&&(p+=z,r==null||r(z))}}if(0<f.trim().length){const h=fu(n,f.trim());h!==null&&0<h.length&&(p+=h,r==null||r(h))}}finally{l.releaseLock()}return o==null||o(p),p}async function Wm(e,n,r,o,l){const p=Rd().aiSettings,f=`You are an intelligent code completion assistant. Complete the code at the cursor position. Only output the completion text, no explanations, no markdown, no code fences. The code is in ${r}.`,h=`Complete the code at [CURSOR]:

${e}[CURSOR]${n}

Output ONLY the completion text that goes at [CURSOR]. No explanations.`;return Ui([{role:"system",content:f},{role:"user",content:h}],{temperature:p.codeTemperature,maxTokens:p.inlineMaxTokens,stream:!1},void 0,o,l)}function qm(){nn!==null&&(nn.abort(),nn=null)}async function Nv(e,n){var r;try{const o=0<e.models.length?e.models[0].id:"",l=jd(e,o,!1),u=Bd(e,n);let p;const f=[{role:"user",content:'Say "ok".'}];e.type==="anthropic"?p=Md(f,o,{maxTokens:10,stream:!1}):e.type==="google"?p=Pd(f,{maxTokens:10}):p=Od(f,o,{maxTokens:10,stream:!1});const h=await fetch(l,{method:"POST",headers:u,body:JSON.stringify(p)});if(h.ok)return{success:!0};const x=await h.text();let _=`HTTP ${h.status}`;try{const y=JSON.parse(x);_=((r=y.error)==null?void 0:r.message)||y.message||_}catch{}return{success:!1,error:_}}catch(o){return{success:!1,error:o instanceof Error?o.message:String(o)}}}const du=["text-embedding","tts-","whisper","dall-e","davinci","babbage","curie","ada","gpt-3.5-turbo-instruct","chatgpt-4o-latest"];function Vm(e){const n=e.toLowerCase();for(let r=0,o=du.length;r<o;r++)if(n.startsWith(du[r]))return!1;return!(/^\w+-\d{4}-\d{2}-\d{2}/.test(e)||/\d{4}-\d{2}-\d{2}$/.test(e))}function Sa(e){return e.replace(/^gpt-/,"GPT-").replace(/^o(\d)/,"o$1").replace(/-mini$/," Mini").replace(/-nano$/," Nano").replace(/-pro$/," Pro").replace(/-turbo$/," Turbo").replace(/^claude-/,"Claude ").replace(/^gemini-/,"Gemini ")}async function Zm(e,n){try{if(e.type==="openai"||e.type==="custom"){const r=await fetch(`${e.baseUrl}/v1/models`,{headers:{Authorization:`Bearer ${n}`}});return r.ok?((await r.json()).data||[]).filter(u=>Vm(u.id)).sort((u,p)=>(p.created||0)-(u.created||0)).map(u=>({id:u.id,name:Sa(u.id),providerId:e.id,contextWindow:128e3,supportsStreaming:!0,supportsFIM:!1})):null}if(e.type==="anthropic"){const r=await fetch(`${e.baseUrl}/v1/models`,{headers:{"x-api-key":n,"anthropic-version":kd,"anthropic-dangerous-direct-browser-access":"true"}});return r.ok?((await r.json()).data||[]).map(u=>({id:u.id,name:u.display_name||Sa(u.id),providerId:e.id,contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1})):null}if(e.type==="google"){const r=await fetch(`${e.baseUrl}/v1beta/models?key=${n}&pageSize=100`);return r.ok?((await r.json()).models||[]).filter(u=>{var p;return(p=u.supportedGenerationMethods)==null?void 0:p.includes("generateContent")}).map(u=>{const p=u.name.replace("models/","");return{id:p,name:u.displayName||Sa(p),providerId:e.id,contextWindow:u.inputTokenLimit||1048576,supportsStreaming:!0,supportsFIM:!1}}):null}return null}catch{return null}}function Km(e){if(e.length===0)return"";const n=[],r=e.length;for(let o=0;o<r;o++){const l=e[o];l.type==="file"?n.push(`--- File: ${l.label} (${l.language||"unknown"}) ---
${l.content}`):l.type==="selection"?n.push(`--- Selected code (${l.language||"unknown"}) ---
${l.content}`):l.type==="error"?n.push(`--- Error ---
${l.content}`):l.type==="diff"&&n.push(`--- Diff ---
${l.content}`)}return n.join(`

`)}function Fd(e){const n=[],r=/```(\w*)\n([\s\S]*?)```/g;let o;for(;(o=r.exec(e))!==null;)n.push({language:o[1]||"text",code:o[2].trim()});return n}const Xm=(e,n)=>({aiEnabled:!1,activeProviderId:"openai",activeModelId:"gpt-4o-mini",providers:uu(),credentials:[],aiSettings:cu(),conversations:[],activeConversationId:null,isAiStreaming:!1,aiStreamContent:"",inlineSuggestionEnabled:!0,currentInlineSuggestion:null,aiContextItems:[],commitMessageDraft:"",showAiSettings:!1,aiOperationError:null,isRefreshingModels:!1,SetAiEnabled:r=>e({aiEnabled:r}),SetActiveProvider:r=>e({activeProviderId:r}),SetActiveModel:r=>e({activeModelId:r}),SetProviders:r=>e({providers:r}),AddProvider:r=>{e(tt(o=>{const l=o.providers.findIndex(u=>u.id===r.id);l!==-1?o.providers[l]=r:o.providers.push(r)})),n().SaveAIState()},RemoveProvider:r=>{e(tt(o=>{const l=o.providers.findIndex(u=>u.id===r);l!==-1&&!o.providers[l].isBuiltIn&&o.providers.splice(l,1)})),n().SaveAIState()},SetCredentials:r=>e({credentials:r}),SetCredentialForProvider:(r,o,l)=>{e(tt(h=>{const x=h.credentials.findIndex(y=>y.providerId===r),_={providerId:r,apiKey:o,rememberKey:l};x!==-1?h.credentials[x]=_:h.credentials.push(_)}));const u=n().credentials,p=u.filter(h=>h.rememberKey).map(h=>({providerId:h.providerId,apiKey:h.apiKey,rememberKey:!0}));0<p.length?jn(tr,JSON.stringify(p),yi*3600):_a(tr);const f=u.filter(h=>!h.rememberKey);0<f.length&&jn(tr+"_session",JSON.stringify(f),0)},RemoveCredentialForProvider:r=>{e(tt(u=>{const p=u.credentials.findIndex(f=>f.providerId===r);p!==-1&&u.credentials.splice(p,1)}));const l=n().credentials.filter(u=>u.rememberKey);0<l.length?jn(tr,JSON.stringify(l),yi*3600):_a(tr)},UpdateAISettings:r=>{e(tt(o=>{Object.assign(o.aiSettings,r)})),jt(va,n().aiSettings)},SetConversations:r=>e({conversations:r}),AddConversation:r=>{e(tt(o=>{o.conversations.unshift(r),au<o.conversations.length&&(o.conversations.length=au)})),e({activeConversationId:r.id})},RemoveConversation:r=>{e(tt(o=>{const l=o.conversations.findIndex(u=>u.id===r);l!==-1&&o.conversations.splice(l,1),r===o.activeConversationId&&(o.activeConversationId=0<o.conversations.length?o.conversations[0].id:null)}))},SetActiveConversation:r=>e({activeConversationId:r}),AddMessageToConversation:(r,o)=>{e(tt(l=>{const u=l.conversations.find(p=>p.id===r);u&&u.messages.push(o)}))},UpdateLastMessage:(r,o)=>{e(tt(l=>{const u=l.conversations.find(p=>p.id===r);if(u&&0<u.messages.length){const p=u.messages[u.messages.length-1];p.content=o}}))},SetIsAiStreaming:r=>e({isAiStreaming:r}),SetAiStreamContent:r=>e({aiStreamContent:r}),SetInlineSuggestionEnabled:r=>e({inlineSuggestionEnabled:r}),SetCurrentInlineSuggestion:r=>e({currentInlineSuggestion:r}),AddAiContextItem:r=>{e(tt(o=>{o.aiContextItems.push(r)}))},RemoveAiContextItem:r=>{e(tt(o=>{0<=r&&r<o.aiContextItems.length&&o.aiContextItems.splice(r,1)}))},ClearAiContext:()=>e({aiContextItems:[]}),SetCommitMessageDraft:r=>e({commitMessageDraft:r}),SetShowAiSettings:r=>e({showAiSettings:r}),SetAiOperationError:r=>e({aiOperationError:r}),RefreshProviderModels:async r=>{const o=n(),l=o.providers.find(p=>p.id===r);if(!l)return!1;const u=o.credentials.find(p=>p.providerId===r);if(!u)return!1;e({isRefreshingModels:!0});try{const p=await Zm(l,u.apiKey);return p===null||p.length===0?(e({isRefreshingModels:!1}),!1):(e(tt(f=>{const h=f.providers.findIndex(x=>x.id===r);h!==-1&&(f.providers[h].models=p),f.isRefreshingModels=!1})),!0)}catch{return e({isRefreshingModels:!1}),!1}},LoadAIState:()=>{const r=ur(va),o=ur(nu),l=ur(iu),u=uu();let p=u;if(o!=null){const f=o.filter(h=>!h.isBuiltIn);p=[...u,...f]}e({aiSettings:r||cu(),credentials:[],providers:p,conversations:l||[],aiEnabled:!1}),Nm(tr).then(f=>{let h=[];if(f!==null)try{h=JSON.parse(f)}catch{h=[]}else{const x=ur(tr);if(x!==null&&0<x.length){h=x;const _=x.filter(y=>y.rememberKey);0<_.length&&jn(tr,JSON.stringify(_),yi*3600),ym(tr)}}e({credentials:h,aiEnabled:0<h.length})}).catch(()=>{})},SaveAIState:()=>{const r=n();jt(va,r.aiSettings);const o=r.providers.filter(u=>!u.isBuiltIn);0<o.length&&jt(nu,o);const l=r.credentials.filter(u=>u.rememberKey);0<l.length?jn(tr,JSON.stringify(l),yi*3600):_a(tr),jt(iu,r.conversations)},GetActiveProvider:()=>{const r=n();return r.providers.find(o=>o.id===r.activeProviderId)||null},GetActiveModel:()=>{const r=n(),o=r.providers.find(l=>l.id===r.activeProviderId);return o==null?null:o.models.find(l=>l.id===r.activeModelId)||null},GetCredentialForProvider:r=>n().credentials.find(o=>o.providerId===r)||null,GetActiveConversation:()=>{const r=n();return r.activeConversationId===null?null:r.conversations.find(o=>o.id===r.activeConversationId)||null}}),Me=bg()((...e)=>({...um(...e),...dm(...e),...hm(...e),...mm(...e),...wm(...e),...bm(...e),...vm(...e),...Xm(...e)}));typeof window<"u"&&(window.__ZUSTAND_STORE__=Me);const Mi={"mac-glass":{bg:"#1a1520",bgSecondary:"#221c2a",bgTertiary:"#2a2233",bgHover:"#342c3e",bgActive:"#3d2e1e",text:"#e8e4ec",textSecondary:"#9e96a8",textMuted:"#6b6474",border:"#362e40",accent:"#e8863a",accentHover:"#f5a04e",accentText:"#ffffff",danger:"#e85555",warning:"#f5c242",success:"#6cd97e",tabBg:"#221c2a",tabActiveBg:"#1a1520",tabActiveText:"#f5a04e",tabBorder:"#362e40",menuBg:"#221c2a",menuHover:"#3d2e1e",menuText:"#e8e4ec",statusBarBg:"#e8863a",statusBarText:"#ffffff",sidebarBg:"#221c2a",sidebarText:"#c8c0d0",scrollbarBg:"transparent",scrollbarThumb:"#3e3648",editorBg:"#1a1520",editorMonacoTheme:"mac-glass",findBg:"#221c2a"},dark:{bg:"#1e1e1e",bgSecondary:"#252526",bgTertiary:"#2d2d30",bgHover:"#3e3e42",bgActive:"#094771",text:"#cccccc",textSecondary:"#969696",textMuted:"#6e6e6e",border:"#3e3e42",accent:"#007acc",accentHover:"#1a8ad4",accentText:"#ffffff",danger:"#f44747",warning:"#cca700",success:"#89d185",tabBg:"#2d2d30",tabActiveBg:"#1e1e1e",tabActiveText:"#ffffff",tabBorder:"#3e3e42",menuBg:"#2d2d30",menuHover:"#094771",menuText:"#cccccc",statusBarBg:"#007acc",statusBarText:"#ffffff",sidebarBg:"#252526",sidebarText:"#cccccc",scrollbarBg:"transparent",scrollbarThumb:"#424242",editorBg:"#1e1e1e",editorMonacoTheme:"vs-dark",findBg:"#252526"},light:{bg:"#ffffff",bgSecondary:"#f3f3f3",bgTertiary:"#ececec",bgHover:"#e0e0e0",bgActive:"#cce5ff",text:"#333333",textSecondary:"#666666",textMuted:"#999999",border:"#d4d4d4",accent:"#0078d4",accentHover:"#106ebe",accentText:"#ffffff",danger:"#d32f2f",warning:"#f9a825",success:"#2e7d32",tabBg:"#ececec",tabActiveBg:"#ffffff",tabActiveText:"#333333",tabBorder:"#d4d4d4",menuBg:"#f3f3f3",menuHover:"#0078d4",menuText:"#333333",statusBarBg:"#0078d4",statusBarText:"#ffffff",sidebarBg:"#f3f3f3",sidebarText:"#333333",scrollbarBg:"transparent",scrollbarThumb:"#c4c4c4",editorBg:"#ffffff",editorMonacoTheme:"vs",findBg:"#f3f3f3"},monokai:{bg:"#272822",bgSecondary:"#1e1f1c",bgTertiary:"#3e3d32",bgHover:"#49483e",bgActive:"#49483e",text:"#f8f8f2",textSecondary:"#a6a69c",textMuted:"#75715e",border:"#3e3d32",accent:"#a6e22e",accentHover:"#b8f340",accentText:"#272822",danger:"#f92672",warning:"#e6db74",success:"#a6e22e",tabBg:"#1e1f1c",tabActiveBg:"#272822",tabActiveText:"#f8f8f2",tabBorder:"#3e3d32",menuBg:"#1e1f1c",menuHover:"#49483e",menuText:"#f8f8f2",statusBarBg:"#49483e",statusBarText:"#f8f8f2",sidebarBg:"#1e1f1c",sidebarText:"#f8f8f2",scrollbarBg:"transparent",scrollbarThumb:"#49483e",editorBg:"#272822",editorMonacoTheme:"monokai",findBg:"#1e1f1c"},dracula:{bg:"#282a36",bgSecondary:"#21222c",bgTertiary:"#343746",bgHover:"#44475a",bgActive:"#44475a",text:"#f8f8f2",textSecondary:"#bd93f9",textMuted:"#6272a4",border:"#44475a",accent:"#bd93f9",accentHover:"#caa9fa",accentText:"#282a36",danger:"#ff5555",warning:"#f1fa8c",success:"#50fa7b",tabBg:"#21222c",tabActiveBg:"#282a36",tabActiveText:"#f8f8f2",tabBorder:"#44475a",menuBg:"#21222c",menuHover:"#44475a",menuText:"#f8f8f2",statusBarBg:"#44475a",statusBarText:"#f8f8f2",sidebarBg:"#21222c",sidebarText:"#f8f8f2",scrollbarBg:"transparent",scrollbarThumb:"#44475a",editorBg:"#282a36",editorMonacoTheme:"dracula",findBg:"#21222c"},"solarized-dark":{bg:"#002b36",bgSecondary:"#073642",bgTertiary:"#073642",bgHover:"#0a4858",bgActive:"#0a4858",text:"#839496",textSecondary:"#657b83",textMuted:"#586e75",border:"#073642",accent:"#268bd2",accentHover:"#2aa7f5",accentText:"#fdf6e3",danger:"#dc322f",warning:"#b58900",success:"#859900",tabBg:"#073642",tabActiveBg:"#002b36",tabActiveText:"#93a1a1",tabBorder:"#073642",menuBg:"#073642",menuHover:"#0a4858",menuText:"#839496",statusBarBg:"#073642",statusBarText:"#839496",sidebarBg:"#073642",sidebarText:"#839496",scrollbarBg:"transparent",scrollbarThumb:"#0a4858",editorBg:"#002b36",editorMonacoTheme:"solarized-dark",findBg:"#073642"},"solarized-light":{bg:"#fdf6e3",bgSecondary:"#eee8d5",bgTertiary:"#eee8d5",bgHover:"#e4ddc8",bgActive:"#e4ddc8",text:"#657b83",textSecondary:"#839496",textMuted:"#93a1a1",border:"#eee8d5",accent:"#268bd2",accentHover:"#2aa7f5",accentText:"#fdf6e3",danger:"#dc322f",warning:"#b58900",success:"#859900",tabBg:"#eee8d5",tabActiveBg:"#fdf6e3",tabActiveText:"#586e75",tabBorder:"#eee8d5",menuBg:"#eee8d5",menuHover:"#e4ddc8",menuText:"#657b83",statusBarBg:"#eee8d5",statusBarText:"#657b83",sidebarBg:"#eee8d5",sidebarText:"#657b83",scrollbarBg:"transparent",scrollbarThumb:"#d3cbb7",editorBg:"#fdf6e3",editorMonacoTheme:"solarized-light",findBg:"#eee8d5"}};function Ym(e){return Mi[e]||Mi["mac-glass"]}function Jm(e,n){const r=Mi[e]||Mi["mac-glass"];return{...r,...n,editorMonacoTheme:r.editorMonacoTheme}}const Uv=[{label:"Backgrounds",keys:[{key:"bg",label:"Primary Background"},{key:"bgSecondary",label:"Secondary Background"},{key:"bgTertiary",label:"Tertiary Background"},{key:"bgHover",label:"Hover Background"},{key:"bgActive",label:"Active Background"},{key:"editorBg",label:"Editor Background"},{key:"findBg",label:"Find Panel Background"}]},{label:"Text",keys:[{key:"text",label:"Primary Text"},{key:"textSecondary",label:"Secondary Text"},{key:"textMuted",label:"Muted Text"}]},{label:"Accent & Status",keys:[{key:"accent",label:"Accent Color"},{key:"accentHover",label:"Accent Hover"},{key:"accentText",label:"Accent Text"},{key:"danger",label:"Danger / Error"},{key:"warning",label:"Warning"},{key:"success",label:"Success"}]},{label:"Borders & Scrollbar",keys:[{key:"border",label:"Border"},{key:"scrollbarBg",label:"Scrollbar Track"},{key:"scrollbarThumb",label:"Scrollbar Thumb"}]},{label:"Tabs",keys:[{key:"tabBg",label:"Tab Background"},{key:"tabActiveBg",label:"Active Tab Background"},{key:"tabActiveText",label:"Active Tab Text"},{key:"tabBorder",label:"Tab Border"}]},{label:"Menu",keys:[{key:"menuBg",label:"Menu Background"},{key:"menuHover",label:"Menu Hover"},{key:"menuText",label:"Menu Text"}]},{label:"Status Bar",keys:[{key:"statusBarBg",label:"Status Bar Background"},{key:"statusBarText",label:"Status Bar Text"}]},{label:"Sidebar",keys:[{key:"sidebarBg",label:"Sidebar Background"},{key:"sidebarText",label:"Sidebar Text"}]}];function Qm(e){e.editor.defineTheme("mac-glass",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"6b6474",fontStyle:"italic"},{token:"keyword",foreground:"e8863a"},{token:"string",foreground:"6cd97e"},{token:"number",foreground:"f5c242"},{token:"type",foreground:"f5a04e",fontStyle:"italic"},{token:"function",foreground:"c8a0ff"},{token:"variable",foreground:"e8e4ec"},{token:"operator",foreground:"e8863a"},{token:"delimiter",foreground:"9e96a8"}],colors:{"editor.background":"#1a1520","editor.foreground":"#e8e4ec","editor.lineHighlightBackground":"#221c2a","editor.selectionBackground":"#3d2e1e","editorCursor.foreground":"#e8863a","editor.selectionHighlightBackground":"#362e4040","editorLineNumber.foreground":"#6b6474","editorLineNumber.activeForeground":"#e8863a","editorIndentGuide.background":"#2a2233","editorIndentGuide.activeBackground":"#362e40"}}),e.editor.defineTheme("monokai",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"75715e",fontStyle:"italic"},{token:"keyword",foreground:"f92672"},{token:"string",foreground:"e6db74"},{token:"number",foreground:"ae81ff"},{token:"type",foreground:"66d9ef",fontStyle:"italic"},{token:"function",foreground:"a6e22e"},{token:"variable",foreground:"f8f8f2"}],colors:{"editor.background":"#272822","editor.foreground":"#f8f8f2","editor.lineHighlightBackground":"#3e3d32","editor.selectionBackground":"#49483e","editorCursor.foreground":"#f8f8f0"}}),e.editor.defineTheme("dracula",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"6272a4",fontStyle:"italic"},{token:"keyword",foreground:"ff79c6"},{token:"string",foreground:"f1fa8c"},{token:"number",foreground:"bd93f9"},{token:"type",foreground:"8be9fd",fontStyle:"italic"},{token:"function",foreground:"50fa7b"},{token:"variable",foreground:"f8f8f2"}],colors:{"editor.background":"#282a36","editor.foreground":"#f8f8f2","editor.lineHighlightBackground":"#44475a","editor.selectionBackground":"#44475a","editorCursor.foreground":"#f8f8f2"}}),e.editor.defineTheme("solarized-dark",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"586e75",fontStyle:"italic"},{token:"keyword",foreground:"859900"},{token:"string",foreground:"2aa198"},{token:"number",foreground:"d33682"},{token:"type",foreground:"b58900"},{token:"function",foreground:"268bd2"}],colors:{"editor.background":"#002b36","editor.foreground":"#839496","editor.lineHighlightBackground":"#073642","editor.selectionBackground":"#073642"}}),e.editor.defineTheme("solarized-light",{base:"vs",inherit:!0,rules:[{token:"comment",foreground:"93a1a1",fontStyle:"italic"},{token:"keyword",foreground:"859900"},{token:"string",foreground:"2aa198"},{token:"number",foreground:"d33682"},{token:"type",foreground:"b58900"},{token:"function",foreground:"268bd2"}],colors:{"editor.background":"#fdf6e3","editor.foreground":"#657b83","editor.lineHighlightBackground":"#eee8d5","editor.selectionBackground":"#eee8d5"}})}function ew(e,n,r){const o=document.activeElement,l=document.querySelector(".notemac-app");if(!((l==null?void 0:l.contains(o))||o===document.body))return;const p=e.metaKey||e.ctrlKey,f=Me.getState();p&&e.key==="n"?(e.preventDefault(),f.addTab()):p&&e.key==="w"?(e.preventDefault(),n!==null&&f.closeTab(n)):p&&e.shiftKey&&e.key==="T"?(e.preventDefault(),f.restoreLastClosedTab()):p&&e.key==="f"?(e.preventDefault(),f.setShowFindReplace(!0,"find")):p&&e.key==="h"?(e.preventDefault(),f.setShowFindReplace(!0,"replace")):p&&e.key==="g"?(e.preventDefault(),f.setShowGoToLine(!0)):p&&e.key==="b"?(e.preventDefault(),f.toggleSidebar()):p&&e.key===","?(e.preventDefault(),f.setShowSettings(!0)):p&&e.key==="="?(e.preventDefault(),f.setZoomLevel(r+1)):p&&e.key==="-"?(e.preventDefault(),f.setZoomLevel(r-1)):p&&e.key==="0"?(e.preventDefault(),f.setZoomLevel(0)):p&&e.shiftKey&&e.key==="P"?(e.preventDefault(),f.setShowCommandPalette(!0)):p&&e.shiftKey&&e.key==="F"?(e.preventDefault(),f.setShowFindReplace(!0,"findInFiles")):p&&e.key==="p"?(e.preventDefault(),f.setShowQuickOpen(!0)):e.ctrlKey&&e.key==="`"?(e.preventDefault(),f.setShowTerminalPanel(!f.showTerminalPanel)):e.ctrlKey&&e.shiftKey&&e.key==="G"?(e.preventDefault(),f.setSidebarPanel(f.sidebarPanel==="git"?null:"git")):e.key==="Escape"&&(f.setShowFindReplace(!1),f.setShowSettings(!1),f.setShowGoToLine(!1),f.setShowAbout(!1),f.setShowRunCommand(!1),f.setShowColumnEditor(!1),f.setShowSummary(!1),f.setShowCharInRange(!1),f.setShowShortcutMapper(!1),f.setShowCommandPalette(!1),f.setShowQuickOpen(!1),f.setShowDiffViewer(!1),f.setShowSnippetManager(!1),f.setShowCloneDialog(!1),f.setShowGitSettings(!1))}let Dd=null,Ss=null;function tw(e){Dd=e}function zv(){return Dd}function rw(e){Ss=e}function Ld(){return Ss}function nw(){Ss=null}function $d(e,n,r,o,l){var f,h,x,_;const u=Me.getState(),p=Ld();switch(e){case"new":u.addTab();break;case"open":iw();break;case"open-folder":aw();break;case"save":ka(n,r,!1);break;case"save-as":ka(n,r,!0);break;case"save-copy-as":ka(n,r,!0);break;case"save-all":ow(r);break;case"reload-from-disk":sw(n,r);break;case"rename-file":lw(n,r);break;case"delete-file":n!==null&&u.closeTab(n);break;case"close-tab":n!==null&&u.closeTab(n);break;case"close-all":u.closeAllTabs();break;case"close-others":n!==null&&u.closeOtherTabs(n);break;case"close-tabs-to-left":n!==null&&u.closeTabsToLeft(n);break;case"close-tabs-to-right":n!==null&&u.closeTabsToRight(n);break;case"close-unchanged":u.closeUnchangedTabs();break;case"close-all-but-pinned":u.closeAllButPinned();break;case"restore-last-closed":u.restoreLastClosedTab();break;case"pin-tab":n!==null&&u.togglePinTab(n);break;case"print":window.print();break;case"find":u.setShowFindReplace(!0,"find");break;case"replace":u.setShowFindReplace(!0,"replace");break;case"find-in-files":u.setShowFindReplace(!0,"findInFiles");break;case"mark":u.setShowFindReplace(!0,"mark");break;case"incremental-search":u.setShowIncrementalSearch(!0);break;case"goto-line":u.setShowGoToLine(!0);break;case"find-char-in-range":u.setShowCharInRange(!0);break;case"word-wrap":u.updateSettings({wordWrap:l});break;case"show-whitespace":u.updateSettings({showWhitespace:l,renderWhitespace:l?"all":"none"});break;case"show-eol":u.updateSettings({showEOL:l});break;case"show-non-printable":u.updateSettings({showNonPrintable:l});break;case"show-wrap-symbol":u.updateSettings({showWrapSymbol:l});break;case"indent-guide":u.updateSettings({showIndentGuides:l});break;case"show-line-numbers":u.updateSettings({showLineNumbers:l});break;case"toggle-minimap":u.updateSettings({showMinimap:l});break;case"zoom-in":u.setZoomLevel(o+1);break;case"zoom-out":u.setZoomLevel(o-1);break;case"zoom-reset":u.setZoomLevel(0);break;case"toggle-sidebar":u.toggleSidebar();break;case"show-doc-list":u.setSidebarPanel("docList");break;case"show-function-list":u.setSidebarPanel("functions");break;case"show-project-panel":u.setSidebarPanel("project");break;case"distraction-free":u.updateSettings({distractionFreeMode:l});break;case"always-on-top":{u.updateSettings({alwaysOnTop:l}),window.electronAPI&&((h=(f=window.electronAPI).setAlwaysOnTop)==null||h.call(f,l));break}case"sync-scroll-v":u.updateSettings({syncScrollVertical:l});break;case"sync-scroll-h":u.updateSettings({syncScrollHorizontal:l});break;case"split-right":n!==null&&u.setSplitView("vertical",n);break;case"split-down":n!==null&&u.setSplitView("horizontal",n);break;case"close-split":u.setSplitView("none");break;case"show-summary":u.setShowSummary(!0);break;case"toggle-monitoring":{if(n!==null){const y=r.find(O=>O.id===n);y&&u.updateTab(n,{isMonitoring:!y.isMonitoring})}break}case"language":n!==null&&u.updateTab(n,{language:l});break;case"encoding":n!==null&&u.updateTab(n,{encoding:l});break;case"line-ending":n!==null&&u.updateTab(n,{lineEnding:l});break;case"macro-start":u.startRecordingMacro();break;case"macro-stop":u.stopRecordingMacro();break;case"command-palette":u.setShowCommandPalette(!0);break;case"quick-open":u.setShowQuickOpen(!0);break;case"compare-files":u.setShowDiffViewer(!0);break;case"snippet-manager":u.setShowSnippetManager(!0);break;case"toggle-terminal":u.setShowTerminalPanel(!u.showTerminalPanel);break;case"clone-repository":u.setShowCloneDialog(!0);break;case"git-settings":u.setShowGitSettings(!0);break;case"show-git-panel":u.setSidebarPanel("git");break;case"ai-chat":u.setSidebarPanel("ai");break;case"ai-settings":u.SetShowAiSettings(!0);break;case"ai-explain":case"ai-refactor":case"ai-generate-tests":case"ai-generate-docs":case"ai-fix-error":case"ai-simplify":case"ai-convert-language":p&&p(e);break;case"ai-toggle-inline":u.SetInlineSuggestionEnabled(!u.inlineSuggestionEnabled);break;case"preferences":u.setShowSettings(!0);break;case"about":u.setShowAbout(!0);break;case"run-command":u.setShowRunCommand(!0);break;case"column-editor":u.setShowColumnEditor(!0);break;case"shortcut-mapper":u.setShowShortcutMapper(!0);break;case"clipboard-history":u.setSidebarPanel("clipboardHistory");break;case"char-panel":u.setSidebarPanel("charPanel");break;case"search-google":{const y=(x=window.getSelection())==null?void 0:x.toString();y&&window.open(`https://www.google.com/search?q=${encodeURIComponent(y)}`,"_blank");break}case"search-wikipedia":{const y=(_=window.getSelection())==null?void 0:_.toString();y&&window.open(`https://en.wikipedia.org/wiki/${encodeURIComponent(y)}`,"_blank");break}case"open-in-browser":{const y=r.find(O=>O.id===n);y&&y.path&&window.open(`file://${y.path}`,"_blank");break}case"save-session":{const y=u.saveSession(),O=new Blob([JSON.stringify(y,null,2)],{type:"application/json"}),R=URL.createObjectURL(O),z=document.createElement("a");z.href=R,z.download="session.json",z.click(),URL.revokeObjectURL(R);break}case"load-session":{const y=document.createElement("input");y.type="file",y.accept=".json",y.onchange=async O=>{var z;const R=(z=O.target.files)==null?void 0:z[0];if(R)try{const N=await R.text();Me.getState().loadSession(JSON.parse(N))}catch{}},y.click();break}default:p&&p(e,l);break}}function iw(){var n,r;if(window.electronAPI){(r=(n=window.electronAPI).openFile)==null||r.call(n);return}const e=document.createElement("input");e.type="file",e.multiple=!0,e.onchange=async()=>{if(e.files)try{const o=Me.getState();for(const l of Array.from(e.files)){const u=await l.text();o.addTab({name:l.name,content:u,language:sr(l.name),lineEnding:br(u)})}}catch{}},e.click()}function aw(){var n,r;if(window.electronAPI){(r=(n=window.electronAPI).openFolder)==null||r.call(n);return}const e=document.createElement("input");e.type="file",e.webkitdirectory=!0,e.onchange=async()=>{if(!(!e.files||e.files.length===0))try{const o=Me.getState();for(const l of Array.from(e.files)){const u=await l.text();o.addTab({name:l.name,content:u,language:sr(l.name),lineEnding:br(u)})}}catch{}},e.click()}function ka(e,n,r){var f,h,x,_;if(e===null)return;const o=n.find(y=>y.id===e);if(!o)return;if(window.electronAPI){r||!o.path?(h=(f=window.electronAPI).saveFileAs)==null||h.call(f,o.content,o.name):(_=(x=window.electronAPI).saveFile)==null||_.call(x,o.content,o.path),Me.getState().updateTab(e,{isModified:!1});return}const l=new Blob([o.content],{type:"text/plain;charset=utf-8"}),u=URL.createObjectURL(l),p=document.createElement("a");p.href=u,p.download=o.name,p.click(),URL.revokeObjectURL(u),Me.getState().updateTab(e,{isModified:!1})}function ow(e){var r,o;const n=Me.getState();for(const l of e)if(l.isModified)if(window.electronAPI&&l.path)(o=(r=window.electronAPI).saveFile)==null||o.call(r,l.content,l.path),n.updateTab(l.id,{isModified:!1});else{const u=new Blob([l.content],{type:"text/plain;charset=utf-8"}),p=URL.createObjectURL(u),f=document.createElement("a");f.href=p,f.download=l.name,f.click(),URL.revokeObjectURL(p),n.updateTab(l.id,{isModified:!1})}}function sw(e,n){var l,u;if(e===null)return;const r=n.find(p=>p.id===e);if(!r)return;if(window.electronAPI&&r.path){(u=(l=window.electronAPI).readFile)==null||u.call(l,r.path).then(p=>{Me.getState().updateTabContent(e,p),Me.getState().updateTab(e,{isModified:!1})}).catch(p=>{const f=p instanceof Error?p.message:String(p);window.alert(`Failed to reload file from disk: ${f}`)});return}const o=document.createElement("input");o.type="file",o.onchange=async()=>{var p;try{const f=(p=o.files)==null?void 0:p[0];if(f){const h=await f.text();Me.getState().updateTabContent(e,h),Me.getState().updateTab(e,{isModified:!1,name:f.name})}}catch{}},o.click()}function lw(e,n){var l,u;if(e===null)return;const r=n.find(p=>p.id===e);if(!r)return;const o=prompt("Enter new file name:",r.name);o&&o!==r.name&&(Me.getState().updateTab(e,{name:o}),window.electronAPI&&r.path&&((u=(l=window.electronAPI).renameFile)==null||u.call(l,r.path,o)))}var Oe={},Ea,hu;function cw(){if(hu)return Ea;hu=1;var e=function(n){if(n=n||{},this.Promise=n.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=n.domainReentrant||!1,this.domainReentrant){if(typeof process>"u"||typeof process.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=n.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=n.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=n.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,n.maxPending===1/0||Number.isInteger(n.maxPending)&&n.maxPending>=0?this.maxPending=n.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(n,r,o,l){if(Array.isArray(n))return this._acquireBatch(n,r,o,l);if(typeof r!="function")throw new Error("You must pass a function to execute");var u=null,p=null,f=null;typeof o!="function"&&(l=o,o=null,f=new this.Promise(function(G,X){u=G,p=X})),l=l||{};var h=!1,x=null,_=null,y=null,O=this,R=function(G,X,q){_&&(clearTimeout(_),_=null),y&&(clearTimeout(y),y=null),G&&(O.queues[n]&&O.queues[n].length===0&&delete O.queues[n],O.domainReentrant&&delete O.domains[n]),h||(f?X?p(X):u(q):typeof o=="function"&&o(X,q),h=!0),G&&O.queues[n]&&O.queues[n].length>0&&O.queues[n].shift()()},z=function(G){if(h)return R(G);x&&(clearTimeout(x),x=null),O.domainReentrant&&G&&(O.domains[n]=process.domain);var X=l.maxExecutionTime||O.maxExecutionTime;if(X&&(y=setTimeout(function(){O.queues[n]&&R(G,new Error("Maximum execution time is exceeded "+n))},X)),r.length===1){var q=!1;try{r(function(Y,B){q||(q=!0,R(G,Y,B))})}catch(Y){q||(q=!0,R(G,Y))}}else O._promiseTry(function(){return r()}).then(function(Y){R(G,void 0,Y)},function(Y){R(G,Y)})};O.domainReentrant&&process.domain&&(z=process.domain.bind(z));var N=l.maxPending||O.maxPending;if(!O.queues[n])O.queues[n]=[],z(!0);else if(O.domainReentrant&&process.domain&&process.domain===O.domains[n])z(!1);else if(O.queues[n].length>=N)R(!1,new Error("Too many pending tasks in queue "+n));else{var L=function(){z(!0)};l.skipQueue?O.queues[n].unshift(L):O.queues[n].push(L);var D=l.timeout||O.timeout;D&&(x=setTimeout(function(){x=null,R(!1,new Error("async-lock timed out in queue "+n))},D))}var U=l.maxOccupationTime||O.maxOccupationTime;if(U&&(_=setTimeout(function(){O.queues[n]&&R(!1,new Error("Maximum occupation time is exceeded in queue "+n))},U)),f)return f},e.prototype._acquireBatch=function(n,r,o,l){typeof o!="function"&&(l=o,o=null);var u=this,p=function(h,x){return function(_){u.acquire(h,x,_,l)}},f=n.reduceRight(function(h,x){return p(x,h)},r);if(typeof o=="function")f(o);else return new this.Promise(function(h,x){f.length===1?f(function(_,y){_?x(_):h(y)}):h(f())})},e.prototype.isBusy=function(n){return n?!!this.queues[n]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(n){try{return this.Promise.resolve(n())}catch(r){return this.Promise.reject(r)}},Ea=e,Ea}var Aa,pu;function uw(){return pu||(pu=1,Aa=cw()),Aa}var vi={exports:{}},gu;function fw(){return gu||(gu=1,typeof Object.create=="function"?vi.exports=function(n,r){r&&(n.super_=r,n.prototype=Object.create(r.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}))}:vi.exports=function(n,r){if(r){n.super_=r;var o=function(){};o.prototype=r.prototype,n.prototype=new o,n.prototype.constructor=n}}),vi.exports}var xi={exports:{}},Ia={},Bn={},mu;function dw(){if(mu)return Bn;mu=1,Bn.byteLength=f,Bn.toByteArray=x,Bn.fromByteArray=O;for(var e=[],n=[],r=typeof Uint8Array<"u"?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,u=o.length;l<u;++l)e[l]=o[l],n[o.charCodeAt(l)]=l;n[45]=62,n[95]=63;function p(R){var z=R.length;if(z%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var N=R.indexOf("=");N===-1&&(N=z);var L=N===z?0:4-N%4;return[N,L]}function f(R){var z=p(R),N=z[0],L=z[1];return(N+L)*3/4-L}function h(R,z,N){return(z+N)*3/4-N}function x(R){var z,N=p(R),L=N[0],D=N[1],U=new r(h(R,L,D)),G=0,X=D>0?L-4:L,q;for(q=0;q<X;q+=4)z=n[R.charCodeAt(q)]<<18|n[R.charCodeAt(q+1)]<<12|n[R.charCodeAt(q+2)]<<6|n[R.charCodeAt(q+3)],U[G++]=z>>16&255,U[G++]=z>>8&255,U[G++]=z&255;return D===2&&(z=n[R.charCodeAt(q)]<<2|n[R.charCodeAt(q+1)]>>4,U[G++]=z&255),D===1&&(z=n[R.charCodeAt(q)]<<10|n[R.charCodeAt(q+1)]<<4|n[R.charCodeAt(q+2)]>>2,U[G++]=z>>8&255,U[G++]=z&255),U}function _(R){return e[R>>18&63]+e[R>>12&63]+e[R>>6&63]+e[R&63]}function y(R,z,N){for(var L,D=[],U=z;U<N;U+=3)L=(R[U]<<16&16711680)+(R[U+1]<<8&65280)+(R[U+2]&255),D.push(_(L));return D.join("")}function O(R){for(var z,N=R.length,L=N%3,D=[],U=16383,G=0,X=N-L;G<X;G+=U)D.push(y(R,G,G+U>X?X:G+U));return L===1?(z=R[N-1],D.push(e[z>>2]+e[z<<4&63]+"==")):L===2&&(z=(R[N-2]<<8)+R[N-1],D.push(e[z>>10]+e[z>>4&63]+e[z<<2&63]+"=")),D.join("")}return Bn}var _i={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var wu;function hw(){return wu||(wu=1,_i.read=function(e,n,r,o,l){var u,p,f=l*8-o-1,h=(1<<f)-1,x=h>>1,_=-7,y=r?l-1:0,O=r?-1:1,R=e[n+y];for(y+=O,u=R&(1<<-_)-1,R>>=-_,_+=f;_>0;u=u*256+e[n+y],y+=O,_-=8);for(p=u&(1<<-_)-1,u>>=-_,_+=o;_>0;p=p*256+e[n+y],y+=O,_-=8);if(u===0)u=1-x;else{if(u===h)return p?NaN:(R?-1:1)*(1/0);p=p+Math.pow(2,o),u=u-x}return(R?-1:1)*p*Math.pow(2,u-o)},_i.write=function(e,n,r,o,l,u){var p,f,h,x=u*8-l-1,_=(1<<x)-1,y=_>>1,O=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,R=o?0:u-1,z=o?1:-1,N=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(f=isNaN(n)?1:0,p=_):(p=Math.floor(Math.log(n)/Math.LN2),n*(h=Math.pow(2,-p))<1&&(p--,h*=2),p+y>=1?n+=O/h:n+=O*Math.pow(2,1-y),n*h>=2&&(p++,h/=2),p+y>=_?(f=0,p=_):p+y>=1?(f=(n*h-1)*Math.pow(2,l),p=p+y):(f=n*Math.pow(2,y-1)*Math.pow(2,l),p=0));l>=8;e[r+R]=f&255,R+=z,f/=256,l-=8);for(p=p<<l|f,x+=l;x>0;e[r+R]=p&255,R+=z,p/=256,x-=8);e[r+R-z]|=N*128}),_i}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var yu;function pw(){return yu||(yu=1,(function(e){var n=dw(),r=hw(),o=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=f,e.SlowBuffer=U,e.INSPECT_MAX_BYTES=50;var l=2147483647;e.kMaxLength=l,f.TYPED_ARRAY_SUPPORT=u(),!f.TYPED_ARRAY_SUPPORT&&typeof console<"u";function u(){try{var M=new Uint8Array(1),g={foo:function(){return 42}};return Object.setPrototypeOf(g,Uint8Array.prototype),Object.setPrototypeOf(M,g),M.foo()===42}catch{return!1}}Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}});function p(M){if(M>l)throw new RangeError('The value "'+M+'" is invalid for option "size"');var g=new Uint8Array(M);return Object.setPrototypeOf(g,f.prototype),g}function f(M,g,b){if(typeof M=="number"){if(typeof g=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(M)}return h(M,g,b)}f.poolSize=8192;function h(M,g,b){if(typeof M=="string")return O(M,g);if(ArrayBuffer.isView(M))return z(M);if(M==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof M);if(Ze(M,ArrayBuffer)||M&&Ze(M.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ze(M,SharedArrayBuffer)||M&&Ze(M.buffer,SharedArrayBuffer)))return N(M,g,b);if(typeof M=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var $=M.valueOf&&M.valueOf();if($!=null&&$!==M)return f.from($,g,b);var ae=L(M);if(ae)return ae;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof M[Symbol.toPrimitive]=="function")return f.from(M[Symbol.toPrimitive]("string"),g,b);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof M)}f.from=function(M,g,b){return h(M,g,b)},Object.setPrototypeOf(f.prototype,Uint8Array.prototype),Object.setPrototypeOf(f,Uint8Array);function x(M){if(typeof M!="number")throw new TypeError('"size" argument must be of type number');if(M<0)throw new RangeError('The value "'+M+'" is invalid for option "size"')}function _(M,g,b){return x(M),M<=0?p(M):g!==void 0?typeof b=="string"?p(M).fill(g,b):p(M).fill(g):p(M)}f.alloc=function(M,g,b){return _(M,g,b)};function y(M){return x(M),p(M<0?0:D(M)|0)}f.allocUnsafe=function(M){return y(M)},f.allocUnsafeSlow=function(M){return y(M)};function O(M,g){if((typeof g!="string"||g==="")&&(g="utf8"),!f.isEncoding(g))throw new TypeError("Unknown encoding: "+g);var b=G(M,g)|0,$=p(b),ae=$.write(M,g);return ae!==b&&($=$.slice(0,ae)),$}function R(M){for(var g=M.length<0?0:D(M.length)|0,b=p(g),$=0;$<g;$+=1)b[$]=M[$]&255;return b}function z(M){if(Ze(M,Uint8Array)){var g=new Uint8Array(M);return N(g.buffer,g.byteOffset,g.byteLength)}return R(M)}function N(M,g,b){if(g<0||M.byteLength<g)throw new RangeError('"offset" is outside of buffer bounds');if(M.byteLength<g+(b||0))throw new RangeError('"length" is outside of buffer bounds');var $;return g===void 0&&b===void 0?$=new Uint8Array(M):b===void 0?$=new Uint8Array(M,g):$=new Uint8Array(M,g,b),Object.setPrototypeOf($,f.prototype),$}function L(M){if(f.isBuffer(M)){var g=D(M.length)|0,b=p(g);return b.length===0||M.copy(b,0,0,g),b}if(M.length!==void 0)return typeof M.length!="number"||pt(M.length)?p(0):R(M);if(M.type==="Buffer"&&Array.isArray(M.data))return R(M.data)}function D(M){if(M>=l)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l.toString(16)+" bytes");return M|0}function U(M){return+M!=M&&(M=0),f.alloc(+M)}f.isBuffer=function(g){return g!=null&&g._isBuffer===!0&&g!==f.prototype},f.compare=function(g,b){if(Ze(g,Uint8Array)&&(g=f.from(g,g.offset,g.byteLength)),Ze(b,Uint8Array)&&(b=f.from(b,b.offset,b.byteLength)),!f.isBuffer(g)||!f.isBuffer(b))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(g===b)return 0;for(var $=g.length,ae=b.length,ye=0,ve=Math.min($,ae);ye<ve;++ye)if(g[ye]!==b[ye]){$=g[ye],ae=b[ye];break}return $<ae?-1:ae<$?1:0},f.isEncoding=function(g){switch(String(g).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(g,b){if(!Array.isArray(g))throw new TypeError('"list" argument must be an Array of Buffers');if(g.length===0)return f.alloc(0);var $;if(b===void 0)for(b=0,$=0;$<g.length;++$)b+=g[$].length;var ae=f.allocUnsafe(b),ye=0;for($=0;$<g.length;++$){var ve=g[$];if(Ze(ve,Uint8Array))ye+ve.length>ae.length?f.from(ve).copy(ae,ye):Uint8Array.prototype.set.call(ae,ve,ye);else if(f.isBuffer(ve))ve.copy(ae,ye);else throw new TypeError('"list" argument must be an Array of Buffers');ye+=ve.length}return ae};function G(M,g){if(f.isBuffer(M))return M.length;if(ArrayBuffer.isView(M)||Ze(M,ArrayBuffer))return M.byteLength;if(typeof M!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof M);var b=M.length,$=arguments.length>2&&arguments[2]===!0;if(!$&&b===0)return 0;for(var ae=!1;;)switch(g){case"ascii":case"latin1":case"binary":return b;case"utf8":case"utf-8":return We(M).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b*2;case"hex":return b>>>1;case"base64":return at(M).length;default:if(ae)return $?-1:We(M).length;g=(""+g).toLowerCase(),ae=!0}}f.byteLength=G;function X(M,g,b){var $=!1;if((g===void 0||g<0)&&(g=0),g>this.length||((b===void 0||b>this.length)&&(b=this.length),b<=0)||(b>>>=0,g>>>=0,b<=g))return"";for(M||(M="utf8");;)switch(M){case"hex":return ce(this,g,b);case"utf8":case"utf-8":return W(this,g,b);case"ascii":return ie(this,g,b);case"latin1":case"binary":return ue(this,g,b);case"base64":return oe(this,g,b);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Fe(this,g,b);default:if($)throw new TypeError("Unknown encoding: "+M);M=(M+"").toLowerCase(),$=!0}}f.prototype._isBuffer=!0;function q(M,g,b){var $=M[g];M[g]=M[b],M[b]=$}f.prototype.swap16=function(){var g=this.length;if(g%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<g;b+=2)q(this,b,b+1);return this},f.prototype.swap32=function(){var g=this.length;if(g%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<g;b+=4)q(this,b,b+3),q(this,b+1,b+2);return this},f.prototype.swap64=function(){var g=this.length;if(g%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<g;b+=8)q(this,b,b+7),q(this,b+1,b+6),q(this,b+2,b+5),q(this,b+3,b+4);return this},f.prototype.toString=function(){var g=this.length;return g===0?"":arguments.length===0?W(this,0,g):X.apply(this,arguments)},f.prototype.toLocaleString=f.prototype.toString,f.prototype.equals=function(g){if(!f.isBuffer(g))throw new TypeError("Argument must be a Buffer");return this===g?!0:f.compare(this,g)===0},f.prototype.inspect=function(){var g="",b=e.INSPECT_MAX_BYTES;return g=this.toString("hex",0,b).replace(/(.{2})/g,"$1 ").trim(),this.length>b&&(g+=" ... "),"<Buffer "+g+">"},o&&(f.prototype[o]=f.prototype.inspect),f.prototype.compare=function(g,b,$,ae,ye){if(Ze(g,Uint8Array)&&(g=f.from(g,g.offset,g.byteLength)),!f.isBuffer(g))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof g);if(b===void 0&&(b=0),$===void 0&&($=g?g.length:0),ae===void 0&&(ae=0),ye===void 0&&(ye=this.length),b<0||$>g.length||ae<0||ye>this.length)throw new RangeError("out of range index");if(ae>=ye&&b>=$)return 0;if(ae>=ye)return-1;if(b>=$)return 1;if(b>>>=0,$>>>=0,ae>>>=0,ye>>>=0,this===g)return 0;for(var ve=ye-ae,Ve=$-b,Ye=Math.min(ve,Ve),nt=this.slice(ae,ye),ft=g.slice(b,$),st=0;st<Ye;++st)if(nt[st]!==ft[st]){ve=nt[st],Ve=ft[st];break}return ve<Ve?-1:Ve<ve?1:0};function Y(M,g,b,$,ae){if(M.length===0)return-1;if(typeof b=="string"?($=b,b=0):b>2147483647?b=2147483647:b<-2147483648&&(b=-2147483648),b=+b,pt(b)&&(b=ae?0:M.length-1),b<0&&(b=M.length+b),b>=M.length){if(ae)return-1;b=M.length-1}else if(b<0)if(ae)b=0;else return-1;if(typeof g=="string"&&(g=f.from(g,$)),f.isBuffer(g))return g.length===0?-1:B(M,g,b,$,ae);if(typeof g=="number")return g=g&255,typeof Uint8Array.prototype.indexOf=="function"?ae?Uint8Array.prototype.indexOf.call(M,g,b):Uint8Array.prototype.lastIndexOf.call(M,g,b):B(M,[g],b,$,ae);throw new TypeError("val must be string, number or Buffer")}function B(M,g,b,$,ae){var ye=1,ve=M.length,Ve=g.length;if($!==void 0&&($=String($).toLowerCase(),$==="ucs2"||$==="ucs-2"||$==="utf16le"||$==="utf-16le")){if(M.length<2||g.length<2)return-1;ye=2,ve/=2,Ve/=2,b/=2}function Ye(Bt,Jt){return ye===1?Bt[Jt]:Bt.readUInt16BE(Jt*ye)}var nt;if(ae){var ft=-1;for(nt=b;nt<ve;nt++)if(Ye(M,nt)===Ye(g,ft===-1?0:nt-ft)){if(ft===-1&&(ft=nt),nt-ft+1===Ve)return ft*ye}else ft!==-1&&(nt-=nt-ft),ft=-1}else for(b+Ve>ve&&(b=ve-Ve),nt=b;nt>=0;nt--){for(var st=!0,yt=0;yt<Ve;yt++)if(Ye(M,nt+yt)!==Ye(g,yt)){st=!1;break}if(st)return nt}return-1}f.prototype.includes=function(g,b,$){return this.indexOf(g,b,$)!==-1},f.prototype.indexOf=function(g,b,$){return Y(this,g,b,$,!0)},f.prototype.lastIndexOf=function(g,b,$){return Y(this,g,b,$,!1)};function K(M,g,b,$){b=Number(b)||0;var ae=M.length-b;$?($=Number($),$>ae&&($=ae)):$=ae;var ye=g.length;$>ye/2&&($=ye/2);for(var ve=0;ve<$;++ve){var Ve=parseInt(g.substr(ve*2,2),16);if(pt(Ve))return ve;M[b+ve]=Ve}return ve}function se(M,g,b,$){return Ge(We(g,M.length-b),M,b,$)}function S(M,g,b,$){return Ge(rt(g),M,b,$)}function ne(M,g,b,$){return Ge(at(g),M,b,$)}function Q(M,g,b,$){return Ge(Xe(g,M.length-b),M,b,$)}f.prototype.write=function(g,b,$,ae){if(b===void 0)ae="utf8",$=this.length,b=0;else if($===void 0&&typeof b=="string")ae=b,$=this.length,b=0;else if(isFinite(b))b=b>>>0,isFinite($)?($=$>>>0,ae===void 0&&(ae="utf8")):(ae=$,$=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ye=this.length-b;if(($===void 0||$>ye)&&($=ye),g.length>0&&($<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");ae||(ae="utf8");for(var ve=!1;;)switch(ae){case"hex":return K(this,g,b,$);case"utf8":case"utf-8":return se(this,g,b,$);case"ascii":case"latin1":case"binary":return S(this,g,b,$);case"base64":return ne(this,g,b,$);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Q(this,g,b,$);default:if(ve)throw new TypeError("Unknown encoding: "+ae);ae=(""+ae).toLowerCase(),ve=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function oe(M,g,b){return g===0&&b===M.length?n.fromByteArray(M):n.fromByteArray(M.slice(g,b))}function W(M,g,b){b=Math.min(M.length,b);for(var $=[],ae=g;ae<b;){var ye=M[ae],ve=null,Ve=ye>239?4:ye>223?3:ye>191?2:1;if(ae+Ve<=b){var Ye,nt,ft,st;switch(Ve){case 1:ye<128&&(ve=ye);break;case 2:Ye=M[ae+1],(Ye&192)===128&&(st=(ye&31)<<6|Ye&63,st>127&&(ve=st));break;case 3:Ye=M[ae+1],nt=M[ae+2],(Ye&192)===128&&(nt&192)===128&&(st=(ye&15)<<12|(Ye&63)<<6|nt&63,st>2047&&(st<55296||st>57343)&&(ve=st));break;case 4:Ye=M[ae+1],nt=M[ae+2],ft=M[ae+3],(Ye&192)===128&&(nt&192)===128&&(ft&192)===128&&(st=(ye&15)<<18|(Ye&63)<<12|(nt&63)<<6|ft&63,st>65535&&st<1114112&&(ve=st))}}ve===null?(ve=65533,Ve=1):ve>65535&&(ve-=65536,$.push(ve>>>10&1023|55296),ve=56320|ve&1023),$.push(ve),ae+=Ve}return te($)}var le=4096;function te(M){var g=M.length;if(g<=le)return String.fromCharCode.apply(String,M);for(var b="",$=0;$<g;)b+=String.fromCharCode.apply(String,M.slice($,$+=le));return b}function ie(M,g,b){var $="";b=Math.min(M.length,b);for(var ae=g;ae<b;++ae)$+=String.fromCharCode(M[ae]&127);return $}function ue(M,g,b){var $="";b=Math.min(M.length,b);for(var ae=g;ae<b;++ae)$+=String.fromCharCode(M[ae]);return $}function ce(M,g,b){var $=M.length;(!g||g<0)&&(g=0),(!b||b<0||b>$)&&(b=$);for(var ae="",ye=g;ye<b;++ye)ae+=wt[M[ye]];return ae}function Fe(M,g,b){for(var $=M.slice(g,b),ae="",ye=0;ye<$.length-1;ye+=2)ae+=String.fromCharCode($[ye]+$[ye+1]*256);return ae}f.prototype.slice=function(g,b){var $=this.length;g=~~g,b=b===void 0?$:~~b,g<0?(g+=$,g<0&&(g=0)):g>$&&(g=$),b<0?(b+=$,b<0&&(b=0)):b>$&&(b=$),b<g&&(b=g);var ae=this.subarray(g,b);return Object.setPrototypeOf(ae,f.prototype),ae};function xe(M,g,b){if(M%1!==0||M<0)throw new RangeError("offset is not uint");if(M+g>b)throw new RangeError("Trying to access beyond buffer length")}f.prototype.readUintLE=f.prototype.readUIntLE=function(g,b,$){g=g>>>0,b=b>>>0,$||xe(g,b,this.length);for(var ae=this[g],ye=1,ve=0;++ve<b&&(ye*=256);)ae+=this[g+ve]*ye;return ae},f.prototype.readUintBE=f.prototype.readUIntBE=function(g,b,$){g=g>>>0,b=b>>>0,$||xe(g,b,this.length);for(var ae=this[g+--b],ye=1;b>0&&(ye*=256);)ae+=this[g+--b]*ye;return ae},f.prototype.readUint8=f.prototype.readUInt8=function(g,b){return g=g>>>0,b||xe(g,1,this.length),this[g]},f.prototype.readUint16LE=f.prototype.readUInt16LE=function(g,b){return g=g>>>0,b||xe(g,2,this.length),this[g]|this[g+1]<<8},f.prototype.readUint16BE=f.prototype.readUInt16BE=function(g,b){return g=g>>>0,b||xe(g,2,this.length),this[g]<<8|this[g+1]},f.prototype.readUint32LE=f.prototype.readUInt32LE=function(g,b){return g=g>>>0,b||xe(g,4,this.length),(this[g]|this[g+1]<<8|this[g+2]<<16)+this[g+3]*16777216},f.prototype.readUint32BE=f.prototype.readUInt32BE=function(g,b){return g=g>>>0,b||xe(g,4,this.length),this[g]*16777216+(this[g+1]<<16|this[g+2]<<8|this[g+3])},f.prototype.readIntLE=function(g,b,$){g=g>>>0,b=b>>>0,$||xe(g,b,this.length);for(var ae=this[g],ye=1,ve=0;++ve<b&&(ye*=256);)ae+=this[g+ve]*ye;return ye*=128,ae>=ye&&(ae-=Math.pow(2,8*b)),ae},f.prototype.readIntBE=function(g,b,$){g=g>>>0,b=b>>>0,$||xe(g,b,this.length);for(var ae=b,ye=1,ve=this[g+--ae];ae>0&&(ye*=256);)ve+=this[g+--ae]*ye;return ye*=128,ve>=ye&&(ve-=Math.pow(2,8*b)),ve},f.prototype.readInt8=function(g,b){return g=g>>>0,b||xe(g,1,this.length),this[g]&128?(255-this[g]+1)*-1:this[g]},f.prototype.readInt16LE=function(g,b){g=g>>>0,b||xe(g,2,this.length);var $=this[g]|this[g+1]<<8;return $&32768?$|4294901760:$},f.prototype.readInt16BE=function(g,b){g=g>>>0,b||xe(g,2,this.length);var $=this[g+1]|this[g]<<8;return $&32768?$|4294901760:$},f.prototype.readInt32LE=function(g,b){return g=g>>>0,b||xe(g,4,this.length),this[g]|this[g+1]<<8|this[g+2]<<16|this[g+3]<<24},f.prototype.readInt32BE=function(g,b){return g=g>>>0,b||xe(g,4,this.length),this[g]<<24|this[g+1]<<16|this[g+2]<<8|this[g+3]},f.prototype.readFloatLE=function(g,b){return g=g>>>0,b||xe(g,4,this.length),r.read(this,g,!0,23,4)},f.prototype.readFloatBE=function(g,b){return g=g>>>0,b||xe(g,4,this.length),r.read(this,g,!1,23,4)},f.prototype.readDoubleLE=function(g,b){return g=g>>>0,b||xe(g,8,this.length),r.read(this,g,!0,52,8)},f.prototype.readDoubleBE=function(g,b){return g=g>>>0,b||xe(g,8,this.length),r.read(this,g,!1,52,8)};function Te(M,g,b,$,ae,ye){if(!f.isBuffer(M))throw new TypeError('"buffer" argument must be a Buffer instance');if(g>ae||g<ye)throw new RangeError('"value" argument is out of bounds');if(b+$>M.length)throw new RangeError("Index out of range")}f.prototype.writeUintLE=f.prototype.writeUIntLE=function(g,b,$,ae){if(g=+g,b=b>>>0,$=$>>>0,!ae){var ye=Math.pow(2,8*$)-1;Te(this,g,b,$,ye,0)}var ve=1,Ve=0;for(this[b]=g&255;++Ve<$&&(ve*=256);)this[b+Ve]=g/ve&255;return b+$},f.prototype.writeUintBE=f.prototype.writeUIntBE=function(g,b,$,ae){if(g=+g,b=b>>>0,$=$>>>0,!ae){var ye=Math.pow(2,8*$)-1;Te(this,g,b,$,ye,0)}var ve=$-1,Ve=1;for(this[b+ve]=g&255;--ve>=0&&(Ve*=256);)this[b+ve]=g/Ve&255;return b+$},f.prototype.writeUint8=f.prototype.writeUInt8=function(g,b,$){return g=+g,b=b>>>0,$||Te(this,g,b,1,255,0),this[b]=g&255,b+1},f.prototype.writeUint16LE=f.prototype.writeUInt16LE=function(g,b,$){return g=+g,b=b>>>0,$||Te(this,g,b,2,65535,0),this[b]=g&255,this[b+1]=g>>>8,b+2},f.prototype.writeUint16BE=f.prototype.writeUInt16BE=function(g,b,$){return g=+g,b=b>>>0,$||Te(this,g,b,2,65535,0),this[b]=g>>>8,this[b+1]=g&255,b+2},f.prototype.writeUint32LE=f.prototype.writeUInt32LE=function(g,b,$){return g=+g,b=b>>>0,$||Te(this,g,b,4,4294967295,0),this[b+3]=g>>>24,this[b+2]=g>>>16,this[b+1]=g>>>8,this[b]=g&255,b+4},f.prototype.writeUint32BE=f.prototype.writeUInt32BE=function(g,b,$){return g=+g,b=b>>>0,$||Te(this,g,b,4,4294967295,0),this[b]=g>>>24,this[b+1]=g>>>16,this[b+2]=g>>>8,this[b+3]=g&255,b+4},f.prototype.writeIntLE=function(g,b,$,ae){if(g=+g,b=b>>>0,!ae){var ye=Math.pow(2,8*$-1);Te(this,g,b,$,ye-1,-ye)}var ve=0,Ve=1,Ye=0;for(this[b]=g&255;++ve<$&&(Ve*=256);)g<0&&Ye===0&&this[b+ve-1]!==0&&(Ye=1),this[b+ve]=(g/Ve>>0)-Ye&255;return b+$},f.prototype.writeIntBE=function(g,b,$,ae){if(g=+g,b=b>>>0,!ae){var ye=Math.pow(2,8*$-1);Te(this,g,b,$,ye-1,-ye)}var ve=$-1,Ve=1,Ye=0;for(this[b+ve]=g&255;--ve>=0&&(Ve*=256);)g<0&&Ye===0&&this[b+ve+1]!==0&&(Ye=1),this[b+ve]=(g/Ve>>0)-Ye&255;return b+$},f.prototype.writeInt8=function(g,b,$){return g=+g,b=b>>>0,$||Te(this,g,b,1,127,-128),g<0&&(g=255+g+1),this[b]=g&255,b+1},f.prototype.writeInt16LE=function(g,b,$){return g=+g,b=b>>>0,$||Te(this,g,b,2,32767,-32768),this[b]=g&255,this[b+1]=g>>>8,b+2},f.prototype.writeInt16BE=function(g,b,$){return g=+g,b=b>>>0,$||Te(this,g,b,2,32767,-32768),this[b]=g>>>8,this[b+1]=g&255,b+2},f.prototype.writeInt32LE=function(g,b,$){return g=+g,b=b>>>0,$||Te(this,g,b,4,2147483647,-2147483648),this[b]=g&255,this[b+1]=g>>>8,this[b+2]=g>>>16,this[b+3]=g>>>24,b+4},f.prototype.writeInt32BE=function(g,b,$){return g=+g,b=b>>>0,$||Te(this,g,b,4,2147483647,-2147483648),g<0&&(g=4294967295+g+1),this[b]=g>>>24,this[b+1]=g>>>16,this[b+2]=g>>>8,this[b+3]=g&255,b+4};function Ne(M,g,b,$,ae,ye){if(b+$>M.length)throw new RangeError("Index out of range");if(b<0)throw new RangeError("Index out of range")}function Je(M,g,b,$,ae){return g=+g,b=b>>>0,ae||Ne(M,g,b,4),r.write(M,g,b,$,23,4),b+4}f.prototype.writeFloatLE=function(g,b,$){return Je(this,g,b,!0,$)},f.prototype.writeFloatBE=function(g,b,$){return Je(this,g,b,!1,$)};function it(M,g,b,$,ae){return g=+g,b=b>>>0,ae||Ne(M,g,b,8),r.write(M,g,b,$,52,8),b+8}f.prototype.writeDoubleLE=function(g,b,$){return it(this,g,b,!0,$)},f.prototype.writeDoubleBE=function(g,b,$){return it(this,g,b,!1,$)},f.prototype.copy=function(g,b,$,ae){if(!f.isBuffer(g))throw new TypeError("argument should be a Buffer");if($||($=0),!ae&&ae!==0&&(ae=this.length),b>=g.length&&(b=g.length),b||(b=0),ae>0&&ae<$&&(ae=$),ae===$||g.length===0||this.length===0)return 0;if(b<0)throw new RangeError("targetStart out of bounds");if($<0||$>=this.length)throw new RangeError("Index out of range");if(ae<0)throw new RangeError("sourceEnd out of bounds");ae>this.length&&(ae=this.length),g.length-b<ae-$&&(ae=g.length-b+$);var ye=ae-$;return this===g&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(b,$,ae):Uint8Array.prototype.set.call(g,this.subarray($,ae),b),ye},f.prototype.fill=function(g,b,$,ae){if(typeof g=="string"){if(typeof b=="string"?(ae=b,b=0,$=this.length):typeof $=="string"&&(ae=$,$=this.length),ae!==void 0&&typeof ae!="string")throw new TypeError("encoding must be a string");if(typeof ae=="string"&&!f.isEncoding(ae))throw new TypeError("Unknown encoding: "+ae);if(g.length===1){var ye=g.charCodeAt(0);(ae==="utf8"&&ye<128||ae==="latin1")&&(g=ye)}}else typeof g=="number"?g=g&255:typeof g=="boolean"&&(g=Number(g));if(b<0||this.length<b||this.length<$)throw new RangeError("Out of range index");if($<=b)return this;b=b>>>0,$=$===void 0?this.length:$>>>0,g||(g=0);var ve;if(typeof g=="number")for(ve=b;ve<$;++ve)this[ve]=g;else{var Ve=f.isBuffer(g)?g:f.from(g,ae),Ye=Ve.length;if(Ye===0)throw new TypeError('The value "'+g+'" is invalid for argument "value"');for(ve=0;ve<$-b;++ve)this[ve+b]=Ve[ve%Ye]}return this};var Qe=/[^+/0-9A-Za-z-_]/g;function He(M){if(M=M.split("=")[0],M=M.trim().replace(Qe,""),M.length<2)return"";for(;M.length%4!==0;)M=M+"=";return M}function We(M,g){g=g||1/0;for(var b,$=M.length,ae=null,ye=[],ve=0;ve<$;++ve){if(b=M.charCodeAt(ve),b>55295&&b<57344){if(!ae){if(b>56319){(g-=3)>-1&&ye.push(239,191,189);continue}else if(ve+1===$){(g-=3)>-1&&ye.push(239,191,189);continue}ae=b;continue}if(b<56320){(g-=3)>-1&&ye.push(239,191,189),ae=b;continue}b=(ae-55296<<10|b-56320)+65536}else ae&&(g-=3)>-1&&ye.push(239,191,189);if(ae=null,b<128){if((g-=1)<0)break;ye.push(b)}else if(b<2048){if((g-=2)<0)break;ye.push(b>>6|192,b&63|128)}else if(b<65536){if((g-=3)<0)break;ye.push(b>>12|224,b>>6&63|128,b&63|128)}else if(b<1114112){if((g-=4)<0)break;ye.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw new Error("Invalid code point")}return ye}function rt(M){for(var g=[],b=0;b<M.length;++b)g.push(M.charCodeAt(b)&255);return g}function Xe(M,g){for(var b,$,ae,ye=[],ve=0;ve<M.length&&!((g-=2)<0);++ve)b=M.charCodeAt(ve),$=b>>8,ae=b%256,ye.push(ae),ye.push($);return ye}function at(M){return n.toByteArray(He(M))}function Ge(M,g,b,$){for(var ae=0;ae<$&&!(ae+b>=g.length||ae>=M.length);++ae)g[ae+b]=M[ae];return ae}function Ze(M,g){return M instanceof g||M!=null&&M.constructor!=null&&M.constructor.name!=null&&M.constructor.name===g.name}function pt(M){return M!==M}var wt=(function(){for(var M="0123456789abcdef",g=new Array(256),b=0;b<16;++b)for(var $=b*16,ae=0;ae<16;++ae)g[$+ae]=M[b]+M[ae];return g})()})(Ia)),Ia}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var bu;function ks(){return bu||(bu=1,(function(e,n){var r=pw(),o=r.Buffer;function l(p,f){for(var h in p)f[h]=p[h]}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?e.exports=r:(l(r,n),n.Buffer=u);function u(p,f,h){return o(p,f,h)}u.prototype=Object.create(o.prototype),l(o,u),u.from=function(p,f,h){if(typeof p=="number")throw new TypeError("Argument must not be a number");return o(p,f,h)},u.alloc=function(p,f,h){if(typeof p!="number")throw new TypeError("Argument must be a number");var x=o(p);return f!==void 0?typeof h=="string"?x.fill(f,h):x.fill(f):x.fill(0),x},u.allocUnsafe=function(p){if(typeof p!="number")throw new TypeError("Argument must be a number");return o(p)},u.allocUnsafeSlow=function(p){if(typeof p!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(p)}})(xi,xi.exports)),xi.exports}var Ta,vu;function gw(){if(vu)return Ta;vu=1;var e={}.toString;return Ta=Array.isArray||function(n){return e.call(n)=="[object Array]"},Ta}var Ca,xu;function Kn(){return xu||(xu=1,Ca=TypeError),Ca}var Ra,_u;function Nd(){return _u||(_u=1,Ra=Object),Ra}var Oa,Su;function mw(){return Su||(Su=1,Oa=Error),Oa}var Ma,ku;function ww(){return ku||(ku=1,Ma=EvalError),Ma}var Pa,Eu;function yw(){return Eu||(Eu=1,Pa=RangeError),Pa}var ja,Au;function bw(){return Au||(Au=1,ja=ReferenceError),ja}var Ba,Iu;function Ud(){return Iu||(Iu=1,Ba=SyntaxError),Ba}var Fa,Tu;function vw(){return Tu||(Tu=1,Fa=URIError),Fa}var Da,Cu;function xw(){return Cu||(Cu=1,Da=Math.abs),Da}var La,Ru;function _w(){return Ru||(Ru=1,La=Math.floor),La}var $a,Ou;function Sw(){return Ou||(Ou=1,$a=Math.max),$a}var Na,Mu;function kw(){return Mu||(Mu=1,Na=Math.min),Na}var Ua,Pu;function Ew(){return Pu||(Pu=1,Ua=Math.pow),Ua}var za,ju;function Aw(){return ju||(ju=1,za=Math.round),za}var Ga,Bu;function Iw(){return Bu||(Bu=1,Ga=Number.isNaN||function(n){return n!==n}),Ga}var Ha,Fu;function Tw(){if(Fu)return Ha;Fu=1;var e=Iw();return Ha=function(r){return e(r)||r===0?r:r<0?-1:1},Ha}var Wa,Du;function Cw(){return Du||(Du=1,Wa=Object.getOwnPropertyDescriptor),Wa}var qa,Lu;function Xn(){if(Lu)return qa;Lu=1;var e=Cw();if(e)try{e([],"length")}catch{e=null}return qa=e,qa}var Va,$u;function zi(){if($u)return Va;$u=1;var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return Va=e,Va}var Za,Nu;function zd(){return Nu||(Nu=1,Za=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var n={},r=Symbol("test"),o=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(o)!=="[object Symbol]")return!1;var l=42;n[r]=l;for(var u in n)return!1;if(typeof Object.keys=="function"&&Object.keys(n).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(n).length!==0)return!1;var p=Object.getOwnPropertySymbols(n);if(p.length!==1||p[0]!==r||!Object.prototype.propertyIsEnumerable.call(n,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var f=Object.getOwnPropertyDescriptor(n,r);if(f.value!==l||f.enumerable!==!0)return!1}return!0}),Za}var Ka,Uu;function Rw(){if(Uu)return Ka;Uu=1;var e=typeof Symbol<"u"&&Symbol,n=zd();return Ka=function(){return typeof e!="function"||typeof Symbol!="function"||typeof e("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:n()},Ka}var Xa,zu;function Gd(){return zu||(zu=1,Xa=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Xa}var Ya,Gu;function Hd(){if(Gu)return Ya;Gu=1;var e=Nd();return Ya=e.getPrototypeOf||null,Ya}var Ja,Hu;function Ow(){if(Hu)return Ja;Hu=1;var e="Function.prototype.bind called on incompatible ",n=Object.prototype.toString,r=Math.max,o="[object Function]",l=function(h,x){for(var _=[],y=0;y<h.length;y+=1)_[y]=h[y];for(var O=0;O<x.length;O+=1)_[O+h.length]=x[O];return _},u=function(h,x){for(var _=[],y=x,O=0;y<h.length;y+=1,O+=1)_[O]=h[y];return _},p=function(f,h){for(var x="",_=0;_<f.length;_+=1)x+=f[_],_+1<f.length&&(x+=h);return x};return Ja=function(h){var x=this;if(typeof x!="function"||n.apply(x)!==o)throw new TypeError(e+x);for(var _=u(arguments,1),y,O=function(){if(this instanceof y){var D=x.apply(this,l(_,arguments));return Object(D)===D?D:this}return x.apply(h,l(_,arguments))},R=r(0,x.length-_.length),z=[],N=0;N<R;N++)z[N]="$"+N;if(y=Function("binder","return function ("+p(z,",")+"){ return binder.apply(this,arguments); }")(O),x.prototype){var L=function(){};L.prototype=x.prototype,y.prototype=new L,L.prototype=null}return y},Ja}var Qa,Wu;function Yn(){if(Wu)return Qa;Wu=1;var e=Ow();return Qa=Function.prototype.bind||e,Qa}var eo,qu;function Es(){return qu||(qu=1,eo=Function.prototype.call),eo}var to,Vu;function As(){return Vu||(Vu=1,to=Function.prototype.apply),to}var ro,Zu;function Mw(){return Zu||(Zu=1,ro=typeof Reflect<"u"&&Reflect&&Reflect.apply),ro}var no,Ku;function Wd(){if(Ku)return no;Ku=1;var e=Yn(),n=As(),r=Es(),o=Mw();return no=o||e.call(r,n),no}var io,Xu;function Is(){if(Xu)return io;Xu=1;var e=Yn(),n=Kn(),r=Es(),o=Wd();return io=function(u){if(u.length<1||typeof u[0]!="function")throw new n("a function is required");return o(e,r,u)},io}var ao,Yu;function Pw(){if(Yu)return ao;Yu=1;var e=Is(),n=Xn(),r;try{r=[].__proto__===Array.prototype}catch(p){if(!p||typeof p!="object"||!("code"in p)||p.code!=="ERR_PROTO_ACCESS")throw p}var o=!!r&&n&&n(Object.prototype,"__proto__"),l=Object,u=l.getPrototypeOf;return ao=o&&typeof o.get=="function"?e([o.get]):typeof u=="function"?function(f){return u(f==null?f:l(f))}:!1,ao}var oo,Ju;function qd(){if(Ju)return oo;Ju=1;var e=Gd(),n=Hd(),r=Pw();return oo=e?function(l){return e(l)}:n?function(l){if(!l||typeof l!="object"&&typeof l!="function")throw new TypeError("getProto: not an object");return n(l)}:r?function(l){return r(l)}:null,oo}var so,Qu;function jw(){if(Qu)return so;Qu=1;var e=Function.prototype.call,n=Object.prototype.hasOwnProperty,r=Yn();return so=r.call(e,n),so}var lo,ef;function Vd(){if(ef)return lo;ef=1;var e,n=Nd(),r=mw(),o=ww(),l=yw(),u=bw(),p=Ud(),f=Kn(),h=vw(),x=xw(),_=_w(),y=Sw(),O=kw(),R=Ew(),z=Aw(),N=Tw(),L=Function,D=function(rt){try{return L('"use strict"; return ('+rt+").constructor;")()}catch{}},U=Xn(),G=zi(),X=function(){throw new f},q=U?(function(){try{return arguments.callee,X}catch{try{return U(arguments,"callee").get}catch{return X}}})():X,Y=Rw()(),B=qd(),K=Hd(),se=Gd(),S=As(),ne=Es(),Q={},oe=typeof Uint8Array>"u"||!B?e:B(Uint8Array),W={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?e:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?e:ArrayBuffer,"%ArrayIteratorPrototype%":Y&&B?B([][Symbol.iterator]()):e,"%AsyncFromSyncIteratorPrototype%":e,"%AsyncFunction%":Q,"%AsyncGenerator%":Q,"%AsyncGeneratorFunction%":Q,"%AsyncIteratorPrototype%":Q,"%Atomics%":typeof Atomics>"u"?e:Atomics,"%BigInt%":typeof BigInt>"u"?e:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?e:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":o,"%Float16Array%":typeof Float16Array>"u"?e:Float16Array,"%Float32Array%":typeof Float32Array>"u"?e:Float32Array,"%Float64Array%":typeof Float64Array>"u"?e:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?e:FinalizationRegistry,"%Function%":L,"%GeneratorFunction%":Q,"%Int8Array%":typeof Int8Array>"u"?e:Int8Array,"%Int16Array%":typeof Int16Array>"u"?e:Int16Array,"%Int32Array%":typeof Int32Array>"u"?e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Y&&B?B(B([][Symbol.iterator]())):e,"%JSON%":typeof JSON=="object"?JSON:e,"%Map%":typeof Map>"u"?e:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Y||!B?e:B(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":n,"%Object.getOwnPropertyDescriptor%":U,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?e:Promise,"%Proxy%":typeof Proxy>"u"?e:Proxy,"%RangeError%":l,"%ReferenceError%":u,"%Reflect%":typeof Reflect>"u"?e:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?e:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Y||!B?e:B(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Y&&B?B(""[Symbol.iterator]()):e,"%Symbol%":Y?Symbol:e,"%SyntaxError%":p,"%ThrowTypeError%":q,"%TypedArray%":oe,"%TypeError%":f,"%Uint8Array%":typeof Uint8Array>"u"?e:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?e:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?e:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?e:Uint32Array,"%URIError%":h,"%WeakMap%":typeof WeakMap>"u"?e:WeakMap,"%WeakRef%":typeof WeakRef>"u"?e:WeakRef,"%WeakSet%":typeof WeakSet>"u"?e:WeakSet,"%Function.prototype.call%":ne,"%Function.prototype.apply%":S,"%Object.defineProperty%":G,"%Object.getPrototypeOf%":K,"%Math.abs%":x,"%Math.floor%":_,"%Math.max%":y,"%Math.min%":O,"%Math.pow%":R,"%Math.round%":z,"%Math.sign%":N,"%Reflect.getPrototypeOf%":se};if(B)try{null.error}catch(rt){var le=B(B(rt));W["%Error.prototype%"]=le}var te=function rt(Xe){var at;if(Xe==="%AsyncFunction%")at=D("async function () {}");else if(Xe==="%GeneratorFunction%")at=D("function* () {}");else if(Xe==="%AsyncGeneratorFunction%")at=D("async function* () {}");else if(Xe==="%AsyncGenerator%"){var Ge=rt("%AsyncGeneratorFunction%");Ge&&(at=Ge.prototype)}else if(Xe==="%AsyncIteratorPrototype%"){var Ze=rt("%AsyncGenerator%");Ze&&B&&(at=B(Ze.prototype))}return W[Xe]=at,at},ie={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ue=Yn(),ce=jw(),Fe=ue.call(ne,Array.prototype.concat),xe=ue.call(S,Array.prototype.splice),Te=ue.call(ne,String.prototype.replace),Ne=ue.call(ne,String.prototype.slice),Je=ue.call(ne,RegExp.prototype.exec),it=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Qe=/\\(\\)?/g,He=function(Xe){var at=Ne(Xe,0,1),Ge=Ne(Xe,-1);if(at==="%"&&Ge!=="%")throw new p("invalid intrinsic syntax, expected closing `%`");if(Ge==="%"&&at!=="%")throw new p("invalid intrinsic syntax, expected opening `%`");var Ze=[];return Te(Xe,it,function(pt,wt,M,g){Ze[Ze.length]=M?Te(g,Qe,"$1"):wt||pt}),Ze},We=function(Xe,at){var Ge=Xe,Ze;if(ce(ie,Ge)&&(Ze=ie[Ge],Ge="%"+Ze[0]+"%"),ce(W,Ge)){var pt=W[Ge];if(pt===Q&&(pt=te(Ge)),typeof pt>"u"&&!at)throw new f("intrinsic "+Xe+" exists, but is not available. Please file an issue!");return{alias:Ze,name:Ge,value:pt}}throw new p("intrinsic "+Xe+" does not exist!")};return lo=function(Xe,at){if(typeof Xe!="string"||Xe.length===0)throw new f("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof at!="boolean")throw new f('"allowMissing" argument must be a boolean');if(Je(/^%?[^%]*%?$/,Xe)===null)throw new p("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var Ge=He(Xe),Ze=Ge.length>0?Ge[0]:"",pt=We("%"+Ze+"%",at),wt=pt.name,M=pt.value,g=!1,b=pt.alias;b&&(Ze=b[0],xe(Ge,Fe([0,1],b)));for(var $=1,ae=!0;$<Ge.length;$+=1){var ye=Ge[$],ve=Ne(ye,0,1),Ve=Ne(ye,-1);if((ve==='"'||ve==="'"||ve==="`"||Ve==='"'||Ve==="'"||Ve==="`")&&ve!==Ve)throw new p("property names with quotes must have matching quotes");if((ye==="constructor"||!ae)&&(g=!0),Ze+="."+ye,wt="%"+Ze+"%",ce(W,wt))M=W[wt];else if(M!=null){if(!(ye in M)){if(!at)throw new f("base intrinsic for "+Xe+" exists, but the property is not available.");return}if(U&&$+1>=Ge.length){var Ye=U(M,ye);ae=!!Ye,ae&&"get"in Ye&&!("originalValue"in Ye.get)?M=Ye.get:M=M[ye]}else ae=ce(M,ye),M=M[ye];ae&&!g&&(W[wt]=M)}}return M},lo}var co,tf;function Zd(){if(tf)return co;tf=1;var e=Vd(),n=Is(),r=n([e("%String.prototype.indexOf%")]);return co=function(l,u){var p=e(l,!!u);return typeof p=="function"&&r(l,".prototype.")>-1?n([p]):p},co}var uo,rf;function Bw(){if(rf)return uo;rf=1;var e=Function.prototype.toString,n=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,r,o;if(typeof n=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw o}}),o={},n(function(){throw 42},null,r)}catch(U){U!==o&&(n=null)}else n=null;var l=/^\s*class\b/,u=function(G){try{var X=e.call(G);return l.test(X)}catch{return!1}},p=function(G){try{return u(G)?!1:(e.call(G),!0)}catch{return!1}},f=Object.prototype.toString,h="[object Object]",x="[object Function]",_="[object GeneratorFunction]",y="[object HTMLAllCollection]",O="[object HTML document.all class]",R="[object HTMLCollection]",z=typeof Symbol=="function"&&!!Symbol.toStringTag,N=!(0 in[,]),L=function(){return!1};if(typeof document=="object"){var D=document.all;f.call(D)===f.call(document.all)&&(L=function(G){if((N||!G)&&(typeof G>"u"||typeof G=="object"))try{var X=f.call(G);return(X===y||X===O||X===R||X===h)&&G("")==null}catch{}return!1})}return uo=n?function(G){if(L(G))return!0;if(!G||typeof G!="function"&&typeof G!="object")return!1;try{n(G,null,r)}catch(X){if(X!==o)return!1}return!u(G)&&p(G)}:function(G){if(L(G))return!0;if(!G||typeof G!="function"&&typeof G!="object")return!1;if(z)return p(G);if(u(G))return!1;var X=f.call(G);return X!==x&&X!==_&&!/^\[object HTML/.test(X)?!1:p(G)},uo}var fo,nf;function Fw(){if(nf)return fo;nf=1;var e=Bw(),n=Object.prototype.toString,r=Object.prototype.hasOwnProperty,o=function(h,x,_){for(var y=0,O=h.length;y<O;y++)r.call(h,y)&&(_==null?x(h[y],y,h):x.call(_,h[y],y,h))},l=function(h,x,_){for(var y=0,O=h.length;y<O;y++)_==null?x(h.charAt(y),y,h):x.call(_,h.charAt(y),y,h)},u=function(h,x,_){for(var y in h)r.call(h,y)&&(_==null?x(h[y],y,h):x.call(_,h[y],y,h))};function p(f){return n.call(f)==="[object Array]"}return fo=function(h,x,_){if(!e(x))throw new TypeError("iterator must be a function");var y;arguments.length>=3&&(y=_),p(h)?o(h,x,y):typeof h=="string"?l(h,x,y):u(h,x,y)},fo}var ho,af;function Dw(){return af||(af=1,ho=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),ho}var po,of;function Lw(){if(of)return po;of=1;var e=Dw(),n=typeof globalThis>"u"?Ai:globalThis;return po=function(){for(var o=[],l=0;l<e.length;l++)typeof n[e[l]]=="function"&&(o[o.length]=e[l]);return o},po}var go={exports:{}},mo,sf;function $w(){if(sf)return mo;sf=1;var e=zi(),n=Ud(),r=Kn(),o=Xn();return mo=function(u,p,f){if(!u||typeof u!="object"&&typeof u!="function")throw new r("`obj` must be an object or a function`");if(typeof p!="string"&&typeof p!="symbol")throw new r("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new r("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new r("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new r("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new r("`loose`, if provided, must be a boolean");var h=arguments.length>3?arguments[3]:null,x=arguments.length>4?arguments[4]:null,_=arguments.length>5?arguments[5]:null,y=arguments.length>6?arguments[6]:!1,O=!!o&&o(u,p);if(e)e(u,p,{configurable:_===null&&O?O.configurable:!_,enumerable:h===null&&O?O.enumerable:!h,value:f,writable:x===null&&O?O.writable:!x});else if(y||!h&&!x&&!_)u[p]=f;else throw new n("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},mo}var wo,lf;function Nw(){if(lf)return wo;lf=1;var e=zi(),n=function(){return!!e};return n.hasArrayLengthDefineBug=function(){if(!e)return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},wo=n,wo}var yo,cf;function Uw(){if(cf)return yo;cf=1;var e=Vd(),n=$w(),r=Nw()(),o=Xn(),l=Kn(),u=e("%Math.floor%");return yo=function(f,h){if(typeof f!="function")throw new l("`fn` is not a function");if(typeof h!="number"||h<0||h>4294967295||u(h)!==h)throw new l("`length` must be a positive 32-bit integer");var x=arguments.length>2&&!!arguments[2],_=!0,y=!0;if("length"in f&&o){var O=o(f,"length");O&&!O.configurable&&(_=!1),O&&!O.writable&&(y=!1)}return(_||y||!x)&&(r?n(f,"length",h,!0,!0):n(f,"length",h)),f},yo}var bo,uf;function zw(){if(uf)return bo;uf=1;var e=Yn(),n=As(),r=Wd();return bo=function(){return r(e,n,arguments)},bo}var ff;function Gw(){return ff||(ff=1,(function(e){var n=Uw(),r=zi(),o=Is(),l=zw();e.exports=function(p){var f=o(arguments),h=p.length-(arguments.length-1);return n(f,1+(h>0?h:0),!0)},r?r(e.exports,"apply",{value:l}):e.exports.apply=l})(go)),go.exports}var vo,df;function Hw(){if(df)return vo;df=1;var e=zd();return vo=function(){return e()&&!!Symbol.toStringTag},vo}var xo,hf;function Ww(){if(hf)return xo;hf=1;var e=Fw(),n=Lw(),r=Gw(),o=Zd(),l=Xn(),u=qd(),p=o("Object.prototype.toString"),f=Hw()(),h=typeof globalThis>"u"?Ai:globalThis,x=n(),_=o("String.prototype.slice"),y=o("Array.prototype.indexOf",!0)||function(L,D){for(var U=0;U<L.length;U+=1)if(L[U]===D)return U;return-1},O={__proto__:null};f&&l&&u?e(x,function(N){var L=new h[N];if(Symbol.toStringTag in L&&u){var D=u(L),U=l(D,Symbol.toStringTag);if(!U&&D){var G=u(D);U=l(G,Symbol.toStringTag)}if(U&&U.get){var X=r(U.get);O["$"+N]=X}}}):e(x,function(N){var L=new h[N],D=L.slice||L.set;if(D){var U=r(D);O["$"+N]=U}});var R=function(L){var D=!1;return e(O,function(U,G){if(!D)try{"$"+U(L)===G&&(D=_(G,1))}catch{}}),D},z=function(L){var D=!1;return e(O,function(U,G){if(!D)try{U(L),D=_(G,1)}catch{}}),D};return xo=function(L){if(!L||typeof L!="object")return!1;if(!f){var D=_(p(L),8,-1);return y(x,D)>-1?D:D!=="Object"?!1:z(L)}return l?R(L):null},xo}var _o,pf;function qw(){if(pf)return _o;pf=1;var e=Ww();return _o=function(r){return!!e(r)},_o}var So,gf;function Vw(){if(gf)return So;gf=1;var e=Kn(),n=Zd(),r=n("TypedArray.prototype.buffer",!0),o=qw();return So=r||function(u){if(!o(u))throw new e("Not a Typed Array");return u.buffer},So}var ko,mf;function Zw(){if(mf)return ko;mf=1;var e=ks().Buffer,n=gw(),r=Vw(),o=ArrayBuffer.isView||function(h){try{return r(h),!0}catch{return!1}},l=typeof Uint8Array<"u",u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",p=u&&(e.prototype instanceof Uint8Array||e.TYPED_ARRAY_SUPPORT);return ko=function(h,x){if(e.isBuffer(h))return h.constructor&&!("isBuffer"in h)?e.from(h):h;if(typeof h=="string")return e.from(h,x);if(u&&o(h)){if(h.byteLength===0)return e.alloc(0);if(p){var _=e.from(h.buffer,h.byteOffset,h.byteLength);if(_.byteLength===h.byteLength)return _}var y=h instanceof Uint8Array?h:new Uint8Array(h.buffer,h.byteOffset,h.byteLength),O=e.from(y);if(O.length===h.byteLength)return O}if(l&&h instanceof Uint8Array)return e.from(h);var R=n(h);if(R)for(var z=0;z<h.length;z+=1){var N=h[z];if(typeof N!="number"||N<0||N>255||~~N!==N)throw new RangeError("Array items must be numbers in the range 0-255.")}if(R||e.isBuffer(h)&&h.constructor&&typeof h.constructor.isBuffer=="function"&&h.constructor.isBuffer(h))return e.from(h);throw new TypeError('The "data" argument must be a string, an Array, a Buffer, a Uint8Array, or a DataView.')},ko}var Eo,wf;function Kw(){if(wf)return Eo;wf=1;var e=ks().Buffer,n=Zw();function r(o,l){this._block=e.alloc(o),this._finalSize=l,this._blockSize=o,this._len=0}return r.prototype.update=function(o,l){o=n(o,l||"utf8");for(var u=this._block,p=this._blockSize,f=o.length,h=this._len,x=0;x<f;){for(var _=h%p,y=Math.min(f-x,p-_),O=0;O<y;O++)u[_+O]=o[x+O];h+=y,x+=y,h%p===0&&this._update(u)}return this._len+=f,this},r.prototype.digest=function(o){var l=this._len%this._blockSize;this._block[l]=128,this._block.fill(0,l+1),l>=this._finalSize&&(this._update(this._block),this._block.fill(0));var u=this._len*8;if(u<=4294967295)this._block.writeUInt32BE(u,this._blockSize-4);else{var p=(u&4294967295)>>>0,f=(u-p)/4294967296;this._block.writeUInt32BE(f,this._blockSize-8),this._block.writeUInt32BE(p,this._blockSize-4)}this._update(this._block);var h=this._hash();return o?h.toString(o):h},r.prototype._update=function(){throw new Error("_update must be implemented by subclass")},Eo=r,Eo}var Ao,yf;function Xw(){if(yf)return Ao;yf=1;var e=fw(),n=Kw(),r=ks().Buffer,o=[1518500249,1859775393,-1894007588,-899497514],l=new Array(80);function u(){this.init(),this._w=l,n.call(this,64,56)}e(u,n),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function p(_){return _<<1|_>>>31}function f(_){return _<<5|_>>>27}function h(_){return _<<30|_>>>2}function x(_,y,O,R){return _===0?y&O|~y&R:_===2?y&O|y&R|O&R:y^O^R}return u.prototype._update=function(_){for(var y=this._w,O=this._a|0,R=this._b|0,z=this._c|0,N=this._d|0,L=this._e|0,D=0;D<16;++D)y[D]=_.readInt32BE(D*4);for(;D<80;++D)y[D]=p(y[D-3]^y[D-8]^y[D-14]^y[D-16]);for(var U=0;U<80;++U){var G=~~(U/20),X=f(O)+x(G,R,z,N)+L+y[U]+o[G]|0;L=N,N=z,z=h(R),R=O,O=X}this._a=O+this._a|0,this._b=R+this._b|0,this._c=z+this._c|0,this._d=N+this._d|0,this._e=L+this._e|0},u.prototype._hash=function(){var _=r.allocUnsafe(20);return _.writeInt32BE(this._a|0,0),_.writeInt32BE(this._b|0,4),_.writeInt32BE(this._c|0,8),_.writeInt32BE(this._d|0,12),_.writeInt32BE(this._e|0,16),_},Ao=u,Ao}var Io={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var bf;function Yw(){return bf||(bf=1,(function(e){(function(n){n(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(n){n.version="1.2.2";function r(){for(var K=0,se=new Array(256),S=0;S!=256;++S)K=S,K=K&1?-306674912^K>>>1:K>>>1,K=K&1?-306674912^K>>>1:K>>>1,K=K&1?-306674912^K>>>1:K>>>1,K=K&1?-306674912^K>>>1:K>>>1,K=K&1?-306674912^K>>>1:K>>>1,K=K&1?-306674912^K>>>1:K>>>1,K=K&1?-306674912^K>>>1:K>>>1,K=K&1?-306674912^K>>>1:K>>>1,se[S]=K;return typeof Int32Array<"u"?new Int32Array(se):se}var o=r();function l(K){var se=0,S=0,ne=0,Q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ne=0;ne!=256;++ne)Q[ne]=K[ne];for(ne=0;ne!=256;++ne)for(S=K[ne],se=256+ne;se<4096;se+=256)S=Q[se]=S>>>8^K[S&255];var oe=[];for(ne=1;ne!=16;++ne)oe[ne-1]=typeof Int32Array<"u"?Q.subarray(ne*256,ne*256+256):Q.slice(ne*256,ne*256+256);return oe}var u=l(o),p=u[0],f=u[1],h=u[2],x=u[3],_=u[4],y=u[5],O=u[6],R=u[7],z=u[8],N=u[9],L=u[10],D=u[11],U=u[12],G=u[13],X=u[14];function q(K,se){for(var S=se^-1,ne=0,Q=K.length;ne<Q;)S=S>>>8^o[(S^K.charCodeAt(ne++))&255];return~S}function Y(K,se){for(var S=se^-1,ne=K.length-15,Q=0;Q<ne;)S=X[K[Q++]^S&255]^G[K[Q++]^S>>8&255]^U[K[Q++]^S>>16&255]^D[K[Q++]^S>>>24]^L[K[Q++]]^N[K[Q++]]^z[K[Q++]]^R[K[Q++]]^O[K[Q++]]^y[K[Q++]]^_[K[Q++]]^x[K[Q++]]^h[K[Q++]]^f[K[Q++]]^p[K[Q++]]^o[K[Q++]];for(ne+=15;Q<ne;)S=S>>>8^o[(S^K[Q++])&255];return~S}function B(K,se){for(var S=se^-1,ne=0,Q=K.length,oe=0,W=0;ne<Q;)oe=K.charCodeAt(ne++),oe<128?S=S>>>8^o[(S^oe)&255]:oe<2048?(S=S>>>8^o[(S^(192|oe>>6&31))&255],S=S>>>8^o[(S^(128|oe&63))&255]):oe>=55296&&oe<57344?(oe=(oe&1023)+64,W=K.charCodeAt(ne++)&1023,S=S>>>8^o[(S^(240|oe>>8&7))&255],S=S>>>8^o[(S^(128|oe>>2&63))&255],S=S>>>8^o[(S^(128|W>>6&15|(oe&3)<<4))&255],S=S>>>8^o[(S^(128|W&63))&255]):(S=S>>>8^o[(S^(224|oe>>12&15))&255],S=S>>>8^o[(S^(128|oe>>6&63))&255],S=S>>>8^o[(S^(128|oe&63))&255]);return~S}n.table=o,n.bstr=q,n.buf=Y,n.str=B})})(Io)),Io}var To={},vf;function xr(){return vf||(vf=1,(function(e){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function r(u,p){return Object.prototype.hasOwnProperty.call(u,p)}e.assign=function(u){for(var p=Array.prototype.slice.call(arguments,1);p.length;){var f=p.shift();if(f){if(typeof f!="object")throw new TypeError(f+"must be non-object");for(var h in f)r(f,h)&&(u[h]=f[h])}}return u},e.shrinkBuf=function(u,p){return u.length===p?u:u.subarray?u.subarray(0,p):(u.length=p,u)};var o={arraySet:function(u,p,f,h,x){if(p.subarray&&u.subarray){u.set(p.subarray(f,f+h),x);return}for(var _=0;_<h;_++)u[x+_]=p[f+_]},flattenChunks:function(u){var p,f,h,x,_,y;for(h=0,p=0,f=u.length;p<f;p++)h+=u[p].length;for(y=new Uint8Array(h),x=0,p=0,f=u.length;p<f;p++)_=u[p],y.set(_,x),x+=_.length;return y}},l={arraySet:function(u,p,f,h,x){for(var _=0;_<h;_++)u[x+_]=p[f+_]},flattenChunks:function(u){return[].concat.apply([],u)}};e.setTyped=function(u){u?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,o)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,l))},e.setTyped(n)})(To)),To}var Qr={},rr={},Mr={},xf;function Jw(){if(xf)return Mr;xf=1;var e=xr(),n=4,r=0,o=1,l=2;function u(P){for(var _e=P.length;--_e>=0;)P[_e]=0}var p=0,f=1,h=2,x=3,_=258,y=29,O=256,R=O+1+y,z=30,N=19,L=2*R+1,D=15,U=16,G=7,X=256,q=16,Y=17,B=18,K=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],se=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=512,oe=new Array((R+2)*2);u(oe);var W=new Array(z*2);u(W);var le=new Array(Q);u(le);var te=new Array(_-x+1);u(te);var ie=new Array(y);u(ie);var ue=new Array(z);u(ue);function ce(P,_e,ke,Be,ee){this.static_tree=P,this.extra_bits=_e,this.extra_base=ke,this.elems=Be,this.max_length=ee,this.has_stree=P&&P.length}var Fe,xe,Te;function Ne(P,_e){this.dyn_tree=P,this.max_code=0,this.stat_desc=_e}function Je(P){return P<256?le[P]:le[256+(P>>>7)]}function it(P,_e){P.pending_buf[P.pending++]=_e&255,P.pending_buf[P.pending++]=_e>>>8&255}function Qe(P,_e,ke){P.bi_valid>U-ke?(P.bi_buf|=_e<<P.bi_valid&65535,it(P,P.bi_buf),P.bi_buf=_e>>U-P.bi_valid,P.bi_valid+=ke-U):(P.bi_buf|=_e<<P.bi_valid&65535,P.bi_valid+=ke)}function He(P,_e,ke){Qe(P,ke[_e*2],ke[_e*2+1])}function We(P,_e){var ke=0;do ke|=P&1,P>>>=1,ke<<=1;while(--_e>0);return ke>>>1}function rt(P){P.bi_valid===16?(it(P,P.bi_buf),P.bi_buf=0,P.bi_valid=0):P.bi_valid>=8&&(P.pending_buf[P.pending++]=P.bi_buf&255,P.bi_buf>>=8,P.bi_valid-=8)}function Xe(P,_e){var ke=_e.dyn_tree,Be=_e.max_code,ee=_e.stat_desc.static_tree,he=_e.stat_desc.has_stree,A=_e.stat_desc.extra_bits,Se=_e.stat_desc.extra_base,qe=_e.stat_desc.max_length,m,H,ge,T,Z,fe,ze=0;for(T=0;T<=D;T++)P.bl_count[T]=0;for(ke[P.heap[P.heap_max]*2+1]=0,m=P.heap_max+1;m<L;m++)H=P.heap[m],T=ke[ke[H*2+1]*2+1]+1,T>qe&&(T=qe,ze++),ke[H*2+1]=T,!(H>Be)&&(P.bl_count[T]++,Z=0,H>=Se&&(Z=A[H-Se]),fe=ke[H*2],P.opt_len+=fe*(T+Z),he&&(P.static_len+=fe*(ee[H*2+1]+Z)));if(ze!==0){do{for(T=qe-1;P.bl_count[T]===0;)T--;P.bl_count[T]--,P.bl_count[T+1]+=2,P.bl_count[qe]--,ze-=2}while(ze>0);for(T=qe;T!==0;T--)for(H=P.bl_count[T];H!==0;)ge=P.heap[--m],!(ge>Be)&&(ke[ge*2+1]!==T&&(P.opt_len+=(T-ke[ge*2+1])*ke[ge*2],ke[ge*2+1]=T),H--)}}function at(P,_e,ke){var Be=new Array(D+1),ee=0,he,A;for(he=1;he<=D;he++)Be[he]=ee=ee+ke[he-1]<<1;for(A=0;A<=_e;A++){var Se=P[A*2+1];Se!==0&&(P[A*2]=We(Be[Se]++,Se))}}function Ge(){var P,_e,ke,Be,ee,he=new Array(D+1);for(ke=0,Be=0;Be<y-1;Be++)for(ie[Be]=ke,P=0;P<1<<K[Be];P++)te[ke++]=Be;for(te[ke-1]=Be,ee=0,Be=0;Be<16;Be++)for(ue[Be]=ee,P=0;P<1<<se[Be];P++)le[ee++]=Be;for(ee>>=7;Be<z;Be++)for(ue[Be]=ee<<7,P=0;P<1<<se[Be]-7;P++)le[256+ee++]=Be;for(_e=0;_e<=D;_e++)he[_e]=0;for(P=0;P<=143;)oe[P*2+1]=8,P++,he[8]++;for(;P<=255;)oe[P*2+1]=9,P++,he[9]++;for(;P<=279;)oe[P*2+1]=7,P++,he[7]++;for(;P<=287;)oe[P*2+1]=8,P++,he[8]++;for(at(oe,R+1,he),P=0;P<z;P++)W[P*2+1]=5,W[P*2]=We(P,5);Fe=new ce(oe,K,O+1,R,D),xe=new ce(W,se,0,z,D),Te=new ce(new Array(0),S,0,N,G)}function Ze(P){var _e;for(_e=0;_e<R;_e++)P.dyn_ltree[_e*2]=0;for(_e=0;_e<z;_e++)P.dyn_dtree[_e*2]=0;for(_e=0;_e<N;_e++)P.bl_tree[_e*2]=0;P.dyn_ltree[X*2]=1,P.opt_len=P.static_len=0,P.last_lit=P.matches=0}function pt(P){P.bi_valid>8?it(P,P.bi_buf):P.bi_valid>0&&(P.pending_buf[P.pending++]=P.bi_buf),P.bi_buf=0,P.bi_valid=0}function wt(P,_e,ke,Be){pt(P),it(P,ke),it(P,~ke),e.arraySet(P.pending_buf,P.window,_e,ke,P.pending),P.pending+=ke}function M(P,_e,ke,Be){var ee=_e*2,he=ke*2;return P[ee]<P[he]||P[ee]===P[he]&&Be[_e]<=Be[ke]}function g(P,_e,ke){for(var Be=P.heap[ke],ee=ke<<1;ee<=P.heap_len&&(ee<P.heap_len&&M(_e,P.heap[ee+1],P.heap[ee],P.depth)&&ee++,!M(_e,Be,P.heap[ee],P.depth));)P.heap[ke]=P.heap[ee],ke=ee,ee<<=1;P.heap[ke]=Be}function b(P,_e,ke){var Be,ee,he=0,A,Se;if(P.last_lit!==0)do Be=P.pending_buf[P.d_buf+he*2]<<8|P.pending_buf[P.d_buf+he*2+1],ee=P.pending_buf[P.l_buf+he],he++,Be===0?He(P,ee,_e):(A=te[ee],He(P,A+O+1,_e),Se=K[A],Se!==0&&(ee-=ie[A],Qe(P,ee,Se)),Be--,A=Je(Be),He(P,A,ke),Se=se[A],Se!==0&&(Be-=ue[A],Qe(P,Be,Se)));while(he<P.last_lit);He(P,X,_e)}function $(P,_e){var ke=_e.dyn_tree,Be=_e.stat_desc.static_tree,ee=_e.stat_desc.has_stree,he=_e.stat_desc.elems,A,Se,qe=-1,m;for(P.heap_len=0,P.heap_max=L,A=0;A<he;A++)ke[A*2]!==0?(P.heap[++P.heap_len]=qe=A,P.depth[A]=0):ke[A*2+1]=0;for(;P.heap_len<2;)m=P.heap[++P.heap_len]=qe<2?++qe:0,ke[m*2]=1,P.depth[m]=0,P.opt_len--,ee&&(P.static_len-=Be[m*2+1]);for(_e.max_code=qe,A=P.heap_len>>1;A>=1;A--)g(P,ke,A);m=he;do A=P.heap[1],P.heap[1]=P.heap[P.heap_len--],g(P,ke,1),Se=P.heap[1],P.heap[--P.heap_max]=A,P.heap[--P.heap_max]=Se,ke[m*2]=ke[A*2]+ke[Se*2],P.depth[m]=(P.depth[A]>=P.depth[Se]?P.depth[A]:P.depth[Se])+1,ke[A*2+1]=ke[Se*2+1]=m,P.heap[1]=m++,g(P,ke,1);while(P.heap_len>=2);P.heap[--P.heap_max]=P.heap[1],Xe(P,_e),at(ke,qe,P.bl_count)}function ae(P,_e,ke){var Be,ee=-1,he,A=_e[1],Se=0,qe=7,m=4;for(A===0&&(qe=138,m=3),_e[(ke+1)*2+1]=65535,Be=0;Be<=ke;Be++)he=A,A=_e[(Be+1)*2+1],!(++Se<qe&&he===A)&&(Se<m?P.bl_tree[he*2]+=Se:he!==0?(he!==ee&&P.bl_tree[he*2]++,P.bl_tree[q*2]++):Se<=10?P.bl_tree[Y*2]++:P.bl_tree[B*2]++,Se=0,ee=he,A===0?(qe=138,m=3):he===A?(qe=6,m=3):(qe=7,m=4))}function ye(P,_e,ke){var Be,ee=-1,he,A=_e[1],Se=0,qe=7,m=4;for(A===0&&(qe=138,m=3),Be=0;Be<=ke;Be++)if(he=A,A=_e[(Be+1)*2+1],!(++Se<qe&&he===A)){if(Se<m)do He(P,he,P.bl_tree);while(--Se!==0);else he!==0?(he!==ee&&(He(P,he,P.bl_tree),Se--),He(P,q,P.bl_tree),Qe(P,Se-3,2)):Se<=10?(He(P,Y,P.bl_tree),Qe(P,Se-3,3)):(He(P,B,P.bl_tree),Qe(P,Se-11,7));Se=0,ee=he,A===0?(qe=138,m=3):he===A?(qe=6,m=3):(qe=7,m=4)}}function ve(P){var _e;for(ae(P,P.dyn_ltree,P.l_desc.max_code),ae(P,P.dyn_dtree,P.d_desc.max_code),$(P,P.bl_desc),_e=N-1;_e>=3&&P.bl_tree[ne[_e]*2+1]===0;_e--);return P.opt_len+=3*(_e+1)+5+5+4,_e}function Ve(P,_e,ke,Be){var ee;for(Qe(P,_e-257,5),Qe(P,ke-1,5),Qe(P,Be-4,4),ee=0;ee<Be;ee++)Qe(P,P.bl_tree[ne[ee]*2+1],3);ye(P,P.dyn_ltree,_e-1),ye(P,P.dyn_dtree,ke-1)}function Ye(P){var _e=4093624447,ke;for(ke=0;ke<=31;ke++,_e>>>=1)if(_e&1&&P.dyn_ltree[ke*2]!==0)return r;if(P.dyn_ltree[18]!==0||P.dyn_ltree[20]!==0||P.dyn_ltree[26]!==0)return o;for(ke=32;ke<O;ke++)if(P.dyn_ltree[ke*2]!==0)return o;return r}var nt=!1;function ft(P){nt||(Ge(),nt=!0),P.l_desc=new Ne(P.dyn_ltree,Fe),P.d_desc=new Ne(P.dyn_dtree,xe),P.bl_desc=new Ne(P.bl_tree,Te),P.bi_buf=0,P.bi_valid=0,Ze(P)}function st(P,_e,ke,Be){Qe(P,(p<<1)+(Be?1:0),3),wt(P,_e,ke)}function yt(P){Qe(P,f<<1,3),He(P,X,oe),rt(P)}function Bt(P,_e,ke,Be){var ee,he,A=0;P.level>0?(P.strm.data_type===l&&(P.strm.data_type=Ye(P)),$(P,P.l_desc),$(P,P.d_desc),A=ve(P),ee=P.opt_len+3+7>>>3,he=P.static_len+3+7>>>3,he<=ee&&(ee=he)):ee=he=ke+5,ke+4<=ee&&_e!==-1?st(P,_e,ke,Be):P.strategy===n||he===ee?(Qe(P,(f<<1)+(Be?1:0),3),b(P,oe,W)):(Qe(P,(h<<1)+(Be?1:0),3),Ve(P,P.l_desc.max_code+1,P.d_desc.max_code+1,A+1),b(P,P.dyn_ltree,P.dyn_dtree)),Ze(P),Be&&pt(P)}function Jt(P,_e,ke){return P.pending_buf[P.d_buf+P.last_lit*2]=_e>>>8&255,P.pending_buf[P.d_buf+P.last_lit*2+1]=_e&255,P.pending_buf[P.l_buf+P.last_lit]=ke&255,P.last_lit++,_e===0?P.dyn_ltree[ke*2]++:(P.matches++,_e--,P.dyn_ltree[(te[ke]+O+1)*2]++,P.dyn_dtree[Je(_e)*2]++),P.last_lit===P.lit_bufsize-1}return Mr._tr_init=ft,Mr._tr_stored_block=st,Mr._tr_flush_block=Bt,Mr._tr_tally=Jt,Mr._tr_align=yt,Mr}var Co,_f;function Kd(){if(_f)return Co;_f=1;function e(n,r,o,l){for(var u=n&65535|0,p=n>>>16&65535|0,f=0;o!==0;){f=o>2e3?2e3:o,o-=f;do u=u+r[l++]|0,p=p+u|0;while(--f);u%=65521,p%=65521}return u|p<<16|0}return Co=e,Co}var Ro,Sf;function Xd(){if(Sf)return Ro;Sf=1;function e(){for(var o,l=[],u=0;u<256;u++){o=u;for(var p=0;p<8;p++)o=o&1?3988292384^o>>>1:o>>>1;l[u]=o}return l}var n=e();function r(o,l,u,p){var f=n,h=p+u;o^=-1;for(var x=p;x<h;x++)o=o>>>8^f[(o^l[x])&255];return o^-1}return Ro=r,Ro}var Oo,kf;function Ts(){return kf||(kf=1,Oo={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),Oo}var Ef;function Qw(){if(Ef)return rr;Ef=1;var e=xr(),n=Jw(),r=Kd(),o=Xd(),l=Ts(),u=0,p=1,f=3,h=4,x=5,_=0,y=1,O=-2,R=-3,z=-5,N=-1,L=1,D=2,U=3,G=4,X=0,q=2,Y=8,B=9,K=15,se=8,S=29,ne=256,Q=ne+1+S,oe=30,W=19,le=2*Q+1,te=15,ie=3,ue=258,ce=ue+ie+1,Fe=32,xe=42,Te=69,Ne=73,Je=91,it=103,Qe=113,He=666,We=1,rt=2,Xe=3,at=4,Ge=3;function Ze(m,H){return m.msg=l[H],H}function pt(m){return(m<<1)-(m>4?9:0)}function wt(m){for(var H=m.length;--H>=0;)m[H]=0}function M(m){var H=m.state,ge=H.pending;ge>m.avail_out&&(ge=m.avail_out),ge!==0&&(e.arraySet(m.output,H.pending_buf,H.pending_out,ge,m.next_out),m.next_out+=ge,H.pending_out+=ge,m.total_out+=ge,m.avail_out-=ge,H.pending-=ge,H.pending===0&&(H.pending_out=0))}function g(m,H){n._tr_flush_block(m,m.block_start>=0?m.block_start:-1,m.strstart-m.block_start,H),m.block_start=m.strstart,M(m.strm)}function b(m,H){m.pending_buf[m.pending++]=H}function $(m,H){m.pending_buf[m.pending++]=H>>>8&255,m.pending_buf[m.pending++]=H&255}function ae(m,H,ge,T){var Z=m.avail_in;return Z>T&&(Z=T),Z===0?0:(m.avail_in-=Z,e.arraySet(H,m.input,m.next_in,Z,ge),m.state.wrap===1?m.adler=r(m.adler,H,Z,ge):m.state.wrap===2&&(m.adler=o(m.adler,H,Z,ge)),m.next_in+=Z,m.total_in+=Z,Z)}function ye(m,H){var ge=m.max_chain_length,T=m.strstart,Z,fe,ze=m.prev_length,Pe=m.nice_match,Ce=m.strstart>m.w_size-ce?m.strstart-(m.w_size-ce):0,et=m.window,Vt=m.w_mask,gt=m.prev,ot=m.strstart+ue,vt=et[T+ze-1],kt=et[T+ze];m.prev_length>=m.good_match&&(ge>>=2),Pe>m.lookahead&&(Pe=m.lookahead);do if(Z=H,!(et[Z+ze]!==kt||et[Z+ze-1]!==vt||et[Z]!==et[T]||et[++Z]!==et[T+1])){T+=2,Z++;do;while(et[++T]===et[++Z]&&et[++T]===et[++Z]&&et[++T]===et[++Z]&&et[++T]===et[++Z]&&et[++T]===et[++Z]&&et[++T]===et[++Z]&&et[++T]===et[++Z]&&et[++T]===et[++Z]&&T<ot);if(fe=ue-(ot-T),T=ot-ue,fe>ze){if(m.match_start=H,ze=fe,fe>=Pe)break;vt=et[T+ze-1],kt=et[T+ze]}}while((H=gt[H&Vt])>Ce&&--ge!==0);return ze<=m.lookahead?ze:m.lookahead}function ve(m){var H=m.w_size,ge,T,Z,fe,ze;do{if(fe=m.window_size-m.lookahead-m.strstart,m.strstart>=H+(H-ce)){e.arraySet(m.window,m.window,H,H,0),m.match_start-=H,m.strstart-=H,m.block_start-=H,T=m.hash_size,ge=T;do Z=m.head[--ge],m.head[ge]=Z>=H?Z-H:0;while(--T);T=H,ge=T;do Z=m.prev[--ge],m.prev[ge]=Z>=H?Z-H:0;while(--T);fe+=H}if(m.strm.avail_in===0)break;if(T=ae(m.strm,m.window,m.strstart+m.lookahead,fe),m.lookahead+=T,m.lookahead+m.insert>=ie)for(ze=m.strstart-m.insert,m.ins_h=m.window[ze],m.ins_h=(m.ins_h<<m.hash_shift^m.window[ze+1])&m.hash_mask;m.insert&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[ze+ie-1])&m.hash_mask,m.prev[ze&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=ze,ze++,m.insert--,!(m.lookahead+m.insert<ie)););}while(m.lookahead<ce&&m.strm.avail_in!==0)}function Ve(m,H){var ge=65535;for(ge>m.pending_buf_size-5&&(ge=m.pending_buf_size-5);;){if(m.lookahead<=1){if(ve(m),m.lookahead===0&&H===u)return We;if(m.lookahead===0)break}m.strstart+=m.lookahead,m.lookahead=0;var T=m.block_start+ge;if((m.strstart===0||m.strstart>=T)&&(m.lookahead=m.strstart-T,m.strstart=T,g(m,!1),m.strm.avail_out===0)||m.strstart-m.block_start>=m.w_size-ce&&(g(m,!1),m.strm.avail_out===0))return We}return m.insert=0,H===h?(g(m,!0),m.strm.avail_out===0?Xe:at):(m.strstart>m.block_start&&(g(m,!1),m.strm.avail_out===0),We)}function Ye(m,H){for(var ge,T;;){if(m.lookahead<ce){if(ve(m),m.lookahead<ce&&H===u)return We;if(m.lookahead===0)break}if(ge=0,m.lookahead>=ie&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+ie-1])&m.hash_mask,ge=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),ge!==0&&m.strstart-ge<=m.w_size-ce&&(m.match_length=ye(m,ge)),m.match_length>=ie)if(T=n._tr_tally(m,m.strstart-m.match_start,m.match_length-ie),m.lookahead-=m.match_length,m.match_length<=m.max_lazy_match&&m.lookahead>=ie){m.match_length--;do m.strstart++,m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+ie-1])&m.hash_mask,ge=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart;while(--m.match_length!==0);m.strstart++}else m.strstart+=m.match_length,m.match_length=0,m.ins_h=m.window[m.strstart],m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+1])&m.hash_mask;else T=n._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++;if(T&&(g(m,!1),m.strm.avail_out===0))return We}return m.insert=m.strstart<ie-1?m.strstart:ie-1,H===h?(g(m,!0),m.strm.avail_out===0?Xe:at):m.last_lit&&(g(m,!1),m.strm.avail_out===0)?We:rt}function nt(m,H){for(var ge,T,Z;;){if(m.lookahead<ce){if(ve(m),m.lookahead<ce&&H===u)return We;if(m.lookahead===0)break}if(ge=0,m.lookahead>=ie&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+ie-1])&m.hash_mask,ge=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),m.prev_length=m.match_length,m.prev_match=m.match_start,m.match_length=ie-1,ge!==0&&m.prev_length<m.max_lazy_match&&m.strstart-ge<=m.w_size-ce&&(m.match_length=ye(m,ge),m.match_length<=5&&(m.strategy===L||m.match_length===ie&&m.strstart-m.match_start>4096)&&(m.match_length=ie-1)),m.prev_length>=ie&&m.match_length<=m.prev_length){Z=m.strstart+m.lookahead-ie,T=n._tr_tally(m,m.strstart-1-m.prev_match,m.prev_length-ie),m.lookahead-=m.prev_length-1,m.prev_length-=2;do++m.strstart<=Z&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+ie-1])&m.hash_mask,ge=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart);while(--m.prev_length!==0);if(m.match_available=0,m.match_length=ie-1,m.strstart++,T&&(g(m,!1),m.strm.avail_out===0))return We}else if(m.match_available){if(T=n._tr_tally(m,0,m.window[m.strstart-1]),T&&g(m,!1),m.strstart++,m.lookahead--,m.strm.avail_out===0)return We}else m.match_available=1,m.strstart++,m.lookahead--}return m.match_available&&(T=n._tr_tally(m,0,m.window[m.strstart-1]),m.match_available=0),m.insert=m.strstart<ie-1?m.strstart:ie-1,H===h?(g(m,!0),m.strm.avail_out===0?Xe:at):m.last_lit&&(g(m,!1),m.strm.avail_out===0)?We:rt}function ft(m,H){for(var ge,T,Z,fe,ze=m.window;;){if(m.lookahead<=ue){if(ve(m),m.lookahead<=ue&&H===u)return We;if(m.lookahead===0)break}if(m.match_length=0,m.lookahead>=ie&&m.strstart>0&&(Z=m.strstart-1,T=ze[Z],T===ze[++Z]&&T===ze[++Z]&&T===ze[++Z])){fe=m.strstart+ue;do;while(T===ze[++Z]&&T===ze[++Z]&&T===ze[++Z]&&T===ze[++Z]&&T===ze[++Z]&&T===ze[++Z]&&T===ze[++Z]&&T===ze[++Z]&&Z<fe);m.match_length=ue-(fe-Z),m.match_length>m.lookahead&&(m.match_length=m.lookahead)}if(m.match_length>=ie?(ge=n._tr_tally(m,1,m.match_length-ie),m.lookahead-=m.match_length,m.strstart+=m.match_length,m.match_length=0):(ge=n._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++),ge&&(g(m,!1),m.strm.avail_out===0))return We}return m.insert=0,H===h?(g(m,!0),m.strm.avail_out===0?Xe:at):m.last_lit&&(g(m,!1),m.strm.avail_out===0)?We:rt}function st(m,H){for(var ge;;){if(m.lookahead===0&&(ve(m),m.lookahead===0)){if(H===u)return We;break}if(m.match_length=0,ge=n._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++,ge&&(g(m,!1),m.strm.avail_out===0))return We}return m.insert=0,H===h?(g(m,!0),m.strm.avail_out===0?Xe:at):m.last_lit&&(g(m,!1),m.strm.avail_out===0)?We:rt}function yt(m,H,ge,T,Z){this.good_length=m,this.max_lazy=H,this.nice_length=ge,this.max_chain=T,this.func=Z}var Bt;Bt=[new yt(0,0,0,0,Ve),new yt(4,4,8,4,Ye),new yt(4,5,16,8,Ye),new yt(4,6,32,32,Ye),new yt(4,4,16,16,nt),new yt(8,16,32,32,nt),new yt(8,16,128,128,nt),new yt(8,32,128,256,nt),new yt(32,128,258,1024,nt),new yt(32,258,258,4096,nt)];function Jt(m){m.window_size=2*m.w_size,wt(m.head),m.max_lazy_match=Bt[m.level].max_lazy,m.good_match=Bt[m.level].good_length,m.nice_match=Bt[m.level].nice_length,m.max_chain_length=Bt[m.level].max_chain,m.strstart=0,m.block_start=0,m.lookahead=0,m.insert=0,m.match_length=m.prev_length=ie-1,m.match_available=0,m.ins_h=0}function P(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(le*2),this.dyn_dtree=new e.Buf16((2*oe+1)*2),this.bl_tree=new e.Buf16((2*W+1)*2),wt(this.dyn_ltree),wt(this.dyn_dtree),wt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(te+1),this.heap=new e.Buf16(2*Q+1),wt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*Q+1),wt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _e(m){var H;return!m||!m.state?Ze(m,O):(m.total_in=m.total_out=0,m.data_type=q,H=m.state,H.pending=0,H.pending_out=0,H.wrap<0&&(H.wrap=-H.wrap),H.status=H.wrap?xe:Qe,m.adler=H.wrap===2?0:1,H.last_flush=u,n._tr_init(H),_)}function ke(m){var H=_e(m);return H===_&&Jt(m.state),H}function Be(m,H){return!m||!m.state||m.state.wrap!==2?O:(m.state.gzhead=H,_)}function ee(m,H,ge,T,Z,fe){if(!m)return O;var ze=1;if(H===N&&(H=6),T<0?(ze=0,T=-T):T>15&&(ze=2,T-=16),Z<1||Z>B||ge!==Y||T<8||T>15||H<0||H>9||fe<0||fe>G)return Ze(m,O);T===8&&(T=9);var Pe=new P;return m.state=Pe,Pe.strm=m,Pe.wrap=ze,Pe.gzhead=null,Pe.w_bits=T,Pe.w_size=1<<Pe.w_bits,Pe.w_mask=Pe.w_size-1,Pe.hash_bits=Z+7,Pe.hash_size=1<<Pe.hash_bits,Pe.hash_mask=Pe.hash_size-1,Pe.hash_shift=~~((Pe.hash_bits+ie-1)/ie),Pe.window=new e.Buf8(Pe.w_size*2),Pe.head=new e.Buf16(Pe.hash_size),Pe.prev=new e.Buf16(Pe.w_size),Pe.lit_bufsize=1<<Z+6,Pe.pending_buf_size=Pe.lit_bufsize*4,Pe.pending_buf=new e.Buf8(Pe.pending_buf_size),Pe.d_buf=1*Pe.lit_bufsize,Pe.l_buf=3*Pe.lit_bufsize,Pe.level=H,Pe.strategy=fe,Pe.method=ge,ke(m)}function he(m,H){return ee(m,H,Y,K,se,X)}function A(m,H){var ge,T,Z,fe;if(!m||!m.state||H>x||H<0)return m?Ze(m,O):O;if(T=m.state,!m.output||!m.input&&m.avail_in!==0||T.status===He&&H!==h)return Ze(m,m.avail_out===0?z:O);if(T.strm=m,ge=T.last_flush,T.last_flush=H,T.status===xe)if(T.wrap===2)m.adler=0,b(T,31),b(T,139),b(T,8),T.gzhead?(b(T,(T.gzhead.text?1:0)+(T.gzhead.hcrc?2:0)+(T.gzhead.extra?4:0)+(T.gzhead.name?8:0)+(T.gzhead.comment?16:0)),b(T,T.gzhead.time&255),b(T,T.gzhead.time>>8&255),b(T,T.gzhead.time>>16&255),b(T,T.gzhead.time>>24&255),b(T,T.level===9?2:T.strategy>=D||T.level<2?4:0),b(T,T.gzhead.os&255),T.gzhead.extra&&T.gzhead.extra.length&&(b(T,T.gzhead.extra.length&255),b(T,T.gzhead.extra.length>>8&255)),T.gzhead.hcrc&&(m.adler=o(m.adler,T.pending_buf,T.pending,0)),T.gzindex=0,T.status=Te):(b(T,0),b(T,0),b(T,0),b(T,0),b(T,0),b(T,T.level===9?2:T.strategy>=D||T.level<2?4:0),b(T,Ge),T.status=Qe);else{var ze=Y+(T.w_bits-8<<4)<<8,Pe=-1;T.strategy>=D||T.level<2?Pe=0:T.level<6?Pe=1:T.level===6?Pe=2:Pe=3,ze|=Pe<<6,T.strstart!==0&&(ze|=Fe),ze+=31-ze%31,T.status=Qe,$(T,ze),T.strstart!==0&&($(T,m.adler>>>16),$(T,m.adler&65535)),m.adler=1}if(T.status===Te)if(T.gzhead.extra){for(Z=T.pending;T.gzindex<(T.gzhead.extra.length&65535)&&!(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>Z&&(m.adler=o(m.adler,T.pending_buf,T.pending-Z,Z)),M(m),Z=T.pending,T.pending===T.pending_buf_size));)b(T,T.gzhead.extra[T.gzindex]&255),T.gzindex++;T.gzhead.hcrc&&T.pending>Z&&(m.adler=o(m.adler,T.pending_buf,T.pending-Z,Z)),T.gzindex===T.gzhead.extra.length&&(T.gzindex=0,T.status=Ne)}else T.status=Ne;if(T.status===Ne)if(T.gzhead.name){Z=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>Z&&(m.adler=o(m.adler,T.pending_buf,T.pending-Z,Z)),M(m),Z=T.pending,T.pending===T.pending_buf_size)){fe=1;break}T.gzindex<T.gzhead.name.length?fe=T.gzhead.name.charCodeAt(T.gzindex++)&255:fe=0,b(T,fe)}while(fe!==0);T.gzhead.hcrc&&T.pending>Z&&(m.adler=o(m.adler,T.pending_buf,T.pending-Z,Z)),fe===0&&(T.gzindex=0,T.status=Je)}else T.status=Je;if(T.status===Je)if(T.gzhead.comment){Z=T.pending;do{if(T.pending===T.pending_buf_size&&(T.gzhead.hcrc&&T.pending>Z&&(m.adler=o(m.adler,T.pending_buf,T.pending-Z,Z)),M(m),Z=T.pending,T.pending===T.pending_buf_size)){fe=1;break}T.gzindex<T.gzhead.comment.length?fe=T.gzhead.comment.charCodeAt(T.gzindex++)&255:fe=0,b(T,fe)}while(fe!==0);T.gzhead.hcrc&&T.pending>Z&&(m.adler=o(m.adler,T.pending_buf,T.pending-Z,Z)),fe===0&&(T.status=it)}else T.status=it;if(T.status===it&&(T.gzhead.hcrc?(T.pending+2>T.pending_buf_size&&M(m),T.pending+2<=T.pending_buf_size&&(b(T,m.adler&255),b(T,m.adler>>8&255),m.adler=0,T.status=Qe)):T.status=Qe),T.pending!==0){if(M(m),m.avail_out===0)return T.last_flush=-1,_}else if(m.avail_in===0&&pt(H)<=pt(ge)&&H!==h)return Ze(m,z);if(T.status===He&&m.avail_in!==0)return Ze(m,z);if(m.avail_in!==0||T.lookahead!==0||H!==u&&T.status!==He){var Ce=T.strategy===D?st(T,H):T.strategy===U?ft(T,H):Bt[T.level].func(T,H);if((Ce===Xe||Ce===at)&&(T.status=He),Ce===We||Ce===Xe)return m.avail_out===0&&(T.last_flush=-1),_;if(Ce===rt&&(H===p?n._tr_align(T):H!==x&&(n._tr_stored_block(T,0,0,!1),H===f&&(wt(T.head),T.lookahead===0&&(T.strstart=0,T.block_start=0,T.insert=0))),M(m),m.avail_out===0))return T.last_flush=-1,_}return H!==h?_:T.wrap<=0?y:(T.wrap===2?(b(T,m.adler&255),b(T,m.adler>>8&255),b(T,m.adler>>16&255),b(T,m.adler>>24&255),b(T,m.total_in&255),b(T,m.total_in>>8&255),b(T,m.total_in>>16&255),b(T,m.total_in>>24&255)):($(T,m.adler>>>16),$(T,m.adler&65535)),M(m),T.wrap>0&&(T.wrap=-T.wrap),T.pending!==0?_:y)}function Se(m){var H;return!m||!m.state?O:(H=m.state.status,H!==xe&&H!==Te&&H!==Ne&&H!==Je&&H!==it&&H!==Qe&&H!==He?Ze(m,O):(m.state=null,H===Qe?Ze(m,R):_))}function qe(m,H){var ge=H.length,T,Z,fe,ze,Pe,Ce,et,Vt;if(!m||!m.state||(T=m.state,ze=T.wrap,ze===2||ze===1&&T.status!==xe||T.lookahead))return O;for(ze===1&&(m.adler=r(m.adler,H,ge,0)),T.wrap=0,ge>=T.w_size&&(ze===0&&(wt(T.head),T.strstart=0,T.block_start=0,T.insert=0),Vt=new e.Buf8(T.w_size),e.arraySet(Vt,H,ge-T.w_size,T.w_size,0),H=Vt,ge=T.w_size),Pe=m.avail_in,Ce=m.next_in,et=m.input,m.avail_in=ge,m.next_in=0,m.input=H,ve(T);T.lookahead>=ie;){Z=T.strstart,fe=T.lookahead-(ie-1);do T.ins_h=(T.ins_h<<T.hash_shift^T.window[Z+ie-1])&T.hash_mask,T.prev[Z&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=Z,Z++;while(--fe);T.strstart=Z,T.lookahead=ie-1,ve(T)}return T.strstart+=T.lookahead,T.block_start=T.strstart,T.insert=T.lookahead,T.lookahead=0,T.match_length=T.prev_length=ie-1,T.match_available=0,m.next_in=Ce,m.input=et,m.avail_in=Pe,T.wrap=ze,_}return rr.deflateInit=he,rr.deflateInit2=ee,rr.deflateReset=ke,rr.deflateResetKeep=_e,rr.deflateSetHeader=Be,rr.deflate=A,rr.deflateEnd=Se,rr.deflateSetDictionary=qe,rr.deflateInfo="pako deflate (from Nodeca project)",rr}var Pr={},Af;function Yd(){if(Af)return Pr;Af=1;var e=xr(),n=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch{n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{r=!1}for(var o=new e.Buf8(256),l=0;l<256;l++)o[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;o[254]=o[254]=1,Pr.string2buf=function(p){var f,h,x,_,y,O=p.length,R=0;for(_=0;_<O;_++)h=p.charCodeAt(_),(h&64512)===55296&&_+1<O&&(x=p.charCodeAt(_+1),(x&64512)===56320&&(h=65536+(h-55296<<10)+(x-56320),_++)),R+=h<128?1:h<2048?2:h<65536?3:4;for(f=new e.Buf8(R),y=0,_=0;y<R;_++)h=p.charCodeAt(_),(h&64512)===55296&&_+1<O&&(x=p.charCodeAt(_+1),(x&64512)===56320&&(h=65536+(h-55296<<10)+(x-56320),_++)),h<128?f[y++]=h:h<2048?(f[y++]=192|h>>>6,f[y++]=128|h&63):h<65536?(f[y++]=224|h>>>12,f[y++]=128|h>>>6&63,f[y++]=128|h&63):(f[y++]=240|h>>>18,f[y++]=128|h>>>12&63,f[y++]=128|h>>>6&63,f[y++]=128|h&63);return f};function u(p,f){if(f<65534&&(p.subarray&&r||!p.subarray&&n))return String.fromCharCode.apply(null,e.shrinkBuf(p,f));for(var h="",x=0;x<f;x++)h+=String.fromCharCode(p[x]);return h}return Pr.buf2binstring=function(p){return u(p,p.length)},Pr.binstring2buf=function(p){for(var f=new e.Buf8(p.length),h=0,x=f.length;h<x;h++)f[h]=p.charCodeAt(h);return f},Pr.buf2string=function(p,f){var h,x,_,y,O=f||p.length,R=new Array(O*2);for(x=0,h=0;h<O;){if(_=p[h++],_<128){R[x++]=_;continue}if(y=o[_],y>4){R[x++]=65533,h+=y-1;continue}for(_&=y===2?31:y===3?15:7;y>1&&h<O;)_=_<<6|p[h++]&63,y--;if(y>1){R[x++]=65533;continue}_<65536?R[x++]=_:(_-=65536,R[x++]=55296|_>>10&1023,R[x++]=56320|_&1023)}return u(R,x)},Pr.utf8border=function(p,f){var h;for(f=f||p.length,f>p.length&&(f=p.length),h=f-1;h>=0&&(p[h]&192)===128;)h--;return h<0||h===0?f:h+o[p[h]]>f?h:f},Pr}var Mo,If;function Jd(){if(If)return Mo;If=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return Mo=e,Mo}var Tf;function ey(){if(Tf)return Qr;Tf=1;var e=Qw(),n=xr(),r=Yd(),o=Ts(),l=Jd(),u=Object.prototype.toString,p=0,f=4,h=0,x=1,_=2,y=-1,O=0,R=8;function z(U){if(!(this instanceof z))return new z(U);this.options=n.assign({level:y,method:R,chunkSize:16384,windowBits:15,memLevel:8,strategy:O,to:""},U||{});var G=this.options;G.raw&&G.windowBits>0?G.windowBits=-G.windowBits:G.gzip&&G.windowBits>0&&G.windowBits<16&&(G.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var X=e.deflateInit2(this.strm,G.level,G.method,G.windowBits,G.memLevel,G.strategy);if(X!==h)throw new Error(o[X]);if(G.header&&e.deflateSetHeader(this.strm,G.header),G.dictionary){var q;if(typeof G.dictionary=="string"?q=r.string2buf(G.dictionary):u.call(G.dictionary)==="[object ArrayBuffer]"?q=new Uint8Array(G.dictionary):q=G.dictionary,X=e.deflateSetDictionary(this.strm,q),X!==h)throw new Error(o[X]);this._dict_set=!0}}z.prototype.push=function(U,G){var X=this.strm,q=this.options.chunkSize,Y,B;if(this.ended)return!1;B=G===~~G?G:G===!0?f:p,typeof U=="string"?X.input=r.string2buf(U):u.call(U)==="[object ArrayBuffer]"?X.input=new Uint8Array(U):X.input=U,X.next_in=0,X.avail_in=X.input.length;do{if(X.avail_out===0&&(X.output=new n.Buf8(q),X.next_out=0,X.avail_out=q),Y=e.deflate(X,B),Y!==x&&Y!==h)return this.onEnd(Y),this.ended=!0,!1;(X.avail_out===0||X.avail_in===0&&(B===f||B===_))&&(this.options.to==="string"?this.onData(r.buf2binstring(n.shrinkBuf(X.output,X.next_out))):this.onData(n.shrinkBuf(X.output,X.next_out)))}while((X.avail_in>0||X.avail_out===0)&&Y!==x);return B===f?(Y=e.deflateEnd(this.strm),this.onEnd(Y),this.ended=!0,Y===h):(B===_&&(this.onEnd(h),X.avail_out=0),!0)},z.prototype.onData=function(U){this.chunks.push(U)},z.prototype.onEnd=function(U){U===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=U,this.msg=this.strm.msg};function N(U,G){var X=new z(G);if(X.push(U,!0),X.err)throw X.msg||o[X.err];return X.result}function L(U,G){return G=G||{},G.raw=!0,N(U,G)}function D(U,G){return G=G||{},G.gzip=!0,N(U,G)}return Qr.Deflate=z,Qr.deflate=N,Qr.deflateRaw=L,Qr.gzip=D,Qr}var en={},Yt={},Po,Cf;function ty(){if(Cf)return Po;Cf=1;var e=30,n=12;return Po=function(o,l){var u,p,f,h,x,_,y,O,R,z,N,L,D,U,G,X,q,Y,B,K,se,S,ne,Q,oe;u=o.state,p=o.next_in,Q=o.input,f=p+(o.avail_in-5),h=o.next_out,oe=o.output,x=h-(l-o.avail_out),_=h+(o.avail_out-257),y=u.dmax,O=u.wsize,R=u.whave,z=u.wnext,N=u.window,L=u.hold,D=u.bits,U=u.lencode,G=u.distcode,X=(1<<u.lenbits)-1,q=(1<<u.distbits)-1;e:do{D<15&&(L+=Q[p++]<<D,D+=8,L+=Q[p++]<<D,D+=8),Y=U[L&X];t:for(;;){if(B=Y>>>24,L>>>=B,D-=B,B=Y>>>16&255,B===0)oe[h++]=Y&65535;else if(B&16){K=Y&65535,B&=15,B&&(D<B&&(L+=Q[p++]<<D,D+=8),K+=L&(1<<B)-1,L>>>=B,D-=B),D<15&&(L+=Q[p++]<<D,D+=8,L+=Q[p++]<<D,D+=8),Y=G[L&q];r:for(;;){if(B=Y>>>24,L>>>=B,D-=B,B=Y>>>16&255,B&16){if(se=Y&65535,B&=15,D<B&&(L+=Q[p++]<<D,D+=8,D<B&&(L+=Q[p++]<<D,D+=8)),se+=L&(1<<B)-1,se>y){o.msg="invalid distance too far back",u.mode=e;break e}if(L>>>=B,D-=B,B=h-x,se>B){if(B=se-B,B>R&&u.sane){o.msg="invalid distance too far back",u.mode=e;break e}if(S=0,ne=N,z===0){if(S+=O-B,B<K){K-=B;do oe[h++]=N[S++];while(--B);S=h-se,ne=oe}}else if(z<B){if(S+=O+z-B,B-=z,B<K){K-=B;do oe[h++]=N[S++];while(--B);if(S=0,z<K){B=z,K-=B;do oe[h++]=N[S++];while(--B);S=h-se,ne=oe}}}else if(S+=z-B,B<K){K-=B;do oe[h++]=N[S++];while(--B);S=h-se,ne=oe}for(;K>2;)oe[h++]=ne[S++],oe[h++]=ne[S++],oe[h++]=ne[S++],K-=3;K&&(oe[h++]=ne[S++],K>1&&(oe[h++]=ne[S++]))}else{S=h-se;do oe[h++]=oe[S++],oe[h++]=oe[S++],oe[h++]=oe[S++],K-=3;while(K>2);K&&(oe[h++]=oe[S++],K>1&&(oe[h++]=oe[S++]))}}else if((B&64)===0){Y=G[(Y&65535)+(L&(1<<B)-1)];continue r}else{o.msg="invalid distance code",u.mode=e;break e}break}}else if((B&64)===0){Y=U[(Y&65535)+(L&(1<<B)-1)];continue t}else if(B&32){u.mode=n;break e}else{o.msg="invalid literal/length code",u.mode=e;break e}break}}while(p<f&&h<_);K=D>>3,p-=K,D-=K<<3,L&=(1<<D)-1,o.next_in=p,o.next_out=h,o.avail_in=p<f?5+(f-p):5-(p-f),o.avail_out=h<_?257+(_-h):257-(h-_),u.hold=L,u.bits=D},Po}var jo,Rf;function ry(){if(Rf)return jo;Rf=1;var e=xr(),n=15,r=852,o=592,l=0,u=1,p=2,f=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],h=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],x=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],_=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return jo=function(O,R,z,N,L,D,U,G){var X=G.bits,q=0,Y=0,B=0,K=0,se=0,S=0,ne=0,Q=0,oe=0,W=0,le,te,ie,ue,ce,Fe=null,xe=0,Te,Ne=new e.Buf16(n+1),Je=new e.Buf16(n+1),it=null,Qe=0,He,We,rt;for(q=0;q<=n;q++)Ne[q]=0;for(Y=0;Y<N;Y++)Ne[R[z+Y]]++;for(se=X,K=n;K>=1&&Ne[K]===0;K--);if(se>K&&(se=K),K===0)return L[D++]=1<<24|64<<16|0,L[D++]=1<<24|64<<16|0,G.bits=1,0;for(B=1;B<K&&Ne[B]===0;B++);for(se<B&&(se=B),Q=1,q=1;q<=n;q++)if(Q<<=1,Q-=Ne[q],Q<0)return-1;if(Q>0&&(O===l||K!==1))return-1;for(Je[1]=0,q=1;q<n;q++)Je[q+1]=Je[q]+Ne[q];for(Y=0;Y<N;Y++)R[z+Y]!==0&&(U[Je[R[z+Y]]++]=Y);if(O===l?(Fe=it=U,Te=19):O===u?(Fe=f,xe-=257,it=h,Qe-=257,Te=256):(Fe=x,it=_,Te=-1),W=0,Y=0,q=B,ce=D,S=se,ne=0,ie=-1,oe=1<<se,ue=oe-1,O===u&&oe>r||O===p&&oe>o)return 1;for(;;){He=q-ne,U[Y]<Te?(We=0,rt=U[Y]):U[Y]>Te?(We=it[Qe+U[Y]],rt=Fe[xe+U[Y]]):(We=96,rt=0),le=1<<q-ne,te=1<<S,B=te;do te-=le,L[ce+(W>>ne)+te]=He<<24|We<<16|rt|0;while(te!==0);for(le=1<<q-1;W&le;)le>>=1;if(le!==0?(W&=le-1,W+=le):W=0,Y++,--Ne[q]===0){if(q===K)break;q=R[z+U[Y]]}if(q>se&&(W&ue)!==ie){for(ne===0&&(ne=se),ce+=B,S=q-ne,Q=1<<S;S+ne<K&&(Q-=Ne[S+ne],!(Q<=0));)S++,Q<<=1;if(oe+=1<<S,O===u&&oe>r||O===p&&oe>o)return 1;ie=W&ue,L[ie]=se<<24|S<<16|ce-D|0}}return W!==0&&(L[ce+W]=q-ne<<24|64<<16|0),G.bits=se,0},jo}var Of;function ny(){if(Of)return Yt;Of=1;var e=xr(),n=Kd(),r=Xd(),o=ty(),l=ry(),u=0,p=1,f=2,h=4,x=5,_=6,y=0,O=1,R=2,z=-2,N=-3,L=-4,D=-5,U=8,G=1,X=2,q=3,Y=4,B=5,K=6,se=7,S=8,ne=9,Q=10,oe=11,W=12,le=13,te=14,ie=15,ue=16,ce=17,Fe=18,xe=19,Te=20,Ne=21,Je=22,it=23,Qe=24,He=25,We=26,rt=27,Xe=28,at=29,Ge=30,Ze=31,pt=32,wt=852,M=592,g=15,b=g;function $(ee){return(ee>>>24&255)+(ee>>>8&65280)+((ee&65280)<<8)+((ee&255)<<24)}function ae(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ye(ee){var he;return!ee||!ee.state?z:(he=ee.state,ee.total_in=ee.total_out=he.total=0,ee.msg="",he.wrap&&(ee.adler=he.wrap&1),he.mode=G,he.last=0,he.havedict=0,he.dmax=32768,he.head=null,he.hold=0,he.bits=0,he.lencode=he.lendyn=new e.Buf32(wt),he.distcode=he.distdyn=new e.Buf32(M),he.sane=1,he.back=-1,y)}function ve(ee){var he;return!ee||!ee.state?z:(he=ee.state,he.wsize=0,he.whave=0,he.wnext=0,ye(ee))}function Ve(ee,he){var A,Se;return!ee||!ee.state||(Se=ee.state,he<0?(A=0,he=-he):(A=(he>>4)+1,he<48&&(he&=15)),he&&(he<8||he>15))?z:(Se.window!==null&&Se.wbits!==he&&(Se.window=null),Se.wrap=A,Se.wbits=he,ve(ee))}function Ye(ee,he){var A,Se;return ee?(Se=new ae,ee.state=Se,Se.window=null,A=Ve(ee,he),A!==y&&(ee.state=null),A):z}function nt(ee){return Ye(ee,b)}var ft=!0,st,yt;function Bt(ee){if(ft){var he;for(st=new e.Buf32(512),yt=new e.Buf32(32),he=0;he<144;)ee.lens[he++]=8;for(;he<256;)ee.lens[he++]=9;for(;he<280;)ee.lens[he++]=7;for(;he<288;)ee.lens[he++]=8;for(l(p,ee.lens,0,288,st,0,ee.work,{bits:9}),he=0;he<32;)ee.lens[he++]=5;l(f,ee.lens,0,32,yt,0,ee.work,{bits:5}),ft=!1}ee.lencode=st,ee.lenbits=9,ee.distcode=yt,ee.distbits=5}function Jt(ee,he,A,Se){var qe,m=ee.state;return m.window===null&&(m.wsize=1<<m.wbits,m.wnext=0,m.whave=0,m.window=new e.Buf8(m.wsize)),Se>=m.wsize?(e.arraySet(m.window,he,A-m.wsize,m.wsize,0),m.wnext=0,m.whave=m.wsize):(qe=m.wsize-m.wnext,qe>Se&&(qe=Se),e.arraySet(m.window,he,A-Se,qe,m.wnext),Se-=qe,Se?(e.arraySet(m.window,he,A-Se,Se,0),m.wnext=Se,m.whave=m.wsize):(m.wnext+=qe,m.wnext===m.wsize&&(m.wnext=0),m.whave<m.wsize&&(m.whave+=qe))),0}function P(ee,he){var A,Se,qe,m,H,ge,T,Z,fe,ze,Pe,Ce,et,Vt,gt=0,ot,vt,kt,Ft,_r,Sr,xt,Nt,Et=new e.Buf8(4),Zt,Kt,ti=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ee||!ee.state||!ee.output||!ee.input&&ee.avail_in!==0)return z;A=ee.state,A.mode===W&&(A.mode=le),H=ee.next_out,qe=ee.output,T=ee.avail_out,m=ee.next_in,Se=ee.input,ge=ee.avail_in,Z=A.hold,fe=A.bits,ze=ge,Pe=T,Nt=y;e:for(;;)switch(A.mode){case G:if(A.wrap===0){A.mode=le;break}for(;fe<16;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}if(A.wrap&2&&Z===35615){A.check=0,Et[0]=Z&255,Et[1]=Z>>>8&255,A.check=r(A.check,Et,2,0),Z=0,fe=0,A.mode=X;break}if(A.flags=0,A.head&&(A.head.done=!1),!(A.wrap&1)||(((Z&255)<<8)+(Z>>8))%31){ee.msg="incorrect header check",A.mode=Ge;break}if((Z&15)!==U){ee.msg="unknown compression method",A.mode=Ge;break}if(Z>>>=4,fe-=4,xt=(Z&15)+8,A.wbits===0)A.wbits=xt;else if(xt>A.wbits){ee.msg="invalid window size",A.mode=Ge;break}A.dmax=1<<xt,ee.adler=A.check=1,A.mode=Z&512?Q:W,Z=0,fe=0;break;case X:for(;fe<16;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}if(A.flags=Z,(A.flags&255)!==U){ee.msg="unknown compression method",A.mode=Ge;break}if(A.flags&57344){ee.msg="unknown header flags set",A.mode=Ge;break}A.head&&(A.head.text=Z>>8&1),A.flags&512&&(Et[0]=Z&255,Et[1]=Z>>>8&255,A.check=r(A.check,Et,2,0)),Z=0,fe=0,A.mode=q;case q:for(;fe<32;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}A.head&&(A.head.time=Z),A.flags&512&&(Et[0]=Z&255,Et[1]=Z>>>8&255,Et[2]=Z>>>16&255,Et[3]=Z>>>24&255,A.check=r(A.check,Et,4,0)),Z=0,fe=0,A.mode=Y;case Y:for(;fe<16;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}A.head&&(A.head.xflags=Z&255,A.head.os=Z>>8),A.flags&512&&(Et[0]=Z&255,Et[1]=Z>>>8&255,A.check=r(A.check,Et,2,0)),Z=0,fe=0,A.mode=B;case B:if(A.flags&1024){for(;fe<16;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}A.length=Z,A.head&&(A.head.extra_len=Z),A.flags&512&&(Et[0]=Z&255,Et[1]=Z>>>8&255,A.check=r(A.check,Et,2,0)),Z=0,fe=0}else A.head&&(A.head.extra=null);A.mode=K;case K:if(A.flags&1024&&(Ce=A.length,Ce>ge&&(Ce=ge),Ce&&(A.head&&(xt=A.head.extra_len-A.length,A.head.extra||(A.head.extra=new Array(A.head.extra_len)),e.arraySet(A.head.extra,Se,m,Ce,xt)),A.flags&512&&(A.check=r(A.check,Se,Ce,m)),ge-=Ce,m+=Ce,A.length-=Ce),A.length))break e;A.length=0,A.mode=se;case se:if(A.flags&2048){if(ge===0)break e;Ce=0;do xt=Se[m+Ce++],A.head&&xt&&A.length<65536&&(A.head.name+=String.fromCharCode(xt));while(xt&&Ce<ge);if(A.flags&512&&(A.check=r(A.check,Se,Ce,m)),ge-=Ce,m+=Ce,xt)break e}else A.head&&(A.head.name=null);A.length=0,A.mode=S;case S:if(A.flags&4096){if(ge===0)break e;Ce=0;do xt=Se[m+Ce++],A.head&&xt&&A.length<65536&&(A.head.comment+=String.fromCharCode(xt));while(xt&&Ce<ge);if(A.flags&512&&(A.check=r(A.check,Se,Ce,m)),ge-=Ce,m+=Ce,xt)break e}else A.head&&(A.head.comment=null);A.mode=ne;case ne:if(A.flags&512){for(;fe<16;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}if(Z!==(A.check&65535)){ee.msg="header crc mismatch",A.mode=Ge;break}Z=0,fe=0}A.head&&(A.head.hcrc=A.flags>>9&1,A.head.done=!0),ee.adler=A.check=0,A.mode=W;break;case Q:for(;fe<32;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}ee.adler=A.check=$(Z),Z=0,fe=0,A.mode=oe;case oe:if(A.havedict===0)return ee.next_out=H,ee.avail_out=T,ee.next_in=m,ee.avail_in=ge,A.hold=Z,A.bits=fe,R;ee.adler=A.check=1,A.mode=W;case W:if(he===x||he===_)break e;case le:if(A.last){Z>>>=fe&7,fe-=fe&7,A.mode=rt;break}for(;fe<3;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}switch(A.last=Z&1,Z>>>=1,fe-=1,Z&3){case 0:A.mode=te;break;case 1:if(Bt(A),A.mode=Te,he===_){Z>>>=2,fe-=2;break e}break;case 2:A.mode=ce;break;case 3:ee.msg="invalid block type",A.mode=Ge}Z>>>=2,fe-=2;break;case te:for(Z>>>=fe&7,fe-=fe&7;fe<32;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}if((Z&65535)!==(Z>>>16^65535)){ee.msg="invalid stored block lengths",A.mode=Ge;break}if(A.length=Z&65535,Z=0,fe=0,A.mode=ie,he===_)break e;case ie:A.mode=ue;case ue:if(Ce=A.length,Ce){if(Ce>ge&&(Ce=ge),Ce>T&&(Ce=T),Ce===0)break e;e.arraySet(qe,Se,m,Ce,H),ge-=Ce,m+=Ce,T-=Ce,H+=Ce,A.length-=Ce;break}A.mode=W;break;case ce:for(;fe<14;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}if(A.nlen=(Z&31)+257,Z>>>=5,fe-=5,A.ndist=(Z&31)+1,Z>>>=5,fe-=5,A.ncode=(Z&15)+4,Z>>>=4,fe-=4,A.nlen>286||A.ndist>30){ee.msg="too many length or distance symbols",A.mode=Ge;break}A.have=0,A.mode=Fe;case Fe:for(;A.have<A.ncode;){for(;fe<3;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}A.lens[ti[A.have++]]=Z&7,Z>>>=3,fe-=3}for(;A.have<19;)A.lens[ti[A.have++]]=0;if(A.lencode=A.lendyn,A.lenbits=7,Zt={bits:A.lenbits},Nt=l(u,A.lens,0,19,A.lencode,0,A.work,Zt),A.lenbits=Zt.bits,Nt){ee.msg="invalid code lengths set",A.mode=Ge;break}A.have=0,A.mode=xe;case xe:for(;A.have<A.nlen+A.ndist;){for(;gt=A.lencode[Z&(1<<A.lenbits)-1],ot=gt>>>24,vt=gt>>>16&255,kt=gt&65535,!(ot<=fe);){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}if(kt<16)Z>>>=ot,fe-=ot,A.lens[A.have++]=kt;else{if(kt===16){for(Kt=ot+2;fe<Kt;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}if(Z>>>=ot,fe-=ot,A.have===0){ee.msg="invalid bit length repeat",A.mode=Ge;break}xt=A.lens[A.have-1],Ce=3+(Z&3),Z>>>=2,fe-=2}else if(kt===17){for(Kt=ot+3;fe<Kt;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}Z>>>=ot,fe-=ot,xt=0,Ce=3+(Z&7),Z>>>=3,fe-=3}else{for(Kt=ot+7;fe<Kt;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}Z>>>=ot,fe-=ot,xt=0,Ce=11+(Z&127),Z>>>=7,fe-=7}if(A.have+Ce>A.nlen+A.ndist){ee.msg="invalid bit length repeat",A.mode=Ge;break}for(;Ce--;)A.lens[A.have++]=xt}}if(A.mode===Ge)break;if(A.lens[256]===0){ee.msg="invalid code -- missing end-of-block",A.mode=Ge;break}if(A.lenbits=9,Zt={bits:A.lenbits},Nt=l(p,A.lens,0,A.nlen,A.lencode,0,A.work,Zt),A.lenbits=Zt.bits,Nt){ee.msg="invalid literal/lengths set",A.mode=Ge;break}if(A.distbits=6,A.distcode=A.distdyn,Zt={bits:A.distbits},Nt=l(f,A.lens,A.nlen,A.ndist,A.distcode,0,A.work,Zt),A.distbits=Zt.bits,Nt){ee.msg="invalid distances set",A.mode=Ge;break}if(A.mode=Te,he===_)break e;case Te:A.mode=Ne;case Ne:if(ge>=6&&T>=258){ee.next_out=H,ee.avail_out=T,ee.next_in=m,ee.avail_in=ge,A.hold=Z,A.bits=fe,o(ee,Pe),H=ee.next_out,qe=ee.output,T=ee.avail_out,m=ee.next_in,Se=ee.input,ge=ee.avail_in,Z=A.hold,fe=A.bits,A.mode===W&&(A.back=-1);break}for(A.back=0;gt=A.lencode[Z&(1<<A.lenbits)-1],ot=gt>>>24,vt=gt>>>16&255,kt=gt&65535,!(ot<=fe);){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}if(vt&&(vt&240)===0){for(Ft=ot,_r=vt,Sr=kt;gt=A.lencode[Sr+((Z&(1<<Ft+_r)-1)>>Ft)],ot=gt>>>24,vt=gt>>>16&255,kt=gt&65535,!(Ft+ot<=fe);){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}Z>>>=Ft,fe-=Ft,A.back+=Ft}if(Z>>>=ot,fe-=ot,A.back+=ot,A.length=kt,vt===0){A.mode=We;break}if(vt&32){A.back=-1,A.mode=W;break}if(vt&64){ee.msg="invalid literal/length code",A.mode=Ge;break}A.extra=vt&15,A.mode=Je;case Je:if(A.extra){for(Kt=A.extra;fe<Kt;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}A.length+=Z&(1<<A.extra)-1,Z>>>=A.extra,fe-=A.extra,A.back+=A.extra}A.was=A.length,A.mode=it;case it:for(;gt=A.distcode[Z&(1<<A.distbits)-1],ot=gt>>>24,vt=gt>>>16&255,kt=gt&65535,!(ot<=fe);){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}if((vt&240)===0){for(Ft=ot,_r=vt,Sr=kt;gt=A.distcode[Sr+((Z&(1<<Ft+_r)-1)>>Ft)],ot=gt>>>24,vt=gt>>>16&255,kt=gt&65535,!(Ft+ot<=fe);){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}Z>>>=Ft,fe-=Ft,A.back+=Ft}if(Z>>>=ot,fe-=ot,A.back+=ot,vt&64){ee.msg="invalid distance code",A.mode=Ge;break}A.offset=kt,A.extra=vt&15,A.mode=Qe;case Qe:if(A.extra){for(Kt=A.extra;fe<Kt;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}A.offset+=Z&(1<<A.extra)-1,Z>>>=A.extra,fe-=A.extra,A.back+=A.extra}if(A.offset>A.dmax){ee.msg="invalid distance too far back",A.mode=Ge;break}A.mode=He;case He:if(T===0)break e;if(Ce=Pe-T,A.offset>Ce){if(Ce=A.offset-Ce,Ce>A.whave&&A.sane){ee.msg="invalid distance too far back",A.mode=Ge;break}Ce>A.wnext?(Ce-=A.wnext,et=A.wsize-Ce):et=A.wnext-Ce,Ce>A.length&&(Ce=A.length),Vt=A.window}else Vt=qe,et=H-A.offset,Ce=A.length;Ce>T&&(Ce=T),T-=Ce,A.length-=Ce;do qe[H++]=Vt[et++];while(--Ce);A.length===0&&(A.mode=Ne);break;case We:if(T===0)break e;qe[H++]=A.length,T--,A.mode=Ne;break;case rt:if(A.wrap){for(;fe<32;){if(ge===0)break e;ge--,Z|=Se[m++]<<fe,fe+=8}if(Pe-=T,ee.total_out+=Pe,A.total+=Pe,Pe&&(ee.adler=A.check=A.flags?r(A.check,qe,Pe,H-Pe):n(A.check,qe,Pe,H-Pe)),Pe=T,(A.flags?Z:$(Z))!==A.check){ee.msg="incorrect data check",A.mode=Ge;break}Z=0,fe=0}A.mode=Xe;case Xe:if(A.wrap&&A.flags){for(;fe<32;){if(ge===0)break e;ge--,Z+=Se[m++]<<fe,fe+=8}if(Z!==(A.total&4294967295)){ee.msg="incorrect length check",A.mode=Ge;break}Z=0,fe=0}A.mode=at;case at:Nt=O;break e;case Ge:Nt=N;break e;case Ze:return L;case pt:default:return z}return ee.next_out=H,ee.avail_out=T,ee.next_in=m,ee.avail_in=ge,A.hold=Z,A.bits=fe,(A.wsize||Pe!==ee.avail_out&&A.mode<Ge&&(A.mode<rt||he!==h))&&Jt(ee,ee.output,ee.next_out,Pe-ee.avail_out),ze-=ee.avail_in,Pe-=ee.avail_out,ee.total_in+=ze,ee.total_out+=Pe,A.total+=Pe,A.wrap&&Pe&&(ee.adler=A.check=A.flags?r(A.check,qe,Pe,ee.next_out-Pe):n(A.check,qe,Pe,ee.next_out-Pe)),ee.data_type=A.bits+(A.last?64:0)+(A.mode===W?128:0)+(A.mode===Te||A.mode===ie?256:0),(ze===0&&Pe===0||he===h)&&Nt===y&&(Nt=D),Nt}function _e(ee){if(!ee||!ee.state)return z;var he=ee.state;return he.window&&(he.window=null),ee.state=null,y}function ke(ee,he){var A;return!ee||!ee.state||(A=ee.state,(A.wrap&2)===0)?z:(A.head=he,he.done=!1,y)}function Be(ee,he){var A=he.length,Se,qe,m;return!ee||!ee.state||(Se=ee.state,Se.wrap!==0&&Se.mode!==oe)?z:Se.mode===oe&&(qe=1,qe=n(qe,he,A,0),qe!==Se.check)?N:(m=Jt(ee,he,A,A),m?(Se.mode=Ze,L):(Se.havedict=1,y))}return Yt.inflateReset=ve,Yt.inflateReset2=Ve,Yt.inflateResetKeep=ye,Yt.inflateInit=nt,Yt.inflateInit2=Ye,Yt.inflate=P,Yt.inflateEnd=_e,Yt.inflateGetHeader=ke,Yt.inflateSetDictionary=Be,Yt.inflateInfo="pako inflate (from Nodeca project)",Yt}var Bo,Mf;function Qd(){return Mf||(Mf=1,Bo={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),Bo}var Fo,Pf;function iy(){if(Pf)return Fo;Pf=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return Fo=e,Fo}var jf;function ay(){if(jf)return en;jf=1;var e=ny(),n=xr(),r=Yd(),o=Qd(),l=Ts(),u=Jd(),p=iy(),f=Object.prototype.toString;function h(y){if(!(this instanceof h))return new h(y);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},y||{});var O=this.options;O.raw&&O.windowBits>=0&&O.windowBits<16&&(O.windowBits=-O.windowBits,O.windowBits===0&&(O.windowBits=-15)),O.windowBits>=0&&O.windowBits<16&&!(y&&y.windowBits)&&(O.windowBits+=32),O.windowBits>15&&O.windowBits<48&&(O.windowBits&15)===0&&(O.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var R=e.inflateInit2(this.strm,O.windowBits);if(R!==o.Z_OK)throw new Error(l[R]);if(this.header=new p,e.inflateGetHeader(this.strm,this.header),O.dictionary&&(typeof O.dictionary=="string"?O.dictionary=r.string2buf(O.dictionary):f.call(O.dictionary)==="[object ArrayBuffer]"&&(O.dictionary=new Uint8Array(O.dictionary)),O.raw&&(R=e.inflateSetDictionary(this.strm,O.dictionary),R!==o.Z_OK)))throw new Error(l[R])}h.prototype.push=function(y,O){var R=this.strm,z=this.options.chunkSize,N=this.options.dictionary,L,D,U,G,X,q=!1;if(this.ended)return!1;D=O===~~O?O:O===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof y=="string"?R.input=r.binstring2buf(y):f.call(y)==="[object ArrayBuffer]"?R.input=new Uint8Array(y):R.input=y,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new n.Buf8(z),R.next_out=0,R.avail_out=z),L=e.inflate(R,o.Z_NO_FLUSH),L===o.Z_NEED_DICT&&N&&(L=e.inflateSetDictionary(this.strm,N)),L===o.Z_BUF_ERROR&&q===!0&&(L=o.Z_OK,q=!1),L!==o.Z_STREAM_END&&L!==o.Z_OK)return this.onEnd(L),this.ended=!0,!1;R.next_out&&(R.avail_out===0||L===o.Z_STREAM_END||R.avail_in===0&&(D===o.Z_FINISH||D===o.Z_SYNC_FLUSH))&&(this.options.to==="string"?(U=r.utf8border(R.output,R.next_out),G=R.next_out-U,X=r.buf2string(R.output,U),R.next_out=G,R.avail_out=z-G,G&&n.arraySet(R.output,R.output,U,G,0),this.onData(X)):this.onData(n.shrinkBuf(R.output,R.next_out))),R.avail_in===0&&R.avail_out===0&&(q=!0)}while((R.avail_in>0||R.avail_out===0)&&L!==o.Z_STREAM_END);return L===o.Z_STREAM_END&&(D=o.Z_FINISH),D===o.Z_FINISH?(L=e.inflateEnd(this.strm),this.onEnd(L),this.ended=!0,L===o.Z_OK):(D===o.Z_SYNC_FLUSH&&(this.onEnd(o.Z_OK),R.avail_out=0),!0)},h.prototype.onData=function(y){this.chunks.push(y)},h.prototype.onEnd=function(y){y===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg};function x(y,O){var R=new h(O);if(R.push(y,!0),R.err)throw R.msg||l[R.err];return R.result}function _(y,O){return O=O||{},O.raw=!0,x(y,O)}return en.Inflate=h,en.inflate=x,en.inflateRaw=_,en.ungzip=x,en}var Do,Bf;function oy(){if(Bf)return Do;Bf=1;var e=xr().assign,n=ey(),r=ay(),o=Qd(),l={};return e(l,n,r,o),Do=l,Do}var Lo,Ff;function sy(){if(Ff)return Lo;Ff=1;const e=(n,r)=>function(...o){const l=r.promiseModule;return new l((u,p)=>{r.multiArgs?o.push((...f)=>{r.errorFirst?f[0]?p(f):(f.shift(),u(f)):u(f)}):r.errorFirst?o.push((f,h)=>{f?p(f):u(h)}):o.push(u),n.apply(this,o)})};return Lo=(n,r)=>{r=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},r);const o=typeof n;if(!(n!==null&&(o==="object"||o==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${n===null?"null":o}\``);const l=p=>{const f=h=>typeof h=="string"?p===h:h.test(p);return r.include?r.include.some(f):!r.exclude.some(f)};let u;o==="function"?u=function(...p){return r.excludeMain?n(...p):e(n,r).apply(this,p)}:u=Object.create(Object.getPrototypeOf(n));for(const p in n){const f=n[p];u[p]=typeof f=="function"&&l(p)?e(f,r):f}return u},Lo}var $o,Df;function ly(){if(Df)return $o;Df=1;var e={};function n(ie){return Array.isArray(ie)?ie:[ie]}const r="",o=" ",l="\\",u=/^\s+$/,p=/(?:[^\\]|^)\\$/,f=/^\\!/,h=/^\\#/,x=/\r?\n/g,_=/^\.*\/|^\.+$/,y="/";let O="node-ignore";typeof Symbol<"u"&&(O=Symbol.for("node-ignore"));const R=O,z=(ie,ue,ce)=>Object.defineProperty(ie,ue,{value:ce}),N=/([0-z])-([0-z])/g,L=()=>!1,D=ie=>ie.replace(N,(ue,ce,Fe)=>ce.charCodeAt(0)<=Fe.charCodeAt(0)?ue:r),U=ie=>{const{length:ue}=ie;return ie.slice(0,ue-ue%2)},G=[[/^\uFEFF/,()=>r],[/((?:\\\\)*?)(\\?\s+)$/,(ie,ue,ce)=>ue+(ce.indexOf("\\")===0?o:r)],[/(\\+?)\s/g,(ie,ue)=>{const{length:ce}=ue;return ue.slice(0,ce-ce%2)+o}],[/[\\$.|*+(){^]/g,ie=>`\\${ie}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(ie,ue,ce)=>ue+6<ce.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(ie,ue,ce)=>{const Fe=ce.replace(/\\\*/g,"[^\\/]*");return ue+Fe}],[/\\\\\\(?=[$.|*+(){^])/g,()=>l],[/\\\\/g,()=>l],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(ie,ue,ce,Fe,xe)=>ue===l?`\\[${ce}${U(Fe)}${xe}`:xe==="]"&&Fe.length%2===0?`[${D(ce)}${Fe}]`:"[]"],[/(?:[^*])$/,ie=>/\/$/.test(ie)?`${ie}$`:`${ie}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(ie,ue)=>`${ue?`${ue}[^/]+`:"[^/]*"}(?=$|\\/$)`]],X=Object.create(null),q=(ie,ue)=>{let ce=X[ie];return ce||(ce=G.reduce((Fe,[xe,Te])=>Fe.replace(xe,Te.bind(ie)),ie),X[ie]=ce),ue?new RegExp(ce,"i"):new RegExp(ce)},Y=ie=>typeof ie=="string",B=ie=>ie&&Y(ie)&&!u.test(ie)&&!p.test(ie)&&ie.indexOf("#")!==0,K=ie=>ie.split(x);class se{constructor(ue,ce,Fe,xe){this.origin=ue,this.pattern=ce,this.negative=Fe,this.regex=xe}}const S=(ie,ue)=>{const ce=ie;let Fe=!1;ie.indexOf("!")===0&&(Fe=!0,ie=ie.substr(1)),ie=ie.replace(f,"!").replace(h,"#");const xe=q(ie,ue);return new se(ce,ie,Fe,xe)},ne=(ie,ue)=>{throw new ue(ie)},Q=(ie,ue,ce)=>Y(ie)?ie?Q.isNotRelative(ie)?ce(`path should be a \`path.relative()\`d string, but got "${ue}"`,RangeError):!0:ce("path must not be empty",TypeError):ce(`path must be a string, but got \`${ue}\``,TypeError),oe=ie=>_.test(ie);Q.isNotRelative=oe,Q.convert=ie=>ie;class W{constructor({ignorecase:ue=!0,ignoreCase:ce=ue,allowRelativePaths:Fe=!1}={}){z(this,R,!0),this._rules=[],this._ignoreCase=ce,this._allowRelativePaths=Fe,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(ue){if(ue&&ue[R]){this._rules=this._rules.concat(ue._rules),this._added=!0;return}if(B(ue)){const ce=S(ue,this._ignoreCase);this._added=!0,this._rules.push(ce)}}add(ue){return this._added=!1,n(Y(ue)?K(ue):ue).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(ue){return this.add(ue)}_testOne(ue,ce){let Fe=!1,xe=!1;return this._rules.forEach(Te=>{const{negative:Ne}=Te;if(xe===Ne&&Fe!==xe||Ne&&!Fe&&!xe&&!ce)return;Te.regex.test(ue)&&(Fe=!Ne,xe=Ne)}),{ignored:Fe,unignored:xe}}_test(ue,ce,Fe,xe){const Te=ue&&Q.convert(ue);return Q(Te,ue,this._allowRelativePaths?L:ne),this._t(Te,ce,Fe,xe)}_t(ue,ce,Fe,xe){if(ue in ce)return ce[ue];if(xe||(xe=ue.split(y)),xe.pop(),!xe.length)return ce[ue]=this._testOne(ue,Fe);const Te=this._t(xe.join(y)+y,ce,Fe,xe);return ce[ue]=Te.ignored?Te:this._testOne(ue,Fe)}ignores(ue){return this._test(ue,this._ignoreCache,!1).ignored}createFilter(){return ue=>!this.ignores(ue)}filter(ue){return n(ue).filter(this.createFilter())}test(ue){return this._test(ue,this._testCache,!0)}}const le=ie=>new W(ie),te=ie=>Q(ie&&Q.convert(ie),ie,L);if(le.isPathValid=te,le.default=le,$o=le,typeof process<"u"&&(e&&e.IGNORE_TEST_WIN32||process.platform==="win32")){const ie=ce=>/^\\\\\?\\/.test(ce)||/["<>|\u0000-\u001F]+/u.test(ce)?ce:ce.replace(/\\/g,"/");Q.convert=ie;const ue=/^[a-z]:\//i;Q.isNotRelative=ce=>ue.test(ce)||oe(ce)}return $o}var No,Lf;function cy(){if(Lf)return No;Lf=1;function e(o){return o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function n(o,l,u){return l=l instanceof RegExp?l:new RegExp(e(l),"g"),o.replace(l,u)}var r={clean:function(l){if(typeof l!="string")throw new Error("Expected a string, received: "+l);return l=n(l,"./","/"),l=n(l,"..","."),l=n(l," ","-"),l=n(l,/^[~^:?*\\\-]/g,""),l=n(l,/[~^:?*\\]/g,"-"),l=n(l,/[~^:?*\\\-]$/g,""),l=n(l,"@{","-"),l=n(l,/\.$/g,""),l=n(l,/\/$/g,""),l=n(l,/\.lock$/g,""),l}};return No=r,No}var Uo,$f;function uy(){return $f||($f=1,Uo=function(e,n){var r=e,o=n,l=r.length,u=o.length,p=!1,f=null,h=l+1,x=[],_=[],y=[],O="",R=-1,z=0,N=1,L,D,U=function(){l>=u&&(L=r,D=l,r=o,o=L,l=u,u=D,p=!0,h=l+1)},G=function(B,K,se){return{x:B,y:K,k:se}},X=function(B,K){return{elem:B,t:K}},q=function(B,K,se){var S,ne,Q;for(K>se?S=x[B-1+h]:S=x[B+1+h],Q=Math.max(K,se),ne=Q-B;ne<l&&Q<u&&r[ne]===o[Q];)++ne,++Q;return x[B+h]=_.length,_[_.length]=new G(ne,Q,S),Q},Y=function(B){var K,se,S;for(K=se=0,S=B.length-1;S>=0;--S)for(;K<B[S].x||se<B[S].y;)B[S].y-B[S].x>se-K?(p?y[y.length]=new X(o[se],R):y[y.length]=new X(o[se],N),++se):B[S].y-B[S].x<se-K?(p?y[y.length]=new X(r[K],N):y[y.length]=new X(r[K],R),++K):(y[y.length]=new X(r[K],z),O+=r[K],++K,++se)};return U(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return f},getlcs:function(){return O},getses:function(){return y},compose:function(){var B,K,se,S,ne,Q,oe,W;for(B=u-l,K=l+u+3,se={},oe=0;oe<K;++oe)se[oe]=-1,x[oe]=-1;S=-1;do{for(++S,W=-S;W<=B-1;++W)se[W+h]=q(W,se[W-1+h]+1,se[W+1+h]);for(W=B+S;W>=B+1;--W)se[W+h]=q(W,se[W-1+h]+1,se[W+1+h]);se[B+h]=q(B,se[B-1+h]+1,se[B+1+h])}while(se[B+h]!==u);for(f=B+2*S,ne=x[B+h],Q=[];ne!==-1;)Q[Q.length]=new G(_[ne].x,_[ne].y,null),ne=_[ne].k;Y(Q)}}}),Uo}var zo,Nf;function fy(){if(Nf)return zo;Nf=1;var e=uy();function n(u,p){var f=new e(u,p);f.compose();for(var h=f.getses(),x,_,y=u.length-1,O=p.length-1,R=h.length-1;R>=0;--R)h[R].t===f.SES_COMMON?(_?(_.chain={file1index:y,file2index:O,chain:null},_=_.chain):(x={file1index:y,file2index:O,chain:null},_=x),y--,O--):h[R].t===f.SES_DELETE?y--:h[R].t===f.SES_ADD&&O--;var z={file1index:-1,file2index:-1,chain:null};return _?(_.chain=z,x):z}function r(u,p){for(var f=[],h=u.length,x=p.length,_=n(u,p);_!==null;_=_.chain){var y=h-_.file1index-1,O=x-_.file2index-1;h=_.file1index,x=_.file2index,(y||O)&&f.push({file1:[h+1,y],file2:[x+1,O]})}return f.reverse(),f}function o(u,p,f){var h,x=r(p,u),_=r(p,f),y=[];function O(ue,ce){y.push([ue.file1[0],ce,ue.file1[1],ue.file2[0],ue.file2[1]])}for(h=0;h<x.length;h++)O(x[h],0);for(h=0;h<_.length;h++)O(_[h],2);y.sort(function(ue,ce){return ue[0]-ce[0]});var R=[],z=0;function N(ue){ue>z&&(R.push([1,z,ue-z]),z=ue)}for(var L=0;L<y.length;L++){for(var D=L,U=y[L],G=U[0],X=G+U[2];L<y.length-1;){var q=y[L+1],Y=q[0];if(Y>X)break;X=Math.max(X,Y+q[2]),L++}if(N(G),D==L)U[4]>0&&R.push([U[1],U[3],U[4]]);else{var B={0:[u.length,-1,p.length,-1],2:[f.length,-1,p.length,-1]};for(h=D;h<=L;h++){U=y[h];var K=U[1],se=B[K],S=U[0],ne=S+U[2],Q=U[3],oe=Q+U[4];se[0]=Math.min(Q,se[0]),se[1]=Math.max(oe,se[1]),se[2]=Math.min(S,se[2]),se[3]=Math.max(ne,se[3])}var W=B[0][0]+(G-B[0][2]),le=B[0][1]+(X-B[0][3]),te=B[2][0]+(G-B[2][2]),ie=B[2][1]+(X-B[2][3]);R.push([-1,W,le-W,G,X-G,te,ie-te])}z=X}return N(p.length),R}function l(u,p,f){var h=[],x=[u,p,f],_=o(u,p,f),y=[];function O(){y.length&&h.push({ok:y}),y=[]}function R(U){for(var G=0;G<U.length;G++)y.push(U[G])}function z(U){if(U[2]!=U[6])return!0;for(var G=U[1],X=U[5],q=0;q<U[2];q++)if(u[q+G]!=f[q+X])return!0;return!1}for(var N=0;N<_.length;N++){var L=_[N],D=L[0];D==-1?z(L)?(O(),h.push({conflict:{a:u.slice(L[1],L[1]+L[2]),aIndex:L[1],o:p.slice(L[3],L[3]+L[4]),oIndex:L[3],b:f.slice(L[5],L[5]+L[6]),bIndex:L[5]}})):R(x[0].slice(L[1],L[1]+L[2])):R(x[D].slice(L[1],L[1]+L[2]))}return O(),h}return zo=l,zo}var Uf;function dy(){if(Uf)return Oe;Uf=1,Object.defineProperty(Oe,"__esModule",{value:!0});function e(a){return a&&typeof a=="object"&&"default"in a?a.default:a}var n=e(uw()),r=e(Xw()),o=e(Yw()),l=e(oy()),u=e(sy()),p=e(ly()),f=e(cy()),h=e(fy());class x extends Error{constructor(t){super(t),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(t){const i=new x(t.message);return i.code=t.code,i.data=t.data,i.caller=t.caller,i.stack=t.stack,i}get isIsomorphicGitError(){return!0}}class _ extends x{constructor(t){super(`Modifying the index is not possible because you have unmerged files: ${t.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=_.code,this.data={filepaths:t}}}_.code="UnmergedPathsError";class y extends x{constructor(t){super(`An internal error caused this command to fail.

If you're not a developer, report the bug to the developers of the application you're using. If this is a bug in isomorphic-git then you should create a proper bug yourselves. The bug should include a minimal reproduction and details about the version and environment.

Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${t}`),this.code=this.name=y.code,this.data={message:t}}}y.code="InternalError";class O extends x{constructor(t){super(`The filepath "${t}" contains unsafe character sequences`),this.code=this.name=O.code,this.data={filepath:t}}}O.code="UnsafeFilepathError";class R{constructor(t){this.buffer=t,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(t){this._start=t}slice(t){const i=this.buffer.slice(this._start,this._start+t);return this._start+=t,i}toString(t,i){const s=this.buffer.toString(t,this._start,this._start+i);return this._start+=i,s}write(t,i,s){const c=this.buffer.write(t,this._start,i,s);return this._start+=i,c}copy(t,i,s){const c=t.copy(this.buffer,this._start,i,s);return this._start+=c,c}readUInt8(){const t=this.buffer.readUInt8(this._start);return this._start+=1,t}writeUInt8(t){const i=this.buffer.writeUInt8(t,this._start);return this._start+=1,i}readUInt16BE(){const t=this.buffer.readUInt16BE(this._start);return this._start+=2,t}writeUInt16BE(t){const i=this.buffer.writeUInt16BE(t,this._start);return this._start+=2,i}readUInt32BE(){const t=this.buffer.readUInt32BE(this._start);return this._start+=4,t}writeUInt32BE(t){const i=this.buffer.writeUInt32BE(t,this._start);return this._start+=4,i}}function z(a,t){return-(a<t)||+(a>t)}function N(a,t){return z(a.path,t.path)}function L(a){let t=a>0?a>>12:0;t!==4&&t!==8&&t!==10&&t!==14&&(t=8);let i=a&511;return i&73?i=493:i=420,t!==8&&(i=0),(t<<12)+i}const D=2**32;function U(a,t,i,s){if(a!==void 0&&t!==void 0)return[a,t];i===void 0&&(i=s.valueOf());const c=Math.floor(i/1e3),d=(i-c*1e3)*1e6;return[c,d]}function G(a){const[t,i]=U(a.ctimeSeconds,a.ctimeNanoseconds,a.ctimeMs,a.ctime),[s,c]=U(a.mtimeSeconds,a.mtimeNanoseconds,a.mtimeMs,a.mtime);return{ctimeSeconds:t%D,ctimeNanoseconds:i%D,mtimeSeconds:s%D,mtimeNanoseconds:c%D,dev:a.dev%D,ino:a.ino%D,mode:L(a.mode%D),uid:a.uid%D,gid:a.gid%D,size:a.size>-1?a.size%D:0}}function X(a){let t="";for(const i of new Uint8Array(a))i<16&&(t+="0"),t+=i.toString(16);return t}let q=null;async function Y(a){return q===null&&(q=await se()),q?K(a):B(a)}function B(a){return new r().update(a).digest("hex")}async function K(a){const t=await crypto.subtle.digest("SHA-1",a);return X(t)}async function se(){try{return await K(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709"}catch{}return!1}function S(a){return{assumeValid:!!(a&32768),extended:!!(a&16384),stage:(a&12288)>>12,nameLength:a&4095}}function ne(a){const t=a.flags;return t.extended=!1,t.nameLength=Math.min(Buffer.from(a.path).length,4095),(t.assumeValid?32768:0)+(t.extended?16384:0)+((t.stage&3)<<12)+(t.nameLength&4095)}class Q{constructor(t,i){this._dirty=!1,this._unmergedPaths=i||new Set,this._entries=t||new Map}_addEntry(t){if(t.flags.stage===0)t.stages=[t],this._entries.set(t.path,t),this._unmergedPaths.delete(t.path);else{let i=this._entries.get(t.path);i||(this._entries.set(t.path,t),i=t),i.stages[t.flags.stage]=t,this._unmergedPaths.add(t.path)}}static async from(t){if(Buffer.isBuffer(t))return Q.fromBuffer(t);if(t===null)return new Q(null);throw new y("invalid type passed to GitIndex.from")}static async fromBuffer(t){if(t.length===0)throw new y("Index file is empty (.git/index)");const i=new Q,s=new R(t),c=s.toString("utf8",4);if(c!=="DIRC")throw new y(`Invalid dircache magic file number: ${c}`);const d=await Y(t.slice(0,-20)),w=t.slice(-20).toString("hex");if(w!==d)throw new y(`Invalid checksum in GitIndex buffer: expected ${w} but saw ${d}`);const v=s.readUInt32BE();if(v!==2)throw new y(`Unsupported dircache version: ${v}`);const I=s.readUInt32BE();let C=0;for(;!s.eof()&&C<I;){const k={};k.ctimeSeconds=s.readUInt32BE(),k.ctimeNanoseconds=s.readUInt32BE(),k.mtimeSeconds=s.readUInt32BE(),k.mtimeNanoseconds=s.readUInt32BE(),k.dev=s.readUInt32BE(),k.ino=s.readUInt32BE(),k.mode=s.readUInt32BE(),k.uid=s.readUInt32BE(),k.gid=s.readUInt32BE(),k.size=s.readUInt32BE(),k.oid=s.slice(20).toString("hex");const j=s.readUInt16BE();k.flags=S(j);const F=t.indexOf(0,s.tell()+1)-s.tell();if(F<1)throw new y(`Got a path length of: ${F}`);if(k.path=s.toString("utf8",F),k.path.includes("..\\")||k.path.includes("../"))throw new O(k.path);let V=8-(s.tell()-12)%8;for(V===0&&(V=8);V--;){const re=s.readUInt8();if(re!==0)throw new y(`Expected 1-8 null characters but got '${re}' after ${k.path}`);if(s.eof())throw new y("Unexpected end of file")}k.stages=[],i._addEntry(k),C++}return i}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(N)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(t=>t.stages.length>1?t.stages.filter(i=>i):t)}*[Symbol.iterator](){for(const t of this.entries)yield t}insert({filepath:t,stats:i,oid:s,stage:c=0}){i||(i={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),i=G(i);const d=Buffer.from(t),w={ctimeSeconds:i.ctimeSeconds,ctimeNanoseconds:i.ctimeNanoseconds,mtimeSeconds:i.mtimeSeconds,mtimeNanoseconds:i.mtimeNanoseconds,dev:i.dev,ino:i.ino,mode:i.mode||33188,uid:i.uid,gid:i.gid,size:i.size,path:t,oid:s,flags:{assumeValid:!1,extended:!1,stage:c,nameLength:d.length<4095?d.length:4095},stages:[]};this._addEntry(w),this._dirty=!0}delete({filepath:t}){if(this._entries.has(t))this._entries.delete(t);else for(const i of this._entries.keys())i.startsWith(t+"/")&&this._entries.delete(i);this._unmergedPaths.has(t)&&this._unmergedPaths.delete(t),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:t}){return this._entries.has(t)}render(){return this.entries.map(t=>`${t.mode.toString(8)} ${t.oid}    ${t.path}`).join(`
`)}static async _entryToBuffer(t){const i=Buffer.from(t.path),s=Math.ceil((62+i.length+1)/8)*8,c=Buffer.alloc(s),d=new R(c),w=G(t);return d.writeUInt32BE(w.ctimeSeconds),d.writeUInt32BE(w.ctimeNanoseconds),d.writeUInt32BE(w.mtimeSeconds),d.writeUInt32BE(w.mtimeNanoseconds),d.writeUInt32BE(w.dev),d.writeUInt32BE(w.ino),d.writeUInt32BE(w.mode),d.writeUInt32BE(w.uid),d.writeUInt32BE(w.gid),d.writeUInt32BE(w.size),d.write(t.oid,20,"hex"),d.writeUInt16BE(ne(t)),d.write(t.path,i.length,"utf8"),c}async toObject(){const t=Buffer.alloc(12),i=new R(t);i.write("DIRC",4,"utf8"),i.writeUInt32BE(2),i.writeUInt32BE(this.entriesFlat.length);let s=[];for(const v of this.entries)if(s.push(Q._entryToBuffer(v)),v.stages.length>1)for(const I of v.stages)I&&I!==v&&s.push(Q._entryToBuffer(I));s=await Promise.all(s);const c=Buffer.concat(s),d=Buffer.concat([t,c]),w=await Y(d);return Buffer.concat([d,Buffer.from(w,"hex")])}}function oe(a,t,i=!0,s=!0){const c=G(a),d=G(t);return i&&c.mode!==d.mode||c.mtimeSeconds!==d.mtimeSeconds||c.ctimeSeconds!==d.ctimeSeconds||c.uid!==d.uid||c.gid!==d.gid||s&&c.ino!==d.ino||c.size!==d.size}let W=null;const le=Symbol("IndexCache");function te(){return{map:new Map,stats:new Map}}async function ie(a,t,i){const[s,c]=await Promise.all([a.lstat(t),a.read(t)]),d=await Q.from(c);i.map.set(t,d),i.stats.set(t,s)}async function ue(a,t,i){const s=i.stats.get(t);if(s===void 0)return!0;if(s===null)return!1;const c=await a.lstat(t);return c===null?!1:oe(s,c)}class ce{static async acquire({fs:t,gitdir:i,cache:s,allowUnmerged:c=!0},d){s[le]||(s[le]=te());const w=`${i}/index`;W===null&&(W=new n({maxPending:1/0}));let v,I=[];return await W.acquire(w,async()=>{const C=s[le];await ue(t,w,C)&&await ie(t,w,C);const k=C.map.get(w);if(I=k.unmergedPaths,I.length&&!c)throw new _(I);if(v=await d(k),k._dirty){const j=await k.toObject();await t.write(w,j),C.stats.set(w,await t.lstat(w)),k._dirty=!1}}),v}}function Fe(a){const t=Math.max(a.lastIndexOf("/"),a.lastIndexOf("\\"));return t>-1&&(a=a.slice(t+1)),a}function xe(a){const t=Math.max(a.lastIndexOf("/"),a.lastIndexOf("\\"));return t===-1?".":t===0?"/":a.slice(0,t)}function Te(a){const t=new Map,i=function(c){if(!t.has(c)){const d={type:"tree",fullpath:c,basename:Fe(c),metadata:{},children:[]};t.set(c,d),d.parent=i(xe(c)),d.parent&&d.parent!==d&&d.parent.children.push(d)}return t.get(c)},s=function(c,d){if(!t.has(c)){const w={type:"blob",fullpath:c,basename:Fe(c),metadata:d,parent:i(xe(c)),children:[]};w.parent&&w.parent.children.push(w),t.set(c,w)}return t.get(c)};i(".");for(const c of a)s(c.path,c);return t}function Ne(a){switch(a){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new y(`Unexpected GitTree entry mode: ${a.toString(8)}`)}class Je{constructor({fs:t,gitdir:i,cache:s}){this.treePromise=ce.acquire({fs:t,gitdir:i,cache:s},async function(d){return Te(d.entries)});const c=this;this.ConstructEntry=class{constructor(w){this._fullpath=w,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return c.type(this)}async mode(){return c.mode(this)}async stat(){return c.stat(this)}async content(){return c.content(this)}async oid(){return c.oid(this)}}}async readdir(t){const i=t._fullpath,c=(await this.treePromise).get(i);if(!c||c.type==="blob")return null;if(c.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${i}'`);const d=c.children.map(w=>w.fullpath);return d.sort(z),d}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const s=(await this.treePromise).get(t._fullpath);if(!s)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);const c=s.type==="tree"?{}:G(s.metadata);t._type=s.type==="tree"?"tree":Ne(c.mode),t._mode=c.mode,s.type==="tree"?t._stat=void 0:t._stat=c}return t._stat}async content(t){}async oid(t){if(t._oid===!1){const s=(await this.treePromise).get(t._fullpath);t._oid=s.metadata.oid}return t._oid}}const it=Symbol("GitWalkSymbol");function Qe(){const a=Object.create(null);return Object.defineProperty(a,it,{value:function({fs:t,gitdir:i,cache:s}){return new Je({fs:t,gitdir:i,cache:s})}}),Object.freeze(a),a}class He extends x{constructor(t){super(`Could not find ${t}.`),this.code=this.name=He.code,this.data={what:t}}}He.code="NotFoundError";class We extends x{constructor(t,i,s,c){super(`Object ${t} ${c?`at ${c}`:""}was anticipated to be a ${s} but it is a ${i}.`),this.code=this.name=We.code,this.data={oid:t,actual:i,expected:s,filepath:c}}}We.code="ObjectTypeError";class rt extends x{constructor(t){super(`Expected a 40-char hex object id but saw "${t}".`),this.code=this.name=rt.code,this.data={value:t}}}rt.code="InvalidOidError";class Xe extends x{constructor(t){super(`Could not find a fetch refspec for remote "${t}". Make sure the config file has an entry like the following:
[remote "${t}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=Xe.code,this.data={remote:t}}}Xe.code="NoRefspecError";class at{constructor(t){if(this.refs=new Map,this.parsedConfig=[],t){let i=null;this.parsedConfig=t.trim().split(`
`).map(s=>{if(/^\s*#/.test(s))return{line:s,comment:!0};const c=s.indexOf(" ");if(s.startsWith("^")){const d=s.slice(1);return this.refs.set(i+"^{}",d),{line:s,ref:i,peeled:d}}else{const d=s.slice(0,c);return i=s.slice(c+1),this.refs.set(i,d),{line:s,ref:i,oid:d}}})}return this}static from(t){return new at(t)}delete(t){this.parsedConfig=this.parsedConfig.filter(i=>i.ref!==t),this.refs.delete(t)}toString(){return this.parsedConfig.map(({line:t})=>t).join(`
`)+`
`}}class Ge{constructor({remotePath:t,localPath:i,force:s,matchPrefix:c}){Object.assign(this,{remotePath:t,localPath:i,force:s,matchPrefix:c})}static from(t){const[i,s,c,d,w]=t.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),v=i==="+",I=c==="*";if(I!==(w==="*"))throw new y("Invalid refspec");return new Ge({remotePath:s,localPath:d,force:v,matchPrefix:I})}translate(t){if(this.matchPrefix){if(t.startsWith(this.remotePath))return this.localPath+t.replace(this.remotePath,"")}else if(t===this.remotePath)return this.localPath;return null}reverseTranslate(t){if(this.matchPrefix){if(t.startsWith(this.localPath))return this.remotePath+t.replace(this.localPath,"")}else if(t===this.localPath)return this.remotePath;return null}}class Ze{constructor(t=[]){this.rules=t}static from(t){const i=[];for(const s of t)i.push(Ge.from(s));return new Ze(i)}add(t){const i=Ge.from(t);this.rules.push(i)}translate(t){const i=[];for(const s of this.rules)for(const c of t){const d=s.translate(c);d&&i.push([c,d])}return i}translateOne(t){let i=null;for(const s of this.rules){const c=s.translate(t);c&&(i=c)}return i}localNamespaces(){return this.rules.filter(t=>t.matchPrefix).map(t=>t.localPath.replace(/\/$/,""))}}function pt(a,t){const i=a.replace(/\^\{\}$/,""),s=t.replace(/\^\{\}$/,""),c=-(i<s)||+(i>s);return c===0?a.endsWith("^{}")?1:-1:c}/*!
 * This code for `path.join` is directly copied from @zenfs/core/path for bundle size improvements.
 * SPDX-License-Identifier: LGPL-3.0-or-later
 * Copyright (c) James Prevett and other ZenFS contributors.
 */function wt(a,t){let i="",s=0,c=-1,d=0,w="\0";for(let v=0;v<=a.length;++v){if(v<a.length)w=a[v];else{if(w==="/")break;w="/"}if(w==="/"){if(!(c===v-1||d===1))if(d===2){if(i.length<2||s!==2||i.at(-1)!=="."||i.at(-2)!=="."){if(i.length>2){const I=i.lastIndexOf("/");I===-1?(i="",s=0):(i=i.slice(0,I),s=i.length-1-i.lastIndexOf("/")),c=v,d=0;continue}else if(i.length!==0){i="",s=0,c=v,d=0;continue}}t&&(i+=i.length>0?"/..":"..",s=2)}else i.length>0?i+="/"+a.slice(c+1,v):i=a.slice(c+1,v),s=v-c-1;c=v,d=0}else w==="."&&d!==-1?++d:d=-1}return i}function M(a){if(!a.length)return".";const t=a[0]==="/",i=a.at(-1)==="/";return a=wt(a,!t),a.length?(i&&(a+="/"),t?`/${a}`:a):t?"/":i?"./":"."}function g(...a){if(a.length===0)return".";let t;for(let i=0;i<a.length;++i){const s=a[i];s.length>0&&(t===void 0?t=s:t+="/"+s)}return t===void 0?".":M(t)}const b=a=>{if(typeof a=="number")return a;a=a.toLowerCase();let t=parseInt(a);return a.endsWith("k")&&(t*=1024),a.endsWith("m")&&(t*=1024*1024),a.endsWith("g")&&(t*=1024*1024*1024),t},$=a=>{if(typeof a=="boolean")return a;if(a=a.trim().toLowerCase(),a==="true"||a==="yes"||a==="on")return!0;if(a==="false"||a==="no"||a==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${a}`)},ae={core:{filemode:$,bare:$,logallrefupdates:$,symlinks:$,ignorecase:$,bigFileThreshold:b}},ye=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,ve=/^[A-Za-z0-9-.]+$/,Ve=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,Ye=/^[A-Za-z][A-Za-z-]*$/,nt=/^(.*?)( *[#;].*)$/,ft=a=>{const t=ye.exec(a);if(t!=null){const[i,s]=t.slice(1);return[i,s]}return null},st=a=>{const t=Ve.exec(a);if(t!=null){const[i,s="true"]=t.slice(1),c=yt(s),d=Jt(c);return[i,d]}return null},yt=a=>{const t=nt.exec(a);if(t==null)return a;const[i,s]=t.slice(1);return Bt(i)&&Bt(s)?`${i}${s}`:i},Bt=a=>(a.match(/(?:^|[^\\])"/g)||[]).length%2!==0,Jt=a=>a.split("").reduce((t,i,s,c)=>{const d=i==='"'&&c[s-1]!=="\\",w=i==="\\"&&c[s+1]==='"';return d||w?t:t+i},""),P=a=>a!=null?a.toLowerCase():null,_e=(a,t,i)=>[P(a),t,P(i)].filter(s=>s!=null).join("."),ke=a=>{const t=a.split("."),i=t.shift(),s=t.pop(),c=t.length?t.join("."):void 0;return{section:i,subsection:c,name:s,path:_e(i,c,s),sectionPath:_e(i,c,null),isSection:!!i}},Be=(a,t)=>a.reduce((i,s,c)=>t(s)?c:i,-1);class ee{constructor(t){let i=null,s=null;this.parsedConfig=t?t.split(`
`).map(c=>{let d=null,w=null;const v=c.trim(),I=ft(v),C=I!=null;if(C)[i,s]=I;else{const j=st(v);j!=null&&([d,w]=j)}const k=_e(i,s,d);return{line:c,isSection:C,section:i,subsection:s,name:d,value:w,path:k}}):[]}static from(t){return new ee(t)}async get(t,i=!1){const s=ke(t).path,c=this.parsedConfig.filter(d=>d.path===s).map(({section:d,name:w,value:v})=>{const I=ae[d]&&ae[d][w];return I?I(v):v});return i?c:c.pop()}async getall(t){return this.get(t,!0)}async getSubsections(t){return this.parsedConfig.filter(i=>i.isSection&&i.section===t).map(i=>i.subsection)}async deleteSection(t,i){this.parsedConfig=this.parsedConfig.filter(s=>!(s.section===t&&s.subsection===i))}async append(t,i){return this.set(t,i,!0)}async set(t,i,s=!1){const{section:c,subsection:d,name:w,path:v,sectionPath:I,isSection:C}=ke(t),k=Be(this.parsedConfig,j=>j.path===v);if(i==null)k!==-1&&this.parsedConfig.splice(k,1);else if(k!==-1){const j=this.parsedConfig[k],F=Object.assign({},j,{name:w,value:i,modified:!0});s?this.parsedConfig.splice(k+1,0,F):this.parsedConfig[k]=F}else{const j=this.parsedConfig.findIndex(V=>V.path===I),F={section:c,subsection:d,name:w,value:i,modified:!0,path:v};if(ve.test(c)&&Ye.test(w))if(j>=0)this.parsedConfig.splice(j+1,0,F);else{const V={isSection:C,section:c,subsection:d,modified:!0,path:I};this.parsedConfig.push(V,F)}}}toString(){return this.parsedConfig.map(({line:t,section:i,subsection:s,name:c,value:d,modified:w=!1})=>w?c!=null&&d!=null?typeof d=="string"&&/[#;]/.test(d)?`	${c} = "${d}"`:`	${c} = ${d}`:s!=null?`[${i} "${s}"]`:`[${i}]`:t).join(`
`)}}class he{static async get({fs:t,gitdir:i}){const s=await t.read(`${i}/config`,{encoding:"utf8"});return ee.from(s)}static async save({fs:t,gitdir:i,config:s}){await t.write(`${i}/config`,s.toString(),{encoding:"utf8"})}}const A=a=>[`${a}`,`refs/${a}`,`refs/tags/${a}`,`refs/heads/${a}`,`refs/remotes/${a}`,`refs/remotes/${a}/HEAD`],Se=["config","description","index","shallow","commondir"];let qe;async function m(a,t){return qe===void 0&&(qe=new n),qe.acquire(a,t)}class H{static async updateRemoteRefs({fs:t,gitdir:i,remote:s,refs:c,symrefs:d,tags:w,refspecs:v=void 0,prune:I=!1,pruneTags:C=!1}){for(const pe of c.values())if(!pe.match(/[0-9a-f]{40}/))throw new rt(pe);const k=await he.get({fs:t,gitdir:i});if(!v){if(v=await k.getall(`remote.${s}.fetch`),v.length===0)throw new Xe(s);v.unshift(`+HEAD:refs/remotes/${s}/HEAD`)}const j=Ze.from(v),F=new Map;if(C){const pe=await H.listRefs({fs:t,gitdir:i,filepath:"refs/tags"});await H.deleteRefs({fs:t,gitdir:i,refs:pe.map(we=>`refs/tags/${we}`)})}if(w){for(const pe of c.keys())if(pe.startsWith("refs/tags")&&!pe.endsWith("^{}")&&!await H.exists({fs:t,gitdir:i,ref:pe})){const we=c.get(pe);F.set(pe,we)}}const V=j.translate([...c.keys()]);for(const[pe,we]of V){const be=c.get(pe);F.set(we,be)}const re=j.translate([...d.keys()]);for(const[pe,we]of re){const be=d.get(pe),Ie=j.translateOne(be);Ie&&F.set(we,`ref: ${Ie}`)}const me=[];if(I){for(const pe of j.localNamespaces()){const we=(await H.listRefs({fs:t,gitdir:i,filepath:pe})).map(be=>`${pe}/${be}`);for(const be of we)F.has(be)||me.push(be)}me.length>0&&await H.deleteRefs({fs:t,gitdir:i,refs:me})}for(const[pe,we]of F)await m(pe,async()=>t.write(g(i,pe),`${we.trim()}
`,"utf8"));return{pruned:me}}static async writeRef({fs:t,gitdir:i,ref:s,value:c}){if(!c.match(/[0-9a-f]{40}/))throw new rt(c);await m(s,async()=>t.write(g(i,s),`${c.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:t,gitdir:i,ref:s,value:c}){await m(s,async()=>t.write(g(i,s),`ref: ${c.trim()}
`,"utf8"))}static async deleteRef({fs:t,gitdir:i,ref:s}){return H.deleteRefs({fs:t,gitdir:i,refs:[s]})}static async deleteRefs({fs:t,gitdir:i,refs:s}){await Promise.all(s.map(v=>t.rm(g(i,v))));let c=await m("packed-refs",async()=>t.read(`${i}/packed-refs`,{encoding:"utf8"}));const d=at.from(c),w=d.refs.size;for(const v of s)d.refs.has(v)&&d.delete(v);d.refs.size<w&&(c=d.toString(),await m("packed-refs",async()=>t.write(`${i}/packed-refs`,c,{encoding:"utf8"})))}static async resolve({fs:t,gitdir:i,ref:s,depth:c=void 0}){if(c!==void 0&&(c--,c===-1))return s;if(s.startsWith("ref: "))return s=s.slice(5),H.resolve({fs:t,gitdir:i,ref:s,depth:c});if(s.length===40&&/[0-9a-f]{40}/.test(s))return s;const d=await H.packedRefs({fs:t,gitdir:i}),w=A(s).filter(v=>!Se.includes(v));for(const v of w){const I=await m(v,async()=>await t.read(`${i}/${v}`,{encoding:"utf8"})||d.get(v));if(I)return H.resolve({fs:t,gitdir:i,ref:I.trim(),depth:c})}throw new He(s)}static async exists({fs:t,gitdir:i,ref:s}){try{return await H.expand({fs:t,gitdir:i,ref:s}),!0}catch{return!1}}static async expand({fs:t,gitdir:i,ref:s}){if(s.length===40&&/[0-9a-f]{40}/.test(s))return s;const c=await H.packedRefs({fs:t,gitdir:i}),d=A(s);for(const w of d)if(await m(w,async()=>t.exists(`${i}/${w}`))||c.has(w))return w;throw new He(s)}static async expandAgainstMap({ref:t,map:i}){const s=A(t);for(const c of s)if(await i.has(c))return c;throw new He(t)}static resolveAgainstMap({ref:t,fullref:i=t,depth:s=void 0,map:c}){if(s!==void 0&&(s--,s===-1))return{fullref:i,oid:t};if(t.startsWith("ref: "))return t=t.slice(5),H.resolveAgainstMap({ref:t,fullref:i,depth:s,map:c});if(t.length===40&&/[0-9a-f]{40}/.test(t))return{fullref:i,oid:t};const d=A(t);for(const w of d){const v=c.get(w);if(v)return H.resolveAgainstMap({ref:v.trim(),fullref:w,depth:s,map:c})}throw new He(t)}static async packedRefs({fs:t,gitdir:i}){const s=await m("packed-refs",async()=>t.read(`${i}/packed-refs`,{encoding:"utf8"}));return at.from(s).refs}static async listRefs({fs:t,gitdir:i,filepath:s}){const c=H.packedRefs({fs:t,gitdir:i});let d=null;try{d=await t.readdirDeep(`${i}/${s}`),d=d.map(w=>w.replace(`${i}/${s}/`,""))}catch{d=[]}for(let w of(await c).keys())w.startsWith(s)&&(w=w.replace(s+"/",""),d.includes(w)||d.push(w));return d.sort(pt),d}static async listBranches({fs:t,gitdir:i,remote:s}){return s?H.listRefs({fs:t,gitdir:i,filepath:`refs/remotes/${s}`}):H.listRefs({fs:t,gitdir:i,filepath:"refs/heads"})}static async listTags({fs:t,gitdir:i}){return(await H.listRefs({fs:t,gitdir:i,filepath:"refs/tags"})).filter(c=>!c.endsWith("^{}"))}}function ge(a,t){return z(T(a),T(t))}function T(a){return a.mode==="040000"?a.path+"/":a.path}function Z(a){switch(a){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new y(`Unexpected GitTree entry mode: ${a}`)}function fe(a){const t=[];let i=0;for(;i<a.length;){const s=a.indexOf(32,i);if(s===-1)throw new y(`GitTree: Error parsing buffer at byte location ${i}: Could not find the next space character.`);const c=a.indexOf(0,i);if(c===-1)throw new y(`GitTree: Error parsing buffer at byte location ${i}: Could not find the next null character.`);let d=a.slice(i,s).toString("utf8");d==="40000"&&(d="040000");const w=Z(d),v=a.slice(s+1,c).toString("utf8");if(v.includes("\\")||v.includes("/"))throw new O(v);const I=a.slice(c+1,c+21).toString("hex");i=c+21,t.push({mode:d,path:v,oid:I,type:w})}return t}function ze(a){if(typeof a=="number"&&(a=a.toString(8)),a.match(/^0?4.*/))return"040000";if(a.match(/^1006.*/))return"100644";if(a.match(/^1007.*/))return"100755";if(a.match(/^120.*/))return"120000";if(a.match(/^160.*/))return"160000";throw new y(`Could not understand file mode: ${a}`)}function Pe(a){return!a.oid&&a.sha&&(a.oid=a.sha),a.mode=ze(a.mode),a.type||(a.type=Z(a.mode)),a}class Ce{constructor(t){if(Buffer.isBuffer(t))this._entries=fe(t);else if(Array.isArray(t))this._entries=t.map(Pe);else throw new y("invalid type passed to GitTree constructor");this._entries.sort(N)}static from(t){return new Ce(t)}render(){return this._entries.map(t=>`${t.mode} ${t.type} ${t.oid}    ${t.path}`).join(`
`)}toObject(){const t=[...this._entries];return t.sort(ge),Buffer.concat(t.map(i=>{const s=Buffer.from(i.mode.replace(/^0/,"")),c=Buffer.from(" "),d=Buffer.from(i.path,"utf8"),w=Buffer.from([0]),v=Buffer.from(i.oid,"hex");return Buffer.concat([s,c,d,w,v])}))}entries(){return this._entries}*[Symbol.iterator](){for(const t of this._entries)yield t}}class et{static wrap({type:t,object:i}){const s=`${t} ${i.length}\0`,c=s.length,d=c+i.length,w=new Uint8Array(d);for(let v=0;v<c;v++)w[v]=s.charCodeAt(v);return w.set(i,c),w}static unwrap(t){const i=t.indexOf(32),s=t.indexOf(0),c=t.slice(0,i).toString("utf8"),d=t.slice(i+1,s).toString("utf8"),w=t.length-(s+1);if(parseInt(d)!==w)throw new y(`Length mismatch: expected ${d} bytes but got ${w} instead.`);return{type:c,object:Buffer.from(t.slice(s+1))}}}async function Vt({fs:a,gitdir:t,oid:i}){const s=`objects/${i.slice(0,2)}/${i.slice(2)}`,c=await a.read(`${t}/${s}`);return c?{object:c,format:"deflated",source:s}:null}function gt(a,t){const i=new R(a),s=ot(i);if(s!==t.byteLength)throw new y(`applyDelta expected source buffer to be ${s} bytes but the provided buffer was ${t.length} bytes`);const c=ot(i);let d;const w=kt(i,t);if(w.byteLength===c)d=w;else{d=Buffer.alloc(c);const v=new R(d);for(v.copy(w);!i.eof();)v.copy(kt(i,t));const I=v.tell();if(c!==I)throw new y(`applyDelta expected target buffer to be ${c} bytes but the resulting buffer was ${I} bytes`)}return d}function ot(a){let t=0,i=0,s=null;do s=a.readUInt8(),t|=(s&127)<<i,i+=7;while(s&128);return t}function vt(a,t,i){let s=0,c=0;for(;i--;)t&1&&(s|=a.readUInt8()<<c),t>>=1,c+=8;return s}function kt(a,t){const i=a.readUInt8(),s=128,c=15,d=112;if(i&s){const w=vt(a,i&c,4);let v=vt(a,(i&d)>>4,3);return v===0&&(v=65536),t.slice(w,w+v)}else return a.slice(i)}function Ft(a){let t=[a];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function _r(a){return a[Symbol.asyncIterator]?a[Symbol.asyncIterator]():a[Symbol.iterator]?a[Symbol.iterator]():a.next?a:Ft(a)}class Sr{constructor(t){if(typeof Buffer>"u")throw new Error("Missing Buffer dependency");this.stream=_r(t),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(t){if(!this.eof())return this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t),this.buffer.slice(this.undoCursor,this.cursor)}async skip(t){this.eof()||(this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:t,value:i}=await this.stream.next();return t&&(this._ended=!0,!i)?Buffer.alloc(0):(i&&(i=Buffer.from(i)),i)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(t){this.undoCursor=this.cursor,this.cursor+=t,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(t){if(this._ended)return;const i=[this.buffer];for(;this.cursor+t>xt(i);){const s=await this._next();if(this._ended)break;i.push(s)}this.buffer=Buffer.concat(i)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function xt(a){return a.reduce((t,i)=>t+i.length,0)}async function Nt(a,t){const i=new Sr(a);let s=await i.read(4);if(s=s.toString("utf8"),s!=="PACK")throw new y(`Invalid PACK header '${s}'`);let c=await i.read(4);if(c=c.readUInt32BE(0),c!==2)throw new y(`Invalid packfile version: ${c}`);let d=await i.read(4);if(d=d.readUInt32BE(0),!(d<1))for(;!i.eof()&&d--;){const w=i.tell(),{type:v,length:I,ofs:C,reference:k}=await Et(i),j=new l.Inflate;for(;!j.result;){const F=await i.chunk();if(!F)break;if(j.push(F,!1),j.err)throw new y(`Pako error: ${j.msg}`);if(j.result){if(j.result.length!==I)throw new y("Inflated object size is different from that stated in packfile.");await i.undo(),await i.read(F.length-j.strm.avail_in);const V=i.tell();await t({data:j.result,type:v,num:d,offset:w,end:V,reference:k,ofs:C})}}}}async function Et(a){let t=await a.byte();const i=t>>4&7;let s=t&15;if(t&128){let w=4;do t=await a.byte(),s|=(t&127)<<w,w+=7;while(t&128)}let c,d;if(i===6){let w=0;c=0;const v=[];do t=await a.byte(),c|=(t&127)<<w,w+=7,v.push(t);while(t&128);d=Buffer.from(v)}return i===7&&(d=await a.read(20)),{type:i,length:s,ofs:c,reference:d}}async function Zt(a){return l.inflate(a)}function Kt(a){const t=[];let i=0,s=0;do{i=a.readUInt8();const c=i&127;t.push(c),s=i&128}while(s);return t.reduce((c,d)=>c+1<<7|d,-1)}function ti(a,t){let i=t,s=4,c=null;do c=a.readUInt8(),i|=(c&127)<<s,s+=7;while(c&128);return i}class Ur{constructor(t){Object.assign(this,t),this.offsetCache={}}static async fromIdx({idx:t,getExternalRefDelta:i}){const s=new R(t);if(s.slice(4).toString("hex")!=="ff744f63")return;const d=s.readUInt32BE();if(d!==2)throw new y(`Unable to read version ${d} packfile IDX. (Only version 2 supported)`);if(t.byteLength>2048*1024*1024)throw new y("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");s.seek(s.tell()+1020);const w=s.readUInt32BE(),v=[];for(let k=0;k<w;k++){const j=s.slice(20).toString("hex");v[k]=j}s.seek(s.tell()+4*w);const I=new Map;for(let k=0;k<w;k++)I.set(v[k],s.readUInt32BE());const C=s.slice(20).toString("hex");return new Ur({hashes:v,crcs:{},offsets:I,packfileSha:C,getExternalRefDelta:i})}static async fromPack({pack:t,getExternalRefDelta:i,onProgress:s}){const c={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},d={},w=t.slice(-20).toString("hex"),v=[],I={},C=new Map;let k=null,j=null;await Nt([t],async({data:pe,type:we,reference:be,offset:Ie,num:je})=>{k===null&&(k=je);const De=Math.floor((k-je)*100/k);De!==j&&s&&await s({phase:"Receiving objects",loaded:k-je,total:k}),j=De,we=c[we],["commit","tree","blob","tag"].includes(we)?d[Ie]={type:we,offset:Ie}:we==="ofs-delta"?d[Ie]={type:we,offset:Ie}:we==="ref-delta"&&(d[Ie]={type:we,offset:Ie})});const F=Object.keys(d).map(Number);for(const[pe,we]of F.entries()){const be=pe+1===F.length?t.byteLength-20:F[pe+1],Ie=d[we],je=o.buf(t.slice(we,be))>>>0;Ie.end=be,Ie.crc=je}const V=new Ur({pack:Promise.resolve(t),packfileSha:w,crcs:I,hashes:v,offsets:C,getExternalRefDelta:i});j=null;let re=0;const me=[0,0,0,0,0,0,0,0,0,0,0,0];for(let pe in d){pe=Number(pe);const we=Math.floor(re*100/k);we!==j&&s&&await s({phase:"Resolving deltas",loaded:re,total:k}),re++,j=we;const be=d[pe];if(!be.oid)try{V.readDepth=0,V.externalReadDepth=0;const{type:Ie,object:je}=await V.readSlice({start:pe});me[V.readDepth]+=1;const De=await Y(et.wrap({type:Ie,object:je}));be.oid=De,v.push(De),C.set(De,pe),I[De]=be.crc}catch{continue}}return v.sort(),V}async toBuffer(){const t=[],i=(C,k)=>{t.push(Buffer.from(C,k))};i("ff744f63","hex"),i("00000002","hex");const s=new R(Buffer.alloc(256*4));for(let C=0;C<256;C++){let k=0;for(const j of this.hashes)parseInt(j.slice(0,2),16)<=C&&k++;s.writeUInt32BE(k)}t.push(s.buffer);for(const C of this.hashes)i(C,"hex");const c=new R(Buffer.alloc(this.hashes.length*4));for(const C of this.hashes)c.writeUInt32BE(this.crcs[C]);t.push(c.buffer);const d=new R(Buffer.alloc(this.hashes.length*4));for(const C of this.hashes)d.writeUInt32BE(this.offsets.get(C));t.push(d.buffer),i(this.packfileSha,"hex");const w=Buffer.concat(t),v=await Y(w),I=Buffer.alloc(20);return I.write(v,"hex"),Buffer.concat([w,I])}async load({pack:t}){this.pack=t}async unload(){this.pack=null}async read({oid:t}){if(!this.offsets.get(t)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(t);throw new y(`Could not read object ${t} from packfile`)}const i=this.offsets.get(t);return this.readSlice({start:i})}async readSlice({start:t}){if(this.offsetCache[t])return Object.assign({},this.offsetCache[t]);this.readDepth++;const i={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new y("Tried to read from a GitPackIndex with no packfile loaded into memory");const s=(await this.pack).slice(t),c=new R(s),d=c.readUInt8(),w=d&112;let v=i[w];if(v===void 0)throw new y("Unrecognized type: 0b"+w.toString(2));const I=d&15;let C=I;d&128&&(C=ti(c,I));let j=null,F=null;if(v==="ofs_delta"){const re=Kt(c),me=t-re;({object:j,type:v}=await this.readSlice({start:me}))}if(v==="ref_delta"){const re=c.slice(20).toString("hex");({object:j,type:v}=await this.read({oid:re}))}const V=s.slice(c.tell());if(F=Buffer.from(await Zt(V)),F.byteLength!==C)throw new y(`Packfile told us object would have length ${C} but it had length ${F.byteLength}`);return j&&(F=Buffer.from(gt(F,j))),this.readDepth>3&&(this.offsetCache[t]={type:v,object:F}),{type:v,format:"content",object:F}}}const ri=Symbol("PackfileCache");async function Ch({fs:a,filename:t,getExternalRefDelta:i,emitter:s,emitterPrefix:c}){const d=await a.read(t);return Ur.fromIdx({idx:d,getExternalRefDelta:i})}function Hi({fs:a,cache:t,filename:i,getExternalRefDelta:s,emitter:c,emitterPrefix:d}){t[ri]||(t[ri]=new Map);let w=t[ri].get(i);return w||(w=Ch({fs:a,filename:i,getExternalRefDelta:s,emitter:c,emitterPrefix:d}),t[ri].set(i,w)),w}async function Rh({fs:a,cache:t,gitdir:i,oid:s,format:c="content",getExternalRefDelta:d}){let w=await a.readdir(g(i,"objects/pack"));w=w.filter(v=>v.endsWith(".idx"));for(const v of w){const I=`${i}/objects/pack/${v}`,C=await Hi({fs:a,cache:t,filename:I,getExternalRefDelta:d});if(C.error)throw new y(C.error);if(C.offsets.has(s)){if(!C.pack){const j=I.replace(/idx$/,"pack");C.pack=a.read(j)}const k=await C.read({oid:s,getExternalRefDelta:d});return k.format="content",k.source=`objects/pack/${v.replace(/idx$/,"pack")}`,k}}return null}async function dt({fs:a,cache:t,gitdir:i,oid:s,format:c="content"}){const d=k=>dt({fs:a,cache:t,gitdir:i,oid:k});let w;if(s==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(w={format:"wrapped",object:Buffer.from("tree 0\0")}),w||(w=await Vt({fs:a,gitdir:i,oid:s})),!w){if(w=await Rh({fs:a,cache:t,gitdir:i,oid:s,getExternalRefDelta:d}),!w)throw new He(s);return w}if(c==="deflated"||(w.format==="deflated"&&(w.object=Buffer.from(await Zt(w.object)),w.format="wrapped"),c==="wrapped"))return w;const v=await Y(w.object);if(v!==s)throw new y(`SHA check failed! Expected ${s}, computed ${v}`);const{object:I,type:C}=et.unwrap(w.object);if(w.type=C,w.object=I,w.format="content",c==="content")return w;throw new y(`invalid requested format "${c}"`)}class Qt extends x{constructor(t,i,s=!0){super(`Failed to create ${t} at ${i} because it already exists.${s?` (Hint: use 'force: true' parameter to overwrite existing ${t}.)`:""}`),this.code=this.name=Qt.code,this.data={noun:t,where:i,canForce:s}}}Qt.code="AlreadyExistsError";class ln extends x{constructor(t,i,s){super(`Found multiple ${t} matching "${i}" (${s.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=ln.code,this.data={nouns:t,short:i,matches:s}}}ln.code="AmbiguousError";class cn extends x{constructor(t){super(`Your local changes to the following files would be overwritten by checkout: ${t.join(", ")}`),this.code=this.name=cn.code,this.data={filepaths:t}}}cn.code="CheckoutConflictError";class un extends x{constructor(t,i){super(`Cannot cherry-pick merge commit ${t}. Merge commits have ${i} parents and require specifying which parent to use as the base.`),this.code=this.name=un.code,this.data={oid:t,parentCount:i}}}un.code="CherryPickMergeCommitError";class fn extends x{constructor(t){super(`Cannot cherry-pick root commit ${t}. Root commits have no parents.`),this.code=this.name=fn.code,this.data={oid:t}}}fn.code="CherryPickRootCommitError";class dn extends x{constructor(t,i){super(`Failed to checkout "${t}" because commit ${i} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=dn.code,this.data={ref:t,oid:i}}}dn.code="CommitNotFetchedError";class hn extends x{constructor(){super("Empty response from git server."),this.code=this.name=hn.code,this.data={}}}hn.code="EmptyServerResponseError";class pn extends x{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=pn.code,this.data={}}}pn.code="FastForwardError";class gn extends x{constructor(t,i){super(`One or more branches were not updated: ${t}`),this.code=this.name=gn.code,this.data={prettyDetails:t,result:i}}}gn.code="GitPushError";class zr extends x{constructor(t,i,s){super(`HTTP Error: ${t} ${i}`),this.code=this.name=zr.code,this.data={statusCode:t,statusMessage:i,response:s}}}zr.code="HttpError";class dr extends x{constructor(t){let i="invalid filepath";t==="leading-slash"||t==="trailing-slash"?i='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':t==="directory"&&(i='"filepath" should not be a directory.'),super(i),this.code=this.name=dr.code,this.data={reason:t}}}dr.code="InvalidFilepathError";class er extends x{constructor(t,i){super(`"${t}" would be an invalid git reference. (Hint: a valid alternative would be "${i}".)`),this.code=this.name=er.code,this.data={ref:t,suggestion:i}}}er.code="InvalidRefNameError";class mn extends x{constructor(t){super(`Maximum search depth of ${t} exceeded.`),this.code=this.name=mn.code,this.data={depth:t}}}mn.code="MaxDepthError";class Gr extends x{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=Gr.code,this.data={}}}Gr.code="MergeNotSupportedError";class kr extends x{constructor(t,i,s,c){super(`Automatic merge failed with one or more merge conflicts in the following files: ${t.toString()}. Fix conflicts then commit the result.`),this.code=this.name=kr.code,this.data={filepaths:t,bothModified:i,deleteByUs:s,deleteByTheirs:c}}}kr.code="MergeConflictError";class Rt extends x{constructor(t){super(`No name was provided for ${t} in the argument or in the .git/config file.`),this.code=this.name=Rt.code,this.data={role:t}}}Rt.code="MissingNameError";class Ut extends x{constructor(t){super(`The function requires a "${t}" parameter but none was provided.`),this.code=this.name=Ut.code,this.data={parameter:t}}}Ut.code="MissingParameterError";class wn extends x{constructor(t){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=wn.code,this.data={errors:t},this.errors=t}}wn.code="MultipleGitError";class Er extends x{constructor(t,i){super(`Expected "${t}" but received "${i}".`),this.code=this.name=Er.code,this.data={expected:t,actual:i}}}Er.code="ParseError";class Hr extends x{constructor(t){let i="";t==="not-fast-forward"?i=" because it was not a simple fast-forward":t==="tag-exists"&&(i=" because tag already exists"),super(`Push rejected${i}. Use "force: true" to override.`),this.code=this.name=Hr.code,this.data={reason:t}}}Hr.code="PushRejectedError";class hr extends x{constructor(t,i){super(`Remote does not support the "${t}" so the "${i}" parameter cannot be used.`),this.code=this.name=hr.code,this.data={capability:t,parameter:i}}}hr.code="RemoteCapabilityError";class yn extends x{constructor(t,i){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${t}`),this.code=this.name=yn.code,this.data={preview:t,response:i}}}yn.code="SmartHttpError";class bn extends x{constructor(t,i,s){super(`Git remote "${t}" uses an unrecognized transport protocol: "${i}"`),this.code=this.name=bn.code,this.data={url:t,transport:i,suggestion:s}}}bn.code="UnknownTransportError";class vn extends x{constructor(t){super(`Cannot parse remote URL: "${t}"`),this.code=this.name=vn.code,this.data={url:t}}}vn.code="UrlParseError";class Wr extends x{constructor(){super("The operation was canceled."),this.code=this.name=Wr.code,this.data={}}}Wr.code="UserCanceledError";class xn extends x{constructor(t){super(`Could not merge index: Entry for '${t}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=xn.code,this.data={filepath:t}}}xn.code="IndexResetError";class _n extends x{constructor(t){super(`"${t}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=_n.code,this.data={ref:t}}}_n.code="NoCommitError";var Ps=Object.freeze({__proto__:null,AlreadyExistsError:Qt,AmbiguousError:ln,CheckoutConflictError:cn,CherryPickMergeCommitError:un,CherryPickRootCommitError:fn,CommitNotFetchedError:dn,EmptyServerResponseError:hn,FastForwardError:pn,GitPushError:gn,HttpError:zr,InternalError:y,InvalidFilepathError:dr,InvalidOidError:rt,InvalidRefNameError:er,MaxDepthError:mn,MergeNotSupportedError:Gr,MergeConflictError:kr,MissingNameError:Rt,MissingParameterError:Ut,MultipleGitError:wn,NoRefspecError:Xe,NotFoundError:He,ObjectTypeError:We,ParseError:Er,PushRejectedError:Hr,RemoteCapabilityError:hr,SmartHttpError:yn,UnknownTransportError:bn,UnsafeFilepathError:O,UrlParseError:vn,UserCanceledError:Wr,UnmergedPathsError:_,IndexResetError:xn,NoCommitError:_n});function Wi({name:a,email:t,timestamp:i,timezoneOffset:s}){return s=Oh(s),`${a} <${t}> ${i} ${s}`}function Oh(a){const t=Mh(Ph(a));a=Math.abs(a);const i=Math.floor(a/60);a-=i*60;let s=String(i),c=String(a);return s.length<2&&(s="0"+s),c.length<2&&(c="0"+c),(t===-1?"-":"+")+s+c}function Mh(a){return Math.sign(a)||(Object.is(a,-0)?-1:1)}function Ph(a){return a===0?a:-a}function lr(a){return a=a.replace(/\r/g,""),a=a.replace(/^\n+/,""),a=a.replace(/\n+$/,"")+`
`,a}function ni(a){const[,t,i,s,c]=a.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:t,email:i,timestamp:Number(s),timezoneOffset:jh(c)}}function jh(a){let[,t,i,s]=a.match(/(\+|-)(\d\d)(\d\d)/);return s=(t==="+"?1:-1)*(Number(i)*60+Number(s)),Bh(s)}function Bh(a){return a===0?a:-a}class $t{constructor(t){if(typeof t=="string")this._tag=t;else if(Buffer.isBuffer(t))this._tag=t.toString("utf8");else if(typeof t=="object")this._tag=$t.render(t);else throw new y("invalid type passed to GitAnnotatedTag constructor")}static from(t){return new $t(t)}static render(t){return`object ${t.object}
type ${t.type}
tag ${t.tag}
tagger ${Wi(t.tagger)}

${t.message}
${t.gpgsig?t.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const t=this.withoutSignature();return t.slice(t.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const t=this.justHeaders().split(`
`),i=[];for(const c of t)c[0]===" "?i[i.length-1]+=`
`+c.slice(1):i.push(c);const s={};for(const c of i){const d=c.slice(0,c.indexOf(" ")),w=c.slice(c.indexOf(" ")+1);Array.isArray(s[d])?s[d].push(w):s[d]=w}return s.tagger&&(s.tagger=ni(s.tagger)),s.committer&&(s.committer=ni(s.committer)),s}withoutSignature(){const t=lr(this._tag);return t.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?t:t.slice(0,t.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const t=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return lr(t)}payload(){return this.withoutSignature()+`
`}toObject(){return Buffer.from(this._tag,"utf8")}static async sign(t,i,s){const c=t.payload();let{signature:d}=await i({payload:c,secretKey:s});d=lr(d);const w=c+d;return $t.from(w)}}function qi(a){return a.trim().split(`
`).map(t=>" "+t).join(`
`)+`
`}function Fh(a){return a.split(`
`).map(t=>t.replace(/^ /,"")).join(`
`)}class mt{constructor(t){if(typeof t=="string")this._commit=t;else if(Buffer.isBuffer(t))this._commit=t.toString("utf8");else if(typeof t=="object")this._commit=mt.render(t);else throw new y("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:t,signature:i}){const s=mt.justHeaders(t),c=mt.justMessage(t),d=lr(s+`
gpgsig`+qi(i)+`
`+c);return new mt(d)}static from(t){return new mt(t)}toObject(){return Buffer.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return mt.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(t){return lr(t.slice(t.indexOf(`

`)+2))}static justHeaders(t){return t.slice(0,t.indexOf(`

`))}parseHeaders(){const t=mt.justHeaders(this._commit).split(`
`),i=[];for(const c of t)c[0]===" "?i[i.length-1]+=`
`+c.slice(1):i.push(c);const s={parent:[]};for(const c of i){const d=c.slice(0,c.indexOf(" ")),w=c.slice(c.indexOf(" ")+1);Array.isArray(s[d])?s[d].push(w):s[d]=w}return s.author&&(s.author=ni(s.author)),s.committer&&(s.committer=ni(s.committer)),s}static renderHeaders(t){let i="";if(t.tree?i+=`tree ${t.tree}
`:i+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,t.parent){if(t.parent.length===void 0)throw new y("commit 'parent' property should be an array");for(const d of t.parent)i+=`parent ${d}
`}const s=t.author;i+=`author ${Wi(s)}
`;const c=t.committer||t.author;return i+=`committer ${Wi(c)}
`,t.gpgsig&&(i+="gpgsig"+qi(t.gpgsig)),i}static render(t){return mt.renderHeaders(t)+`
`+lr(t.message)}render(){return this._commit}withoutSignature(){const t=lr(this._commit);if(t.indexOf(`
gpgsig`)===-1)return t;const i=t.slice(0,t.indexOf(`
gpgsig`)),s=t.slice(t.indexOf(`-----END PGP SIGNATURE-----
`)+28);return lr(i+`
`+s)}isolateSignature(){const t=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return Fh(t)}static async sign(t,i,s){const c=t.withoutSignature(),d=mt.justMessage(t._commit);let{signature:w}=await i({payload:c,secretKey:s});w=lr(w);const I=mt.justHeaders(t._commit)+`
gpgsig`+qi(w)+`
`+d;return mt.from(I)}}async function qr({fs:a,cache:t,gitdir:i,oid:s}){if(s==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:Ce.from([]),oid:s};const{type:c,object:d}=await dt({fs:a,cache:t,gitdir:i,oid:s});if(c==="tag")return s=$t.from(d).parse().object,qr({fs:a,cache:t,gitdir:i,oid:s});if(c==="commit")return s=mt.from(d).parse().tree,qr({fs:a,cache:t,gitdir:i,oid:s});if(c!=="tree")throw new We(s,c,"tree");return{tree:Ce.from(d),oid:s}}class Dh{constructor({fs:t,gitdir:i,ref:s,cache:c}){this.fs=t,this.cache=c,this.gitdir=i,this.mapPromise=(async()=>{const w=new Map;let v;try{v=await H.resolve({fs:t,gitdir:i,ref:s})}catch(C){C instanceof He&&(v="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const I=await qr({fs:t,cache:this.cache,gitdir:i,oid:v});return I.type="tree",I.mode="40000",w.set(".",I),w})();const d=this;this.ConstructEntry=class{constructor(v){this._fullpath=v,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return d.type(this)}async mode(){return d.mode(this)}async stat(){return d.stat(this)}async content(){return d.content(this)}async oid(){return d.oid(this)}}}async readdir(t){const i=t._fullpath,{fs:s,cache:c,gitdir:d}=this,w=await this.mapPromise,v=w.get(i);if(!v)throw new Error(`No obj for ${i}`);const I=v.oid;if(!I)throw new Error(`No oid for obj ${JSON.stringify(v)}`);if(v.type!=="tree")return null;const{type:C,object:k}=await dt({fs:s,cache:c,gitdir:d,oid:I});if(C!==v.type)throw new We(I,C,v.type);const j=Ce.from(k);for(const F of j)w.set(g(i,F.path),F);return j.entries().map(F=>g(i,F.path))}async type(t){if(t._type===!1){const i=await this.mapPromise,{type:s}=i.get(t._fullpath);t._type=s}return t._type}async mode(t){if(t._mode===!1){const i=await this.mapPromise,{mode:s}=i.get(t._fullpath);t._mode=L(parseInt(s,8))}return t._mode}async stat(t){}async content(t){if(t._content===!1){const i=await this.mapPromise,{fs:s,cache:c,gitdir:d}=this,v=i.get(t._fullpath).oid,{type:I,object:C}=await dt({fs:s,cache:c,gitdir:d,oid:v});I!=="blob"?t._content=void 0:t._content=new Uint8Array(C)}return t._content}async oid(t){if(t._oid===!1){const s=(await this.mapPromise).get(t._fullpath);t._oid=s.oid}return t._oid}}function Gt({ref:a="HEAD"}={}){const t=Object.create(null);return Object.defineProperty(t,it,{value:function({fs:i,gitdir:s,cache:c}){return new Dh({fs:i,gitdir:s,ref:a,cache:c})}}),Object.freeze(t),t}class Lh{constructor({fs:t,dir:i,gitdir:s,cache:c}){this.fs=t,this.cache=c,this.dir=i,this.gitdir=s,this.config=null;const d=this;this.ConstructEntry=class{constructor(v){this._fullpath=v,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return d.type(this)}async mode(){return d.mode(this)}async stat(){return d.stat(this)}async content(){return d.content(this)}async oid(){return d.oid(this)}}}async readdir(t){const i=t._fullpath,{fs:s,dir:c}=this,d=await s.readdir(g(c,i));return d===null?null:d.map(w=>g(i,w))}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const{fs:i,dir:s}=this;let c=await i.lstat(`${s}/${t._fullpath}`);if(!c)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);let d=c.isDirectory()?"tree":"blob";d==="blob"&&!c.isFile()&&!c.isSymbolicLink()&&(d="special"),t._type=d,c=G(c),t._mode=c.mode,c.size===-1&&t._actualSize&&(c.size=t._actualSize),t._stat=c}return t._stat}async content(t){if(t._content===!1){const{fs:i,dir:s,gitdir:c}=this;if(await t.type()==="tree")t._content=void 0;else{let d;if(await t.mode()>>12===10)d=await i.readlink(`${s}/${t._fullpath}`);else{const v=await(await this._getGitConfig(i,c)).get("core.autocrlf");d=await i.read(`${s}/${t._fullpath}`,{autocrlf:v})}t._actualSize=d.length,t._stat&&t._stat.size===-1&&(t._stat.size=t._actualSize),t._content=new Uint8Array(d)}}return t._content}async oid(t){if(t._oid===!1){const i=this,{fs:s,gitdir:c,cache:d}=this;let w;await ce.acquire({fs:s,gitdir:c,cache:d},async function(v){const I=v.entriesMap.get(t._fullpath),C=await t.stat(),j=await(await i._getGitConfig(s,c)).get("core.filemode"),F=typeof process<"u"?process.platform!=="win32":!0;if(!I||oe(C,I,j,F)){const V=await t.content();V===void 0?w=void 0:(w=await Y(et.wrap({type:"blob",object:V})),I&&w===I.oid&&(!j||C.mode===I.mode)&&oe(C,I,j,F)&&v.insert({filepath:t._fullpath,stats:C,oid:w}))}else w=I.oid}),t._oid=w}return t._oid}async _getGitConfig(t,i){return this.config?this.config:(this.config=await he.get({fs:t,gitdir:i}),this.config)}}function Vr(){const a=Object.create(null);return Object.defineProperty(a,it,{value:function({fs:t,dir:i,gitdir:s,cache:c}){return new Lh({fs:t,dir:i,gitdir:s,cache:c})}}),Object.freeze(a),a}function $h(a,t){const i=t-a;return Array.from({length:i},(s,c)=>a+c)}const js=typeof Array.prototype.flat>"u"?a=>a.reduce((t,i)=>t.concat(i),[]):a=>a.flat();class Nh{constructor(){this.value=null}consider(t){t!=null&&(this.value===null?this.value=t:t<this.value&&(this.value=t))}reset(){this.value=null}}function*Uh(a){const t=new Nh;let i;const s=[],c=a.length;for(let d=0;d<c;d++)s[d]=a[d].next().value,s[d]!==void 0&&t.consider(s[d]);if(t.value!==null)for(;;){const d=[];i=t.value,t.reset();for(let w=0;w<c;w++)s[w]!==void 0&&s[w]===i?(d[w]=s[w],s[w]=a[w].next().value):d[w]=null,s[w]!==void 0&&t.consider(s[w]);if(yield d,t.value===null)return}}async function pr({fs:a,cache:t,dir:i,gitdir:s,trees:c,map:d=async(I,C)=>C,reduce:w=async(I,C)=>{const k=js(C);return I!==void 0&&k.unshift(I),k},iterate:v=(I,C)=>Promise.all([...C].map(I))}){const I=c.map(V=>V[it]({fs:a,dir:i,gitdir:s,cache:t})),C=new Array(I.length).fill("."),k=$h(0,I.length),j=async V=>{k.forEach(pe=>{const we=V[pe];V[pe]=we&&new I[pe].ConstructEntry(we)});const me=(await Promise.all(k.map(pe=>{const we=V[pe];return we?I[pe].readdir(we):[]}))).map(pe=>(pe===null?[]:pe)[Symbol.iterator]());return{entries:V,children:Uh(me)}},F=async V=>{const{entries:re,children:me}=await j(V),pe=re.find(be=>be&&be._fullpath)._fullpath,we=await d(pe,re);if(we!==null){let be=await v(F,me);return be=be.filter(Ie=>Ie!==void 0),w(we,be)}};return F(C)}async function Vi(a,t){const i=await a.readdir(t);i==null?await a.rm(t):i.length?await Promise.all(i.map(s=>{const c=g(t,s);return a.lstat(c).then(d=>{if(d)return d.isDirectory()?Vi(a,c):a.rm(c)})})).then(()=>a.rmdir(t)):await a.rmdir(t)}function zh(a){return Gh(a)&&Bs(a.then)&&Bs(a.catch)}function Gh(a){return a&&typeof a=="object"}function Bs(a){return typeof a=="function"}function Fs(a){return zh((i=>{try{return i.readFile().catch(s=>s)}catch(s){return s}})(a))}const Ds=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function Ls(a,t){if(Fs(t))for(const i of Ds)a[`_${i}`]=t[i].bind(t);else for(const i of Ds)a[`_${i}`]=u(t[i].bind(t));Fs(t)?(t.cp&&(a._cp=t.cp.bind(t)),t.rm?a._rm=t.rm.bind(t):t.rmdir.length>1?a._rm=t.rmdir.bind(t):a._rm=Vi.bind(null,a)):(t.cp&&(a._cp=u(t.cp.bind(t))),t.rm?a._rm=u(t.rm.bind(t)):t.rmdir.length>2?a._rm=u(t.rmdir.bind(t)):a._rm=Vi.bind(null,a))}class $e{constructor(t){if(typeof t._original_unwrapped_fs<"u")return t;const i=Object.getOwnPropertyDescriptor(t,"promises");i&&i.enumerable?Ls(this,t.promises):Ls(this,t),this._original_unwrapped_fs=t}async exists(t,i={}){try{return await this._stat(t),!0}catch(s){if(s.code==="ENOENT"||s.code==="ENOTDIR"||(s.code||"").includes("ENS"))return!1;throw s}}async read(t,i={}){try{let s=await this._readFile(t,i);if(i.autocrlf==="true")try{s=new TextDecoder("utf8",{fatal:!0}).decode(s),s=s.replace(/\r\n/g,`
`),s=new TextEncoder().encode(s)}catch{}return typeof s!="string"&&(s=Buffer.from(s)),s}catch{return null}}async write(t,i,s={}){try{await this._writeFile(t,i,s)}catch{await this.mkdir(xe(t)),await this._writeFile(t,i,s)}}async mkdir(t,i=!1){try{await this._mkdir(t)}catch(s){if(s===null||s.code==="EEXIST")return;if(i)throw s;if(s.code==="ENOENT"){const c=xe(t);if(c==="."||c==="/"||c===t)throw s;await this.mkdir(c),await this.mkdir(t,!0)}}}async rm(t){try{await this._unlink(t)}catch(i){if(i.code!=="ENOENT")throw i}}async rmdir(t,i){try{i&&i.recursive?await this._rm(t,i):await this._rmdir(t)}catch(s){if(s.code!=="ENOENT")throw s}}async readdir(t){try{const i=await this._readdir(t);return i.sort(z),i}catch(i){return i.code==="ENOTDIR"?null:[]}}async readdirDeep(t){const i=await this._readdir(t);return(await Promise.all(i.map(async c=>{const d=t+"/"+c;return(await this._stat(d)).isDirectory()?this.readdirDeep(d):d}))).reduce((c,d)=>c.concat(d),[])}async lstat(t){try{return await this._lstat(t)}catch(i){if(i.code==="ENOENT"||(i.code||"").includes("ENS"))return null;throw i}}async readlink(t,i={encoding:"buffer"}){try{const s=await this._readlink(t,i);return Buffer.isBuffer(s)?s:Buffer.from(s)}catch(s){if(s.code==="ENOENT"||(s.code||"").includes("ENS"))return null;throw s}}async writelink(t,i){return this._symlink(i.toString("utf8"),t)}}function J(a,t){if(t===void 0)throw new Ut(a)}async function Ue({fsp:a,dotgit:t}){J("fsp",a),J("dotgit",t);const i=await a._stat(t).catch(()=>({isFile:()=>!1,isDirectory:()=>!1}));return i.isDirectory()?t:i.isFile()?a._readFile(t,"utf8").then(s=>s.trimRight().substr(8)).then(s=>g(xe(t),s)):t}async function ii(a,t){return!a&&!t?!1:a&&!t||!a&&t?!0:!(await a.type()==="tree"&&await t.type()==="tree"||await a.type()===await t.type()&&await a.mode()===await t.mode()&&await a.oid()===await t.oid())}async function $s({fs:a,dir:t,gitdir:i=g(t,".git"),commit:s="HEAD",cache:c={}}){try{J("fs",a),J("dir",t),J("gitdir",i);const d=new $e(a),w=[Gt({ref:s}),Vr(),Qe()];let v=[];const I=await Ue({fsp:d,dotgit:i});await ce.acquire({fs:d,gitdir:I,cache:c},async function(k){v=k.unmergedPaths});const C=await pr({fs:d,cache:c,dir:t,gitdir:I,trees:w,map:async function(k,[j,F,V]){const re=!await ii(F,V),me=v.includes(k),pe=!await ii(V,j);if(re||me)return j?{path:k,mode:await j.mode(),oid:await j.oid(),type:await j.type(),content:await j.content()}:void 0;if(pe)return!1;throw new xn(k)}});await ce.acquire({fs:d,gitdir:I,cache:c},async function(k){for(const j of C)if(j!==!1){if(!j){await d.rmdir(`${t}/${j.path}`,{recursive:!0}),k.delete({filepath:j.path});continue}if(j.type==="blob"){const F=new TextDecoder().decode(j.content);await d.write(`${t}/${j.path}`,F,{mode:j.mode}),k.insert({filepath:j.path,oid:j.oid,stage:0})}}})}catch(d){throw d.caller="git.abortMerge",d}}class Zr{static async isIgnored({fs:t,dir:i,gitdir:s=g(i,".git"),filepath:c}){if(Fe(c)===".git")return!0;if(c===".")return!1;let d="";const w=g(s,"info","exclude");await t.exists(w)&&(d=await t.read(w,"utf8"));const v=[{gitignore:g(i,".gitignore"),filepath:c}],I=c.split("/").filter(Boolean);for(let k=1;k<I.length;k++){const j=I.slice(0,k).join("/"),F=I.slice(k).join("/");v.push({gitignore:g(i,j,".gitignore"),filepath:F})}let C=!1;for(const k of v){let j;try{j=await t.read(k.gitignore,"utf8")}catch(re){if(re.code==="NOENT")continue}const F=p().add(d);F.add(j);const V=xe(k.filepath);if(V!=="."&&F.ignores(V))return!0;C?C=!F.test(k.filepath).unignored:C=F.test(k.filepath).ignored}return C}}async function Hh({fs:a,gitdir:t,object:i,format:s,oid:c}){const d=`objects/${c.slice(0,2)}/${c.slice(2)}`,w=`${t}/${d}`;await a.exists(w)||await a.write(w,i)}let Zi=null;async function Ns(a){return Zi===null&&(Zi=qh()),Zi?Wh(a):l.deflate(a)}async function Wh(a){const t=new CompressionStream("deflate"),i=new Blob([a]).stream().pipeThrough(t);return new Uint8Array(await new Response(i).arrayBuffer())}function qh(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function zt({fs:a,gitdir:t,type:i,object:s,format:c="content",oid:d=void 0,dryRun:w=!1}){return c!=="deflated"&&(c!=="wrapped"&&(s=et.wrap({type:i,object:s})),d=await Y(s),s=Buffer.from(await Ns(s))),w||await Hh({fs:a,gitdir:t,object:s,format:"deflated",oid:d}),d}function Us(a){let t;for(;~(t=a.indexOf(92));)a[t]=47;return a}async function zs({fs:a,dir:t,gitdir:i=g(t,".git"),filepath:s,cache:c={},force:d=!1,parallel:w=!0}){try{J("fs",a),J("dir",t),J("gitdir",i),J("filepath",s);const v=new $e(a),I=await Ue({fsp:v,dotgit:i});await ce.acquire({fs:v,gitdir:I,cache:c},async C=>{const j=await(await he.get({fs:v,gitdir:I})).get("core.autocrlf");return Ki({dir:t,gitdir:I,fs:v,filepath:s,index:C,force:d,parallel:w,autocrlf:j})})}catch(v){throw v.caller="git.add",v}}async function Ki({dir:a,gitdir:t,fs:i,filepath:s,index:c,force:d,parallel:w,autocrlf:v}){s=Array.isArray(s)?s:[s];const I=s.map(async F=>{if(!d&&await Zr.isIgnored({fs:i,dir:a,gitdir:t,filepath:F}))return;const V=await i.lstat(g(a,F));if(!V)throw new He(F);if(V.isDirectory()){const re=await i.readdir(g(a,F));if(w){const me=re.map(pe=>Ki({dir:a,gitdir:t,fs:i,filepath:[g(F,pe)],index:c,force:d,parallel:w,autocrlf:v}));await Promise.all(me)}else for(const me of re)await Ki({dir:a,gitdir:t,fs:i,filepath:[g(F,me)],index:c,force:d,parallel:w,autocrlf:v})}else{const re=V.isSymbolicLink()?await i.readlink(g(a,F)).then(Us):await i.read(g(a,F),{autocrlf:v});if(re===null)throw new He(F);const me=await zt({fs:i,gitdir:t,type:"blob",object:re});c.insert({filepath:F,stats:V,oid:me})}}),C=await Promise.allSettled(I),k=C.filter(F=>F.status==="rejected").map(F=>F.reason);if(k.length>1)throw new wn(k);if(k.length===1)throw k[0];return C.filter(F=>F.status==="fulfilled"&&F.value).map(F=>F.value)}async function Sn({fs:a,gitdir:t,path:i}){return(await he.get({fs:a,gitdir:t})).get(i)}function Gs(a,...t){for(const i of t)if(i)for(const s of Object.keys(i)){const c=i[s];c!==void 0&&(a[s]=c)}return a}async function gr({fs:a,gitdir:t,author:i,commit:s}){const c=Math.floor(Date.now()/1e3),d={name:await Sn({fs:a,gitdir:t,path:"user.name"}),email:await Sn({fs:a,gitdir:t,path:"user.email"})||"",timestamp:c,timezoneOffset:new Date(c*1e3).getTimezoneOffset()},w=Gs({},d,s?s.author:void 0,i);if(w.name!==void 0)return w}async function Ar({fs:a,gitdir:t,author:i,committer:s,commit:c}){const d=Math.floor(Date.now()/1e3),w={name:await Sn({fs:a,gitdir:t,path:"user.name"}),email:await Sn({fs:a,gitdir:t,path:"user.email"})||"",timestamp:d,timezoneOffset:new Date(d*1e3).getTimezoneOffset()},v=Gs({},w,c?c.committer:void 0,i,s);if(v.name!==void 0)return v}async function Hs({fs:a,cache:t,gitdir:i,oid:s}){const{type:c,object:d}=await dt({fs:a,cache:t,gitdir:i,oid:s});if(c==="tag")return s=$t.from(d).parse().object,Hs({fs:a,cache:t,gitdir:i,oid:s});if(c!=="commit")throw new We(s,c,"commit");return{commit:mt.from(d),oid:s}}async function ir({fs:a,cache:t,gitdir:i,oid:s}){const{commit:c,oid:d}=await Hs({fs:a,cache:t,gitdir:i,oid:s});return{oid:d,commit:c.parse(),payload:c.withoutSignature()}}async function kn({fs:a,cache:t,onSign:i,gitdir:s,message:c,author:d,committer:w,signingKey:v,amend:I=!1,dryRun:C=!1,noUpdateBranch:k=!1,ref:j,parent:F,tree:V}){let re=!1,me=!1;j||(me=!(await a.read(`${s}/HEAD`,{encoding:"utf8"})).startsWith("ref:"),j=await H.resolve({fs:a,gitdir:s,ref:"HEAD",depth:2}));let pe,we;try{pe=await H.resolve({fs:a,gitdir:s,ref:j}),we=await ir({fs:a,gitdir:s,oid:pe,cache:{}})}catch{re=!0}if(I&&re)throw new _n(j);const be=I?await gr({fs:a,gitdir:s,author:d,commit:we.commit}):await gr({fs:a,gitdir:s,author:d});if(!be)throw new Rt("author");const Ie=I?await Ar({fs:a,gitdir:s,author:be,committer:w,commit:we.commit}):await Ar({fs:a,gitdir:s,author:be,committer:w});if(!Ie)throw new Rt("committer");return ce.acquire({fs:a,gitdir:s,cache:t,allowUnmerged:!1},async function(je){const Le=Te(je.entries).get(".");if(V||(V=await Ws({fs:a,gitdir:s,inode:Le,dryRun:C})),F?F=await Promise.all(F.map(Re=>H.resolve({fs:a,gitdir:s,ref:Re}))):I?F=we.commit.parent:F=pe?[pe]:[],!c)if(I)c=we.commit.message;else throw new Ut("message");let Ee=mt.from({tree:V,parent:F,author:be,committer:Ie,message:c});v&&(Ee=await mt.sign(Ee,i,v));const Ae=await zt({fs:a,gitdir:s,type:"commit",object:Ee.toObject(),dryRun:C});return!k&&!C&&await H.writeRef({fs:a,gitdir:s,ref:me?"HEAD":j,value:Ae}),Ae})}async function Ws({fs:a,gitdir:t,inode:i,dryRun:s}){const c=i.children;for(const I of c)I.type==="tree"&&(I.metadata.mode="040000",I.metadata.oid=await Ws({fs:a,gitdir:t,inode:I,dryRun:s}));const d=c.map(I=>({mode:I.metadata.mode,path:I.basename,oid:I.metadata.oid,type:I.type})),w=Ce.from(d);return await zt({fs:a,gitdir:t,type:"tree",object:w.toObject(),dryRun:s})}async function En({fs:a,cache:t,gitdir:i,oid:s,filepath:c}){if(c.startsWith("/"))throw new dr("leading-slash");if(c.endsWith("/"))throw new dr("trailing-slash");const d=s,w=await qr({fs:a,cache:t,gitdir:i,oid:s}),v=w.tree;if(c==="")s=w.oid;else{const I=c.split("/");s=await qs({fs:a,cache:t,gitdir:i,tree:v,pathArray:I,oid:d,filepath:c})}return s}async function qs({fs:a,cache:t,gitdir:i,tree:s,pathArray:c,oid:d,filepath:w}){const v=c.shift();for(const I of s)if(I.path===v){if(c.length===0)return I.oid;{const{type:C,object:k}=await dt({fs:a,cache:t,gitdir:i,oid:I.oid});if(C!=="tree")throw new We(d,C,"tree",w);return s=Ce.from(k),qs({fs:a,cache:t,gitdir:i,tree:s,pathArray:c,oid:d,filepath:w})}}throw new He(`file or directory found at "${d}:${w}"`)}async function Kr({fs:a,cache:t,gitdir:i,oid:s,filepath:c=void 0}){c!==void 0&&(s=await En({fs:a,cache:t,gitdir:i,oid:s,filepath:c}));const{tree:d,oid:w}=await qr({fs:a,cache:t,gitdir:i,oid:s});return{oid:w,tree:d.entries()}}async function An({fs:a,gitdir:t,tree:i}){const s=Ce.from(i).toObject();return await zt({fs:a,gitdir:t,type:"tree",object:s,format:"content"})}async function Vh({fs:a,cache:t,onSign:i,gitdir:s,ref:c,oid:d,note:w,force:v,author:I,committer:C,signingKey:k}){let j;try{j=await H.resolve({gitdir:s,fs:a,ref:c})}catch(we){if(!(we instanceof He))throw we}let V=(await Kr({fs:a,cache:t,gitdir:s,oid:j||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(v)V=V.filter(we=>we.path!==d);else for(const we of V)if(we.path===d)throw new Qt("note",d);typeof w=="string"&&(w=Buffer.from(w,"utf8"));const re=await zt({fs:a,gitdir:s,type:"blob",object:w,format:"content"});V.push({mode:"100644",path:d,oid:re,type:"blob"});const me=await An({fs:a,gitdir:s,tree:V});return await kn({fs:a,cache:t,onSign:i,gitdir:s,ref:c,tree:me,parent:j&&[j],message:`Note added by 'isomorphic-git addNote'
`,author:I,committer:C,signingKey:k})}async function Vs({fs:a,onSign:t,dir:i,gitdir:s=g(i,".git"),ref:c="refs/notes/commits",oid:d,note:w,force:v,author:I,committer:C,signingKey:k,cache:j={}}){try{J("fs",a),J("gitdir",s),J("oid",d),J("note",w),k&&J("onSign",t);const F=new $e(a),V=await gr({fs:F,gitdir:s,author:I});if(!V)throw new Rt("author");const re=await Ar({fs:F,gitdir:s,author:V,committer:C});if(!re)throw new Rt("committer");const me=await Ue({fsp:F,dotgit:s});return await Vh({fs:F,cache:j,onSign:t,gitdir:me,ref:c,oid:d,note:w,force:v,author:V,committer:re,signingKey:k})}catch(F){throw F.caller="git.addNote",F}}const Zh=/(^|[/.])([/.]|$)|^@$|@{|[\x00-\x20\x7f~^:?*[\\]|\.lock(\/|$)/;function In(a,t){if(typeof a!="string")throw new TypeError("Reference name must be a string");return!Zh.test(a)&&!0}async function Zs({fs:a,gitdir:t,remote:i,url:s,force:c}){if(!In(i))throw new er(i,f.clean(i));const d=await he.get({fs:a,gitdir:t});if(!c&&(await d.getSubsections("remote")).includes(i)&&s!==await d.get(`remote.${i}.url`))throw new Qt("remote",i);await d.set(`remote.${i}.url`,s),await d.set(`remote.${i}.fetch`,`+refs/heads/*:refs/remotes/${i}/*`),await he.save({fs:a,gitdir:t,config:d})}async function Ks({fs:a,dir:t,gitdir:i=g(t,".git"),remote:s,url:c,force:d=!1}){try{J("fs",a),J("gitdir",i),J("remote",s),J("url",c);const w=new $e(a),v=await Ue({fsp:w,dotgit:i});return await Zs({fs:w,gitdir:v,remote:s,url:c,force:d})}catch(w){throw w.caller="git.addRemote",w}}async function Kh({fs:a,cache:t,onSign:i,gitdir:s,ref:c,tagger:d,message:w=c,gpgsig:v,object:I,signingKey:C,force:k=!1}){if(c=c.startsWith("refs/tags/")?c:`refs/tags/${c}`,!k&&await H.exists({fs:a,gitdir:s,ref:c}))throw new Qt("tag",c);const j=await H.resolve({fs:a,gitdir:s,ref:I||"HEAD"}),{type:F}=await dt({fs:a,cache:t,gitdir:s,oid:j});let V=$t.from({object:j,type:F,tag:c.replace("refs/tags/",""),tagger:d,message:w,gpgsig:v});C&&(V=await $t.sign(V,i,C));const re=await zt({fs:a,gitdir:s,type:"tag",object:V.toObject()});await H.writeRef({fs:a,gitdir:s,ref:c,value:re})}async function Xs({fs:a,onSign:t,dir:i,gitdir:s=g(i,".git"),ref:c,tagger:d,message:w=c,gpgsig:v,object:I,signingKey:C,force:k=!1,cache:j={}}){try{J("fs",a),J("gitdir",s),J("ref",c),C&&J("onSign",t);const F=new $e(a),V=await Ue({fsp:F,dotgit:s}),re=await gr({fs:F,gitdir:V,author:d});if(!re)throw new Rt("tagger");return await Kh({fs:F,cache:j,onSign:t,gitdir:V,ref:c,tagger:re,message:w,gpgsig:v,object:I,signingKey:C,force:k})}catch(F){throw F.caller="git.annotatedTag",F}}async function Xh({fs:a,gitdir:t,ref:i,object:s,checkout:c=!1,force:d=!1}){if(!In(i))throw new er(i,f.clean(i));const w=`refs/heads/${i}`;if(!d&&await H.exists({fs:a,gitdir:t,ref:w}))throw new Qt("branch",i,!1);let v;try{v=await H.resolve({fs:a,gitdir:t,ref:s||"HEAD"})}catch{}v&&await H.writeRef({fs:a,gitdir:t,ref:w,value:v}),c&&await H.writeSymbolicRef({fs:a,gitdir:t,ref:"HEAD",value:w})}async function Ys({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s,object:c,checkout:d=!1,force:w=!1}){try{J("fs",a),J("gitdir",i),J("ref",s);const v=new $e(a),I=await Ue({fsp:v,dotgit:i});return await Xh({fs:v,gitdir:I,ref:s,object:c,checkout:d,force:w})}catch(v){throw v.caller="git.branch",v}}const Js=(a,t)=>a==="."||t==null||t.length===0||t==="."?!0:t.length>=a.length?t.startsWith(a):a.startsWith(t);async function Xi({fs:a,cache:t,onProgress:i,onPostCheckout:s,dir:c,gitdir:d,remote:w,ref:v,filepaths:I,noCheckout:C,noUpdateHead:k,dryRun:j,force:F,track:V=!0,nonBlocking:re=!1,batchSize:me=100}){let pe;if(s)try{pe=await H.resolve({fs:a,gitdir:d,ref:"HEAD"})}catch{pe="0000000000000000000000000000000000000000"}let we;try{we=await H.resolve({fs:a,gitdir:d,ref:v})}catch(be){if(v==="HEAD")throw be;const Ie=`${w}/${v}`;if(we=await H.resolve({fs:a,gitdir:d,ref:Ie}),V){const je=await he.get({fs:a,gitdir:d});await je.set(`branch.${v}.remote`,w),await je.set(`branch.${v}.merge`,`refs/heads/${v}`),await he.save({fs:a,gitdir:d,config:je})}await H.writeRef({fs:a,gitdir:d,ref:`refs/heads/${v}`,value:we})}if(!C){let be;try{be=await Yh({fs:a,cache:t,onProgress:i,dir:c,gitdir:d,ref:v,force:F,filepaths:I})}catch(Ee){throw Ee instanceof He&&Ee.data.what===we?new dn(v,we):Ee}const Ie=be.filter(([Ee])=>Ee==="conflict").map(([Ee,Ae])=>Ae);if(Ie.length>0)throw new cn(Ie);const je=be.filter(([Ee])=>Ee==="error").map(([Ee,Ae])=>Ae);if(je.length>0)throw new y(je.join(", "));if(j){s&&await s({previousHead:pe,newHead:we,type:I!=null&&I.length>0?"file":"branch"});return}let De=0;const Le=be.length;if(await ce.acquire({fs:a,gitdir:d,cache:t},async function(Ee){await Promise.all(be.filter(([Ae])=>Ae==="delete"||Ae==="delete-index").map(async function([Ae,Re]){const Ke=`${c}/${Re}`;Ae==="delete"&&await a.rm(Ke),Ee.delete({filepath:Re}),i&&await i({phase:"Updating workdir",loaded:++De,total:Le})}))}),await ce.acquire({fs:a,gitdir:d,cache:t},async function(Ee){for(const[Ae,Re]of be)if(Ae==="rmdir"||Ae==="rmdir-index"){const Ke=`${c}/${Re}`;try{Ae==="rmdir"&&await a.rmdir(Ke),Ee.delete({filepath:Re}),i&&await i({phase:"Updating workdir",loaded:++De,total:Le})}catch(lt){if(lt.code!=="ENOTEMPTY")throw lt}}}),await Promise.all(be.filter(([Ee])=>Ee==="mkdir"||Ee==="mkdir-index").map(async function([Ee,Ae]){const Re=`${c}/${Ae}`;await a.mkdir(Re),i&&await i({phase:"Updating workdir",loaded:++De,total:Le})})),re){const Ee=be.filter(([Re])=>Re==="create"||Re==="create-index"||Re==="update"||Re==="mkdir-index"),Ae=await Qs("Update Working Dir",Ee.map(([Re,Ke,lt,At,ct])=>()=>Qh({fs:a,cache:t,gitdir:d,dir:c},[Re,Ke,lt,At,ct])),i,me);await ce.acquire({fs:a,gitdir:d,cache:t,allowUnmerged:!0},async function(Re){await Qs("Update Index",Ae.map(([Ke,lt,At])=>()=>Jh({index:Re,fullpath:Ke,oid:lt,stats:At})),i,me)})}else await ce.acquire({fs:a,gitdir:d,cache:t,allowUnmerged:!0},async function(Ee){await Promise.all(be.filter(([Ae])=>Ae==="create"||Ae==="create-index"||Ae==="update"||Ae==="mkdir-index").map(async function([Ae,Re,Ke,lt,At]){const ct=`${c}/${Re}`;try{if(Ae!=="create-index"&&Ae!=="mkdir-index"){const{object:Ot}=await dt({fs:a,cache:t,gitdir:d,oid:Ke});if(At&&await a.rm(ct),lt===33188)await a.write(ct,Ot);else if(lt===33261)await a.write(ct,Ot,{mode:511});else if(lt===40960)await a.writelink(ct,Ot);else throw new y(`Invalid mode 0o${lt.toString(8)} detected in blob ${Ke}`)}const Tt=await a.lstat(ct);lt===33261&&(Tt.mode=493),Ae==="mkdir-index"&&(Tt.mode=57344),Ee.insert({filepath:Re,stats:Tt,oid:Ke}),i&&await i({phase:"Updating workdir",loaded:++De,total:Le})}catch{}}))});s&&await s({previousHead:pe,newHead:we,type:I!=null&&I.length>0?"file":"branch"})}if(!k){const be=await H.expand({fs:a,gitdir:d,ref:v});be.startsWith("refs/heads")?await H.writeSymbolicRef({fs:a,gitdir:d,ref:"HEAD",value:be}):await H.writeRef({fs:a,gitdir:d,ref:"HEAD",value:we})}}async function Yh({fs:a,cache:t,onProgress:i,dir:s,gitdir:c,ref:d,force:w,filepaths:v}){let I=0;return pr({fs:a,cache:t,dir:s,gitdir:c,trees:[Gt({ref:d}),Vr(),Qe()],map:async function(C,[k,j,F]){if(C===".")return;if(v&&!v.some(re=>Js(C,re)))return null;switch(i&&await i({phase:"Analyzing workdir",loaded:++I}),[!!F,!!k,!!j].map(Number).join("")){case"000":return;case"001":return w&&v&&v.includes(C)?["delete",C]:void 0;case"010":switch(await k.type()){case"tree":return["mkdir",C];case"blob":return["create",C,await k.oid(),await k.mode()];case"commit":return["mkdir-index",C,await k.oid(),await k.mode()];default:return["error",`new entry Unhandled type ${await k.type()}`]}case"011":switch(`${await k.type()}-${await j.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",C];case"blob-blob":return await k.oid()!==await j.oid()?w?["update",C,await k.oid(),await k.mode(),await k.mode()!==await j.mode()]:["conflict",C]:await k.mode()!==await j.mode()?w?["update",C,await k.oid(),await k.mode(),!0]:["conflict",C]:["create-index",C,await k.oid(),await k.mode()];case"commit-tree":return;case"commit-blob":return["conflict",C];default:return["error",`new entry Unhandled type ${k.type}`]}case"100":return["delete-index",C];case"101":switch(await F.type()){case"tree":return["rmdir-index",C];case"blob":return await F.oid()!==await j.oid()?w?["delete",C]:["conflict",C]:["delete",C];case"commit":return["rmdir-index",C];default:return["error",`delete entry Unhandled type ${await F.type()}`]}case"110":case"111":switch(`${await F.type()}-${await k.type()}`){case"tree-tree":return;case"blob-blob":{if(await F.oid()===await k.oid()&&await F.mode()===await k.mode()&&!w)return;if(j){if(await j.oid()!==await F.oid()&&await j.oid()!==await k.oid())return w?["update",C,await k.oid(),await k.mode(),await k.mode()!==await j.mode()]:["conflict",C]}else if(w)return["update",C,await k.oid(),await k.mode(),await k.mode()!==await F.mode()];return await k.mode()!==await F.mode()?["update",C,await k.oid(),await k.mode(),!0]:await k.oid()!==await F.oid()?["update",C,await k.oid(),await k.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",C,await k.oid()];case"blob-tree":return["update-blob-to-tree",C];case"commit-commit":return["mkdir-index",C,await k.oid(),await k.mode()];default:return["error",`update entry Unhandled type ${await F.type()}-${await k.type()}`]}}},reduce:async function(C,k){return k=js(k),C?C&&C[0]==="rmdir"?(k.push(C),k):(k.unshift(C),k):k}})}async function Jh({index:a,fullpath:t,stats:i,oid:s}){try{a.insert({filepath:t,stats:i,oid:s})}catch{}}async function Qh({fs:a,cache:t,gitdir:i,dir:s},[c,d,w,v,I]){const C=`${s}/${d}`;if(c!=="create-index"&&c!=="mkdir-index"){const{object:j}=await dt({fs:a,cache:t,gitdir:i,oid:w});if(I&&await a.rm(C),v===33188)await a.write(C,j);else if(v===33261)await a.write(C,j,{mode:511});else if(v===40960)await a.writelink(C,j);else throw new y(`Invalid mode 0o${v.toString(8)} detected in blob ${w}`)}const k=await a.lstat(C);return v===33261&&(k.mode=493),c==="mkdir-index"&&(k.mode=57344),[d,w,k]}async function Qs(a,t,i,s){const c=[];try{for(let d=0;d<t.length;d+=s){const w=t.slice(d,d+s).map(I=>I());(await Promise.allSettled(w)).forEach(I=>{I.status==="fulfilled"&&c.push(I.value)}),i&&await i({phase:"Updating workdir",loaded:d+w.length,total:t.length})}return c}catch{}return c}async function Yi({fs:a,onProgress:t,onPostCheckout:i,dir:s,gitdir:c=g(s,".git"),remote:d="origin",ref:w,filepaths:v,noCheckout:I=!1,noUpdateHead:C=w===void 0,dryRun:k=!1,force:j=!1,track:F=!0,cache:V={},nonBlocking:re=!1,batchSize:me=100}){try{J("fs",a),J("dir",s),J("gitdir",c);const pe=w||"HEAD",we=new $e(a),be=await Ue({fsp:we,dotgit:c});return await Xi({fs:we,cache:V,onProgress:t,onPostCheckout:i,dir:s,gitdir:be,remote:d,ref:pe,filepaths:v,noCheckout:I,noUpdateHead:C,dryRun:k,force:j,track:F,nonBlocking:re,batchSize:me})}catch(pe){throw pe.caller="git.checkout",pe}}const Ji=/^.*(\r?\n|$)/gm;function ep({branches:a,contents:t}){const i=a[1],s=a[2],c=t[0],d=t[1],w=t[2],v=d.match(Ji),I=c.match(Ji),C=w.match(Ji),k=h(v,I,C),j=7;let F="",V=!0;for(const re of k)re.ok&&(F+=re.ok.join("")),re.conflict&&(V=!1,F+=`${"<".repeat(j)} ${i}
`,F+=re.conflict.a.join(""),F+=`${"=".repeat(j)}
`,F+=re.conflict.b.join(""),F+=`${">".repeat(j)} ${s}
`);return{cleanMerge:V,mergedText:F}}async function el({fs:a,cache:t,dir:i,gitdir:s=g(i,".git"),index:c,ourOid:d,baseOid:w,theirOid:v,ourName:I="ours",baseName:C="base",theirName:k="theirs",dryRun:j=!1,abortOnConflict:F=!0,mergeDriver:V}){const re=Gt({ref:d}),me=Gt({ref:w}),pe=Gt({ref:v}),we=[],be=[],Ie=[],je=[],De=await pr({fs:a,cache:t,dir:i,gitdir:s,trees:[re,me,pe],map:async function(Le,[Ee,Ae,Re]){const Ke=Fe(Le),lt=await ii(Ee,Ae),At=await ii(Re,Ae);switch(`${lt}-${At}`){case"false-false":return{mode:await Ae.mode(),path:Ke,oid:await Ae.oid(),type:await Ae.type()};case"false-true":return!Re&&await Ee.type()==="tree"?{mode:await Ee.mode(),path:Ke,oid:await Ee.oid(),type:await Ee.type()}:Re?{mode:await Re.mode(),path:Ke,oid:await Re.oid(),type:await Re.type()}:void 0;case"true-false":return!Ee&&await Re.type()==="tree"?{mode:await Re.mode(),path:Ke,oid:await Re.oid(),type:await Re.type()}:Ee?{mode:await Ee.mode(),path:Ke,oid:await Ee.oid(),type:await Ee.type()}:void 0;case"true-true":{if(Ee&&Re&&await Ee.type()==="tree"&&await Re.type()==="tree")return{mode:await Ee.mode(),path:Ke,oid:await Ee.oid(),type:"tree"};if(Ee&&Re&&await Ee.type()==="blob"&&await Re.type()==="blob")return tp({fs:a,gitdir:s,path:Ke,ours:Ee,base:Ae,theirs:Re,ourName:I,baseName:C,theirName:k,mergeDriver:V}).then(async ct=>{if(ct.cleanMerge)F||c.insert({filepath:Le,oid:ct.mergeResult.oid,stage:0});else if(we.push(Le),be.push(Le),!F){let Tt="";Ae&&await Ae.type()==="blob"&&(Tt=await Ae.oid());const Ot=await Ee.oid(),Cr=await Re.oid();c.delete({filepath:Le}),Tt&&c.insert({filepath:Le,oid:Tt,stage:1}),c.insert({filepath:Le,oid:Ot,stage:2}),c.insert({filepath:Le,oid:Cr,stage:3})}return ct.mergeResult});if(Ae&&!Ee&&Re&&await Ae.type()==="blob"&&await Re.type()==="blob"){if(we.push(Le),Ie.push(Le),!F){const ct=await Ae.oid(),Tt=await Re.oid();c.delete({filepath:Le}),c.insert({filepath:Le,oid:ct,stage:1}),c.insert({filepath:Le,oid:Tt,stage:3})}return{mode:await Re.mode(),oid:await Re.oid(),type:"blob",path:Ke}}if(Ae&&Ee&&!Re&&await Ae.type()==="blob"&&await Ee.type()==="blob"){if(we.push(Le),je.push(Le),!F){const ct=await Ae.oid(),Tt=await Ee.oid();c.delete({filepath:Le}),c.insert({filepath:Le,oid:ct,stage:1}),c.insert({filepath:Le,oid:Tt,stage:2})}return{mode:await Ee.mode(),oid:await Ee.oid(),type:"blob",path:Ke}}if(Ae&&!Ee&&!Re&&(await Ae.type()==="blob"||await Ae.type()==="tree"))return;throw new Gr}}},reduce:we.length!==0&&(!i||F)?void 0:async(Le,Ee)=>{const Ae=Ee.filter(Boolean);if(Le&&!(Le&&Le.type==="tree"&&Ae.length===0&&Le.path!==".")){if(Ae.length>0||Le.path==="."&&Ae.length===0){const Ke=new Ce(Ae).toObject(),lt=await zt({fs:a,gitdir:s,type:"tree",object:Ke,dryRun:j});Le.oid=lt}return Le}}});return we.length!==0?(i&&!F&&await pr({fs:a,cache:t,dir:i,gitdir:s,trees:[Gt({ref:De.oid})],map:async function(Le,[Ee]){const Ae=`${i}/${Le}`;if(await Ee.type()==="blob"){const Re=await Ee.mode(),Ke=new TextDecoder().decode(await Ee.content());await a.write(Ae,Ke,{mode:Re})}return!0}}),new kr(we,be,Ie,je)):De.oid}async function tp({fs:a,gitdir:t,path:i,ours:s,base:c,theirs:d,ourName:w,theirName:v,baseName:I,dryRun:C,mergeDriver:k=ep}){const j="blob";let F="100755",V="",re="";c&&await c.type()==="blob"&&(F=await c.mode(),V=await c.oid(),re=Buffer.from(await c.content()).toString("utf8"));const me=F===await s.mode()?await d.mode():await s.mode();if(await s.oid()===await d.oid())return{cleanMerge:!0,mergeResult:{mode:me,path:i,oid:await s.oid(),type:j}};if(await s.oid()===V)return{cleanMerge:!0,mergeResult:{mode:me,path:i,oid:await d.oid(),type:j}};if(await d.oid()===V)return{cleanMerge:!0,mergeResult:{mode:me,path:i,oid:await s.oid(),type:j}};const pe=Buffer.from(await s.content()).toString("utf8"),we=Buffer.from(await d.content()).toString("utf8"),{mergedText:be,cleanMerge:Ie}=await k({branches:[I,w,v],contents:[re,pe,we],path:i}),je=await zt({fs:a,gitdir:t,type:"blob",object:Buffer.from(be,"utf8"),dryRun:C});return{cleanMerge:Ie,mergeResult:{mode:me,path:i,oid:je,type:j}}}const rp={stage:Qe,workdir:Vr};let Qi;async function Xr(a,t){return Qi===void 0&&(Qi=new n),Qi.acquire(a,t)}async function np(a,t,i,s,c=null){const d=g(i,s),w=await a.lstat(d);if(!w)throw new He(d);if(w.isDirectory())throw new y(`${d}: file expected, but found directory`);const v=c?await Vt({fs:a,gitdir:t,oid:c}):void 0;let I=v?c:void 0;return v||await Xr({fs:a,gitdir:t,currentFilepath:d},async()=>{const C=w.isSymbolicLink()?await a.readlink(d).then(Us):await a.read(d);if(C===null)throw new He(d);I=await zt({fs:a,gitdir:t,type:"blob",object:C})}),I}async function ip({fs:a,dir:t,gitdir:i,entries:s}){async function c(d){if(d.type==="tree"){if(!d.oid){const w=await Promise.all(d.children.map(c));d.oid=await An({fs:a,gitdir:i,tree:w}),d.mode=16384}}else d.type==="blob"&&(d.oid=await np(a,i,t,d.path,d.oid),d.mode=33188);return d.path=d.path.split("/").pop(),d}return Promise.all(s.map(c))}async function tl({fs:a,dir:t,gitdir:i,treePair:s}){const c=s[1]==="stage",d=s.map(V=>typeof V=="string"?rp[V]():V),w=[],k=await pr({fs:a,cache:{},dir:t,gitdir:i,trees:d,map:async(V,[re,me])=>{if(!(V==="."||await Zr.isIgnored({fs:a,dir:t,gitdir:i,filepath:V}))&&me)return(!re||await re.oid()!==await me.oid()&&await me.oid()!==void 0)&&w.push([re,me]),{mode:await me.mode(),path:V,oid:await me.oid(),type:await me.type()}},reduce:async(V,re)=>(re=re.filter(Boolean),V?(V.children=re,V):re.length>0?re:void 0),iterate:async(V,re)=>{const me=[];for(const pe of re){const[we,be]=pe;c?be&&(await a.exists(`${t}/${be.toString()}`)?me.push(pe):w.push([null,be])):we&&(be?me.push(pe):w.push([we,null]))}return me.length?Promise.all(me.map(V)):[]}});if(w.length===0||k.length===0)return null;const F=(await ip({fs:a,dir:t,gitdir:i,entries:k})).filter(Boolean).map(V=>({mode:V.mode,path:V.path,oid:V.oid,type:V.type}));return An({fs:a,gitdir:i,tree:F})}async function rl({fs:a,dir:t,gitdir:i,stashCommit:s,parentCommit:c,wasStaged:d}){const w=[],v=[],I=await pr({fs:a,cache:{},dir:t,gitdir:i,trees:[Gt({ref:c}),Gt({ref:s})],map:async(C,[k,j])=>{if(C==="."||await Zr.isIgnored({fs:a,dir:t,gitdir:i,filepath:C}))return;const F=j?await j.type():await k.type();if(F!=="tree"&&F!=="blob")return;if(!j&&k){const re=F==="tree"?"rmdir":"rm";return F==="tree"&&w.push(C),F==="blob"&&d&&v.push({filepath:C,oid:await k.oid()}),{method:re,filepath:C}}const V=await j.oid();if(!k||await k.oid()!==V)return F==="tree"?{method:"mkdir",filepath:C}:(d&&v.push({filepath:C,oid:V,stats:await a.lstat(g(t,C))}),{method:"write",filepath:C,oid:V})}});await Xr({fs:a,gitdir:i,dirRemoved:w,ops:I},async()=>{for(const C of I){const k=g(t,C.filepath);switch(C.method){case"rmdir":await a.rmdir(k);break;case"mkdir":await a.mkdir(k);break;case"rm":await a.rm(k);break;case"write":if(!w.some(j=>k.startsWith(j))){const{object:j}=await dt({fs:a,cache:{},gitdir:i,oid:C.oid});await a.exists(k)&&await a.rm(k),await a.write(k,j)}break}}}),await ce.acquire({fs:a,gitdir:i,cache:{}},async C=>{v.forEach(({filepath:k,stats:j,oid:F})=>{C.insert({filepath:k,stats:j,oid:F})})})}async function nl({fs:a,cache:t,dir:i,gitdir:s,oid:c,dryRun:d=!1,noUpdateBranch:w=!1,abortOnConflict:v=!0,committer:I,mergeDriver:C}){const{commit:k,oid:j}=await ir({fs:a,cache:t,gitdir:s,oid:c});if(k.parent.length>1)throw new un(j,k.parent.length);if(k.parent.length===0)throw new fn(j);const F=await H.resolve({fs:a,gitdir:s,ref:"HEAD"}),{commit:V}=await ir({fs:a,cache:t,gitdir:s,oid:F}),re=k.parent[0],{commit:me}=await ir({fs:a,cache:t,gitdir:s,oid:re}),pe=await ce.acquire({fs:a,gitdir:s,cache:t,allowUnmerged:!1},async be=>el({fs:a,cache:t,dir:i,gitdir:s,index:be,ourOid:V.tree,baseOid:me.tree,theirOid:k.tree,ourName:"HEAD",baseName:`parent of ${j.slice(0,7)}`,theirName:j.slice(0,7),dryRun:d,abortOnConflict:v,mergeDriver:C}));if(pe instanceof kr)throw pe;const we=await kn({fs:a,cache:t,gitdir:s,message:k.message,tree:pe,parent:[F],author:k.author,committer:I,dryRun:d,noUpdateBranch:w});return i&&!d&&!w&&await rl({fs:a,dir:i,gitdir:s,stashCommit:we,parentCommit:F,wasStaged:!0}),we}async function il({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,cache:c={},committer:d,dryRun:w=!1,noUpdateBranch:v=!1,abortOnConflict:I=!0,mergeDriver:C}){try{J("fs",a),J("gitdir",i),J("oid",s);const k=new $e(a),j=await Ue({fsp:k,dotgit:i}),{commit:F}=await ir({fs:k,cache:c,gitdir:j,oid:s});if(F.parent&&F.parent.length>1)return await nl({fs:k,cache:c,dir:t,gitdir:j,oid:s,dryRun:w,noUpdateBranch:v,abortOnConflict:I,committer:void 0,mergeDriver:C});const V=await Ar({fs:k,gitdir:j,committer:d});if(!V)throw new Rt("committer");return await nl({fs:k,cache:c,dir:t,gitdir:j,oid:s,dryRun:w,noUpdateBranch:v,abortOnConflict:I,committer:V,mergeDriver:C})}catch(k){throw k.caller="git.cherryPick",k}}const ap=/^refs\/(heads\/|tags\/|remotes\/)?(.*)/;function Ir(a){const t=ap.exec(a);return t?t[1]==="remotes/"&&a.endsWith("/HEAD")?t[2].slice(0,-5):t[2]:a}async function mr({fs:a,gitdir:t,fullname:i=!1,test:s=!1}){const c=await H.resolve({fs:a,gitdir:t,ref:"HEAD",depth:2});if(s)try{await H.resolve({fs:a,gitdir:t,ref:c})}catch{return}if(c.startsWith("refs/"))return i?c:Ir(c)}function op(a){return a=a.replace(/^git@([^:]+):/,"https://$1/"),a=a.replace(/^ssh:\/\//,"https://"),a}function al({username:a="",password:t=""}){return`Basic ${Buffer.from(`${a}:${t}`).toString("base64")}`}async function Tn(a,t){const i=_r(a);for(;;){const{value:s,done:c}=await i.next();if(s&&await t(s),c)break}i.return&&i.return()}async function ai(a){let t=0;const i=[];await Tn(a,d=>{i.push(d),t+=d.byteLength});const s=new Uint8Array(t);let c=0;for(const d of i)s.set(d,c),c+=d.byteLength;return s}function ol(a){let t=a.match(/^https?:\/\/([^/]+)@/);if(t==null)return{url:a,auth:{}};t=t[1];const[i,s]=t.split(":");return a=a.replace(`${t}@`,""),{url:a,auth:{username:i,password:s}}}function ea(a,t){const i=t.toString(16);return"0".repeat(a-i.length)+i}class _t{static flush(){return Buffer.from("0000","utf8")}static delim(){return Buffer.from("0001","utf8")}static encode(t){typeof t=="string"&&(t=Buffer.from(t));const i=t.length+4,s=ea(4,i);return Buffer.concat([Buffer.from(s,"utf8"),t])}static streamReader(t){const i=new Sr(t);return async function(){try{let c=await i.read(4);if(c==null)return!0;if(c=parseInt(c.toString("utf8"),16),c===0||c===1)return null;const d=await i.read(c-4);return d??!0}catch(c){return t.error=c,!0}}}}async function sl(a){const t={};let i;for(;i=await a(),i!==!0;){if(i===null)continue;i=i.toString("utf8").replace(/\n$/,"");const s=i.indexOf("=");if(s>-1){const c=i.slice(0,s),d=i.slice(s+1);t[c]=d}else t[i]=!0}return{protocolVersion:2,capabilities2:t}}async function ll(a,{service:t}){const i=new Set,s=new Map,c=new Map,d=_t.streamReader(a);let w=await d();for(;w===null;)w=await d();if(w===!0)throw new hn;if(w.includes("version 2"))return sl(d);if(w.toString("utf8").replace(/\n$/,"")!==`# service=${t}`)throw new Er(`# service=${t}\\n`,w.toString("utf8"));let v=await d();for(;v===null;)v=await d();if(v===!0)return{capabilities:i,refs:s,symrefs:c};if(v=v.toString("utf8"),v.includes("version 2"))return sl(d);const[I,C]=ta(v,"\0","\\x00");if(C.split(" ").map(k=>i.add(k)),I!=="0000000000000000000000000000000000000000 capabilities^{}"){const[k,j]=ta(I," "," ");for(s.set(j,k);;){const F=await d();if(F===!0)break;if(F!==null){const[V,re]=ta(F.toString("utf8")," "," ");s.set(re,V)}}}for(const k of i)if(k.startsWith("symref=")){const j=k.match(/symref=([^:]+):(.*)/);j.length===3&&c.set(j[1],j[2])}return{protocolVersion:1,capabilities:i,refs:s,symrefs:c}}function ta(a,t,i){const s=a.trim().split(t);if(s.length!==2)throw new Er(`Two strings separated by '${i}'`,a.toString("utf8"));return s}const cl=(a,t)=>a.endsWith("?")?`${a}${t}`:`${a}/${t.replace(/^https?:\/\//,"")}`,ul=(a,t)=>{(t.username||t.password)&&(a.Authorization=al(t)),t.headers&&Object.assign(a,t.headers)},ra=async a=>{try{const t=Buffer.from(await ai(a.body)),i=t.toString("utf8");return{preview:i.length<256?i:i.slice(0,256)+"...",response:i,data:t}}catch{return{}}};class oi{static async capabilities(){return["discover","connect"]}static async discover({http:t,onProgress:i,onAuth:s,onAuthSuccess:c,onAuthFailure:d,corsProxy:w,service:v,url:I,headers:C,protocolVersion:k}){let{url:j,auth:F}=ol(I);const V=w?cl(w,j):j;(F.username||F.password)&&(C.Authorization=al(F)),k===2&&(C["Git-Protocol"]="version=2");let re,me,pe=!1;do if(re=await t.request({onProgress:i,method:"GET",url:`${V}/info/refs?service=${v}`,headers:C}),me=!1,re.statusCode===401||re.statusCode===203){const we=pe?d:s;if(we){if(F=await we(j,{...F,headers:{...C}}),F&&F.cancel)throw new Wr;F&&(ul(C,F),pe=!0,me=!0)}}else re.statusCode===200&&pe&&c&&await c(j,F);while(me);if(re.statusCode!==200){const{response:we}=await ra(re);throw new zr(re.statusCode,re.statusMessage,we)}if(re.headers["content-type"]===`application/x-${v}-advertisement`){const we=await ll(re.body,{service:v});return we.auth=F,we}else{const{preview:we,response:be,data:Ie}=await ra(re);try{const je=await ll([Ie],{service:v});return je.auth=F,je}catch{throw new yn(we,be)}}}static async connect({http:t,onProgress:i,corsProxy:s,service:c,url:d,auth:w,body:v,headers:I}){const C=ol(d);C&&(d=C.url),s&&(d=cl(s,d)),I["content-type"]=`application/x-${c}-request`,I.accept=`application/x-${c}-result`,ul(I,w);const k=await t.request({onProgress:i,method:"POST",url:`${d}/${c}`,body:v,headers:I});if(k.statusCode!==200){const{response:j}=ra(k);throw new zr(k.statusCode,k.statusMessage,j)}return k}}class si{static getRemoteHelperFor({url:t}){const i=new Map;i.set("http",oi),i.set("https",oi);const s=sp({url:t});if(!s)throw new vn(t);if(i.has(s.transport))return i.get(s.transport);throw new bn(t,s.transport,s.transport==="ssh"?op(t):void 0)}}function sp({url:a}){if(a.startsWith("git@"))return{transport:"ssh",address:a};const t=a.match(/(\w+)(:\/\/|::)(.*)/);if(t!==null){if(t[2]==="://")return{transport:t[1],address:t[0]};if(t[2]==="::")return{transport:t[1],address:t[3]}}}let Tr=null;class Cn{static async read({fs:t,gitdir:i}){Tr===null&&(Tr=new n);const s=g(i,"shallow"),c=new Set;return await Tr.acquire(s,async function(){const d=await t.read(s,{encoding:"utf8"});if(d===null||d.trim()==="")return c;d.trim().split(`
`).map(w=>c.add(w))}),c}static async write({fs:t,gitdir:i,oids:s}){Tr===null&&(Tr=new n);const c=g(i,"shallow");if(s.size>0){const d=[...s].join(`
`)+`
`;await Tr.acquire(c,async function(){await t.write(c,d,{encoding:"utf8"})})}else await Tr.acquire(c,async function(){await t.rm(c)})}}async function lp({fs:a,gitdir:t,oid:i}){const s=`objects/${i.slice(0,2)}/${i.slice(2)}`;return a.exists(`${t}/${s}`)}async function cp({fs:a,cache:t,gitdir:i,oid:s,getExternalRefDelta:c}){let d=await a.readdir(g(i,"objects/pack"));d=d.filter(w=>w.endsWith(".idx"));for(const w of d){const v=`${i}/objects/pack/${w}`,I=await Hi({fs:a,cache:t,filename:v,getExternalRefDelta:c});if(I.error)throw new y(I.error);if(I.offsets.has(s))return!0}return!1}async function fl({fs:a,cache:t,gitdir:i,oid:s,format:c="content"}){const d=v=>dt({fs:a,cache:t,gitdir:i,oid:v});let w=await lp({fs:a,gitdir:i,oid:s});return w||(w=await cp({fs:a,cache:t,gitdir:i,oid:s,getExternalRefDelta:d})),w}function up(a){const c="5041434b"+"00000002"+"00000000";return a.slice(0,12).toString("hex")===c}function dl(a,t){const i=a.map(s=>s.split("=",1)[0]);return t.filter(s=>{const c=s.split("=",1)[0];return i.includes(c)})}const li={name:"isomorphic-git",version:"1.37.1",agent:"git/isomorphic-git@1.37.1"};class ci{constructor(){this._queue=[]}write(t){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const i=this._waiting;this._waiting=null,i({value:t})}else this._queue.push(t)}end(){if(this._ended=!0,this._waiting){const t=this._waiting;this._waiting=null,t({done:!0})}}destroy(t){this.error=t,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(t=>{this._waiting=t})}}function fp(a){const t=a.indexOf("\r"),i=a.indexOf(`
`);return t===-1&&i===-1?-1:t===-1?i+1:i===-1?t+1:i===t+1?i+1:Math.min(t,i)+1}function hl(a){const t=new ci;let i="";return(async()=>(await Tn(a,s=>{for(s=s.toString("utf8"),i+=s;;){const c=fp(i);if(c===-1)break;t.write(i.slice(0,c)),i=i.slice(c)}}),i.length>0&&t.write(i),t.end()))(),t}class pl{static demux(t){const i=_t.streamReader(t),s=new ci,c=new ci,d=new ci,w=async function(){const v=await i();if(v===null)return w();if(v===!0){s.end(),d.end(),t.error?c.destroy(t.error):c.end();return}switch(v[0]){case 1:{c.write(v.slice(1));break}case 2:{d.write(v.slice(1));break}case 3:{const I=v.slice(1);d.write(I),s.end(),d.end(),c.destroy(new Error(I.toString("utf8")));return}default:s.write(v)}w()};return w(),{packetlines:s,packfile:c,progress:d}}}async function dp(a){const{packetlines:t,packfile:i,progress:s}=pl.demux(a),c=[],d=[],w=[];let v=!1,I=!1;return new Promise((C,k)=>{Tn(t,j=>{const F=j.toString("utf8").trim();if(F.startsWith("shallow")){const V=F.slice(-41).trim();V.length!==40&&k(new rt(V)),c.push(V)}else if(F.startsWith("unshallow")){const V=F.slice(-41).trim();V.length!==40&&k(new rt(V)),d.push(V)}else if(F.startsWith("ACK")){const[,V,re]=F.split(" ");w.push({oid:V,status:re}),re||(I=!0)}else F.startsWith("NAK")?(v=!0,I=!0):(I=!0,v=!0);I&&(a.error?k(a.error):C({shallows:c,unshallows:d,acks:w,nak:v,packfile:i,progress:s}))}).finally(()=>{I||(a.error?k(a.error):C({shallows:c,unshallows:d,acks:w,nak:v,packfile:i,progress:s}))})})}function hp({capabilities:a=[],wants:t=[],haves:i=[],shallows:s=[],depth:c=null,since:d=null,exclude:w=[]}){const v=[];t=[...new Set(t)];let I=` ${a.join(" ")}`;for(const C of t)v.push(_t.encode(`want ${C}${I}
`)),I="";for(const C of s)v.push(_t.encode(`shallow ${C}
`));c!==null&&v.push(_t.encode(`deepen ${c}
`)),d!==null&&v.push(_t.encode(`deepen-since ${Math.floor(d.valueOf()/1e3)}
`));for(const C of w)v.push(_t.encode(`deepen-not ${C}
`));v.push(_t.flush());for(const C of i)v.push(_t.encode(`have ${C}
`));return v.push(_t.encode(`done
`)),v}async function na({fs:a,cache:t,http:i,onProgress:s,onMessage:c,onAuth:d,onAuthSuccess:w,onAuthFailure:v,gitdir:I,ref:C,remoteRef:k,remote:j,url:F,corsProxy:V,depth:re=null,since:me=null,exclude:pe=[],relative:we=!1,tags:be=!1,singleBranch:Ie=!1,headers:je={},prune:De=!1,pruneTags:Le=!1}){const Ee=C||await mr({fs:a,gitdir:I,test:!0}),Ae=await he.get({fs:a,gitdir:I}),Re=j||Ee&&await Ae.get(`branch.${Ee}.remote`)||"origin",Ke=F||await Ae.get(`remote.${Re}.url`);if(typeof Ke>"u")throw new Ut("remote OR url");const lt=k||Ee&&await Ae.get(`branch.${Ee}.merge`)||C||"HEAD";V===void 0&&(V=await Ae.get("http.corsProxy"));const At=si.getRemoteHelperFor({url:Ke}),ct=await At.discover({http:i,onAuth:d,onAuthSuccess:w,onAuthFailure:v,corsProxy:V,service:"git-upload-pack",url:Ke,headers:je,protocolVersion:1}),Tt=ct.auth,Ot=ct.refs;if(Ot.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(re!==null&&!ct.capabilities.has("shallow"))throw new hr("shallow","depth");if(me!==null&&!ct.capabilities.has("deepen-since"))throw new hr("deepen-since","since");if(pe.length>0&&!ct.capabilities.has("deepen-not"))throw new hr("deepen-not","exclude");if(we===!0&&!ct.capabilities.has("deepen-relative"))throw new hr("deepen-relative","relative");const{oid:Cr,fullref:Rr}=H.resolveAgainstMap({ref:lt,map:Ot});for(const ut of Ot.keys())ut===Rr||ut==="HEAD"||ut.startsWith("refs/heads/")||be&&ut.startsWith("refs/tags/")||Ot.delete(ut);const Yr=dl([...ct.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${li.agent}`]);we&&Yr.push("deepen-relative");const sa=Ie?[Cr]:Ot.values(),la=Ie?[Ee]:await H.listRefs({fs:a,gitdir:I,filepath:"refs"});let Ht=[];for(let ut of la)try{ut=await H.expand({fs:a,gitdir:I,ref:ut});const Mt=await H.resolve({fs:a,gitdir:I,ref:ut});await fl({fs:a,cache:t,gitdir:I,oid:Mt})&&Ht.push(Mt)}catch{}Ht=[...new Set(Ht)];const bt=await Cn.read({fs:a,gitdir:I}),ar=ct.capabilities.has("shallow")?[...bt]:[],Dt=hp({capabilities:Yr,wants:sa,haves:Ht,shallows:ar,depth:re,since:me,exclude:pe}),Rn=Buffer.from(await ai(Dt)),Or=await At.connect({http:i,onProgress:s,corsProxy:V,service:"git-upload-pack",url:Ke,auth:Tt,body:[Rn],headers:je}),It=await dp(Or.body);Or.headers&&(It.headers=Or.headers);for(const ut of It.shallows)if(!bt.has(ut))try{const{object:Mt}=await dt({fs:a,cache:t,gitdir:I,oid:ut}),Xt=new mt(Mt),or=await Promise.all(Xt.headers().parent.map(Mn=>fl({fs:a,cache:t,gitdir:I,oid:Mn})));or.length===0||or.every(Mn=>Mn)||bt.add(ut)}catch{bt.add(ut)}for(const ut of It.unshallows)bt.delete(ut);if(await Cn.write({fs:a,gitdir:I,oids:bt}),Ie){const ut=new Map([[Rr,Cr]]),Mt=new Map;let Xt=10,or=Rr;for(;Xt--;){const ua=ct.symrefs.get(or);if(ua===void 0)break;Mt.set(or,ua),or=ua}const ca=Ot.get(or);ca&&ut.set(or,ca);const{pruned:Mn}=await H.updateRemoteRefs({fs:a,gitdir:I,remote:Re,refs:ut,symrefs:Mt,tags:be,prune:De});De&&(It.pruned=Mn)}else{const{pruned:ut}=await H.updateRemoteRefs({fs:a,gitdir:I,remote:Re,refs:Ot,symrefs:ct.symrefs,tags:be,prune:De,pruneTags:Le});De&&(It.pruned=ut)}if(It.HEAD=ct.symrefs.get("HEAD"),It.HEAD===void 0){const{oid:ut}=H.resolveAgainstMap({ref:"HEAD",map:Ot});for(const[Mt,Xt]of Ot.entries())if(Mt!=="HEAD"&&Xt===ut){It.HEAD=Mt;break}}const Xp=Rr.startsWith("refs/tags")?"tag":"branch";if(It.FETCH_HEAD={oid:Cr,description:`${Xp} '${Ir(Rr)}' of ${Ke}`},s||c){const ut=hl(It.progress);Tn(ut,async Mt=>{if(c&&await c(Mt),s){const Xt=Mt.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);Xt&&await s({phase:Xt[1].trim(),loaded:parseInt(Xt[2],10),total:parseInt(Xt[3],10)})}})}const fi=Buffer.from(await ai(It.packfile));if(Or.body.error)throw Or.body.error;const Dc=fi.slice(-20).toString("hex"),On={defaultBranch:It.HEAD,fetchHead:It.FETCH_HEAD.oid,fetchHeadDescription:It.FETCH_HEAD.description};if(It.headers&&(On.headers=It.headers),De&&(On.pruned=It.pruned),Dc!==""&&!up(fi)){On.packfile=`objects/pack/pack-${Dc}.pack`;const ut=g(I,On.packfile);await a.write(ut,fi);const Mt=or=>dt({fs:a,cache:t,gitdir:I,oid:or}),Xt=await Ur.fromPack({pack:fi,getExternalRefDelta:Mt,onProgress:s});await a.write(ut.replace(/\.pack$/,".idx"),await Xt.toBuffer())}return On}async function gl({fs:a,bare:t=!1,dir:i,gitdir:s=t?i:g(i,".git"),defaultBranch:c="master"}){if(await a.exists(s+"/config"))return;let d=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];d=d.map(w=>s+"/"+w);for(const w of d)await a.mkdir(w);await a.write(s+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${t}
`+(t?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await a.write(s+"/HEAD",`ref: refs/heads/${c}
`)}async function pp({fs:a,cache:t,http:i,onProgress:s,onMessage:c,onAuth:d,onAuthSuccess:w,onAuthFailure:v,onPostCheckout:I,dir:C,gitdir:k,url:j,corsProxy:F,ref:V,remote:re,depth:me,since:pe,exclude:we,relative:be,singleBranch:Ie,noCheckout:je,noTags:De,headers:Le,nonBlocking:Ee,batchSize:Ae=100}){try{if(await gl({fs:a,gitdir:k}),await Zs({fs:a,gitdir:k,remote:re,url:j,force:!1}),F){const lt=await he.get({fs:a,gitdir:k});await lt.set("http.corsProxy",F),await he.save({fs:a,gitdir:k,config:lt})}const{defaultBranch:Re,fetchHead:Ke}=await na({fs:a,cache:t,http:i,onProgress:s,onMessage:c,onAuth:d,onAuthSuccess:w,onAuthFailure:v,gitdir:k,ref:V,remote:re,corsProxy:F,depth:me,since:pe,exclude:we,relative:be,singleBranch:Ie,headers:Le,tags:!De});if(Ke===null)return;V=V||Re,V=V.replace("refs/heads/",""),await Xi({fs:a,cache:t,onProgress:s,onPostCheckout:I,dir:C,gitdir:k,ref:V,remote:re,noCheckout:je,nonBlocking:Ee,batchSize:Ae})}catch(Re){throw await a.rmdir(k,{recursive:!0,maxRetries:10}).catch(()=>{}),Re}}async function ml({fs:a,http:t,onProgress:i,onMessage:s,onAuth:c,onAuthSuccess:d,onAuthFailure:w,onPostCheckout:v,dir:I,gitdir:C=g(I,".git"),url:k,corsProxy:j=void 0,ref:F=void 0,remote:V="origin",depth:re=void 0,since:me=void 0,exclude:pe=[],relative:we=!1,singleBranch:be=!1,noCheckout:Ie=!1,noTags:je=!1,headers:De={},cache:Le={},nonBlocking:Ee=!1,batchSize:Ae=100}){try{J("fs",a),J("http",t),J("gitdir",C),Ie||J("dir",I),J("url",k);const Re=new $e(a),Ke=await Ue({fsp:Re,dotgit:C});return await pp({fs:Re,cache:Le,http:t,onProgress:i,onMessage:s,onAuth:c,onAuthSuccess:d,onAuthFailure:w,onPostCheckout:v,dir:I,gitdir:Ke,url:k,corsProxy:j,ref:F,remote:V,depth:re,since:me,exclude:pe,relative:we,singleBranch:be,noCheckout:Ie,noTags:je,headers:De,nonBlocking:Ee,batchSize:Ae})}catch(Re){throw Re.caller="git.clone",Re}}async function wl({fs:a,onSign:t,dir:i,gitdir:s=g(i,".git"),message:c,author:d,committer:w,signingKey:v,amend:I=!1,dryRun:C=!1,noUpdateBranch:k=!1,ref:j,parent:F,tree:V,cache:re={}}){try{J("fs",a),I||J("message",c),v&&J("onSign",t);const me=new $e(a),pe=await Ue({fsp:me,dotgit:s});return await kn({fs:me,cache:re,onSign:t,gitdir:pe,message:c,author:d,committer:w,signingKey:v,amend:I,dryRun:C,noUpdateBranch:k,ref:j,parent:F,tree:V})}catch(me){throw me.caller="git.commit",me}}async function yl({fs:a,dir:t,gitdir:i=g(t,".git"),fullname:s=!1,test:c=!1}){try{J("fs",a),J("gitdir",i);const d=new $e(a),w=await Ue({fsp:d,dotgit:i});return await mr({fs:d,gitdir:w,fullname:s,test:c})}catch(d){throw d.caller="git.currentBranch",d}}async function gp({fs:a,gitdir:t,ref:i}){if(i=i.startsWith("refs/heads/")?i:`refs/heads/${i}`,!await H.exists({fs:a,gitdir:t,ref:i}))throw new He(i);const c=await H.expand({fs:a,gitdir:t,ref:i}),d=await mr({fs:a,gitdir:t,fullname:!0});if(c===d){const I=await H.resolve({fs:a,gitdir:t,ref:c});await H.writeRef({fs:a,gitdir:t,ref:"HEAD",value:I})}await H.deleteRef({fs:a,gitdir:t,ref:c});const w=Ir(i),v=await he.get({fs:a,gitdir:t});await v.deleteSection("branch",w),await he.save({fs:a,gitdir:t,config:v})}async function bl({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s}){try{J("fs",a),J("ref",s);const c=new $e(a),d=await Ue({fsp:c,dotgit:i});return await gp({fs:c,gitdir:d,ref:s})}catch(c){throw c.caller="git.deleteBranch",c}}async function vl({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s}){try{J("fs",a),J("ref",s);const c=new $e(a),d=await Ue({fsp:c,dotgit:i});await H.deleteRef({fs:c,gitdir:d,ref:s})}catch(c){throw c.caller="git.deleteRef",c}}async function mp({fs:a,gitdir:t,remote:i}){const s=await he.get({fs:a,gitdir:t});await s.deleteSection("remote",i),await he.save({fs:a,gitdir:t,config:s})}async function xl({fs:a,dir:t,gitdir:i=g(t,".git"),remote:s}){try{J("fs",a),J("remote",s);const c=new $e(a),d=await Ue({fsp:c,dotgit:i});return await mp({fs:c,gitdir:d,remote:s})}catch(c){throw c.caller="git.deleteRemote",c}}async function wp({fs:a,gitdir:t,ref:i}){i=i.startsWith("refs/tags/")?i:`refs/tags/${i}`,await H.deleteRef({fs:a,gitdir:t,ref:i})}async function _l({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s}){try{J("fs",a),J("ref",s);const c=new $e(a),d=await Ue({fsp:c,dotgit:i});return await wp({fs:c,gitdir:d,ref:s})}catch(c){throw c.caller="git.deleteTag",c}}async function yp({fs:a,gitdir:t,oid:i}){const s=i.slice(0,2);return(await a.readdir(`${t}/objects/${s}`)).map(d=>`${s}${d}`).filter(d=>d.startsWith(i))}async function bp({fs:a,cache:t,gitdir:i,oid:s,getExternalRefDelta:c}){const d=[];let w=await a.readdir(g(i,"objects/pack"));w=w.filter(v=>v.endsWith(".idx"));for(const v of w){const I=`${i}/objects/pack/${v}`,C=await Hi({fs:a,cache:t,filename:I,getExternalRefDelta:c});if(C.error)throw new y(C.error);for(const k of C.offsets.keys())k.startsWith(s)&&d.push(k)}return d}async function vp({fs:a,cache:t,gitdir:i,oid:s}){const c=v=>dt({fs:a,cache:t,gitdir:i,oid:v}),d=await yp({fs:a,gitdir:i,oid:s}),w=await bp({fs:a,cache:t,gitdir:i,oid:s,getExternalRefDelta:c});for(const v of w)d.indexOf(v)===-1&&d.push(v);if(d.length===1)return d[0];throw d.length>1?new ln("oids",s,d):new He(`an object matching "${s}"`)}async function Sl({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,cache:c={}}){try{J("fs",a),J("gitdir",i),J("oid",s);const d=new $e(a),w=await Ue({fsp:d,dotgit:i});return await vp({fs:d,cache:c,gitdir:w,oid:s})}catch(d){throw d.caller="git.expandOid",d}}async function kl({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s}){try{J("fs",a),J("gitdir",i),J("ref",s);const c=new $e(a),d=await Ue({fsp:c,dotgit:i});return await H.expand({fs:c,gitdir:d,ref:s})}catch(c){throw c.caller="git.expandRef",c}}async function ia({fs:a,cache:t,gitdir:i,oids:s}){const c={},d=s.length;let w=s.map((v,I)=>({index:I,oid:v}));for(;w.length;){const v=new Set;for(const{oid:C,index:k}of w)c[C]||(c[C]=new Set),c[C].add(k),c[C].size===d&&v.add(C);if(v.size>0)return[...v];const I=new Map;for(const{oid:C,index:k}of w)try{const{object:j}=await dt({fs:a,cache:t,gitdir:i,oid:C}),F=mt.from(j),{parent:V}=F.parseHeaders();for(const re of V)(!c[re]||!c[re].has(k))&&I.set(re+":"+k,{oid:re,index:k})}catch{}w=Array.from(I.values())}return[]}async function El({fs:a,cache:t,dir:i,gitdir:s,ours:c,theirs:d,fastForward:w=!0,fastForwardOnly:v=!1,dryRun:I=!1,noUpdateBranch:C=!1,abortOnConflict:k=!0,message:j,author:F,committer:V,signingKey:re,onSign:me,mergeDriver:pe,allowUnrelatedHistories:we=!1}){c===void 0&&(c=await mr({fs:a,gitdir:s,fullname:!0})),c=await H.expand({fs:a,gitdir:s,ref:c}),d=await H.expand({fs:a,gitdir:s,ref:d});const be=await H.resolve({fs:a,gitdir:s,ref:c}),Ie=await H.resolve({fs:a,gitdir:s,ref:d}),je=await ia({fs:a,cache:t,gitdir:s,oids:[be,Ie]});if(je.length!==1)if(je.length===0&&we)je.push("4b825dc642cb6eb9a060e54bf8d69288fbee4904");else throw new Gr;const De=je[0];if(De===Ie)return{oid:be,alreadyMerged:!0};if(w&&De===be)return!I&&!C&&await H.writeRef({fs:a,gitdir:s,ref:c,value:Ie}),{oid:Ie,fastForward:!0};{if(v)throw new pn;const Le=await ce.acquire({fs:a,gitdir:s,cache:t,allowUnmerged:!1},async Ae=>el({fs:a,cache:t,dir:i,gitdir:s,index:Ae,ourOid:be,theirOid:Ie,baseOid:De,ourName:Ir(c),baseName:"base",theirName:Ir(d),dryRun:I,abortOnConflict:k,mergeDriver:pe}));if(Le instanceof kr)throw Le;return j||(j=`Merge branch '${Ir(d)}' into ${Ir(c)}`),{oid:await kn({fs:a,cache:t,gitdir:s,message:j,ref:c,tree:Le,parent:[be,Ie],author:F,committer:V,signingKey:re,onSign:me,dryRun:I,noUpdateBranch:C}),tree:Le,mergeCommit:!0}}}async function Al({fs:a,cache:t,http:i,onProgress:s,onMessage:c,onAuth:d,onAuthSuccess:w,onAuthFailure:v,dir:I,gitdir:C,ref:k,url:j,remote:F,remoteRef:V,prune:re,pruneTags:me,fastForward:pe,fastForwardOnly:we,corsProxy:be,singleBranch:Ie,headers:je,author:De,committer:Le,signingKey:Ee}){try{if(!k){const Ke=await mr({fs:a,gitdir:C});if(!Ke)throw new Ut("ref");k=Ke}const{fetchHead:Ae,fetchHeadDescription:Re}=await na({fs:a,cache:t,http:i,onProgress:s,onMessage:c,onAuth:d,onAuthSuccess:w,onAuthFailure:v,gitdir:C,corsProxy:be,ref:k,url:j,remote:F,remoteRef:V,singleBranch:Ie,headers:je,prune:re,pruneTags:me});await El({fs:a,cache:t,gitdir:C,ours:k,theirs:Ae,fastForward:pe,fastForwardOnly:we,message:`Merge ${Re}`,author:De,committer:Le,signingKey:Ee,dryRun:!1,noUpdateBranch:!1}),await Xi({fs:a,cache:t,onProgress:s,dir:I,gitdir:C,ref:k,remote:F,noCheckout:!1})}catch(Ae){throw Ae.caller="git.pull",Ae}}async function Il({fs:a,http:t,onProgress:i,onMessage:s,onAuth:c,onAuthSuccess:d,onAuthFailure:w,dir:v,gitdir:I=g(v,".git"),ref:C,url:k,remote:j,remoteRef:F,corsProxy:V,singleBranch:re,headers:me={},cache:pe={}}){try{J("fs",a),J("http",t),J("gitdir",I);const we={name:"",email:"",timestamp:Date.now(),timezoneOffset:0},be=new $e(a),Ie=await Ue({fsp:be,dotgit:I});return await Al({fs:be,cache:pe,http:t,onProgress:i,onMessage:s,onAuth:c,onAuthSuccess:d,onAuthFailure:w,dir:v,gitdir:Ie,ref:C,url:k,remote:j,remoteRef:F,fastForwardOnly:!0,corsProxy:V,singleBranch:re,headers:me,author:we,committer:we})}catch(we){throw we.caller="git.fastForward",we}}async function Tl({fs:a,http:t,onProgress:i,onMessage:s,onAuth:c,onAuthSuccess:d,onAuthFailure:w,dir:v,gitdir:I=g(v,".git"),ref:C,remote:k,remoteRef:j,url:F,corsProxy:V,depth:re=null,since:me=null,exclude:pe=[],relative:we=!1,tags:be=!1,singleBranch:Ie=!1,headers:je={},prune:De=!1,pruneTags:Le=!1,cache:Ee={}}){try{J("fs",a),J("http",t),J("gitdir",I);const Ae=new $e(a),Re=await Ue({fsp:Ae,dotgit:I});return await na({fs:Ae,cache:Ee,http:t,onProgress:i,onMessage:s,onAuth:c,onAuthSuccess:d,onAuthFailure:w,gitdir:Re,ref:C,remote:k,remoteRef:j,url:F,corsProxy:V,depth:re,since:me,exclude:pe,relative:we,tags:be,singleBranch:Ie,headers:je,prune:De,pruneTags:Le})}catch(Ae){throw Ae.caller="git.fetch",Ae}}async function Cl({fs:a,dir:t,gitdir:i=g(t,".git"),oids:s,cache:c={}}){try{J("fs",a),J("gitdir",i),J("oids",s);const d=new $e(a),w=await Ue({fsp:d,dotgit:i});return await ia({fs:d,cache:c,gitdir:w,oids:s})}catch(d){throw d.caller="git.findMergeBase",d}}async function Rl({fs:a,filepath:t}){if(await a.exists(g(t,".git")))return t;{const i=xe(t);if(i===t)throw new He(`git root for ${t}`);return Rl({fs:a,filepath:i})}}async function Ol({fs:a,filepath:t}){try{return J("fs",a),J("filepath",t),await Rl({fs:new $e(a),filepath:t})}catch(i){throw i.caller="git.findRoot",i}}async function Ml({fs:a,dir:t,gitdir:i=g(t,".git"),path:s}){try{J("fs",a),J("gitdir",i),J("path",s);const c=new $e(a),d=await Ue({fsp:c,dotgit:i});return await Sn({fs:c,gitdir:d,path:s})}catch(c){throw c.caller="git.getConfig",c}}async function xp({fs:a,gitdir:t,path:i}){return(await he.get({fs:a,gitdir:t})).getall(i)}async function Pl({fs:a,dir:t,gitdir:i=g(t,".git"),path:s}){try{J("fs",a),J("gitdir",i),J("path",s);const c=new $e(a),d=await Ue({fsp:c,dotgit:i});return await xp({fs:c,gitdir:d,path:s})}catch(c){throw c.caller="git.getConfigAll",c}}async function jl({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:s,corsProxy:c,url:d,headers:w={},forPush:v=!1}){try{J("http",a),J("url",d);const C=await si.getRemoteHelperFor({url:d}).discover({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:s,corsProxy:c,service:v?"git-receive-pack":"git-upload-pack",url:d,headers:w,protocolVersion:1}),k={capabilities:[...C.capabilities]};for(const[j,F]of C.refs){const V=j.split("/"),re=V.pop();let me=k;for(const pe of V)me[pe]=me[pe]||{},me=me[pe];me[re]=F}for(const[j,F]of C.symrefs){const V=j.split("/"),re=V.pop();let me=k;for(const pe of V)me[pe]=me[pe]||{},me=me[pe];me[re]=F}return k}catch(I){throw I.caller="git.getRemoteInfo",I}}function Bl(a,t,i,s){const c=[];for(const[d,w]of a.refs){if(t&&!d.startsWith(t))continue;if(d.endsWith("^{}")){if(s){const I=d.replace("^{}",""),C=c[c.length-1],k=C.ref===I?C:c.find(j=>j.ref===I);if(k===void 0)throw new Error("I did not expect this to happen");k.peeled=w}continue}const v={ref:d,oid:w};i&&a.symrefs.has(d)&&(v.target=a.symrefs.get(d)),c.push(v)}return c}async function Fl({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:s,corsProxy:c,url:d,headers:w={},forPush:v=!1,protocolVersion:I=2}){try{J("http",a),J("url",d);const k=await si.getRemoteHelperFor({url:d}).discover({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:s,corsProxy:c,service:v?"git-receive-pack":"git-upload-pack",url:d,headers:w,protocolVersion:I});if(k.protocolVersion===2)return{protocolVersion:k.protocolVersion,capabilities:k.capabilities2};const j={};for(const F of k.capabilities){const[V,re]=F.split("=");re?j[V]=re:j[V]=!0}return{protocolVersion:1,capabilities:j,refs:Bl(k,void 0,!0,!0)}}catch(C){throw C.caller="git.getRemoteInfo2",C}}async function _p({type:a,object:t,format:i="content",oid:s=void 0}){return i!=="deflated"&&(i!=="wrapped"&&(t=et.wrap({type:a,object:t})),s=await Y(t)),{oid:s,object:t}}async function Dl({object:a}){try{J("object",a),typeof a=="string"?a=Buffer.from(a,"utf8"):a instanceof Uint8Array||(a=new Uint8Array(a));const t="blob",{oid:i,object:s}=await _p({type:t,format:"content",object:a});return{oid:i,type:t,object:s,format:"wrapped"}}catch(t){throw t.caller="git.hashBlob",t}}async function Sp({fs:a,cache:t,onProgress:i,dir:s,gitdir:c,filepath:d}){try{d=g(s,d);const w=await a.read(d),v=C=>dt({fs:a,cache:t,gitdir:c,oid:C}),I=await Ur.fromPack({pack:w,getExternalRefDelta:v,onProgress:i});return await a.write(d.replace(/\.pack$/,".idx"),await I.toBuffer()),{oids:[...I.hashes]}}catch(w){throw w.caller="git.indexPack",w}}async function Ll({fs:a,onProgress:t,dir:i,gitdir:s=g(i,".git"),filepath:c,cache:d={}}){try{J("fs",a),J("dir",i),J("gitdir",i),J("filepath",c);const w=new $e(a),v=await Ue({fsp:w,dotgit:s});return await Sp({fs:w,cache:d,onProgress:t,dir:i,gitdir:v,filepath:c})}catch(w){throw w.caller="git.indexPack",w}}async function $l({fs:a,bare:t=!1,dir:i,gitdir:s=t?i:g(i,".git"),defaultBranch:c="master"}){try{J("fs",a),J("gitdir",s),t||J("dir",i);const d=new $e(a),w=await Ue({fsp:d,dotgit:s});return await gl({fs:d,bare:t,dir:i,gitdir:w,defaultBranch:c})}catch(d){throw d.caller="git.init",d}}async function Nl({fs:a,cache:t,gitdir:i,oid:s,ancestor:c,depth:d}){const w=await Cn.read({fs:a,gitdir:i});if(!s)throw new Ut("oid");if(!c)throw new Ut("ancestor");if(s===c)return!1;const v=[s],I=new Set;let C=0;for(;v.length;){if(C++===d)throw new mn(d);const k=v.shift(),{type:j,object:F}=await dt({fs:a,cache:t,gitdir:i,oid:k});if(j!=="commit")throw new We(k,j,"commit");const V=mt.from(F).parse();for(const re of V.parent)if(re===c)return!0;if(!w.has(k))for(const re of V.parent)I.has(re)||(v.push(re),I.add(re))}return!1}async function Ul({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,ancestor:c,depth:d=-1,cache:w={}}){try{J("fs",a),J("gitdir",i),J("oid",s),J("ancestor",c);const v=new $e(a),I=await Ue({fsp:v,dotgit:i});return await Nl({fs:v,cache:w,gitdir:I,oid:s,ancestor:c,depth:d})}catch(v){throw v.caller="git.isDescendent",v}}async function zl({fs:a,dir:t,gitdir:i=g(t,".git"),filepath:s}){try{J("fs",a),J("dir",t),J("gitdir",i),J("filepath",s);const c=new $e(a),d=await Ue({fsp:c,dotgit:i});return Zr.isIgnored({fs:c,dir:t,gitdir:d,filepath:s})}catch(c){throw c.caller="git.isIgnored",c}}async function Gl({fs:a,dir:t,gitdir:i=g(t,".git"),remote:s}){try{J("fs",a),J("gitdir",i);const c=new $e(a),d=await Ue({fsp:c,dotgit:i});return H.listBranches({fs:c,gitdir:d,remote:s})}catch(c){throw c.caller="git.listBranches",c}}async function kp({fs:a,gitdir:t,ref:i,cache:s}){if(i){const c=await H.resolve({gitdir:t,fs:a,ref:i}),d=[];return await Hl({fs:a,cache:s,gitdir:t,oid:c,filenames:d,prefix:""}),d}else return ce.acquire({fs:a,gitdir:t,cache:s},async function(c){return c.entries.map(d=>d.path)})}async function Hl({fs:a,cache:t,gitdir:i,oid:s,filenames:c,prefix:d}){const{tree:w}=await Kr({fs:a,cache:t,gitdir:i,oid:s});for(const v of w)v.type==="tree"?await Hl({fs:a,cache:t,gitdir:i,oid:v.oid,filenames:c,prefix:g(d,v.path)}):c.push(g(d,v.path))}async function Wl({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s,cache:c={}}){try{J("fs",a),J("gitdir",i);const d=new $e(a),w=await Ue({fsp:d,dotgit:i});return await kp({fs:d,cache:c,gitdir:w,ref:s})}catch(d){throw d.caller="git.listFiles",d}}async function Ep({fs:a,cache:t,gitdir:i,ref:s}){let c;try{c=await H.resolve({gitdir:i,fs:a,ref:s})}catch(v){if(v instanceof He)return[]}return(await Kr({fs:a,cache:t,gitdir:i,oid:c})).tree.map(v=>({target:v.path,note:v.oid}))}async function ql({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s="refs/notes/commits",cache:c={}}){try{J("fs",a),J("gitdir",i),J("ref",s);const d=new $e(a),w=await Ue({fsp:d,dotgit:i});return await Ep({fs:d,cache:c,gitdir:w,ref:s})}catch(d){throw d.caller="git.listNotes",d}}async function Vl({fs:a,dir:t,gitdir:i=g(t,".git"),filepath:s}){try{J("fs",a),J("gitdir",i);const c=new $e(a),d=await Ue({fsp:c,dotgit:i});return H.listRefs({fs:c,gitdir:d,filepath:s})}catch(c){throw c.caller="git.listRefs",c}}async function Ap({fs:a,gitdir:t}){const i=await he.get({fs:a,gitdir:t}),s=await i.getSubsections("remote");return Promise.all(s.map(async d=>{const w=await i.get(`remote.${d}.url`);return{remote:d,url:w}}))}async function Zl({fs:a,dir:t,gitdir:i=g(t,".git")}){try{J("fs",a),J("gitdir",i);const s=new $e(a),c=await Ue({fsp:s,dotgit:i});return await Ap({fs:s,gitdir:c})}catch(s){throw s.caller="git.listRemotes",s}}async function Ip(a){const t=_t.streamReader(a),i=[];let s;for(;s=await t(),s!==!0;){if(s===null)continue;s=s.toString("utf8").replace(/\n$/,"");const[c,d,...w]=s.split(" "),v={ref:d,oid:c};for(const I of w){const[C,k]=I.split(":");C==="symref-target"?v.target=k:C==="peeled"&&(v.peeled=k)}i.push(v)}return i}async function Tp({prefix:a,symrefs:t,peelTags:i}){const s=[];return s.push(_t.encode(`command=ls-refs
`)),s.push(_t.encode(`agent=${li.agent}
`)),(i||t||a)&&s.push(_t.delim()),i&&s.push(_t.encode("peel")),t&&s.push(_t.encode("symrefs")),a&&s.push(_t.encode(`ref-prefix ${a}`)),s.push(_t.flush()),s}async function Kl({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:s,corsProxy:c,url:d,headers:w={},forPush:v=!1,protocolVersion:I=2,prefix:C,symrefs:k,peelTags:j}){try{J("http",a),J("url",d);const F=await oi.discover({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:s,corsProxy:c,service:v?"git-receive-pack":"git-upload-pack",url:d,headers:w,protocolVersion:I});if(F.protocolVersion===1)return Bl(F,C,k,j);const V=await Tp({prefix:C,symrefs:k,peelTags:j}),re=await oi.connect({http:a,auth:F.auth,headers:w,corsProxy:c,service:v?"git-receive-pack":"git-upload-pack",url:d,body:V});return Ip(re.body)}catch(F){throw F.caller="git.listServerRefs",F}}async function Xl({fs:a,dir:t,gitdir:i=g(t,".git")}){try{J("fs",a),J("gitdir",i);const s=new $e(a),c=await Ue({fsp:s,dotgit:i});return H.listTags({fs:s,gitdir:c})}catch(s){throw s.caller="git.listTags",s}}function Cp(a,t){return a.committer.timestamp-t.committer.timestamp}const Rp="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function Yl({fs:a,cache:t,gitdir:i,oid:s,fileId:c}){if(c===Rp)return;const d=s;let w;const v=await qr({fs:a,cache:t,gitdir:i,oid:s}),I=v.tree;return c===v.oid?w=v.path:(w=await Jl({fs:a,cache:t,gitdir:i,tree:I,fileId:c,oid:d}),Array.isArray(w)&&(w.length===0?w=void 0:w.length===1&&(w=w[0]))),w}async function Jl({fs:a,cache:t,gitdir:i,tree:s,fileId:c,oid:d,filepaths:w=[],parentPath:v=""}){const I=s.entries().map(function(C){let k;return C.oid===c?(k=g(v,C.path),w.push(k)):C.type==="tree"&&(k=dt({fs:a,cache:t,gitdir:i,oid:C.oid}).then(function({object:j}){return Jl({fs:a,cache:t,gitdir:i,tree:Ce.from(j),fileId:c,oid:d,filepaths:w,parentPath:g(v,C.path)})})),k});return await Promise.all(I),w}async function Op({fs:a,cache:t,gitdir:i,filepath:s,ref:c,depth:d,since:w,force:v,follow:I}){const C=typeof w>"u"?void 0:Math.floor(w.valueOf()/1e3),k=[],j=await Cn.read({fs:a,gitdir:i}),F=await H.resolve({fs:a,gitdir:i,ref:c}),V=[await ir({fs:a,cache:t,gitdir:i,oid:F})];let re,me,pe;function we(be){pe&&s&&k.push(be)}for(;V.length>0;){const be=V.pop();if(C!==void 0&&be.commit.committer.timestamp<=C)break;if(s){let Ie;try{Ie=await En({fs:a,cache:t,gitdir:i,oid:be.commit.tree,filepath:s}),me&&re!==Ie&&k.push(me),re=Ie,me=be,pe=!0}catch(je){if(je instanceof He){let De=I&&re;if(De&&(De=await Yl({fs:a,cache:t,gitdir:i,oid:be.commit.tree,fileId:re}),De))if(Array.isArray(De)){if(me){const Le=await Yl({fs:a,cache:t,gitdir:i,oid:me.commit.tree,fileId:re});if(Array.isArray(Le))if(De=De.filter(Ee=>Le.indexOf(Ee)===-1),De.length===1)De=De[0],s=De,me&&k.push(me);else{De=!1,me&&k.push(me);break}}}else s=De,me&&k.push(me);if(!De){if(pe&&re&&(k.push(me),!v))break;if(!v&&!I)throw je}me=be,pe=!1}else throw je}}else k.push(be);if(d!==void 0&&k.length===d){we(be);break}if(!j.has(be.oid))for(const Ie of be.commit.parent){const je=await ir({fs:a,cache:t,gitdir:i,oid:Ie});V.map(De=>De.oid).includes(je.oid)||V.push(je)}V.length===0&&we(be),V.sort((Ie,je)=>Cp(Ie.commit,je.commit))}return k}async function Ql({fs:a,dir:t,gitdir:i=g(t,".git"),filepath:s,ref:c="HEAD",depth:d,since:w,force:v,follow:I,cache:C={}}){try{J("fs",a),J("gitdir",i),J("ref",c);const k=new $e(a),j=await Ue({fsp:k,dotgit:i});return await Op({fs:k,cache:C,gitdir:j,filepath:s,ref:c,depth:d,since:w,force:v,follow:I})}catch(k){throw k.caller="git.log",k}}async function ec({fs:a,onSign:t,dir:i,gitdir:s=g(i,".git"),ours:c,theirs:d,fastForward:w=!0,fastForwardOnly:v=!1,dryRun:I=!1,noUpdateBranch:C=!1,abortOnConflict:k=!0,message:j,author:F,committer:V,signingKey:re,cache:me={},mergeDriver:pe,allowUnrelatedHistories:we=!1}){try{J("fs",a),re&&J("onSign",t);const be=new $e(a),Ie=await Ue({fsp:be,dotgit:s}),je=await gr({fs:be,gitdir:Ie,author:F});if(!je&&(!v||!w))throw new Rt("author");const De=await Ar({fs:be,gitdir:Ie,author:je,committer:V});if(!De&&(!v||!w))throw new Rt("committer");return await El({fs:be,cache:me,dir:i,gitdir:Ie,ours:c,theirs:d,fastForward:w,fastForwardOnly:v,dryRun:I,noUpdateBranch:C,abortOnConflict:k,message:j,author:je,committer:De,signingKey:re,onSign:t,mergeDriver:pe,allowUnrelatedHistories:we})}catch(be){throw be.caller="git.merge",be}}const Mp={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function tc({fs:a,cache:t,dir:i,gitdir:s=g(i,".git"),oids:c}){const d=new r,w=[];function v(k,j){const F=Buffer.from(k,j);w.push(F),d.update(F)}async function I({stype:k,object:j}){const F=Mp[k];let V=j.length,re=V>15?128:0;const me=V&15;V=V>>>4;let pe=(re|F|me).toString(16);for(v(pe,"hex");re;)re=V>127?128:0,pe=re|V&127,v(ea(2,pe),"hex"),V=V>>>7;v(Buffer.from(await Ns(j)))}v("PACK"),v("00000002","hex"),v(ea(8,c.length),"hex");for(const k of c){const{type:j,object:F}=await dt({fs:a,cache:t,gitdir:s,oid:k});await I({object:F,stype:j})}const C=d.digest();return w.push(C),w}async function Pp({fs:a,cache:t,gitdir:i,oids:s,write:c}){const d=await tc({fs:a,cache:t,gitdir:i,oids:s}),w=Buffer.from(await ai(d)),I=`pack-${w.slice(-20).toString("hex")}.pack`;return c?(await a.write(g(i,`objects/pack/${I}`),w),{filename:I}):{filename:I,packfile:new Uint8Array(w)}}async function rc({fs:a,dir:t,gitdir:i=g(t,".git"),oids:s,write:c=!1,cache:d={}}){try{J("fs",a),J("gitdir",i),J("oids",s);const w=new $e(a),v=await Ue({fsp:w,dotgit:i});return await Pp({fs:w,cache:d,gitdir:v,oids:s,write:c})}catch(w){throw w.caller="git.packObjects",w}}async function nc({fs:a,http:t,onProgress:i,onMessage:s,onAuth:c,onAuthSuccess:d,onAuthFailure:w,dir:v,gitdir:I=g(v,".git"),ref:C,url:k,remote:j,remoteRef:F,prune:V=!1,pruneTags:re=!1,fastForward:me=!0,fastForwardOnly:pe=!1,corsProxy:we,singleBranch:be,headers:Ie={},author:je,committer:De,signingKey:Le,cache:Ee={}}){try{J("fs",a),J("gitdir",I);const Ae=new $e(a),Re=await Ue({fsp:Ae,dotgit:I}),Ke=await gr({fs:Ae,gitdir:Re,author:je});if(!Ke)throw new Rt("author");const lt=await Ar({fs:Ae,gitdir:Re,author:Ke,committer:De});if(!lt)throw new Rt("committer");return await Al({fs:Ae,cache:Ee,http:t,onProgress:i,onMessage:s,onAuth:c,onAuthSuccess:d,onAuthFailure:w,dir:v,gitdir:Re,ref:C,url:k,remote:j,remoteRef:F,fastForward:me,fastForwardOnly:pe,corsProxy:we,singleBranch:be,headers:Ie,author:Ke,committer:lt,signingKey:Le,prune:V,pruneTags:re})}catch(Ae){throw Ae.caller="git.pull",Ae}}async function jp({fs:a,cache:t,dir:i,gitdir:s=g(i,".git"),start:c,finish:d}){const w=await Cn.read({fs:a,gitdir:s}),v=new Set,I=new Set;for(const j of c)v.add(await H.resolve({fs:a,gitdir:s,ref:j}));for(const j of d)try{const F=await H.resolve({fs:a,gitdir:s,ref:j});I.add(F)}catch{}const C=new Set;async function k(j){C.add(j);const{type:F,object:V}=await dt({fs:a,cache:t,gitdir:s,oid:j});if(F==="tag"){const me=$t.from(V).headers().object;return k(me)}if(F!=="commit")throw new We(j,F,"commit");if(!w.has(j)){const me=mt.from(V).headers().parent;for(j of me)!I.has(j)&&!C.has(j)&&await k(j)}}for(const j of v)await k(j);return C}async function aa({fs:a,cache:t,dir:i,gitdir:s=g(i,".git"),oids:c}){const d=new Set;async function w(v){if(d.has(v))return;d.add(v);const{type:I,object:C}=await dt({fs:a,cache:t,gitdir:s,oid:v});if(I==="tag"){const j=$t.from(C).headers().object;await w(j)}else if(I==="commit"){const j=mt.from(C).headers().tree;await w(j)}else if(I==="tree"){const k=Ce.from(C);for(const j of k)j.type==="blob"&&d.add(j.oid),j.type==="tree"&&await w(j.oid)}}for(const v of c)await w(v);return d}async function Bp(a){const t={};let i="";const s=_t.streamReader(a);let c=await s();for(;c!==!0;)c!==null&&(i+=c.toString("utf8")+`
`),c=await s();const d=i.toString("utf8").split(`
`);if(c=d.shift(),!c.startsWith("unpack "))throw new Er('unpack ok" or "unpack [error message]',c);t.ok=c==="unpack ok",t.ok||(t.error=c.slice(7)),t.refs={};for(const w of d){if(w.trim()==="")continue;const v=w.slice(0,2),I=w.slice(3);let C=I.indexOf(" ");C===-1&&(C=I.length);const k=I.slice(0,C),j=I.slice(C+1);t.refs[k]={ok:v==="ok",error:j}}return t}async function Fp({capabilities:a=[],triplets:t=[]}){const i=[];let s=`\0 ${a.join(" ")}`;for(const c of t)i.push(_t.encode(`${c.oldoid} ${c.oid} ${c.fullRef}${s}
`)),s="";return i.push(_t.flush()),i}async function Dp({fs:a,cache:t,http:i,onProgress:s,onMessage:c,onAuth:d,onAuthSuccess:w,onAuthFailure:v,onPrePush:I,gitdir:C,ref:k,remoteRef:j,remote:F,url:V,force:re=!1,delete:me=!1,corsProxy:pe,headers:we={}}){const be=k||await mr({fs:a,gitdir:C});if(typeof be>"u")throw new Ut("ref");const Ie=await he.get({fs:a,gitdir:C});F=F||await Ie.get(`branch.${be}.pushRemote`)||await Ie.get("remote.pushDefault")||await Ie.get(`branch.${be}.remote`)||"origin";const je=V||await Ie.get(`remote.${F}.pushurl`)||await Ie.get(`remote.${F}.url`);if(typeof je>"u")throw new Ut("remote OR url");const De=j||await Ie.get(`branch.${be}.merge`);if(typeof je>"u")throw new Ut("remoteRef");pe===void 0&&(pe=await Ie.get("http.corsProxy"));const Le=await H.expand({fs:a,gitdir:C,ref:be}),Ee=me?"0000000000000000000000000000000000000000":await H.resolve({fs:a,gitdir:C,ref:Le}),Ae=si.getRemoteHelperFor({url:je}),Re=await Ae.discover({http:i,onAuth:d,onAuthSuccess:w,onAuthFailure:v,corsProxy:pe,service:"git-receive-pack",url:je,headers:we,protocolVersion:1}),Ke=Re.auth;let lt;if(!De)lt=Le;else try{lt=await H.expandAgainstMap({ref:De,map:Re.refs})}catch(bt){if(bt instanceof He)lt=De.startsWith("refs/")?De:`refs/heads/${De}`;else throw bt}const At=Re.refs.get(lt)||"0000000000000000000000000000000000000000";if(I&&!await I({remote:F,url:je,localRef:{ref:me?"(delete)":Le,oid:Ee},remoteRef:{ref:lt,oid:At}}))throw new Wr;const ct=!Re.capabilities.has("no-thin");let Tt=new Set;if(!me){const bt=[...Re.refs.values()];let ar=new Set;if(At!=="0000000000000000000000000000000000000000"){const Dt=await ia({fs:a,cache:t,gitdir:C,oids:[Ee,At]});for(const Rn of Dt)bt.push(Rn);ct&&(ar=await aa({fs:a,cache:t,gitdir:C,oids:Dt}))}if(!bt.includes(Ee)){const Dt=await jp({fs:a,cache:t,gitdir:C,start:[Ee],finish:bt});Tt=await aa({fs:a,cache:t,gitdir:C,oids:Dt})}if(ct){try{const Dt=await H.resolve({fs:a,gitdir:C,ref:`refs/remotes/${F}/HEAD`,depth:2}),{oid:Rn}=await H.resolveAgainstMap({ref:Dt.replace(`refs/remotes/${F}/`,""),fullref:Dt,map:Re.refs}),Or=[Rn];for(const It of await aa({fs:a,cache:t,gitdir:C,oids:Or}))ar.add(It)}catch{}for(const Dt of ar)Tt.delete(Dt)}if(Ee===At&&(re=!0),!re){if(Le.startsWith("refs/tags")&&At!=="0000000000000000000000000000000000000000")throw new Hr("tag-exists");if(Ee!=="0000000000000000000000000000000000000000"&&At!=="0000000000000000000000000000000000000000"&&!await Nl({fs:a,cache:t,gitdir:C,oid:Ee,ancestor:At,depth:-1}))throw new Hr("not-fast-forward")}}const Ot=dl([...Re.capabilities],["report-status","side-band-64k",`agent=${li.agent}`]),Cr=await Fp({capabilities:Ot,triplets:[{oldoid:At,oid:Ee,fullRef:lt}]}),Rr=me?[]:await tc({fs:a,cache:t,gitdir:C,oids:[...Tt]}),Yr=await Ae.connect({http:i,onProgress:s,corsProxy:pe,service:"git-receive-pack",url:je,auth:Ke,headers:we,body:[...Cr,...Rr]}),{packfile:sa,progress:la}=await pl.demux(Yr.body);if(c){const bt=hl(la);Tn(bt,async ar=>{await c(ar)})}const Ht=await Bp(sa);if(Yr.headers&&(Ht.headers=Yr.headers),F&&Ht.ok&&Ht.refs[lt].ok&&!Le.startsWith("refs/tags")){const bt=`refs/remotes/${F}/${lt.replace("refs/heads","")}`;me?await H.deleteRef({fs:a,gitdir:C,ref:bt}):await H.writeRef({fs:a,gitdir:C,ref:bt,value:Ee})}if(Ht.ok&&Object.values(Ht.refs).every(bt=>bt.ok))return Ht;{const bt=Object.entries(Ht.refs).filter(([ar,Dt])=>!Dt.ok).map(([ar,Dt])=>`
  - ${ar}: ${Dt.error}`).join("");throw new gn(bt,Ht)}}async function ic({fs:a,http:t,onProgress:i,onMessage:s,onAuth:c,onAuthSuccess:d,onAuthFailure:w,onPrePush:v,dir:I,gitdir:C=g(I,".git"),ref:k,remoteRef:j,remote:F="origin",url:V,force:re=!1,delete:me=!1,corsProxy:pe,headers:we={},cache:be={}}){try{J("fs",a),J("http",t),J("gitdir",C);const Ie=new $e(a),je=await Ue({fsp:Ie,dotgit:C});return await Dp({fs:Ie,cache:be,http:t,onProgress:i,onMessage:s,onAuth:c,onAuthSuccess:d,onAuthFailure:w,onPrePush:v,gitdir:je,ref:k,remoteRef:j,remote:F,url:V,force:re,delete:me,corsProxy:pe,headers:we})}catch(Ie){throw Ie.caller="git.push",Ie}}async function ac({fs:a,cache:t,gitdir:i,oid:s}){const{type:c,object:d}=await dt({fs:a,cache:t,gitdir:i,oid:s});if(c==="tag")return s=$t.from(d).parse().object,ac({fs:a,cache:t,gitdir:i,oid:s});if(c!=="blob")throw new We(s,c,"blob");return{oid:s,blob:new Uint8Array(d)}}async function oc({fs:a,cache:t,gitdir:i,oid:s,filepath:c=void 0}){return c!==void 0&&(s=await En({fs:a,cache:t,gitdir:i,oid:s,filepath:c})),await ac({fs:a,cache:t,gitdir:i,oid:s})}async function sc({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,filepath:c,cache:d={}}){try{J("fs",a),J("gitdir",i),J("oid",s);const w=new $e(a),v=await Ue({fsp:w,dotgit:i});return await oc({fs:w,cache:d,gitdir:v,oid:s,filepath:c})}catch(w){throw w.caller="git.readBlob",w}}async function oa({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,cache:c={}}){try{J("fs",a),J("gitdir",i),J("oid",s);const d=new $e(a),w=await Ue({fsp:d,dotgit:i});return await ir({fs:d,cache:c,gitdir:w,oid:s})}catch(d){throw d.caller="git.readCommit",d}}async function Lp({fs:a,cache:t,gitdir:i,ref:s="refs/notes/commits",oid:c}){const d=await H.resolve({gitdir:i,fs:a,ref:s}),{blob:w}=await oc({fs:a,cache:t,gitdir:i,oid:d,filepath:c});return w}async function lc({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s="refs/notes/commits",oid:c,cache:d={}}){try{J("fs",a),J("gitdir",i),J("ref",s),J("oid",c);const w=new $e(a),v=await Ue({fsp:w,dotgit:i});return await Lp({fs:w,cache:d,gitdir:v,ref:s,oid:c})}catch(w){throw w.caller="git.readNote",w}}async function cc({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,format:c="parsed",filepath:d=void 0,encoding:w=void 0,cache:v={}}){try{J("fs",a),J("gitdir",i),J("oid",s);const I=new $e(a),C=await Ue({fsp:I,dotgit:i});d!==void 0&&(s=await En({fs:I,cache:v,gitdir:C,oid:s,filepath:d}));const j=await dt({fs:I,cache:v,gitdir:C,oid:s,format:c==="parsed"?"content":c});if(j.oid=s,c==="parsed")switch(j.format="parsed",j.type){case"commit":j.object=mt.from(j.object).parse();break;case"tree":j.object=Ce.from(j.object).entries();break;case"blob":w?j.object=j.object.toString(w):(j.object=new Uint8Array(j.object),j.format="content");break;case"tag":j.object=$t.from(j.object).parse();break;default:throw new We(j.oid,j.type,"blob|commit|tag|tree")}else(j.format==="deflated"||j.format==="wrapped")&&(j.type=j.format);return j}catch(I){throw I.caller="git.readObject",I}}async function $p({fs:a,cache:t,gitdir:i,oid:s}){const{type:c,object:d}=await dt({fs:a,cache:t,gitdir:i,oid:s,format:"content"});if(c!=="tag")throw new We(s,c,"tag");const w=$t.from(d);return{oid:s,tag:w.parse(),payload:w.payload()}}async function uc({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,cache:c={}}){try{J("fs",a),J("gitdir",i),J("oid",s);const d=new $e(a),w=await Ue({fsp:d,dotgit:i});return await $p({fs:d,cache:c,gitdir:w,oid:s})}catch(d){throw d.caller="git.readTag",d}}async function fc({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,filepath:c=void 0,cache:d={}}){try{J("fs",a),J("gitdir",i),J("oid",s);const w=new $e(a),v=await Ue({fsp:w,dotgit:i});return await Kr({fs:w,cache:d,gitdir:v,oid:s,filepath:c})}catch(w){throw w.caller="git.readTree",w}}async function dc({fs:a,dir:t,gitdir:i=g(t,".git"),filepath:s,cache:c={}}){try{J("fs",a),J("gitdir",i),J("filepath",s);const d=new $e(a),w=await Ue({fsp:d,dotgit:i});await ce.acquire({fs:d,gitdir:w,cache:c},async function(v){v.delete({filepath:s})})}catch(d){throw d.caller="git.remove",d}}async function Np({fs:a,cache:t,onSign:i,gitdir:s,ref:c="refs/notes/commits",oid:d,author:w,committer:v,signingKey:I}){let C;try{C=await H.resolve({gitdir:s,fs:a,ref:c})}catch(re){if(!(re instanceof He))throw re}let j=(await Kr({fs:a,cache:t,gitdir:s,oid:C||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;j=j.filter(re=>re.path!==d);const F=await An({fs:a,gitdir:s,tree:j});return await kn({fs:a,cache:t,onSign:i,gitdir:s,ref:c,tree:F,parent:C&&[C],message:`Note removed by 'isomorphic-git removeNote'
`,author:w,committer:v,signingKey:I})}async function hc({fs:a,onSign:t,dir:i,gitdir:s=g(i,".git"),ref:c="refs/notes/commits",oid:d,author:w,committer:v,signingKey:I,cache:C={}}){try{J("fs",a),J("gitdir",s),J("oid",d);const k=new $e(a),j=await Ue({fsp:k,dotgit:s}),F=await gr({fs:k,gitdir:j,author:w});if(!F)throw new Rt("author");const V=await Ar({fs:k,gitdir:j,author:F,committer:v});if(!V)throw new Rt("committer");return await Np({fs:k,cache:C,onSign:t,gitdir:j,ref:c,oid:d,author:F,committer:V,signingKey:I})}catch(k){throw k.caller="git.removeNote",k}}async function Up({fs:a,gitdir:t,oldref:i,ref:s,checkout:c=!1}){if(!In(s))throw new er(s,f.clean(s));if(!In(i))throw new er(i,f.clean(i));const d=`refs/heads/${i}`,w=`refs/heads/${s}`;if(await H.exists({fs:a,gitdir:t,ref:w}))throw new Qt("branch",s,!1);const I=await H.resolve({fs:a,gitdir:t,ref:d,depth:1});await H.writeRef({fs:a,gitdir:t,ref:w,value:I}),await H.deleteRef({fs:a,gitdir:t,ref:d});const k=await mr({fs:a,gitdir:t,fullname:!0})===d;(c||k)&&await H.writeSymbolicRef({fs:a,gitdir:t,ref:"HEAD",value:w})}async function pc({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s,oldref:c,checkout:d=!1}){try{J("fs",a),J("gitdir",i),J("ref",s),J("oldref",c);const w=new $e(a),v=await Ue({fsp:w,dotgit:i});return await Up({fs:w,gitdir:v,ref:s,oldref:c,checkout:d})}catch(w){throw w.caller="git.renameBranch",w}}async function gc({gitdir:a,type:t,object:i}){return Y(et.wrap({type:t,object:i}))}async function mc({fs:a,dir:t,gitdir:i=g(t,".git"),filepath:s,ref:c,cache:d={}}){try{J("fs",a),J("gitdir",i),J("filepath",s);const w=new $e(a),v=await Ue({fsp:w,dotgit:i});let I,C;try{I=await H.resolve({fs:w,gitdir:v,ref:c||"HEAD"})}catch(F){if(c)throw F}if(I)try{I=await En({fs:w,cache:d,gitdir:v,oid:I,filepath:s})}catch{I=null}let k={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const j=t&&await w.read(g(t,s));j&&(C=await gc({gitdir:v,type:"blob",object:j}),I===C&&(k=await w.lstat(g(t,s)))),await ce.acquire({fs:w,gitdir:v,cache:d},async function(F){F.delete({filepath:s}),I&&F.insert({filepath:s,stats:k,oid:I})})}catch(w){throw w.caller="git.reset",w}}async function wc({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s,depth:c}){try{J("fs",a),J("gitdir",i),J("ref",s);const d=new $e(a),w=await Ue({fsp:d,dotgit:i});return await H.resolve({fs:d,gitdir:w,ref:s,depth:c})}catch(d){throw d.caller="git.resolveRef",d}}async function yc({fs:a,dir:t,gitdir:i=g(t,".git"),path:s,value:c,append:d=!1}){try{J("fs",a),J("gitdir",i),J("path",s);const w=new $e(a),v=await Ue({fsp:w,dotgit:i}),I=await he.get({fs:w,gitdir:v});d?await I.append(s,c):await I.set(s,c),await he.save({fs:w,gitdir:v,config:I})}catch(w){throw w.caller="git.setConfig",w}}async function bc({fs:a,gitdir:t,commit:i}){const s=mt.from(i).toObject();return await zt({fs:a,gitdir:t,type:"commit",object:s,format:"content"})}class ui{static get timezoneOffsetForRefLogEntry(){const t=new Date().getTimezoneOffset(),i=Math.abs(Math.floor(t/60)),s=Math.abs(t%60).toString().padStart(2,"0");return`${t>0?"-":"+"}${i.toString().padStart(2,"0")}${s}`}static createStashReflogEntry(t,i,s){const c=t.name.replace(/\s/g,""),d="0000000000000000000000000000000000000000",w=Math.floor(Date.now()/1e3),v=ui.timezoneOffsetForRefLogEntry;return`${d} ${i} ${c} ${t.email} ${w} ${v}	${s}
`}static getStashReflogEntry(t,i=!1){return t.split(`
`).filter(d=>d).reverse().map((d,w)=>i?`stash@{${w}}: ${d.split("	")[1]}`:d)}}class cr{constructor({fs:t,dir:i,gitdir:s=g(i,".git")}){Object.assign(this,{fs:t,dir:i,gitdir:s,_author:null})}static get refStash(){return"refs/stash"}static get refLogsStash(){return"logs/refs/stash"}get refStashPath(){return g(this.gitdir,cr.refStash)}get refLogsStashPath(){return g(this.gitdir,cr.refLogsStash)}async getAuthor(){if(!this._author&&(this._author=await gr({fs:this.fs,gitdir:this.gitdir,author:{}}),!this._author))throw new Rt("author");return this._author}async getStashSHA(t,i){return await this.fs.exists(this.refStashPath)?(i||await this.readStashReflogs({parsed:!1}))[t].split(" ")[1]:null}async writeStashCommit({message:t,tree:i,parent:s}){return bc({fs:this.fs,gitdir:this.gitdir,commit:{message:t,tree:i,parent:s,author:await this.getAuthor(),committer:await this.getAuthor()}})}async readStashCommit(t){const i=await this.readStashReflogs({parsed:!1});if(t!==0&&(t<0||t>i.length-1))throw new er(`stash@${t}`,"number that is in range of [0, num of stash pushed]");const s=await this.getStashSHA(t,i);return s?ir({fs:this.fs,cache:{},gitdir:this.gitdir,oid:s}):{}}async writeStashRef(t){return H.writeRef({fs:this.fs,gitdir:this.gitdir,ref:cr.refStash,value:t})}async writeStashReflogEntry({stashCommit:t,message:i}){const s=await this.getAuthor(),c=ui.createStashReflogEntry(s,t,i),d=this.refLogsStashPath;await Xr({filepath:d,entry:c},async()=>{const w=await this.fs.exists(d)?await this.fs.read(d,"utf8"):"";await this.fs.write(d,w+c,"utf8")})}async readStashReflogs({parsed:t=!1}){if(!await this.fs.exists(this.refLogsStashPath))return[];const i=await this.fs.read(this.refLogsStashPath,"utf8");return ui.getStashReflogEntry(i,t)}}async function vc({fs:a,dir:t,gitdir:i,message:s=""}){const c=new cr({fs:a,dir:t,gitdir:i});await c.getAuthor();const d=await mr({fs:a,gitdir:i,fullname:!1}),w=await H.resolve({fs:a,gitdir:i,ref:"HEAD"}),I=(await oa({fs:a,dir:t,gitdir:i,oid:w})).commit.message,C=[w];let k=null,j=Gt({ref:"HEAD"});const F=await tl({fs:a,dir:t,gitdir:i,treePair:[Gt({ref:"HEAD"}),"stage"]});if(F){const pe=await c.writeStashCommit({message:`stash-Index: WIP on ${d} - ${new Date().toISOString()}`,tree:F,parent:C});C.push(pe),k=F,j=Qe()}const V=await tl({fs:a,dir:t,gitdir:i,treePair:[j,"workdir"]});if(V){const pe=await c.writeStashCommit({message:`stash-WorkDir: WIP on ${d} - ${new Date().toISOString()}`,tree:V,parent:[C[C.length-1]]});C.push(pe),k=V}if(!k||!F&&!V)throw new He("changes, nothing to stash");const re=(s.trim()||`WIP on ${d}`)+`: ${w.substring(0,7)} ${I}`;return{stashCommit:await c.writeStashCommit({message:re,tree:k,parent:C}),stashMsg:re,branch:d,stashMgr:c}}async function zp({fs:a,dir:t,gitdir:i,message:s=""}){const{stashCommit:c,stashMsg:d,branch:w,stashMgr:v}=await vc({fs:a,dir:t,gitdir:i,message:s});return await v.writeStashRef(c),await v.writeStashReflogEntry({stashCommit:c,message:d}),await Yi({fs:a,dir:t,gitdir:i,ref:w,track:!1,force:!0}),c}async function Gp({fs:a,dir:t,gitdir:i,message:s=""}){const{stashCommit:c}=await vc({fs:a,dir:t,gitdir:i,message:s});return c}async function xc({fs:a,dir:t,gitdir:i,refIdx:s=0}){const d=await new cr({fs:a,dir:t,gitdir:i}).readStashCommit(s),{parent:w=null}=d.commit?d.commit:{};if(!(!w||!Array.isArray(w)))for(let v=0;v<w.length-1;v++){const C=(await ir({fs:a,cache:{},gitdir:i,oid:w[v+1]})).commit.message.startsWith("stash-Index");await rl({fs:a,dir:t,gitdir:i,stashCommit:w[v+1],parentCommit:w[v],wasStaged:C})}}async function _c({fs:a,dir:t,gitdir:i,refIdx:s=0}){const c=new cr({fs:a,dir:t,gitdir:i});if(!(await c.readStashCommit(s)).commit)return;const w=c.refStashPath;await Xr(w,async()=>{await a.exists(w)&&await a.rm(w)});const v=await c.readStashReflogs({parsed:!1});if(!v.length)return;v.splice(s,1);const I=c.refLogsStashPath;await Xr({reflogEntries:v,stashReflogPath:I,stashMgr:c},async()=>{if(v.length){await a.write(I,v.reverse().join(`
`)+`
`,"utf8");const C=v[v.length-1].split(" ")[1];await c.writeStashRef(C)}else await a.rm(I)})}async function Hp({fs:a,dir:t,gitdir:i}){return new cr({fs:a,dir:t,gitdir:i}).readStashReflogs({parsed:!0})}async function Wp({fs:a,dir:t,gitdir:i}){const s=new cr({fs:a,dir:t,gitdir:i}),c=[s.refStashPath,s.refLogsStashPath];await Xr(c,async()=>{await Promise.all(c.map(async d=>{if(await a.exists(d))return a.rm(d)}))})}async function qp({fs:a,dir:t,gitdir:i,refIdx:s=0}){await xc({fs:a,dir:t,gitdir:i,refIdx:s}),await _c({fs:a,dir:t,gitdir:i,refIdx:s})}async function Sc({fs:a,dir:t,gitdir:i=g(t,".git"),op:s="push",message:c="",refIdx:d=0}){J("fs",a),J("dir",t),J("gitdir",i),J("op",s);const w={push:zp,apply:xc,drop:_c,list:Hp,clear:Wp,pop:qp,create:Gp},v=["apply","drop","pop"];try{const I=new $e(a),C=await Ue({fsp:I,dotgit:i});["refs","logs","logs/refs"].map(F=>g(C,F)).forEach(async F=>{await I.exists(F)||await I.mkdir(F)});const j=w[s];if(j){if(v.includes(s)&&d<0)throw new er(`stash@${d}`,"number that is in range of [0, num of stash pushed]");return await j({fs:I,dir:t,gitdir:C,message:c,refIdx:d})}throw new Error(`To be implemented: ${s}`)}catch(I){throw I.caller="git.stash",I}}async function kc({fs:a,dir:t,gitdir:i=g(t,".git"),filepath:s,cache:c={}}){try{J("fs",a),J("gitdir",i),J("filepath",s);const d=new $e(a),w=await Ue({fsp:d,dotgit:i});if(await Zr.isIgnored({fs:d,gitdir:w,dir:t,filepath:s}))return"ignored";const I=await Vp({fs:d,cache:c,gitdir:w}),C=await Ec({fs:d,cache:c,gitdir:w,tree:I,path:s}),k=await ce.acquire({fs:d,gitdir:w,cache:c},async function(pe){for(const we of pe)if(we.path===s)return we;return null}),j=await d.lstat(g(t,s)),F=C!==null,V=k!==null,re=j!==null,me=async()=>{if(V&&!oe(k,j))return k.oid;{const pe=await d.read(g(t,s)),we=await gc({gitdir:w,type:"blob",object:pe});return V&&k.oid===we&&j.size!==-1&&ce.acquire({fs:d,gitdir:w,cache:c},async function(be){be.insert({filepath:s,stats:j,oid:we})}),we}};if(!F&&!re&&!V)return"absent";if(!F&&!re&&V)return"*absent";if(!F&&re&&!V)return"*added";if(!F&&re&&V)return await me()===k.oid?"added":"*added";if(F&&!re&&!V)return"deleted";if(F&&!re&&V)return C===k.oid,"*deleted";if(F&&re&&!V)return await me()===C?"*undeleted":"*undeletemodified";if(F&&re&&V){const pe=await me();return pe===C?pe===k.oid?"unmodified":"*unmodified":pe===k.oid?"modified":"*modified"}}catch(d){throw d.caller="git.status",d}}async function Ec({fs:a,cache:t,gitdir:i,tree:s,path:c}){typeof c=="string"&&(c=c.split("/"));const d=c.shift();for(const w of s)if(w.path===d){if(c.length===0)return w.oid;const{type:v,object:I}=await dt({fs:a,cache:t,gitdir:i,oid:w.oid});if(v==="tree"){const C=Ce.from(I);return Ec({fs:a,cache:t,gitdir:i,tree:C,path:c})}if(v==="blob")throw new We(w.oid,v,"blob",c.join("/"))}return null}async function Vp({fs:a,cache:t,gitdir:i}){let s;try{s=await H.resolve({fs:a,gitdir:i,ref:"HEAD"})}catch(d){if(d instanceof He)return[]}const{tree:c}=await Kr({fs:a,cache:t,gitdir:i,oid:s});return c}async function Ac({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s="HEAD",filepaths:c=["."],filter:d,cache:w={},ignored:v=!1}){try{J("fs",a),J("gitdir",i),J("ref",s);const I=new $e(a),C=await Ue({fsp:I,dotgit:i});return await pr({fs:I,cache:w,dir:t,gitdir:C,trees:[Gt({ref:s}),Vr(),Qe()],map:async function(k,[j,F,V]){if(!j&&!V&&F&&!v&&await Zr.isIgnored({fs:I,dir:t,filepath:k})||!c.some(Ee=>Js(k,Ee)))return null;if(d&&!d(k))return;const[re,me,pe]=await Promise.all([j&&j.type(),F&&F.type(),V&&V.type()]),we=[re,me,pe].includes("blob");if((re==="tree"||re==="special")&&!we)return;if(re==="commit")return null;if((me==="tree"||me==="special")&&!we)return;if(pe==="commit")return null;if((pe==="tree"||pe==="special")&&!we)return;const be=re==="blob"?await j.oid():void 0,Ie=pe==="blob"?await V.oid():void 0;let je;re!=="blob"&&me==="blob"&&pe!=="blob"?je="42":me==="blob"&&(je=await F.oid());const De=[void 0,be,je,Ie],Le=De.map(Ee=>De.indexOf(Ee));return Le.shift(),[k,...Le]}})}catch(I){throw I.caller="git.statusMatrix",I}}async function Ic({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s,object:c,force:d=!1}){try{J("fs",a),J("gitdir",i),J("ref",s);const w=new $e(a);if(s===void 0)throw new Ut("ref");s=s.startsWith("refs/tags/")?s:`refs/tags/${s}`;const v=await Ue({fsp:w,dotgit:i}),I=await H.resolve({fs:w,gitdir:v,ref:c||"HEAD"});if(!d&&await H.exists({fs:w,gitdir:v,ref:s}))throw new Qt("tag",s);await H.writeRef({fs:w,gitdir:v,ref:s,value:I})}catch(w){throw w.caller="git.tag",w}}async function Tc({fs:a,dir:t,gitdir:i=g(t,".git"),cache:s={},filepath:c,oid:d,mode:w,add:v,remove:I,force:C}){try{J("fs",a),J("gitdir",i),J("filepath",c);const k=new $e(a),j=await Ue({fsp:k,dotgit:i});if(I)return await ce.acquire({fs:k,gitdir:j,cache:s},async function(V){if(!C){const re=await k.lstat(g(t,c));if(re){if(re.isDirectory())throw new dr("directory");return}}V.has({filepath:c})&&V.delete({filepath:c})});let F;if(!d){if(F=await k.lstat(g(t,c)),!F)throw new He(`file at "${c}" on disk and "remove" not set`);if(F.isDirectory())throw new dr("directory")}return await ce.acquire({fs:k,gitdir:j,cache:s},async function(V){if(!v&&!V.has({filepath:c}))throw new He(`file at "${c}" in index and "add" not set`);let re;if(d)re={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:w,uid:0,gid:0,size:0};else{re=F;const me=re.isSymbolicLink()?await k.readlink(g(t,c)):await k.read(g(t,c));d=await zt({fs:k,gitdir:j,type:"blob",format:"content",object:me})}return V.insert({filepath:c,oid:d,stats:re}),d})}catch(k){throw k.caller="git.updateIndex",k}}function Cc(){try{return li.version}catch(a){throw a.caller="git.version",a}}async function Rc({fs:a,dir:t,gitdir:i=g(t,".git"),trees:s,map:c,reduce:d,iterate:w,cache:v={}}){try{J("fs",a),J("gitdir",i),J("trees",s);const I=new $e(a),C=await Ue({fsp:I,dotgit:i});return await pr({fs:I,cache:v,dir:t,gitdir:C,trees:s,map:c,reduce:d,iterate:w})}catch(I){throw I.caller="git.walk",I}}async function Oc({fs:a,dir:t,gitdir:i=g(t,".git"),blob:s}){try{J("fs",a),J("gitdir",i),J("blob",s);const c=new $e(a),d=await Ue({fsp:c,dotgit:i});return await zt({fs:c,gitdir:d,type:"blob",object:s,format:"content"})}catch(c){throw c.caller="git.writeBlob",c}}async function Mc({fs:a,dir:t,gitdir:i=g(t,".git"),commit:s}){try{J("fs",a),J("gitdir",i),J("commit",s);const c=new $e(a),d=await Ue({fsp:c,dotgit:i});return await bc({fs:c,gitdir:d,commit:s})}catch(c){throw c.caller="git.writeCommit",c}}async function Pc({fs:a,dir:t,gitdir:i=g(t,".git"),type:s,object:c,format:d="parsed",oid:w,encoding:v=void 0}){try{const I=new $e(a),C=await Ue({fsp:I,dotgit:i});if(d==="parsed"){switch(s){case"commit":c=mt.from(c).toObject();break;case"tree":c=Ce.from(c).toObject();break;case"blob":c=Buffer.from(c,v);break;case"tag":c=$t.from(c).toObject();break;default:throw new We(w||"",s,"blob|commit|tag|tree")}d="content"}return w=await zt({fs:I,gitdir:C,type:s,object:c,oid:w,format:d}),w}catch(I){throw I.caller="git.writeObject",I}}async function jc({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s,value:c,force:d=!1,symbolic:w=!1}){try{J("fs",a),J("gitdir",i),J("ref",s),J("value",c);const v=new $e(a);if(!In(s,!0))throw new er(s,f.clean(s));const I=await Ue({fsp:v,dotgit:i});if(!d&&await H.exists({fs:v,gitdir:I,ref:s}))throw new Qt("ref",s);w?await H.writeSymbolicRef({fs:v,gitdir:I,ref:s,value:c}):(c=await H.resolve({fs:v,gitdir:I,ref:c}),await H.writeRef({fs:v,gitdir:I,ref:s,value:c}))}catch(v){throw v.caller="git.writeRef",v}}async function Zp({fs:a,gitdir:t,tag:i}){const s=$t.from(i).toObject();return await zt({fs:a,gitdir:t,type:"tag",object:s,format:"content"})}async function Bc({fs:a,dir:t,gitdir:i=g(t,".git"),tag:s}){try{J("fs",a),J("gitdir",i),J("tag",s);const c=new $e(a),d=await Ue({fsp:c,dotgit:i});return await Zp({fs:c,gitdir:d,tag:s})}catch(c){throw c.caller="git.writeTag",c}}async function Fc({fs:a,dir:t,gitdir:i=g(t,".git"),tree:s}){try{J("fs",a),J("gitdir",i),J("tree",s);const c=new $e(a),d=await Ue({fsp:c,dotgit:i});return await An({fs:c,gitdir:d,tree:s})}catch(c){throw c.caller="git.writeTree",c}}var Kp={Errors:Ps,STAGE:Qe,TREE:Gt,WORKDIR:Vr,add:zs,abortMerge:$s,addNote:Vs,addRemote:Ks,annotatedTag:Xs,branch:Ys,cherryPick:il,checkout:Yi,clone:ml,commit:wl,getConfig:Ml,getConfigAll:Pl,setConfig:yc,currentBranch:yl,deleteBranch:bl,deleteRef:vl,deleteRemote:xl,deleteTag:_l,expandOid:Sl,expandRef:kl,fastForward:Il,fetch:Tl,findMergeBase:Cl,findRoot:Ol,getRemoteInfo:jl,getRemoteInfo2:Fl,hashBlob:Dl,indexPack:Ll,init:$l,isDescendent:Ul,isIgnored:zl,listBranches:Gl,listFiles:Wl,listNotes:ql,listRefs:Vl,listRemotes:Zl,listServerRefs:Kl,listTags:Xl,log:Ql,merge:ec,packObjects:rc,pull:nc,push:ic,readBlob:sc,readCommit:oa,readNote:lc,readObject:cc,readTag:uc,readTree:fc,remove:dc,removeNote:hc,renameBranch:pc,resetIndex:mc,updateIndex:Tc,resolveRef:wc,status:kc,statusMatrix:Ac,tag:Ic,version:Cc,walk:Rc,writeBlob:Oc,writeCommit:Mc,writeObject:Pc,writeRef:jc,writeTag:Bc,writeTree:Fc,stash:Sc};return Oe.Errors=Ps,Oe.STAGE=Qe,Oe.TREE=Gt,Oe.WORKDIR=Vr,Oe.abortMerge=$s,Oe.add=zs,Oe.addNote=Vs,Oe.addRemote=Ks,Oe.annotatedTag=Xs,Oe.branch=Ys,Oe.checkout=Yi,Oe.cherryPick=il,Oe.clone=ml,Oe.commit=wl,Oe.currentBranch=yl,Oe.default=Kp,Oe.deleteBranch=bl,Oe.deleteRef=vl,Oe.deleteRemote=xl,Oe.deleteTag=_l,Oe.expandOid=Sl,Oe.expandRef=kl,Oe.fastForward=Il,Oe.fetch=Tl,Oe.findMergeBase=Cl,Oe.findRoot=Ol,Oe.getConfig=Ml,Oe.getConfigAll=Pl,Oe.getRemoteInfo=jl,Oe.getRemoteInfo2=Fl,Oe.hashBlob=Dl,Oe.indexPack=Ll,Oe.init=$l,Oe.isDescendent=Ul,Oe.isIgnored=zl,Oe.listBranches=Gl,Oe.listFiles=Wl,Oe.listNotes=ql,Oe.listRefs=Vl,Oe.listRemotes=Zl,Oe.listServerRefs=Kl,Oe.listTags=Xl,Oe.log=Ql,Oe.merge=ec,Oe.packObjects=rc,Oe.pull=nc,Oe.push=ic,Oe.readBlob=sc,Oe.readCommit=oa,Oe.readNote=lc,Oe.readObject=cc,Oe.readTag=uc,Oe.readTree=fc,Oe.remove=dc,Oe.removeNote=hc,Oe.renameBranch=pc,Oe.resetIndex=mc,Oe.resolveRef=wc,Oe.setConfig=yc,Oe.stash=Sc,Oe.status=kc,Oe.statusMatrix=Ac,Oe.tag=Ic,Oe.updateIndex=Tc,Oe.version=Cc,Oe.walk=Rc,Oe.writeBlob=Oc,Oe.writeCommit=Mc,Oe.writeObject=Pc,Oe.writeRef=jc,Oe.writeTag=Bc,Oe.writeTree=Fc,Oe}var hy=dy();const Cs=qn(hy);function py(e){let n=[e];return{next(){return Promise.resolve({done:n.length===0,value:n.pop()})},return(){return n=[],{}},[Symbol.asyncIterator](){return this}}}function gy(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:py(e)}async function my(e,n){const r=gy(e);for(;;){const{value:o,done:l}=await r.next();if(o&&await n(o),l)break}r.return&&r.return()}async function wy(e){let n=0;const r=[];await my(e,u=>{r.push(u),n+=u.byteLength});const o=new Uint8Array(n);let l=0;for(const u of r)o.set(u,l),l+=u.byteLength;return o}function yy(e){if(e[Symbol.asyncIterator])return e;const n=e.getReader();return{next(){return n.read()},return(){return n.releaseLock(),{}},[Symbol.asyncIterator](){return this}}}async function by({onProgress:e,url:n,method:r="GET",headers:o={},body:l}){l&&(l=await wy(l));const u=await fetch(n,{method:r,headers:o,body:l}),p=u.body&&u.body.getReader?yy(u.body):[new Uint8Array(await u.arrayBuffer())];o={};for(const[f,h]of u.headers.entries())o[f]=h;return{url:u.url,method:u.method,statusCode:u.status,statusMessage:u.statusText,body:p,headers:o}}var vy={request:by};const an=new Map;function xy(e,n){an.has(e)||an.set(e,new Set),an.get(e).add(n)}function _y(e,n){const r=an.get(e);r&&(r.delete(n),r.size===0&&an.delete(e))}function Nn(e,n){const r=an.get(e);r&&r.forEach(o=>o(n))}const Fr={FIND:"notemac-find",REPLACE:"notemac-replace",MARK:"notemac-mark",GOTO_LINE:"notemac-goto-line",COLUMN_EDIT:"notemac-column-edit",CLEAR_MARKS:"notemac-clear-marks",EDITOR_ACTION:"notemac-editor-action",INSERT_SNIPPET:"notemac-insert-snippet",EXECUTE_COMMAND:"notemac-execute-command",GIT_STATUS_CHANGED:"notemac-git-status-changed",GIT_BRANCH_CHANGED:"notemac-git-branch-changed",GIT_OPERATION_COMPLETE:"notemac-git-operation-complete",AI_RESPONSE_COMPLETE:"notemac-ai-response-complete",AI_STREAM_CHUNK:"notemac-ai-stream-chunk",AI_INLINE_SUGGESTION:"notemac-ai-inline-suggestion",AI_ERROR:"notemac-ai-error",AI_ACTION:"notemac-ai-action"};var Go,zf;function Sy(){if(zf)return Go;zf=1,Go=e;function e(n){var r,o;if(typeof n!="function")throw new Error("expected a function but got "+n);return function(){return r||(r=!0,o=n.apply(this,arguments)),o}}return Go}var Ho={},Gf;function ky(){return Gf||(Gf=1,(function(e){function n(D,U){var G;return D instanceof Buffer?G=D:G=Buffer.from(D.buffer,D.byteOffset,D.byteLength),G.toString(U)}var r=function(D){return Buffer.from(D)};function o(D){for(var U=0,G=Math.min(256*256,D.length+1),X=new Uint16Array(G),q=[],Y=0;;){var B=U<D.length;if(!B||Y>=G-1){var K=X.subarray(0,Y),se=K;if(q.push(String.fromCharCode.apply(null,se)),!B)return q.join("");D=D.subarray(U),U=0,Y=0}var S=D[U++];if((S&128)===0)X[Y++]=S;else if((S&224)===192){var ne=D[U++]&63;X[Y++]=(S&31)<<6|ne}else if((S&240)===224){var ne=D[U++]&63,Q=D[U++]&63;X[Y++]=(S&31)<<12|ne<<6|Q}else if((S&248)===240){var ne=D[U++]&63,Q=D[U++]&63,oe=D[U++]&63,W=(S&7)<<18|ne<<12|Q<<6|oe;W>65535&&(W-=65536,X[Y++]=W>>>10&1023|55296,W=56320|W&1023),X[Y++]=W}}}function l(D){for(var U=0,G=D.length,X=0,q=Math.max(32,G+(G>>>1)+7),Y=new Uint8Array(q>>>3<<3);U<G;){var B=D.charCodeAt(U++);if(B>=55296&&B<=56319){if(U<G){var K=D.charCodeAt(U);(K&64512)===56320&&(++U,B=((B&1023)<<10)+(K&1023)+65536)}if(B>=55296&&B<=56319)continue}if(X+4>Y.length){q+=8,q*=1+U/D.length*2,q=q>>>3<<3;var se=new Uint8Array(q);se.set(Y),Y=se}if((B&4294967168)===0){Y[X++]=B;continue}else if((B&4294965248)===0)Y[X++]=B>>>6&31|192;else if((B&4294901760)===0)Y[X++]=B>>>12&15|224,Y[X++]=B>>>6&63|128;else if((B&4292870144)===0)Y[X++]=B>>>18&7|240,Y[X++]=B>>>12&63|128,Y[X++]=B>>>6&63|128;else continue;Y[X++]=B&63|128}return Y.slice?Y.slice(0,X):Y.subarray(0,X)}var u="Failed to ",p=function(D,U,G){if(D)throw new Error("".concat(u).concat(U,": the '").concat(G,"' option is unsupported."))},f=typeof Buffer=="function"&&Buffer.from,h=f?r:l;function x(){this.encoding="utf-8"}x.prototype.encode=function(D,U){return p(U&&U.stream,"encode","stream"),h(D)};function _(D){var U;try{var G=new Blob([D],{type:"text/plain;charset=UTF-8"});U=URL.createObjectURL(G);var X=new XMLHttpRequest;return X.open("GET",U,!1),X.send(),X.responseText}finally{U&&URL.revokeObjectURL(U)}}var y=!f&&typeof Blob=="function"&&typeof URL=="function"&&typeof URL.createObjectURL=="function",O=["utf-8","utf8","unicode-1-1-utf-8"],R=o;f?R=n:y&&(R=function(D){try{return _(D)}catch{return o(D)}});var z="construct 'TextDecoder'",N="".concat(u," ").concat(z,": the ");function L(D,U){p(U&&U.fatal,z,"fatal"),D=D||"utf-8";var G;if(f?G=Buffer.isEncoding(D):G=O.indexOf(D.toLowerCase())!==-1,!G)throw new RangeError("".concat(N," encoding label provided ('").concat(D,"') is invalid."));this.encoding=D,this.fatal=!1,this.ignoreBOM=!1}L.prototype.decode=function(D,U){p(U&&U.stream,"decode","stream");var G;return D instanceof Uint8Array?G=D:D.buffer instanceof ArrayBuffer?G=new Uint8Array(D.buffer):G=new Uint8Array(D),R(G,this.encoding)},e.TextEncoder=e.TextEncoder||x,e.TextDecoder=e.TextDecoder||L})(typeof window<"u"?window:typeof Ai<"u"?Ai:Ho)),Ho}var Wo,Hf;function Ey(){return Hf||(Hf=1,ky(),Wo={encode:e=>new TextEncoder().encode(e),decode:e=>new TextDecoder().decode(e)}),Wo}var qo,Wf;function Ay(){if(Wf)return qo;Wf=1,qo=e;function e(n,r,o){var l;return function(){if(!r)return n.apply(this,arguments);var u=this,p=arguments,f=o&&!l;if(clearTimeout(l),l=setTimeout(function(){if(l=null,!f)return n.apply(u,p)},r),f)return n.apply(this,arguments)}}return qo}var Vo,qf;function Rs(){if(qf)return Vo;qf=1;function e(f){if(f.length===0)return".";let h=o(f);return h=h.reduce(p,[]),r(...h)}function n(...f){let h="";for(let x of f)x.startsWith("/")?h=x:h=e(r(h,x));return h}function r(...f){if(f.length===0)return"";let h=f.join("/");return h=h.replace(/\/{2,}/g,"/"),h}function o(f){if(f.length===0)return[];if(f==="/")return["/"];let h=f.split("/");return h[h.length-1]===""&&h.pop(),f[0]==="/"?h[0]="/":h[0]!=="."&&h.unshift("."),h}function l(f){const h=f.lastIndexOf("/");if(h===-1)throw new Error(`Cannot get dirname of "${f}"`);return h===0?"/":f.slice(0,h)}function u(f){if(f==="/")throw new Error(`Cannot get basename of "${f}"`);const h=f.lastIndexOf("/");return h===-1?f:f.slice(h+1)}function p(f,h){if(f.length===0)return f.push(h),f;if(h===".")return f;if(h===".."){if(f.length===1){if(f[0]==="/")throw new Error("Unable to normalize path - traverses above root directory");if(f[0]===".")return f.push(h),f}return f[f.length-1]===".."?(f.push(".."),f):(f.pop(),f)}return f.push(h),f}return Vo={join:r,normalize:e,split:o,basename:u,dirname:l,resolve:n},Vo}var Zo,Vf;function eh(){if(Vf)return Zo;Vf=1;function e(f){return class extends Error{constructor(...h){super(...h),this.code=f,this.message?this.message=f+": "+this.message:this.message=f}}}const n=e("EEXIST"),r=e("ENOENT"),o=e("ENOTDIR"),l=e("ENOTEMPTY"),u=e("ETIMEDOUT"),p=e("EISDIR");return Zo={EEXIST:n,ENOENT:r,ENOTDIR:o,ENOTEMPTY:l,ETIMEDOUT:u,EISDIR:p},Zo}var Ko,Zf;function Iy(){if(Zf)return Ko;Zf=1;const e=Rs(),{EEXIST:n,ENOENT:r,ENOTDIR:o,ENOTEMPTY:l,EISDIR:u}=eh(),p=0;return Ko=class{constructor(){}_makeRoot(h=new Map){return h.set(p,{mode:511,type:"dir",size:0,ino:0,mtimeMs:Date.now()}),h}activate(h=null){h===null?this._root=new Map([["/",this._makeRoot()]]):typeof h=="string"?this._root=new Map([["/",this._makeRoot(this.parse(h))]]):this._root=h}get activated(){return!!this._root}deactivate(){this._root=void 0}size(){return this._countInodes(this._root.get("/"))-1}_countInodes(h){let x=1;for(let[_,y]of h)_!==p&&(x+=this._countInodes(y));return x}autoinc(){return this._maxInode(this._root.get("/"))+1}_maxInode(h){let x=h.get(p).ino;for(let[_,y]of h)_!==p&&(x=Math.max(x,this._maxInode(y)));return x}print(h=this._root.get("/")){let x="";const _=(y,O)=>{for(let[R,z]of y){if(R===0)continue;let N=z.get(p),L=N.mode.toString(8);x+=`${"	".repeat(O)}${R}	${L}`,N.type==="file"?x+=`	${N.size}	${N.mtimeMs}
`:(x+=`
`,_(z,O+1))}};return _(h,0),x}parse(h){let x=0;function _(z){const N=++x,L=z.length===1?"dir":"file";let[D,U,G]=z;return D=parseInt(D,8),U=U?parseInt(U):0,G=G?parseInt(G):Date.now(),new Map([[p,{mode:D,type:L,size:U,mtimeMs:G,ino:N}]])}let y=h.trim().split(`
`),O=this._makeRoot(),R=[{indent:-1,node:O},{indent:0,node:null}];for(let z of y){let L=z.match(/^\t*/)[0].length;z=z.slice(L);let[D,...U]=z.split("	"),G=_(U);if(L<=R[R.length-1].indent)for(;L<=R[R.length-1].indent;)R.pop();R.push({indent:L,node:G}),R[R.length-2].node.set(D,G)}return O}_lookup(h,x=!0){let _=this._root,y="/",O=e.split(h);for(let R=0;R<O.length;++R){let z=O[R];if(_=_.get(z),!_)throw new r(h);if(x||R<O.length-1){const N=_.get(p);if(N.type==="symlink"){let L=e.resolve(y,N.target);_=this._lookup(L)}y?y=e.join(y,z):y=z}}return _}mkdir(h,{mode:x}){if(h==="/")throw new n;let _=this._lookup(e.dirname(h)),y=e.basename(h);if(_.has(y))throw new n;let O=new Map,R={mode:x,type:"dir",size:0,mtimeMs:Date.now(),ino:this.autoinc()};O.set(p,R),_.set(y,O)}rmdir(h){let x=this._lookup(h);if(x.get(p).type!=="dir")throw new o;if(x.size>1)throw new l;let _=this._lookup(e.dirname(h)),y=e.basename(h);_.delete(y)}readdir(h){let x=this._lookup(h);if(x.get(p).type!=="dir")throw new o;return[...x.keys()].filter(_=>typeof _=="string")}writeStat(h,x,{mode:_}){let y,O;try{O=this.stat(h)}catch{}if(O!==void 0){if(O.type==="dir")throw new u;_==null&&(_=O.mode),y=O.ino}_==null&&(_=438),y==null&&(y=this.autoinc());let R=this._lookup(e.dirname(h)),z=e.basename(h),N={mode:_,type:"file",size:x,mtimeMs:Date.now(),ino:y},L=new Map;return L.set(p,N),R.set(z,L),N}unlink(h){let x=this._lookup(e.dirname(h)),_=e.basename(h);x.delete(_)}rename(h,x){let _=e.basename(x),y=this._lookup(h);this._lookup(e.dirname(x)).set(_,y),this.unlink(h)}stat(h){return this._lookup(h).get(p)}lstat(h){return this._lookup(h,!1).get(p)}readlink(h){return this._lookup(h,!1).get(p).target}symlink(h,x){let _,y;try{let L=this.stat(x);y===null&&(y=L.mode),_=L.ino}catch{}y==null&&(y=40960),_==null&&(_=this.autoinc());let O=this._lookup(e.dirname(x)),R=e.basename(x),z={mode:y,type:"symlink",target:h,size:0,mtimeMs:Date.now(),ino:_},N=new Map;return N.set(p,z),O.set(R,N),z}_du(h){let x=0;for(const[_,y]of h.entries())_===p?x+=y.size:x+=this._du(y);return x}du(h){let x=this._lookup(h);return this._du(x)}},Ko}class th{constructor(n="keyval-store",r="keyval"){this.storeName=r,this._dbName=n,this._storeName=r,this._init()}_init(){this._dbp||(this._dbp=new Promise((n,r)=>{const o=indexedDB.open(this._dbName);o.onerror=()=>r(o.error),o.onsuccess=()=>n(o.result),o.onupgradeneeded=()=>{o.result.createObjectStore(this._storeName)}}))}_withIDBStore(n,r){return this._init(),this._dbp.then(o=>new Promise((l,u)=>{const p=o.transaction(this.storeName,n);p.oncomplete=()=>l(),p.onabort=p.onerror=()=>u(p.error),r(p.objectStore(this.storeName))}))}_close(){return this._init(),this._dbp.then(n=>{n.close(),this._dbp=void 0})}}let Xo;function $r(){return Xo||(Xo=new th),Xo}function Ty(e,n=$r()){let r;return n._withIDBStore("readwrite",o=>{r=o.get(e)}).then(()=>r.result)}function Cy(e,n,r=$r()){return r._withIDBStore("readwrite",o=>{o.put(n,e)})}function Ry(e,n,r=$r()){return r._withIDBStore("readwrite",o=>{const l=o.get(e);l.onsuccess=()=>{o.put(n(l.result),e)}})}function Oy(e,n=$r()){return n._withIDBStore("readwrite",r=>{r.delete(e)})}function My(e=$r()){return e._withIDBStore("readwrite",n=>{n.clear()})}function Py(e=$r()){const n=[];return e._withIDBStore("readwrite",r=>{(r.openKeyCursor||r.openCursor).call(r).onsuccess=function(){this.result&&(n.push(this.result.key),this.result.continue())}}).then(()=>n)}function jy(e=$r()){return e._close()}const By=Object.freeze(Object.defineProperty({__proto__:null,Store:th,clear:My,close:jy,del:Oy,get:Ty,keys:Py,set:Cy,update:Ry},Symbol.toStringTag,{value:"Module"})),rh=eg(By);var Yo,Kf;function Fy(){if(Kf)return Yo;Kf=1;const e=rh;return Yo=class{constructor(r,o){this._database=r,this._storename=o,this._store=new e.Store(this._database,this._storename)}saveSuperblock(r){return e.set("!root",r,this._store)}loadSuperblock(){return e.get("!root",this._store)}readFile(r){return e.get(r,this._store)}writeFile(r,o){return e.set(r,o,this._store)}unlink(r){return e.del(r,this._store)}wipe(){return e.clear(this._store)}close(){return e.close(this._store)}},Yo}var Jo,Xf;function Dy(){return Xf||(Xf=1,Jo=class{constructor(n){this._url=n}loadSuperblock(){return fetch(this._url+"/.superblock.txt").then(n=>n.ok?n.text():null)}async readFile(n){const r=await fetch(this._url+n);if(r.status===200)return r.arrayBuffer();throw new Error("ENOENT")}async sizeFile(n){const r=await fetch(this._url+n,{method:"HEAD"});if(r.status===200)return r.headers.get("content-length");throw new Error("ENOENT")}}),Jo}var Qo,Yf;function Ly(){if(Yf)return Qo;Yf=1;const e=rh,n=r=>new Promise(o=>setTimeout(o,r));return Qo=class{constructor(o,l){this._id=Math.random(),this._database=o,this._storename=l,this._store=new e.Store(this._database,this._storename),this._lock=null}async has({margin:o=2e3}={}){if(this._lock&&this._lock.holder===this._id){const l=Date.now();return this._lock.expires>l+o?!0:await this.renew()}else return!1}async renew({ttl:o=5e3}={}){let l;return await e.update("lock",u=>{const f=Date.now()+o;return l=u&&u.holder===this._id,this._lock=l?{holder:this._id,expires:f}:u,this._lock},this._store),l}async acquire({ttl:o=5e3}={}){let l,u,p;if(await e.update("lock",f=>{const h=Date.now(),x=h+o;return u=f&&f.expires<h,l=f===void 0||u,p=f&&f.holder===this._id,this._lock=l?{holder:this._id,expires:x}:f,this._lock},this._store),p)throw new Error("Mutex double-locked");return l}async wait({interval:o=100,limit:l=6e3,ttl:u}={}){for(;l--;){if(await this.acquire({ttl:u}))return!0;await n(o)}throw new Error("Mutex timeout")}async release({force:o=!1}={}){let l,u,p;if(await e.update("lock",f=>(l=o||f&&f.holder===this._id,u=f===void 0,p=f&&f.holder!==this._id,this._lock=l?void 0:f,this._lock),this._store),await e.close(this._store),!l&&!o){if(u)throw new Error("Mutex double-freed");if(p)throw new Error("Mutex lost ownership")}return l}},Qo}var es,Jf;function $y(){return Jf||(Jf=1,es=class{constructor(n){this._id=Math.random(),this._database=n,this._has=!1,this._release=null}async has(){return this._has}async acquire(){return new Promise(n=>{navigator.locks.request(this._database+"_lock",{ifAvailable:!0},r=>(this._has=!!r,n(!!r),new Promise(o=>{this._release=o})))})}async wait({timeout:n=6e5}={}){return new Promise((r,o)=>{const l=new AbortController;setTimeout(()=>{l.abort(),o(new Error("Mutex timeout"))},n),navigator.locks.request(this._database+"_lock",{signal:l.signal},u=>(this._has=!!u,r(!!u),new Promise(p=>{this._release=p})))})}async release({force:n=!1}={}){this._has=!1,this._release?this._release():n&&navigator.locks.request(this._database+"_lock",{steal:!0},r=>!0)}}),es}var ts,Qf;function Ny(){if(Qf)return ts;Qf=1;const{encode:e,decode:n}=Ey(),r=Ay(),o=Iy(),{ENOENT:l,ENOTEMPTY:u,ETIMEDOUT:p}=eh(),f=Fy(),h=Dy(),x=Ly(),_=$y(),y=Rs();return ts=class{constructor(){this.saveSuperblock=r(()=>{this.flush()},500)}async init(R,{wipe:z,url:N,urlauto:L,fileDbName:D=R,db:U=null,fileStoreName:G=R+"_files",lockDbName:X=R+"_lock",lockStoreName:q=R+"_lock"}={}){this._name=R,this._idb=U||new f(D,G),this._mutex=navigator.locks?new _(R):new x(X,q),this._cache=new o(R),this._opts={wipe:z,url:N},this._needsWipe=!!z,N&&(this._http=new h(N),this._urlauto=!!L)}async activate(){if(this._cache.activated)return;this._needsWipe&&(this._needsWipe=!1,await this._idb.wipe(),await this._mutex.release({force:!0})),await this._mutex.has()||await this._mutex.wait();const R=await this._idb.loadSuperblock();if(R)this._cache.activate(R);else if(this._http){const z=await this._http.loadSuperblock();this._cache.activate(z),await this._saveSuperblock()}else this._cache.activate();if(!await this._mutex.has())throw new p}async deactivate(){await this._mutex.has()&&await this._saveSuperblock(),this._cache.deactivate();try{await this._mutex.release()}catch{}await this._idb.close()}async _saveSuperblock(){this._cache.activated&&(this._lastSavedAt=Date.now(),await this._idb.saveSuperblock(this._cache._root))}_writeStat(R,z,N){let L=y.split(y.dirname(R)),D=L.shift();for(let U of L){D=y.join(D,U);try{this._cache.mkdir(D,{mode:511})}catch{}}return this._cache.writeStat(R,z,N)}async readFile(R,z){const N=typeof z=="string"?z:z&&z.encoding;if(N&&N!=="utf8")throw new Error('Only "utf8" encoding is supported in readFile');let L=null,D=null;try{D=this._cache.stat(R),L=await this._idb.readFile(D.ino)}catch(U){if(!this._urlauto)throw U}if(!L&&this._http){let U=this._cache.lstat(R);for(;U.type==="symlink";)R=y.resolve(y.dirname(R),U.target),U=this._cache.lstat(R);L=await this._http.readFile(R)}if(L&&((!D||D.size!=L.byteLength)&&(D=await this._writeStat(R,L.byteLength,{mode:D?D.mode:438}),this.saveSuperblock()),N==="utf8"?L=n(L):L.toString=()=>n(L)),!D)throw new l(R);return L}async writeFile(R,z,N){const{mode:L,encoding:D="utf8"}=N;if(typeof z=="string"){if(D!=="utf8")throw new Error('Only "utf8" encoding is supported in writeFile');z=e(z)}const U=await this._cache.writeStat(R,z.byteLength,{mode:L});await this._idb.writeFile(U.ino,z)}async unlink(R,z){const N=this._cache.lstat(R);this._cache.unlink(R),N.type!=="symlink"&&await this._idb.unlink(N.ino)}readdir(R,z){return this._cache.readdir(R)}mkdir(R,z){const{mode:N=511}=z;this._cache.mkdir(R,{mode:N})}rmdir(R,z){if(R==="/")throw new u;this._cache.rmdir(R)}rename(R,z){this._cache.rename(R,z)}stat(R,z){return this._cache.stat(R)}lstat(R,z){return this._cache.lstat(R)}readlink(R,z){return this._cache.readlink(R)}symlink(R,z){this._cache.symlink(R,z)}async backFile(R,z){let N=await this._http.sizeFile(R);await this._writeStat(R,N,z)}du(R){return this._cache.du(R)}flush(){return this._saveSuperblock()}},ts}var rs,ed;function Uy(){return ed||(ed=1,rs=class{constructor(n){this.type=n.type,this.mode=n.mode,this.size=n.size,this.ino=n.ino,this.mtimeMs=n.mtimeMs,this.ctimeMs=n.ctimeMs||n.mtimeMs,this.uid=1,this.gid=1,this.dev=1}isFile(){return this.type==="file"}isDirectory(){return this.type==="dir"}isSymbolicLink(){return this.type==="symlink"}}),rs}var ns,td;function zy(){if(td)return ns;td=1;const e=Ny(),n=Uy(),r=Rs();function o(p,f,...h){return p=r.normalize(p),(typeof f>"u"||typeof f=="function")&&(f={}),typeof f=="string"&&(f={encoding:f}),[p,f,...h]}function l(p,f,h,...x){return p=r.normalize(p),(typeof h>"u"||typeof h=="function")&&(h={}),typeof h=="string"&&(h={encoding:h}),[p,f,h,...x]}function u(p,f,...h){return[r.normalize(p),r.normalize(f),...h]}return ns=class{constructor(f,h={}){this.init=this.init.bind(this),this.readFile=this._wrap(this.readFile,o,!1),this.writeFile=this._wrap(this.writeFile,l,!0),this.unlink=this._wrap(this.unlink,o,!0),this.readdir=this._wrap(this.readdir,o,!1),this.mkdir=this._wrap(this.mkdir,o,!0),this.rmdir=this._wrap(this.rmdir,o,!0),this.rename=this._wrap(this.rename,u,!0),this.stat=this._wrap(this.stat,o,!1),this.lstat=this._wrap(this.lstat,o,!1),this.readlink=this._wrap(this.readlink,o,!1),this.symlink=this._wrap(this.symlink,u,!0),this.backFile=this._wrap(this.backFile,o,!0),this.du=this._wrap(this.du,o,!1),this._deactivationPromise=null,this._deactivationTimeout=null,this._activationPromise=null,this._operations=new Set,f&&this.init(f,h)}async init(...f){return this._initPromiseResolve&&await this._initPromise,this._initPromise=this._init(...f),this._initPromise}async _init(f,h={}){await this._gracefulShutdown(),this._activationPromise&&await this._deactivate(),this._backend&&this._backend.destroy&&await this._backend.destroy(),this._backend=h.backend||new e,this._backend.init&&await this._backend.init(f,h),this._initPromiseResolve&&(this._initPromiseResolve(),this._initPromiseResolve=null),h.defer||this.stat("/")}async _gracefulShutdown(){this._operations.size>0&&(this._isShuttingDown=!0,await new Promise(f=>this._gracefulShutdownResolve=f),this._isShuttingDown=!1,this._gracefulShutdownResolve=null)}_wrap(f,h,x){return async(..._)=>{_=h(..._);let y={name:f.name,args:_};this._operations.add(y);try{return await this._activate(),await f.apply(this,_)}finally{this._operations.delete(y),x&&this._backend.saveSuperblock(),this._operations.size===0&&(this._deactivationTimeout||clearTimeout(this._deactivationTimeout),this._deactivationTimeout=setTimeout(this._deactivate.bind(this),500))}}}async _activate(){this._initPromise,await this._initPromise,this._deactivationTimeout&&(clearTimeout(this._deactivationTimeout),this._deactivationTimeout=null),this._deactivationPromise&&await this._deactivationPromise,this._deactivationPromise=null,this._activationPromise||(this._activationPromise=this._backend.activate?this._backend.activate():Promise.resolve()),await this._activationPromise}async _deactivate(){return this._activationPromise&&await this._activationPromise,this._deactivationPromise||(this._deactivationPromise=this._backend.deactivate?this._backend.deactivate():Promise.resolve()),this._activationPromise=null,this._gracefulShutdownResolve&&this._gracefulShutdownResolve(),this._deactivationPromise}async readFile(f,h){return this._backend.readFile(f,h)}async writeFile(f,h,x){return await this._backend.writeFile(f,h,x),null}async unlink(f,h){return await this._backend.unlink(f,h),null}async readdir(f,h){return this._backend.readdir(f,h)}async mkdir(f,h){return await this._backend.mkdir(f,h),null}async rmdir(f,h){return await this._backend.rmdir(f,h),null}async rename(f,h){return await this._backend.rename(f,h),null}async stat(f,h){const x=await this._backend.stat(f,h);return new n(x)}async lstat(f,h){const x=await this._backend.lstat(f,h);return new n(x)}async readlink(f,h){return this._backend.readlink(f,h)}async symlink(f,h){return await this._backend.symlink(f,h),null}async backFile(f,h){return await this._backend.backFile(f,h),null}async du(f){return this._backend.du(f)}async flush(){return this._backend.flush()}},ns}var is,rd;function Gy(){if(rd)return is;rd=1;const e=Sy(),n=zy();function r(o,l){return typeof o=="function"&&(l=o),l=e(l),[(...p)=>l(null,...p),l]}return is=class{constructor(...l){this.promises=new n(...l),this.init=this.init.bind(this),this.readFile=this.readFile.bind(this),this.writeFile=this.writeFile.bind(this),this.unlink=this.unlink.bind(this),this.readdir=this.readdir.bind(this),this.mkdir=this.mkdir.bind(this),this.rmdir=this.rmdir.bind(this),this.rename=this.rename.bind(this),this.stat=this.stat.bind(this),this.lstat=this.lstat.bind(this),this.readlink=this.readlink.bind(this),this.symlink=this.symlink.bind(this),this.backFile=this.backFile.bind(this),this.du=this.du.bind(this),this.flush=this.flush.bind(this)}init(l,u){return this.promises.init(l,u)}readFile(l,u,p){const[f,h]=r(u,p);this.promises.readFile(l,u).then(f).catch(h)}writeFile(l,u,p,f){const[h,x]=r(p,f);this.promises.writeFile(l,u,p).then(h).catch(x)}unlink(l,u,p){const[f,h]=r(u,p);this.promises.unlink(l,u).then(f).catch(h)}readdir(l,u,p){const[f,h]=r(u,p);this.promises.readdir(l,u).then(f).catch(h)}mkdir(l,u,p){const[f,h]=r(u,p);this.promises.mkdir(l,u).then(f).catch(h)}rmdir(l,u,p){const[f,h]=r(u,p);this.promises.rmdir(l,u).then(f).catch(h)}rename(l,u,p){const[f,h]=r(p);this.promises.rename(l,u).then(f).catch(h)}stat(l,u,p){const[f,h]=r(u,p);this.promises.stat(l).then(f).catch(h)}lstat(l,u,p){const[f,h]=r(u,p);this.promises.lstat(l).then(f).catch(h)}readlink(l,u,p){const[f,h]=r(u,p);this.promises.readlink(l).then(f).catch(h)}symlink(l,u,p){const[f,h]=r(p);this.promises.symlink(l,u).then(f).catch(h)}backFile(l,u,p){const[f,h]=r(u,p);this.promises.backFile(l,u).then(f).catch(h)}du(l,u){const[p,f]=r(u);this.promises.du(l).then(p).catch(f)}flush(l){const[u,p]=r(l);this.promises.flush().then(u).catch(p)}},is}var Hy=Gy();const Wy=qn(Hy);function fr(){return typeof window<"u"&&window.__TAURI__?"tauri":typeof window<"u"&&window.electronAPI?"electron":"showDirectoryPicker"in window?"webfs":"lightningfs"}function qy(){return fr()==="tauri"}function Vy(){return fr()==="electron"}function Zy(){const e=fr();return e==="electron"||e==="tauri"}function Ky(){return fr()==="webfs"}function Xy(){return fr()==="lightningfs"}const Ei=new Map;function nh(e){return Ei.has(e)||Ei.set(e,new Wy(e)),Ei.get(e)}function Yy(e){Ei.delete(e),"indexedDB"in window&&window.indexedDB.deleteDatabase(e)}function Os(e){return nh(e).promises}const ih=new Map;function ah(e,n){ih.set(e,n)}function oh(e){return ih.get(e)}function sh(e){async function n(l){const u=l.split("/").filter(h=>0<h.length);if(u.length===0)return{dir:e,name:""};const p=u.pop();let f=e;for(const h of u)f=await f.getDirectoryHandle(h,{create:!1});return{dir:f,name:p}}async function r(l){const u=l.split("/").filter(f=>0<f.length);let p=e;for(const f of u)p=await p.getDirectoryHandle(f,{create:!1});return p}const o={readFile:async(l,u)=>{const{dir:p,name:f}=await n(l),x=await(await p.getFileHandle(f)).getFile();return(typeof u=="string"?u:u==null?void 0:u.encoding)==="utf8"?await x.text():new Uint8Array(await x.arrayBuffer())},writeFile:async(l,u,p)=>{const f=l.split("/").filter(O=>0<O.length),h=f.pop();let x=e;for(const O of f)x=await x.getDirectoryHandle(O,{create:!0});const y=await(await x.getFileHandle(h,{create:!0})).createWritable();await y.write(u),await y.close()},unlink:async l=>{const{dir:u,name:p}=await n(l);await u.removeEntry(p)},readdir:async l=>{const u=l.length===0||l==="/"||l==="."?e:await r(l),p=[];for await(const f of u.values())p.push(f.name);return p},mkdir:async l=>{const u=l.split("/").filter(f=>0<f.length);let p=e;for(const f of u)p=await p.getDirectoryHandle(f,{create:!0})},rmdir:async l=>{const{dir:u,name:p}=await n(l);await u.removeEntry(p,{recursive:!0})},stat:async l=>{if(l.length===0||l==="/"||l===".")return{isFile:()=>!1,isDirectory:()=>!0,isSymbolicLink:()=>!1,size:0,mode:16877,mtimeMs:Date.now()};try{return await r(l),{isFile:()=>!1,isDirectory:()=>!0,isSymbolicLink:()=>!1,size:0,mode:16877,mtimeMs:Date.now()}}catch{const{dir:u,name:p}=await n(l),h=await(await u.getFileHandle(p)).getFile();return{isFile:()=>!0,isDirectory:()=>!1,isSymbolicLink:()=>!1,size:h.size,mode:33188,mtimeMs:h.lastModified}}},lstat:async l=>o.stat(l)};return o}function lh(e,n){const r=fr();return r==="electron"||r==="tauri"?null:r==="webfs"&&n?sh(n):Os(e)}const t1=Object.freeze(Object.defineProperty({__proto__:null,CreateLightningFsAdapter:Os,CreateWebFsAdapter:sh,DeleteLightningFs:Yy,DetectFsBackend:fr,GetDirHandle:oh,GetFsForGit:lh,GetLightningFs:nh,IsBrowserWorkspaceEnvironment:Xy,IsDesktopNativeEnvironment:Zy,IsElectronEnvironment:Vy,IsTauriEnvironment:qy,IsWebFsEnvironment:Ky,RegisterDirHandle:ah},Symbol.toStringTag,{value:"Module"}));let Br=null,Dn=!1,tn=null,Pi=null;function Nr(){return Me.getState()}function Jy(){Br=null,Dn=!1,tn=null,Pi=null}function Ms(){const n=Nr().workspacePath||"";if(Dn&&n===Pi)return Br;Pi=n;const r=fr();if(r==="electron")return Br=null,Dn=!0,null;if(r==="webfs"){const o=oh(n);if(o)return Br=lh(n,o),Dn=!0,Br}return Br=Os(n||"notemac-default"),Dn=!0,Br}function ch(){const e=Nr().workspacePath||"";return tn!==null&&e===Pi?tn:fr()==="webfs"?(tn="/","/"):(tn=e||"/",tn)}function Qy(){return Nr().gitSettings.corsProxy||_d}function eb(e){const n=e||Nr().gitCredentials;if(n!=null)return()=>({username:n.username||n.token||"",password:n.token||""})}async function tb(){const e=Ms();if(e===null)return!1;try{const n=ch();return await Cs.findRoot({fs:e,filepath:n}),!0}catch{return!1}}async function uh(e){const n=Nr();if(e){const o=n.workspacePath||e.name;ah(o,e)}if(Jy(),Ms()!==null)try{const o=await tb();if(n.SetRepoInitialized(o),o){const{RefreshGitStatus:l}=await ht(async()=>{const{RefreshGitStatus:f}=await import("./GitStatusController-f_qnadiG.js");return{RefreshGitStatus:f}},__vite__mapDeps([0,1,2,3]),import.meta.url),{RefreshBranches:u}=await ht(async()=>{const{RefreshBranches:f}=await import("./GitBranchController-CvyWl29Z.js");return{RefreshBranches:f}},__vite__mapDeps([4,2,3,1]),import.meta.url),{FetchCommitLog:p}=await ht(async()=>{const{FetchCommitLog:f}=await import("./GitLogController-DjeBCuO2.js");return{FetchCommitLog:f}},__vite__mapDeps([5,1,2,3]),import.meta.url);await l(),await u(),await p()}}catch{n.SetRepoInitialized(!1)}}async function r1(){const e=Nr(),n=Ms();if(n!==null)try{e.SetGitOperationInProgress(!0),e.SetGitOperationError(null),await Cs.init({fs:n,dir:ch(),defaultBranch:"main"}),e.SetRepoInitialized(!0),e.SetCurrentBranch("main");const{RefreshGitStatus:r}=await ht(async()=>{const{RefreshGitStatus:o}=await import("./GitStatusController-f_qnadiG.js");return{RefreshGitStatus:o}},__vite__mapDeps([0,1,2,3]),import.meta.url);await r(),Nn(Fr.GIT_STATUS_CHANGED)}catch(r){e.SetGitOperationError(r instanceof Error?r.message:String(r))}finally{e.SetGitOperationInProgress(!1)}}async function n1(e,n,r,o){const l=Nr();try{l.SetGitOperationInProgress(!0),l.SetCurrentGitOperation("clone"),l.SetGitOperationProgress(0),l.SetGitOperationError(null),await Cs.clone({fs:n,http:vy,dir:r,url:e,corsProxy:Qy(),singleBranch:!0,depth:1,onAuth:eb(o),onProgress:u=>{u.total&&l.SetGitOperationProgress(Math.round(u.loaded/u.total*100))}}),l.SetRepoInitialized(!0),Nn(Fr.GIT_OPERATION_COMPLETE,{operation:"clone"})}catch(u){throw l.SetGitOperationError(u instanceof Error?u.message:String(u)),u}finally{l.SetGitOperationInProgress(!1),l.SetCurrentGitOperation(null),l.SetGitOperationProgress(0)}}let ji=null,ws=null;async function rb(){if(ji!==null)return!0;try{const e=await ht(()=>import("./core-DhEqZVGG.js"),[],import.meta.url),n=await ht(()=>import("./event-DjZVAIBO.js"),__vite__mapDeps([6,7]),import.meta.url);return ji=e.invoke,ws=n.listen,!0}catch{return!1}}async function nb(){if(!await rb()||ji===null||ws===null)return null;const n=ji,r=ws;return{onMenuAction(o){r("menu-action",l=>{const u=l.payload;o(u.action,u.value??void 0)})},onFileOpened(o){r("file-opened",l=>{o(l.payload)})},onFolderOpened(o){r("folder-opened",l=>{o(l.payload)})},onFileSaved(o){r("file-saved",l=>{o(l.payload)})},openFile(){n("open_file_dialog")},openFolder(){n("open_folder_dialog")},async readFile(o){return await n("read_file",{path:o})},async writeFile(o,l){return await n("write_file",{path:o,content:l})},async readDir(o){return await n("read_dir",{path:o})},saveFileAs(o,l){n("save_file_dialog",{content:o,suggestedName:l})},renameFile(o,l){n("rename_file",{oldPath:o,newName:l})},setAlwaysOnTop(o){n("set_always_on_top",{value:o})},async safeStorageEncrypt(o){return await n("safe_storage_encrypt",{plaintext:o})},async safeStorageDecrypt(o){return await n("safe_storage_decrypt",{encrypted:o})},async isSafeStorageAvailable(){return await n("is_safe_storage_available")}}}function nd(e){e.preventDefault(),e.stopPropagation()}async function id(e){var n;if(e.preventDefault(),e.stopPropagation(),(n=e.dataTransfer)!=null&&n.files){const r=Array.from(e.dataTransfer.files),o=Me.getState();for(const l of r){const u=await l.text();o.addTab({name:l.name,content:u,language:sr(l.name),lineEnding:br(u)})}}}function fh(e){const n=Me.getState(),r=n.tabs.find(o=>o.path===e.path);r?n.setActiveTab(r.id):(n.addTab({name:e.name,path:e.path,content:e.content,language:sr(e.name),lineEnding:br(e.content)}),n.addRecentFile(e.path,e.name))}function dh(e){const n=Me.getState();n.setFileTree(e.tree),n.setWorkspacePath(e.path),n.setSidebarPanel("explorer"),uh()}function hh(e,n){const r=Me.getState();$d(e,r.activeTabId,r.tabs,r.zoomLevel,n)}function ph(e){const n=Me.getState();n.activeTabId!==null&&n.updateTab(n.activeTabId,{name:e.name,path:e.path,isModified:!1,language:sr(e.name)})}function ib(){var e,n;if(Zn()){ab();return}window.electronAPI&&(window.electronAPI.onFileOpened(fh),window.electronAPI.onFolderOpened(dh),window.electronAPI.onMenuAction(hh),(n=(e=window.electronAPI).onFileSaved)==null||n.call(e,ph))}async function ab(){const e=await nb();e!==null&&(e.onFileOpened(fh),e.onFolderOpened(dh),e.onMenuAction(hh),e.onFileSaved(ph))}const ob=[{group:"Unicode",items:[{value:"utf-8",label:"UTF-8"},{value:"utf-8-bom",label:"UTF-8 BOM"},{value:"utf-16le",label:"UTF-16 LE"},{value:"utf-16be",label:"UTF-16 BE"}]},{group:"Western European",items:[{value:"windows-1252",label:"Windows-1252 (ANSI)"},{value:"iso-8859-1",label:"ISO 8859-1 (Latin I)"},{value:"iso-8859-15",label:"ISO 8859-15 (Latin 9)"},{value:"cp850",label:"OEM 850 (DOS Latin)"}]},{group:"Central European",items:[{value:"windows-1250",label:"Windows-1250"},{value:"iso-8859-2",label:"ISO 8859-2 (Latin II)"}]},{group:"Cyrillic",items:[{value:"windows-1251",label:"Windows-1251"},{value:"iso-8859-5",label:"ISO 8859-5"},{value:"koi8-r",label:"KOI8-R"},{value:"koi8-u",label:"KOI8-U"},{value:"cp866",label:"OEM 866 (DOS Cyrillic)"}]},{group:"Greek",items:[{value:"windows-1253",label:"Windows-1253"},{value:"iso-8859-7",label:"ISO 8859-7"}]},{group:"Turkish",items:[{value:"windows-1254",label:"Windows-1254"},{value:"iso-8859-9",label:"ISO 8859-9"}]},{group:"Hebrew",items:[{value:"windows-1255",label:"Windows-1255"},{value:"iso-8859-8",label:"ISO 8859-8"}]},{group:"Arabic",items:[{value:"windows-1256",label:"Windows-1256"},{value:"iso-8859-6",label:"ISO 8859-6"}]},{group:"Baltic",items:[{value:"windows-1257",label:"Windows-1257"},{value:"iso-8859-13",label:"ISO 8859-13"}]},{group:"Vietnamese",items:[{value:"windows-1258",label:"Windows-1258"}]},{group:"East Asian",items:[{value:"big5",label:"Big5 (Traditional Chinese)"},{value:"gb2312",label:"GB2312 (Simplified Chinese)"},{value:"shift_jis",label:"Shift JIS (Japanese)"},{value:"euc-kr",label:"EUC-KR (Korean)"},{value:"iso-2022-jp",label:"ISO-2022-JP"}]},{group:"Thai",items:[{value:"tis-620",label:"TIS-620 (Thai)"}]},{group:"DOS",items:[{value:"cp437",label:"OEM 437 (US)"},{value:"cp737",label:"OEM 737 (Greek)"},{value:"cp775",label:"OEM 775 (Baltic)"},{value:"cp852",label:"OEM 852 (Latin II)"},{value:"cp855",label:"OEM 855 (Cyrillic)"},{value:"cp857",label:"OEM 857 (Turkish)"},{value:"cp858",label:"OEM 858 (Latin I + Euro)"},{value:"cp860",label:"OEM 860 (Portuguese)"},{value:"cp861",label:"OEM 861 (Icelandic)"},{value:"cp862",label:"OEM 862 (Hebrew)"},{value:"cp863",label:"OEM 863 (French Canadian)"},{value:"cp865",label:"OEM 865 (Nordic)"},{value:"cp869",label:"OEM 869 (Greek)"}]}];function ad(){return ob}const sb=[{value:"plaintext",label:"Normal Text"},{value:"actionscript",label:"ActionScript"},{value:"ada",label:"Ada"},{value:"asp",label:"ASP"},{value:"asm",label:"Assembly"},{value:"autoit",label:"AutoIt"},{value:"bat",label:"Batch"},{value:"c",label:"C"},{value:"cpp",label:"C++"},{value:"csharp",label:"C#"},{value:"caml",label:"OCaml"},{value:"cmake",label:"CMake"},{value:"cobol",label:"COBOL"},{value:"coffeescript",label:"CoffeeScript"},{value:"css",label:"CSS"},{value:"d",label:"D"},{value:"dart",label:"Dart"},{value:"diff",label:"Diff"},{value:"dockerfile",label:"Dockerfile"},{value:"elixir",label:"Elixir"},{value:"erlang",label:"Erlang"},{value:"fortran",label:"Fortran"},{value:"fsharp",label:"F#"},{value:"gdscript",label:"GDScript"},{value:"go",label:"Go"},{value:"graphql",label:"GraphQL"},{value:"haskell",label:"Haskell"},{value:"html",label:"HTML"},{value:"ini",label:"INI"},{value:"java",label:"Java"},{value:"javascript",label:"JavaScript"},{value:"json",label:"JSON"},{value:"json5",label:"JSON5"},{value:"julia",label:"Julia"},{value:"kotlin",label:"Kotlin"},{value:"latex",label:"LaTeX"},{value:"less",label:"LESS"},{value:"lisp",label:"Lisp"},{value:"lua",label:"Lua"},{value:"makefile",label:"Makefile"},{value:"markdown",label:"Markdown"},{value:"matlab",label:"MATLAB"},{value:"nim",label:"Nim"},{value:"nsis",label:"NSIS"},{value:"objective-c",label:"Objective-C"},{value:"pascal",label:"Pascal"},{value:"perl",label:"Perl"},{value:"php",label:"PHP"},{value:"powershell",label:"PowerShell"},{value:"properties",label:"Properties"},{value:"python",label:"Python"},{value:"r",label:"R"},{value:"raku",label:"Raku"},{value:"restructuredtext",label:"reStructuredText"},{value:"ruby",label:"Ruby"},{value:"rust",label:"Rust"},{value:"sas",label:"SAS"},{value:"scala",label:"Scala"},{value:"scheme",label:"Scheme"},{value:"scss",label:"SCSS"},{value:"shell",label:"Shell/Bash"},{value:"smalltalk",label:"Smalltalk"},{value:"sql",label:"SQL"},{value:"swift",label:"Swift"},{value:"tcl",label:"Tcl"},{value:"toml",label:"TOML"},{value:"typescript",label:"TypeScript"},{value:"vb",label:"Visual Basic"},{value:"verilog",label:"Verilog"},{value:"vhdl",label:"VHDL"},{value:"xml",label:"XML"},{value:"yaml",label:"YAML"}];function lb(){return sb}function cb({theme:e,onAction:n,isElectron:r}){const[o,l]=de.useState(null),[u,p]=de.useState(null),[f,h]=de.useState(null),[x,_]=de.useState(-1),y=de.useRef(null),{settings:O,isRecordingMacro:R}=Me(),z=navigator.platform.includes("Mac"),N=z?"":"Ctrl+",L=z?"":"Shift+",D=z?"":"Alt+";de.useEffect(()=>{const B=K=>{y.current&&!y.current.contains(K.target)&&(l(null),h(null),_(-1))};return document.addEventListener("mousedown",B),()=>document.removeEventListener("mousedown",B)},[]);const U=(B,K)=>{const se=f?K.indexOf(f):-1;switch(B.key){case"ArrowLeft":case"ArrowRight":B.preventDefault();const S=B.key==="ArrowRight"?1:-1,ne=se===-1?0:(se+S+K.length)%K.length,Q=K[ne];h(Q),l(Q),_(-1);break;case"ArrowDown":B.preventDefault(),!o&&f?(l(f),_(0)):o&&_(x+1);break;case"ArrowUp":B.preventDefault(),o&&x>0&&_(x-1);break;case"Enter":case" ":if(B.preventDefault(),o&&x>=0){const W=q[o].filter(le=>le.type!=="separator"&&!le.label.startsWith(""));if(x<W.length){const le=W[x];Y(le)}}else f&&(l(f),_(0));break;case"Escape":B.preventDefault(),l(null),h(null),_(-1);break}},G=[];ad().forEach(B=>{G.push({type:"separator",label:`--- ${B.group} ---`}),B.items.forEach(K=>{G.push({label:K.label,action:"encoding",value:K.value})})});const X=lb().map(B=>({label:B.label,action:"language",value:B.value})),q={File:[{label:"New",shortcut:`${N}N`,action:"new"},{type:"separator",label:""},{label:"Open...",shortcut:`${N}O`,action:"open"},{label:"Open Folder as Workspace",action:"open-folder"},{label:"Reload from Disk",action:"reload-from-disk"},{type:"separator",label:""},{label:"Save",shortcut:`${N}S`,action:"save"},{label:"Save As...",shortcut:`${L}${N}S`,action:"save-as"},{label:"Save Copy As...",action:"save-copy-as"},{label:"Save All",action:"save-all"},{type:"separator",label:""},{label:"Rename...",action:"rename-file"},{label:"Delete from Disk",action:"delete-file"},{type:"separator",label:""},{label:"Restore Last Closed Tab",shortcut:`${L}${N}T`,action:"restore-last-closed"},{type:"separator",label:""},{label:"Close Tab",shortcut:`${N}W`,action:"close-tab"},{label:"Close All",action:"close-all"},{label:"Close Others",action:"close-others"},{label:"Close Tabs to Left",action:"close-tabs-to-left"},{label:"Close Tabs to Right",action:"close-tabs-to-right"},{label:"Close Unchanged",action:"close-unchanged"},{label:"Close All but Pinned",action:"close-all-but-pinned"},{type:"separator",label:""},{label:"Pin Tab",action:"pin-tab"},{type:"separator",label:""},{label:"Load Session...",action:"load-session"},{label:"Save Session...",action:"save-session"},{type:"separator",label:""},{label:"Print...",shortcut:`${N}P`,action:"print"}],Edit:[{label:"Undo",shortcut:`${N}Z`,action:"undo"},{label:"Redo",shortcut:`${L}${N}Z`,action:"redo"},{type:"separator",label:""},{label:"Cut",shortcut:`${N}X`,action:"cut"},{label:"Copy",shortcut:`${N}C`,action:"copy"},{label:"Paste",shortcut:`${N}V`,action:"paste"},{label:"Select All",shortcut:`${N}A`,action:"select-all"},{type:"separator",label:""},{label:"Duplicate Line",shortcut:`${N}D`,action:"duplicate-line"},{label:"Delete Line",shortcut:`${L}${N}K`,action:"delete-line"},{label:"Transpose Line",shortcut:`${D}T`,action:"transpose-line"},{label:"Move Line Up",shortcut:`${D}`,action:"move-line-up"},{label:"Move Line Down",shortcut:`${D}`,action:"move-line-down"},{label:"Split Lines",action:"split-lines"},{label:"Join Lines",action:"join-lines"},{type:"separator",label:""},{label:"Toggle Comment",shortcut:`${N}/`,action:"toggle-comment"},{label:"Block Comment",shortcut:`${L}${D}A`,action:"block-comment"},{type:"separator",label:""},{label:"UPPERCASE",shortcut:`${L}${N}U`,action:"uppercase"},{label:"lowercase",shortcut:`${N}U`,action:"lowercase"},{label:"Proper Case",action:"proper-case"},{label:"Sentence Case",action:"sentence-case"},{label:"Invert Case",action:"invert-case"},{label:"Random Case",action:"random-case"},{type:"separator",label:""},{label:"Insert Date/Time",action:"insert-datetime"},{type:"separator",label:""},{label:"Column Editor...",shortcut:`${D}C`,action:"column-editor"},{label:"Clipboard History",shortcut:`${N}${L}V`,action:"clipboard-history"},{label:"Character Panel",action:"char-panel"},{type:"separator",label:""},{label:"Copy File Path",action:"copy-file-path"},{label:"Copy File Name",action:"copy-file-name"},{label:"Copy File Dir",action:"copy-file-dir"},{type:"separator",label:""},{label:"Compare Files...",action:"compare-files"},{label:"Snippet Manager...",action:"snippet-manager"},{type:"separator",label:""},{label:"Set Read-Only",action:"toggle-readonly"}],Search:[{label:"Find...",shortcut:`${N}F`,action:"find"},{label:"Replace...",shortcut:`${N}H`,action:"replace"},{label:"Find in Files...",shortcut:`${L}${N}F`,action:"find-in-files"},{label:"Incremental Search",shortcut:`${N}${D}I`,action:"incremental-search"},{type:"separator",label:""},{label:"Mark...",action:"mark"},{label:"Mark Style 1",action:"mark-style",value:1},{label:"Mark Style 2",action:"mark-style",value:2},{label:"Mark Style 3",action:"mark-style",value:3},{label:"Mark Style 4",action:"mark-style",value:4},{label:"Mark Style 5",action:"mark-style",value:5},{label:"Clear All Marks",action:"clear-marks"},{type:"separator",label:""},{label:"Cut Marked Lines",action:"cut-marked-lines"},{label:"Copy Marked Lines",action:"copy-marked-lines"},{label:"Paste to (Replace) Marked Lines",action:"paste-marked-lines"},{label:"Delete Marked Lines",action:"delete-marked-lines"},{label:"Delete Unmarked Lines",action:"delete-unmarked-lines"},{label:"Inverse Marks",action:"inverse-marks"},{type:"separator",label:""},{label:"Go to Line...",shortcut:`${N}G`,action:"goto-line"},{label:"Go to Matching Bracket",shortcut:`${L}${N}\\`,action:"goto-bracket"},{label:"Select to Matching Bracket",action:"select-to-bracket"},{type:"separator",label:""},{label:"Toggle Bookmark",shortcut:`${N}F2`,action:"toggle-bookmark"},{label:"Next Bookmark",shortcut:"F2",action:"next-bookmark"},{label:"Previous Bookmark",shortcut:`${L}F2`,action:"prev-bookmark"},{label:"Clear All Bookmarks",action:"clear-bookmarks"},{type:"separator",label:""},{label:"Find Characters in Range...",action:"find-char-in-range"}],View:[{label:"Word Wrap",type:"checkbox",checked:O.wordWrap,action:"word-wrap"},{type:"separator",label:""},{label:"Show Whitespace",type:"checkbox",checked:O.showWhitespace,action:"show-whitespace"},{label:"Show EOL",type:"checkbox",checked:O.showEOL,action:"show-eol"},{label:"Show Non-Printable Characters",type:"checkbox",checked:O.showNonPrintable,action:"show-non-printable"},{label:"Show Wrap Symbol",type:"checkbox",checked:O.showWrapSymbol,action:"show-wrap-symbol"},{label:"Show Indent Guides",type:"checkbox",checked:O.showIndentGuides,action:"indent-guide"},{label:"Show Line Numbers",type:"checkbox",checked:O.showLineNumbers,action:"show-line-numbers"},{label:"Show Minimap",type:"checkbox",checked:O.showMinimap,action:"toggle-minimap"},{type:"separator",label:""},{label:"Fold All",action:"fold-all"},{label:"Unfold All",action:"unfold-all"},{label:"Fold Level 1",action:"fold-level",value:1},{label:"Fold Level 2",action:"fold-level",value:2},{label:"Fold Level 3",action:"fold-level",value:3},{label:"Fold Level 4",action:"fold-level",value:4},{label:"Fold Level 5",action:"fold-level",value:5},{label:"Fold Level 6",action:"fold-level",value:6},{label:"Fold Level 7",action:"fold-level",value:7},{label:"Fold Level 8",action:"fold-level",value:8},{type:"separator",label:""},{label:"Zoom In",shortcut:`${N}+`,action:"zoom-in"},{label:"Zoom Out",shortcut:`${N}-`,action:"zoom-out"},{label:"Reset Zoom",shortcut:`${N}0`,action:"zoom-reset"},{type:"separator",label:""},{label:"Toggle Sidebar",shortcut:`${N}B`,action:"toggle-sidebar"},{label:"Document List",action:"show-doc-list"},{label:"Function List",action:"show-function-list"},{label:"Project Panel",action:"show-project-panel"},{type:"separator",label:""},{label:"Distraction-Free Mode",type:"checkbox",checked:O.distractionFreeMode,action:"distraction-free"},{label:"Always on Top",type:"checkbox",checked:O.alwaysOnTop,action:"always-on-top"},{type:"separator",label:""},{label:"Synchronize Vertical Scrolling",type:"checkbox",checked:O.syncScrollVertical,action:"sync-scroll-v"},{label:"Synchronize Horizontal Scrolling",type:"checkbox",checked:O.syncScrollHorizontal,action:"sync-scroll-h"},{type:"separator",label:""},{label:"Split Right",action:"split-right"},{label:"Split Down",action:"split-down"},{label:"Close Split",action:"close-split"},{type:"separator",label:""},{label:"Summary...",action:"show-summary"},{label:"Monitoring (tail -f)",action:"toggle-monitoring"},{type:"separator",label:""},{label:"Command Palette...",shortcut:`${L}${N}P`,action:"command-palette"},{label:"Quick Open...",shortcut:`${N}P`,action:"quick-open"},{label:"Toggle Terminal",shortcut:"Ctrl+`",action:"toggle-terminal"}],Encoding:[...ad().flatMap(B=>[{type:"separator",label:` ${B.group} `},...B.items.map(K=>({label:K.label,action:"encoding",value:K.value}))]),{type:"separator",label:""},{label:"Line Ending: LF (Unix/Mac)",action:"line-ending",value:"LF"},{label:"Line Ending: CRLF (Windows)",action:"line-ending",value:"CRLF"},{label:"Line Ending: CR (Old Mac)",action:"line-ending",value:"CR"}],Language:X,"Line Ops":[{label:"Sort Lines Ascending",action:"sort-asc"},{label:"Sort Lines Descending",action:"sort-desc"},{label:"Sort Lines Case Insensitive (Asc)",action:"sort-asc-ci"},{label:"Sort Lines Case Insensitive (Desc)",action:"sort-desc-ci"},{label:"Sort Lines by Length (Asc)",action:"sort-len-asc"},{label:"Sort Lines by Length (Desc)",action:"sort-len-desc"},{type:"separator",label:""},{label:"Remove Duplicate Lines",action:"remove-duplicates"},{label:"Remove Consecutive Duplicate Lines",action:"remove-consecutive-duplicates"},{label:"Remove Empty Lines",action:"remove-empty-lines"},{label:"Remove Empty Lines (Containing Blank)",action:"remove-blank-lines"},{type:"separator",label:""},{label:"Trim Trailing Spaces",action:"trim-trailing"},{label:"Trim Leading Spaces",action:"trim-leading"},{label:"Trim Leading and Trailing Spaces",action:"trim-both"},{label:"EOL to Space",action:"eol-to-space"},{type:"separator",label:""},{label:"TAB to Space",action:"tab-to-space"},{label:"Space to TAB (Leading)",action:"space-to-tab-leading"},{label:"Space to TAB (All)",action:"space-to-tab-all"},{type:"separator",label:""},{label:"Insert Blank Line Above",action:"insert-blank-above"},{label:"Insert Blank Line Below",action:"insert-blank-below"},{label:"Reverse Line Order",action:"reverse-lines"}],Macro:[{label:R?"Stop Recording":"Start Recording",shortcut:`${L}${N}R`,action:R?"macro-stop":"macro-start"},{label:"Playback",shortcut:`${L}${N}P`,action:"macro-playback"},{type:"separator",label:""},{label:"Run Macro Multiple Times...",action:"macro-run-multiple"},{label:"Save Recorded Macro...",action:"macro-save"}],Git:[{label:"Source Control Panel",action:"show-git-panel"},{type:"separator",label:""},{label:"Clone Repository...",action:"clone-repository"},{type:"separator",label:""},{label:"Compare with HEAD",action:"compare-files"},{type:"separator",label:""},{label:"Git Settings...",action:"git-settings"}],Run:[{label:"Run Command...",action:"run-command"},{type:"separator",label:""},{label:"Search on Google",action:"search-google"},{label:"Search on Wikipedia",action:"search-wikipedia"},{label:"Open in Browser",action:"open-in-browser"}],Tools:[{label:"MD5 - Generate",action:"hash-md5"},{label:"MD5 - Copy to Clipboard",action:"hash-md5-clipboard"},{label:"SHA-1 - Generate",action:"hash-sha1"},{label:"SHA-1 - Copy to Clipboard",action:"hash-sha1-clipboard"},{label:"SHA-256 - Generate",action:"hash-sha256"},{label:"SHA-256 - Copy to Clipboard",action:"hash-sha256-clipboard"},{label:"SHA-512 - Generate",action:"hash-sha512"},{label:"SHA-512 - Copy to Clipboard",action:"hash-sha512-clipboard"},{type:"separator",label:""},{label:"MD5 - Generate from File",action:"hash-md5-file"},{label:"SHA-256 - Generate from File",action:"hash-sha256-file"},{type:"separator",label:""},{label:"Base64 Encode",action:"base64-encode"},{label:"Base64 Decode",action:"base64-decode"},{type:"separator",label:""},{label:"URL Encode",action:"url-encode"},{label:"URL Decode",action:"url-decode"},{type:"separator",label:""},{label:"JSON Format",action:"json-format"},{label:"JSON Minify",action:"json-minify"}],AI:[{label:"AI Chat Panel",shortcut:"Ctrl+Shift+A",action:"ai-chat"},{type:"separator",label:""},{label:"Explain Code",shortcut:"Ctrl+Shift+E",action:"ai-explain"},{label:"Refactor Code",shortcut:"Ctrl+Shift+R",action:"ai-refactor"},{label:"Generate Tests",action:"ai-generate-tests"},{label:"Generate Documentation",action:"ai-generate-docs"},{label:"Fix Error",action:"ai-fix-error"},{label:"Simplify Code",action:"ai-simplify"},{type:"separator",label:""},{label:"Toggle Inline Completions",action:"ai-toggle-inline"},{type:"separator",label:""},{label:"AI Settings...",action:"ai-settings"}],Settings:[{label:"Preferences...",shortcut:`${N},`,action:"preferences"},{label:"Shortcut Mapper...",action:"shortcut-mapper"},{type:"separator",label:""},{label:"About Notemac++",action:"about"}]},Y=B=>{B.type!=="separator"&&(B.label.startsWith("")||(B.type==="checkbox"?n(B.action,!B.checked):B.action&&n(B.action,B.value),l(null)))};return E.jsxs("div",{ref:y,role:"menubar",onKeyDown:B=>U(B,Object.keys(q)),style:{display:"flex",alignItems:"center",height:30,backgroundColor:e.menuBg,borderBottom:`1px solid ${e.border}`,paddingLeft:8,flexShrink:0,outline:"none",overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none"},tabIndex:0,children:[E.jsx("span",{style:{fontWeight:600,fontSize:13,marginRight:16,color:e.accent},children:"N++"}),Object.entries(q).map(([B,K])=>E.jsxs("div",{style:{position:"relative"},children:[E.jsx("div",{role:"menuitem","aria-haspopup":"true","aria-expanded":o===B,tabIndex:f===B?0:-1,style:{padding:"4px 10px",cursor:"pointer",borderRadius:4,fontSize:13,backgroundColor:o===B||f===B?e.bgHover:"transparent",color:o===B?e.text:e.menuText,outline:f===B?`1px solid ${e.accent}`:"none",outlineOffset:"-1px"},onClick:()=>{h(B),l(o===B?null:B),_(-1)},onMouseEnter:()=>{h(B),o&&l(B)},onMouseLeave:()=>h(null),children:B}),o===B&&E.jsx("div",{role:"menu",style:{position:"absolute",top:"100%",left:0,minWidth:Math.min(280,window.innerWidth-16),maxWidth:"calc(100vw - 8px)",maxHeight:"calc(100vh - 80px)",overflowY:"auto",backgroundColor:e.menuBg,border:`1px solid ${e.border}`,borderRadius:6,padding:"4px 0",zIndex:Ed,boxShadow:"0 4px 16px rgba(0,0,0,0.3)"},children:K.map((se,S)=>{if(se.type==="separator")return se.label&&se.label.startsWith("")?E.jsx("div",{style:{padding:"4px 16px",fontSize:11,fontWeight:700,color:e.textMuted,textTransform:"uppercase",letterSpacing:.5,cursor:"default"},children:se.label.replace(/\u2500 /g,"").replace(/ \u2500/g,"")},`sep-header-${S}`):E.jsx("div",{style:{height:1,backgroundColor:e.border,margin:"4px 0"}},`sep-divider-${S}`);const Q=K.filter(le=>le.type!=="separator"&&!le.label.startsWith("")).findIndex(le=>le.label===se.label),oe=`${B}-${se.label}-${S}`,W=x===Q;return E.jsxs("div",{role:"menuitem",tabIndex:W?0:-1,style:{padding:"5px 16px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:24,fontSize:13,backgroundColor:W||u===oe?e.bgHover:"transparent",color:e.menuText,outline:W?`1px solid ${e.accent}`:"none",outlineOffset:"-1px"},onClick:()=>Y(se),onMouseEnter:()=>{p(oe),_(Q)},onMouseLeave:()=>p(null),children:[E.jsxs("span",{style:{display:"flex",alignItems:"center",gap:8},children:[se.type==="checkbox"&&E.jsx("span",{style:{width:16,textAlign:"center"},children:se.checked?"":""}),se.label]}),se.shortcut&&E.jsx("span",{style:{opacity:.5,fontSize:11},children:se.shortcut})]},`${B}-${se.action||se.label}-${S}`)})})]},B)),R&&E.jsxs("div",{className:"recording-indicator",style:{display:"flex",alignItems:"center",gap:6,marginLeft:"auto",marginRight:12,color:"#ff4444",fontSize:12,fontWeight:600},children:[E.jsx("span",{style:{width:8,height:8,borderRadius:"50%",backgroundColor:"#ff4444",display:"inline-block"}}),"REC"]})]})}const Pt={newFile:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M9 1H4a1 1 0 00-1 1v12a1 1 0 001 1h8a1 1 0 001-1V5L9 1z"}),E.jsx("path",{d:"M9 1v4h4"}),E.jsx("path",{d:"M8 8v4M6 10h4"})]}),open:e=>E.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:E.jsx("path",{d:"M2 13V4a1 1 0 011-1h3.5l1.5 1.5H13a1 1 0 011 1V13a1 1 0 01-1 1H3a1 1 0 01-1-1z"})}),save:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M13 14H3a1 1 0 01-1-1V3a1 1 0 011-1h7l3 3v8a1 1 0 01-1 1z"}),E.jsx("path",{d:"M11 14V9H5v5"}),E.jsx("path",{d:"M5 2v3h5"})]}),saveAll:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M12 14H4a1 1 0 01-1-1V4a1 1 0 011-1h5.5l2.5 2.5V13a1 1 0 01-1 1z"}),E.jsx("path",{d:"M10 14V10H6v4"}),E.jsx("path",{d:"M6 3v2h3.5"}),E.jsx("path",{d:"M14 5v7.5",opacity:"0.5"}),E.jsx("path",{d:"M5 2H14.5",opacity:"0.5"})]}),undo:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M3 7h6a3.5 3.5 0 010 7H7"}),E.jsx("path",{d:"M6 4L3 7l3 3"})]}),redo:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M13 7H7a3.5 3.5 0 000 7h2"}),E.jsx("path",{d:"M10 4l3 3-3 3"})]}),find:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"7",cy:"7",r:"4"}),E.jsx("path",{d:"M14 14l-3.5-3.5"})]}),replace:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"5.5",cy:"5.5",r:"3"}),E.jsx("path",{d:"M14 14l-2.8-2.8"}),E.jsx("path",{d:"M10 7l2-2 2 2"}),E.jsx("path",{d:"M12 5v5.5a1.5 1.5 0 01-3 0"})]}),zoomIn:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"7",cy:"7",r:"4"}),E.jsx("path",{d:"M14 14l-3.5-3.5"}),E.jsx("path",{d:"M7 5v4M5 7h4"})]}),zoomOut:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"7",cy:"7",r:"4"}),E.jsx("path",{d:"M14 14l-3.5-3.5"}),E.jsx("path",{d:"M5 7h4"})]}),record:e=>E.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:E.jsx("circle",{cx:"8",cy:"8",r:"5",fill:e})}),stop:e=>E.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:E.jsx("rect",{x:"4",y:"4",width:"8",height:"8",rx:"1",fill:e})}),play:e=>E.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:e,children:E.jsx("polygon",{points:"5,3 13,8 5,13"})}),sidebar:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("rect",{x:"2",y:"2",width:"12",height:"12",rx:"1"}),E.jsx("path",{d:"M6 2v12"})]}),wordWrap:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M3 4h10M3 8h8a2 2 0 010 4H8"}),E.jsx("path",{d:"M10 10l-2 2 2 2"})]}),whitespace:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M3 12h10"}),E.jsx("circle",{cx:"5",cy:"7",r:"0.8",fill:e}),E.jsx("circle",{cx:"8",cy:"7",r:"0.8",fill:e}),E.jsx("circle",{cx:"11",cy:"7",r:"0.8",fill:e})]}),settings:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"8",cy:"8",r:"2"}),E.jsx("path",{d:"M8 1.5v2M8 12.5v2M1.5 8h2M12.5 8h2M3.4 3.4l1.4 1.4M11.2 11.2l1.4 1.4M3.4 12.6l1.4-1.4M11.2 4.8l1.4-1.4"})]})};function Lt({icon:e,title:n,onClick:r,theme:o,active:l,danger:u}){const[p,f]=St.useState(!1);return E.jsx("button",{title:n,"aria-label":n,onClick:r,onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),style:{background:p?o.bgHover:l?o.bgActive:"transparent",border:"none",color:u?o.danger:l?o.accent:o.textSecondary,cursor:"pointer",padding:"4px 6px",borderRadius:4,fontSize:16,lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:28,height:28},children:e})}function Fn({theme:e}){return E.jsx("div",{style:{width:1,height:20,backgroundColor:e.border,margin:"0 4px"}})}function ub({theme:e,onAction:n}){const{isRecordingMacro:r,settings:o}=Me(),l=e.textSecondary,u=e.danger||"#e53e3e";return E.jsxs("div",{style:{display:"flex",alignItems:"center",height:36,backgroundColor:e.bgSecondary,borderBottom:`1px solid ${e.border}`,padding:"0 8px",gap:2,flexShrink:0,overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none"},children:[E.jsx(Lt,{icon:Pt.newFile(l),title:"New (Cmd+N)",onClick:()=>n("new"),theme:e}),E.jsx(Lt,{icon:Pt.open(l),title:"Open (Cmd+O)",onClick:()=>n("open"),theme:e}),E.jsx(Lt,{icon:Pt.save(l),title:"Save (Cmd+S)",onClick:()=>n("save"),theme:e}),E.jsx(Lt,{icon:Pt.saveAll(l),title:"Save All",onClick:()=>n("save-all"),theme:e}),E.jsx(Fn,{theme:e}),E.jsx(Lt,{icon:Pt.undo(l),title:"Undo (Cmd+Z)",onClick:()=>n("undo"),theme:e}),E.jsx(Lt,{icon:Pt.redo(l),title:"Redo (Cmd+Shift+Z)",onClick:()=>n("redo"),theme:e}),E.jsx(Fn,{theme:e}),E.jsx(Lt,{icon:Pt.find(l),title:"Find (Cmd+F)",onClick:()=>n("find"),theme:e}),E.jsx(Lt,{icon:Pt.replace(l),title:"Replace (Cmd+H)",onClick:()=>n("replace"),theme:e}),E.jsx(Fn,{theme:e}),E.jsx(Lt,{icon:Pt.zoomIn(l),title:"Zoom In (Cmd++)",onClick:()=>n("zoom-in"),theme:e}),E.jsx(Lt,{icon:Pt.zoomOut(l),title:"Zoom Out (Cmd+-)",onClick:()=>n("zoom-out"),theme:e}),E.jsx(Fn,{theme:e}),E.jsx(Lt,{icon:r?Pt.stop(u):Pt.record(l),title:r?"Stop Recording":"Start Recording",onClick:()=>n(r?"macro-stop":"macro-start"),theme:e,danger:r}),E.jsx(Lt,{icon:Pt.play(l),title:"Playback Macro",onClick:()=>n("macro-playback"),theme:e}),E.jsx(Fn,{theme:e}),E.jsx(Lt,{icon:Pt.sidebar(l),title:"Toggle Sidebar (Cmd+B)",onClick:()=>n("toggle-sidebar"),theme:e}),E.jsx(Lt,{icon:Pt.wordWrap(l),title:"Word Wrap",onClick:()=>n("word-wrap",!o.wordWrap),theme:e}),E.jsx(Lt,{icon:Pt.whitespace(l),title:"Show Whitespace",onClick:()=>n("show-whitespace",!o.showWhitespace),theme:e}),E.jsx("div",{style:{flex:1}}),E.jsx(Lt,{icon:Pt.settings(l),title:"Settings (Cmd+,)",onClick:()=>n("preferences"),theme:e})]})}function fb({theme:e}){const{tabs:n,activeTabId:r,setActiveTab:o,closeTab:l,addTab:u,closeOtherTabs:p,closeAllTabs:f,moveTab:h,setSplitView:x,closeTabsToLeft:_,closeTabsToRight:y,closeUnchangedTabs:O,closeAllButPinned:R,togglePinTab:z,setTabColor:N}=Me(),[L,D]=de.useState(null),[U,G]=de.useState(null),[X,q]=de.useState(null),[Y,B]=de.useState(!1),K=W=>{D(W)},se=(W,le)=>{W.preventDefault(),G(le)},S=W=>{L!==null&&L!==W&&h(L,W),D(null),G(null)},ne=(W,le)=>{W.preventDefault(),q({x:W.clientX,y:W.clientY,tabId:le}),B(!1)},Q=(W,le)=>{W.button===1&&(W.preventDefault(),l(le))};St.useEffect(()=>{const W=()=>{q(null),B(!1)};if(X)return document.addEventListener("click",W),()=>document.removeEventListener("click",W)},[X]);const oe=X?n.find(W=>W.id===X.tabId):null;return E.jsxs(E.Fragment,{children:[E.jsxs("div",{style:{display:"flex",alignItems:"flex-end",backgroundColor:e.tabBg,borderBottom:`1px solid ${e.border}`,overflowX:"auto",overflowY:"hidden",scrollbarWidth:"thin",flexShrink:0,height:xa},children:[n.map((W,le)=>{const te=W.id===r,ie=ru[W.tabColor];return E.jsxs("div",{draggable:!0,onDragStart:()=>K(le),onDragOver:ue=>se(ue,le),onDrop:()=>S(le),onDragEnd:()=>{D(null),G(null)},onClick:()=>o(W.id),onMouseDown:ue=>Q(ue,W.id),onContextMenu:ue=>ne(ue,W.id),style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",cursor:"pointer",backgroundColor:te?e.tabActiveBg:e.tabBg,color:te?e.tabActiveText:e.textSecondary,borderRight:`1px solid ${e.tabBorder}`,borderTop:W.tabColor!=="none"?`3px solid ${ie}`:te?`2px solid ${e.accent}`:"2px solid transparent",borderBottom:te?"none":`1px solid ${e.border}`,minWidth:window.innerWidth<480?60:nm,maxWidth:im,height:xa,position:"relative",opacity:L===le?.5:1,borderLeft:U===le?`2px solid ${e.accent}`:"none",fontSize:13,whiteSpace:"nowrap",flexShrink:0},children:[E.jsxs("span",{style:{overflow:"hidden",textOverflow:"ellipsis",flex:1,display:"flex",alignItems:"center",gap:4},children:[W.isPinned&&E.jsx("span",{style:{fontSize:10,opacity:.7},title:"Pinned",children:""}),W.isModified&&E.jsx("span",{style:{color:e.warning},children:""}),W.isReadOnly&&E.jsx("span",{style:{fontSize:10,opacity:.7},title:"Read Only",children:""}),W.name]}),!W.isPinned&&E.jsx("button",{"aria-label":`Close tab: ${W.name}`,onClick:ue=>{ue.stopPropagation(),l(W.id)},style:{width:ou,height:ou,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,fontSize:14,opacity:.5,flexShrink:0,backgroundColor:"transparent",border:"none",cursor:"pointer",color:"inherit",padding:0},onMouseEnter:ue=>{ue.target.style.opacity="1",ue.target.style.backgroundColor=e.bgHover},onMouseLeave:ue=>{ue.target.style.opacity="0.5",ue.target.style.backgroundColor="transparent"},children:""})]},W.id)}),E.jsx("button",{"aria-label":"New tab",onClick:()=>u(),style:{display:"flex",alignItems:"center",justifyContent:"center",width:am,height:xa,cursor:"pointer",color:e.textMuted,fontSize:18,flexShrink:0,backgroundColor:"transparent",border:"none",padding:0},onMouseEnter:W=>{W.target.style.color=e.text},onMouseLeave:W=>{W.target.style.color=e.textMuted},children:"+"})]}),X&&E.jsxs("div",{className:"context-menu",style:{left:X.x,top:X.y,backgroundColor:e.menuBg,border:`1px solid ${e.border}`,position:"fixed",zIndex:2e4,borderRadius:6,padding:"4px 0",minWidth:200,boxShadow:"0 4px 16px rgba(0,0,0,0.3)"},children:[[{label:"Close",action:()=>l(X.tabId)},{label:"Close Others",action:()=>p(X.tabId)},{label:"Close Tabs to the Left",action:()=>_(X.tabId)},{label:"Close Tabs to the Right",action:()=>y(X.tabId)},{label:"Close All",action:()=>f()},{label:"Close Unchanged",action:()=>O()},{label:"Close All but Pinned",action:()=>R()},{label:"separator"},{label:oe!=null&&oe.isPinned?"Unpin Tab":"Pin Tab",action:()=>z(X.tabId)},{label:"separator"},{label:"Tab Color",action:()=>B(!Y)},{label:"separator"},{label:"Clone to Split View",action:()=>x("vertical",X.tabId)}].map((W,le)=>W.label==="separator"?E.jsx("div",{style:{height:1,backgroundColor:e.border,margin:"4px 0"}},`sep-${le}`):E.jsx("div",{style:{padding:"5px 16px",cursor:"pointer",fontSize:13,color:e.menuText},onClick:te=>{te.stopPropagation(),W.action(),W.label!=="Tab Color"&&q(null)},onMouseEnter:te=>{te.target.style.backgroundColor=e.bgHover},onMouseLeave:te=>{te.target.style.backgroundColor="transparent"},children:W.label},`contextmenu-${W.label}-${le}`)),Y&&E.jsx("div",{style:{display:"flex",gap:4,padding:"4px 16px 8px"},children:["none","color1","color2","color3","color4","color5"].map(W=>E.jsx("div",{onClick:le=>{le.stopPropagation(),N(X.tabId,W),q(null)},style:{width:20,height:20,borderRadius:4,backgroundColor:W==="none"?e.bgTertiary:ru[W],border:(oe==null?void 0:oe.tabColor)===W?"2px solid white":`1px solid ${e.border}`,cursor:"pointer"},title:W==="none"?"No color":W},`color-${W}`))})]})]})}function od(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,o=Array(n);r<n;r++)o[r]=e[r];return o}function db(e){if(Array.isArray(e))return e}function hb(e,n,r){return(n=vb(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function pb(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var o,l,u,p,f=[],h=!0,x=!1;try{if(u=(r=r.call(e)).next,n!==0)for(;!(h=(o=u.call(r)).done)&&(f.push(o.value),f.length!==n);h=!0);}catch(_){x=!0,l=_}finally{try{if(!h&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(x)throw l}}return f}}function gb(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sd(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,o)}return r}function ld(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?sd(Object(r),!0).forEach(function(o){hb(e,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sd(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))})}return e}function mb(e,n){if(e==null)return{};var r,o,l=wb(e,n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)r=u[o],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}function wb(e,n){if(e==null)return{};var r={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(n.indexOf(o)!==-1)continue;r[o]=e[o]}return r}function yb(e,n){return db(e)||pb(e,n)||xb(e,n)||gb()}function bb(e,n){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var o=r.call(e,n);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function vb(e){var n=bb(e,"string");return typeof n=="symbol"?n:n+""}function xb(e,n){if(e){if(typeof e=="string")return od(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?od(e,n):void 0}}function _b(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function cd(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),r.push.apply(r,o)}return r}function ud(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?cd(Object(r),!0).forEach(function(o){_b(e,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cd(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))})}return e}function Sb(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(o){return n.reduceRight(function(l,u){return u(l)},o)}}function Ln(e){return function n(){for(var r=this,o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];return l.length>=e.length?e.apply(this,l):function(){for(var p=arguments.length,f=new Array(p),h=0;h<p;h++)f[h]=arguments[h];return n.apply(r,[].concat(l,f))}}}function Bi(e){return{}.toString.call(e).includes("Object")}function kb(e){return!Object.keys(e).length}function Wn(e){return typeof e=="function"}function Eb(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function Ab(e,n){return Bi(n)||yr("changeType"),Object.keys(n).some(function(r){return!Eb(e,r)})&&yr("changeField"),n}function Ib(e){Wn(e)||yr("selectorType")}function Tb(e){Wn(e)||Bi(e)||yr("handlerType"),Bi(e)&&Object.values(e).some(function(n){return!Wn(n)})&&yr("handlersType")}function Cb(e){e||yr("initialIsRequired"),Bi(e)||yr("initialType"),kb(e)&&yr("initialContent")}function Rb(e,n){throw new Error(e[n]||e.default)}var Ob={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},yr=Ln(Rb)(Ob),Si={changes:Ab,selector:Ib,handler:Tb,initial:Cb};function Mb(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Si.initial(e),Si.handler(n);var r={current:e},o=Ln(Bb)(r,n),l=Ln(jb)(r),u=Ln(Si.changes)(e),p=Ln(Pb)(r);function f(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(_){return _};return Si.selector(x),x(r.current)}function h(x){Sb(o,l,u,p)(x)}return[f,h]}function Pb(e,n){return Wn(n)?n(e.current):n}function jb(e,n){return e.current=ud(ud({},e.current),n),n}function Bb(e,n,r){return Wn(n)?n(e.current):Object.keys(r).forEach(function(o){var l;return(l=n[o])===null||l===void 0?void 0:l.call(n,e.current[o])}),r}var Fb={create:Mb},Db={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function Lb(e){return function n(){for(var r=this,o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];return l.length>=e.length?e.apply(this,l):function(){for(var p=arguments.length,f=new Array(p),h=0;h<p;h++)f[h]=arguments[h];return n.apply(r,[].concat(l,f))}}}function $b(e){return{}.toString.call(e).includes("Object")}function Nb(e){return e||fd("configIsRequired"),$b(e)||fd("configType"),e.urls?{paths:{vs:e.urls.monacoBase}}:e}function Ub(e,n){throw new Error(e[n]||e.default)}var zb={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},fd=Lb(Ub)(zb),Gb={config:Nb},Hb=function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return function(l){return r.reduceRight(function(u,p){return p(u)},l)}};function gh(e,n){return Object.keys(n).forEach(function(r){n[r]instanceof Object&&e[r]&&Object.assign(n[r],gh(e[r],n[r]))}),ld(ld({},e),n)}var Wb={type:"cancelation",msg:"operation is manually canceled"};function as(e){var n=!1,r=new Promise(function(o,l){e.then(function(u){return n?l(Wb):o(u)}),e.catch(l)});return r.cancel=function(){return n=!0},r}var qb=["monaco"],Vb=Fb.create({config:Db,isInitialized:!1,resolve:null,reject:null,monaco:null}),mh=yb(Vb,2),Jn=mh[0],Gi=mh[1];function Zb(e){var n=Gb.config(e),r=n.monaco,o=mb(n,qb);Gi(function(l){return{config:gh(l.config,o),monaco:r}})}function Kb(){var e=Jn(function(n){var r=n.monaco,o=n.isInitialized,l=n.resolve;return{monaco:r,isInitialized:o,resolve:l}});if(!e.isInitialized){if(Gi({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),as(os);if(window.monaco&&window.monaco.editor)return wh(window.monaco),e.resolve(window.monaco),as(os);Hb(Xb,Jb)(Qb)}return as(os)}function Xb(e){return document.body.appendChild(e)}function Yb(e){var n=document.createElement("script");return e&&(n.src=e),n}function Jb(e){var n=Jn(function(o){var l=o.config,u=o.reject;return{config:l,reject:u}}),r=Yb("".concat(n.config.paths.vs,"/loader.js"));return r.onload=function(){return e()},r.onerror=n.reject,r}function Qb(){var e=Jn(function(r){var o=r.config,l=r.resolve,u=r.reject;return{config:o,resolve:l,reject:u}}),n=window.require;n.config(e.config),n(["vs/editor/editor.main"],function(r){var o=r.m||r;wh(o),e.resolve(o)},function(r){e.reject(r)})}function wh(e){Jn().monaco||Gi({monaco:e})}function e0(){return Jn(function(e){var n=e.monaco;return n})}var os=new Promise(function(e,n){return Gi({resolve:e,reject:n})}),yh={config:Zb,init:Kb,__getMonacoInstance:e0},t0={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},ss=t0,r0={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},n0=r0;function i0({children:e}){return St.createElement("div",{style:n0.container},e)}var a0=i0,o0=a0;function s0({width:e,height:n,isEditorReady:r,loading:o,_ref:l,className:u,wrapperProps:p}){return St.createElement("section",{style:{...ss.wrapper,width:e,height:n},...p},!r&&St.createElement(o0,null,o),St.createElement("div",{ref:l,style:{...ss.fullWidth,...!r&&ss.hide},className:u}))}var l0=s0,bh=de.memo(l0);function c0(e){de.useEffect(e,[])}var vh=c0;function u0(e,n,r=!0){let o=de.useRef(!0);de.useEffect(o.current||!r?()=>{o.current=!1}:e,n)}var Wt=u0;function Un(){}function rn(e,n,r,o){return f0(e,o)||d0(e,n,r,o)}function f0(e,n){return e.editor.getModel(xh(e,n))}function d0(e,n,r,o){return e.editor.createModel(n,r,o?xh(e,o):void 0)}function xh(e,n){return e.Uri.parse(n)}function h0({original:e,modified:n,language:r,originalLanguage:o,modifiedLanguage:l,originalModelPath:u,modifiedModelPath:p,keepCurrentOriginalModel:f=!1,keepCurrentModifiedModel:h=!1,theme:x="light",loading:_="Loading...",options:y={},height:O="100%",width:R="100%",className:z,wrapperProps:N={},beforeMount:L=Un,onMount:D=Un}){let[U,G]=de.useState(!1),[X,q]=de.useState(!0),Y=de.useRef(null),B=de.useRef(null),K=de.useRef(null),se=de.useRef(D),S=de.useRef(L),ne=de.useRef(!1);vh(()=>{let le=yh.init();return le.then(te=>(B.current=te)&&q(!1)).catch(te=>(te==null?void 0:te.type)!=="cancelation"&&void 0),()=>Y.current?W():le.cancel()}),Wt(()=>{if(Y.current&&B.current){let le=Y.current.getOriginalEditor(),te=rn(B.current,e||"",o||r||"text",u||"");te!==le.getModel()&&le.setModel(te)}},[u],U),Wt(()=>{if(Y.current&&B.current){let le=Y.current.getModifiedEditor(),te=rn(B.current,n||"",l||r||"text",p||"");te!==le.getModel()&&le.setModel(te)}},[p],U),Wt(()=>{let le=Y.current.getModifiedEditor();le.getOption(B.current.editor.EditorOption.readOnly)?le.setValue(n||""):n!==le.getValue()&&(le.executeEdits("",[{range:le.getModel().getFullModelRange(),text:n||"",forceMoveMarkers:!0}]),le.pushUndoStop())},[n],U),Wt(()=>{var le,te;(te=(le=Y.current)==null?void 0:le.getModel())==null||te.original.setValue(e||"")},[e],U),Wt(()=>{let{original:le,modified:te}=Y.current.getModel();B.current.editor.setModelLanguage(le,o||r||"text"),B.current.editor.setModelLanguage(te,l||r||"text")},[r,o,l],U),Wt(()=>{var le;(le=B.current)==null||le.editor.setTheme(x)},[x],U),Wt(()=>{var le;(le=Y.current)==null||le.updateOptions(y)},[y],U);let Q=de.useCallback(()=>{var ie;if(!B.current)return;S.current(B.current);let le=rn(B.current,e||"",o||r||"text",u||""),te=rn(B.current,n||"",l||r||"text",p||"");(ie=Y.current)==null||ie.setModel({original:le,modified:te})},[r,n,l,e,o,u,p]),oe=de.useCallback(()=>{var le;!ne.current&&K.current&&(Y.current=B.current.editor.createDiffEditor(K.current,{automaticLayout:!0,...y}),Q(),(le=B.current)==null||le.editor.setTheme(x),G(!0),ne.current=!0)},[y,x,Q]);de.useEffect(()=>{U&&se.current(Y.current,B.current)},[U]),de.useEffect(()=>{!X&&!U&&oe()},[X,U,oe]);function W(){var te,ie,ue,ce;let le=(te=Y.current)==null?void 0:te.getModel();f||((ie=le==null?void 0:le.original)==null||ie.dispose()),h||((ue=le==null?void 0:le.modified)==null||ue.dispose()),(ce=Y.current)==null||ce.dispose()}return St.createElement(bh,{width:R,height:O,isEditorReady:U,loading:_,_ref:K,className:z,wrapperProps:N})}var p0=h0,i1=de.memo(p0);function g0(e){let n=de.useRef();return de.useEffect(()=>{n.current=e},[e]),n.current}var m0=g0,ki=new Map;function w0({defaultValue:e,defaultLanguage:n,defaultPath:r,value:o,language:l,path:u,theme:p="light",line:f,loading:h="Loading...",options:x={},overrideServices:_={},saveViewState:y=!0,keepCurrentModel:O=!1,width:R="100%",height:z="100%",className:N,wrapperProps:L={},beforeMount:D=Un,onMount:U=Un,onChange:G,onValidate:X=Un}){let[q,Y]=de.useState(!1),[B,K]=de.useState(!0),se=de.useRef(null),S=de.useRef(null),ne=de.useRef(null),Q=de.useRef(U),oe=de.useRef(D),W=de.useRef(),le=de.useRef(o),te=m0(u),ie=de.useRef(!1),ue=de.useRef(!1);vh(()=>{let xe=yh.init();return xe.then(Te=>(se.current=Te)&&K(!1)).catch(Te=>(Te==null?void 0:Te.type)!=="cancelation"&&void 0),()=>S.current?Fe():xe.cancel()}),Wt(()=>{var Te,Ne,Je,it;let xe=rn(se.current,e||o||"",n||l||"",u||r||"");xe!==((Te=S.current)==null?void 0:Te.getModel())&&(y&&ki.set(te,(Ne=S.current)==null?void 0:Ne.saveViewState()),(Je=S.current)==null||Je.setModel(xe),y&&((it=S.current)==null||it.restoreViewState(ki.get(u))))},[u],q),Wt(()=>{var xe;(xe=S.current)==null||xe.updateOptions(x)},[x],q),Wt(()=>{!S.current||o===void 0||(S.current.getOption(se.current.editor.EditorOption.readOnly)?S.current.setValue(o):o!==S.current.getValue()&&(ue.current=!0,S.current.executeEdits("",[{range:S.current.getModel().getFullModelRange(),text:o,forceMoveMarkers:!0}]),S.current.pushUndoStop(),ue.current=!1))},[o],q),Wt(()=>{var Te,Ne;let xe=(Te=S.current)==null?void 0:Te.getModel();xe&&l&&((Ne=se.current)==null||Ne.editor.setModelLanguage(xe,l))},[l],q),Wt(()=>{var xe;f!==void 0&&((xe=S.current)==null||xe.revealLine(f))},[f],q),Wt(()=>{var xe;(xe=se.current)==null||xe.editor.setTheme(p)},[p],q);let ce=de.useCallback(()=>{var xe;if(!(!ne.current||!se.current)&&!ie.current){oe.current(se.current);let Te=u||r,Ne=rn(se.current,o||e||"",n||l||"",Te||"");S.current=(xe=se.current)==null?void 0:xe.editor.create(ne.current,{model:Ne,automaticLayout:!0,...x},_),y&&S.current.restoreViewState(ki.get(Te)),se.current.editor.setTheme(p),f!==void 0&&S.current.revealLine(f),Y(!0),ie.current=!0}},[e,n,r,o,l,u,x,_,y,p,f]);de.useEffect(()=>{q&&Q.current(S.current,se.current)},[q]),de.useEffect(()=>{!B&&!q&&ce()},[B,q,ce]),le.current=o,de.useEffect(()=>{var xe,Te;q&&G&&((xe=W.current)==null||xe.dispose(),W.current=(Te=S.current)==null?void 0:Te.onDidChangeModelContent(Ne=>{ue.current||G(S.current.getValue(),Ne)}))},[q,G]),de.useEffect(()=>{if(q){let xe=se.current.editor.onDidChangeMarkers(Te=>{var Je;let Ne=(Je=S.current.getModel())==null?void 0:Je.uri;if(Ne&&Te.find(it=>it.path===Ne.path)){let it=se.current.editor.getModelMarkers({resource:Ne});X==null||X(it)}});return()=>{xe==null||xe.dispose()}}return()=>{}},[q,X]);function Fe(){var xe,Te;(xe=W.current)==null||xe.dispose(),O?y&&ki.set(u,S.current.saveViewState()):(Te=S.current.getModel())==null||Te.dispose(),S.current.dispose()}return St.createElement(bh,{width:R,height:z,isEditorReady:q,loading:h,_ref:ne,className:N,wrapperProps:L})}var y0=w0,b0=de.memo(y0),v0=b0;function x0(e){const{savedSnippets:n}=Me.getState();return n.filter(r=>r.language==="*"||r.language===e)}function _0(e,n){if(!e)return;const r=e.getContribution("snippetController2");if(r)r.insert(n);else{const o=n.replace(/\$\{?\d+(?::([^}]*))?\}?/g,"$1").replace(/\$0/g,""),l=e.getSelection();l&&e.executeEdits("snippet",[{range:l,text:o,forceMoveMarkers:!0}])}}function S0(e){return e.languages.registerCompletionItemProvider("*",{provideCompletionItems:(n,r)=>{const o=n.getLanguageId(),l=x0(o);if(l.length===0)return{suggestions:[]};const u=n.getWordUntilPosition(r),p={startLineNumber:r.lineNumber,endLineNumber:r.lineNumber,startColumn:u.startColumn,endColumn:u.endColumn};return{suggestions:l.map(h=>({label:h.prefix,kind:e.languages.CompletionItemKind.Snippet,documentation:h.description||h.name,insertText:h.body,insertTextRules:e.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:`Snippet: ${h.name}`,range:p}))}}})}let wr=null,ls=0;function k0(e,n){const r=[];return r.push(e.languages.registerCompletionItemProvider("*",{provideCompletionItems:(o,l)=>{const{tabs:u}=Me.getState(),p=o.getValue(),f=o.getWordUntilPosition(l),h={startLineNumber:l.lineNumber,endLineNumber:l.lineNumber,startColumn:f.startColumn,endColumn:f.endColumn},x=new Set,_=/\b[a-zA-Z_$][a-zA-Z0-9_$]{2,}\b/g,y=u.length;for(let R=0;R<y;R++){const z=u[R].content;if(z===p)continue;let N;for(_.lastIndex=0;(N=_.exec(z))!==null;)x.add(N[0])}return f.word&&x.delete(f.word),{suggestions:Array.from(x).map(R=>({label:R,kind:e.languages.CompletionItemKind.Text,detail:"from other tabs",insertText:R,range:h,sortText:"~"+R}))}}})),r.push(S0(e)),r.push(e.languages.registerCompletionItemProvider("*",{triggerCharacters:["/"],provideCompletionItems:(o,l)=>{if(!o.getLineContent(l.lineNumber).substring(0,l.column-1).match(/['".]\/[^'"]*$/))return{suggestions:[]};const{tabs:f,fileTree:h}=Me.getState(),x=o.getWordUntilPosition(l),_={startLineNumber:l.lineNumber,endLineNumber:l.lineNumber,startColumn:x.startColumn,endColumn:x.endColumn},y=f.map(O=>({label:O.name,kind:e.languages.CompletionItemKind.File,detail:O.path||"open tab",insertText:O.name,range:_}));if(h){const O=(R,z)=>{for(const N of R)y.push({label:z+N.name,kind:N.isDirectory?e.languages.CompletionItemKind.Folder:e.languages.CompletionItemKind.File,detail:N.path,insertText:N.name,range:_}),N.children&&O(N.children,z+N.name+"/")};O(h,"")}return{suggestions:y}}})),r.push(E0(e)),r}function E0(e,n){return e.languages.registerInlineCompletionsProvider("*",{provideInlineCompletions:async(o,l,u,p)=>{const f=Me.getState();if(!f.aiEnabled||!f.inlineSuggestionEnabled)return{items:[]};if(!f.aiSettings.inlineCompletionEnabled)return{items:[]};const h=f.GetActiveProvider();if(h===null)return{items:[]};const x=f.GetCredentialForProvider(h.id);if(x===null||x.apiKey.length===0)return{items:[]};wr!==null&&(clearTimeout(wr),wr=null);const _=++ls,y=f.aiSettings.inlineDebounceMs||Sd;if(!await new Promise(q=>{wr=setTimeout(()=>{wr=null,q(_===ls)},y),p.onCancellationRequested(()=>{wr!==null&&(clearTimeout(wr),wr=null),q(!1)})}))return{items:[]};const R=o.getOffsetAt(l),z=o.getValue(),N=z.substring(0,R),L=z.substring(R),D=N.length>wi?N.substring(N.length-wi):N,U=L.length>wi?L.substring(0,wi):L;if(D.trimEnd().length<5)return{items:[]};const X=o.getLanguageId()||"plaintext";try{const q=await Wm(D,U,X);if(_!==ls)return{items:[]};if(q.length===0)return{items:[]};let Y=q.trim();if(Y.startsWith("```")){const B=Y.split(`
`);B.shift(),0<B.length&&B[B.length-1].startsWith("```")&&B.pop(),Y=B.join(`
`)}return Y.length===0?{items:[]}:{items:[{insertText:Y,range:new e.Range(l.lineNumber,l.column,l.lineNumber,l.column)}]}}catch{return{items:[]}}},freeInlineCompletions:()=>{}})}const _h=new WeakMap;function A0(e,n,r,o){return de.useCallback((l,u)=>{Qm(u),u.editor.setTheme(n.editorMonacoTheme),o(!0),l.onDidChangeCursorPosition(f=>{r(e.id,{cursorLine:f.position.lineNumber,cursorColumn:f.position.column})}),l.onDidScrollChange(f=>{r(e.id,{scrollTop:f.scrollTop})}),l.addCommand(u.KeyMod.CtrlCmd|u.KeyCode.KeyD,()=>{var f;(f=l.getAction("editor.action.copyLinesDownAction"))==null||f.run()}),l.addCommand(u.KeyMod.CtrlCmd|u.KeyMod.Shift|u.KeyCode.KeyK,()=>{var f;(f=l.getAction("editor.action.deleteLines"))==null||f.run()}),l.addCommand(u.KeyMod.Alt|u.KeyCode.UpArrow,()=>{var f;(f=l.getAction("editor.action.moveLinesUpAction"))==null||f.run()}),l.addCommand(u.KeyMod.Alt|u.KeyCode.DownArrow,()=>{var f;(f=l.getAction("editor.action.moveLinesDownAction"))==null||f.run()}),l.addCommand(u.KeyMod.CtrlCmd|u.KeyCode.Slash,()=>{var f;(f=l.getAction("editor.action.commentLine"))==null||f.run()}),e.scrollTop&&l.setScrollTop(e.scrollTop),tw(l);const p=k0(u);_h.set(l,p),l.focus()},[e.id,e.scrollTop,n.editorMonacoTheme,r,o])}function I0(e){var r;if(!e)return;const n=_h.get(e);if(n)for(const o of n)(r=o==null?void 0:o.dispose)==null||r.call(o)}function T0(e,n,r,o){const l=de.useCallback(_=>{if(!e||!n)return;const{query:y,direction:O,isCaseSensitive:R,isWholeWord:z,isRegex:N}=_.detail;if(!y)return;const L=e.getModel();if(!L)return;const D=L.getValue(),U=e.getPosition(),G=U?L.getOffsetAt(U):0;let X="g";R||(X+="i");let q;N?q=y:q=y.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),z&&(q=`\\b${q}\\b`);let Y;try{Y=new RegExp(q,X)}catch{return}const B=[];let K;for(;(K=Y.exec(D))!==null;)B.push({start:K.index,end:K.index+K[0].length}),K[0].length===0&&Y.lastIndex++;if(B.length===0)return;let se;O==="next"?se=B.find(Q=>Q.start>=G)||B[0]:se=[...B].reverse().find(Q=>Q.end<=G)||B[B.length-1];const S=L.getPositionAt(se.start),ne=L.getPositionAt(se.end);e.setSelection(new n.Range(S.lineNumber,S.column,ne.lineNumber,ne.column)),e.revealLineInCenter(S.lineNumber)},[e,n]),u=de.useCallback(_=>{if(!e||!n)return;const{find:y,replace:O,all:R,isCaseSensitive:z,isWholeWord:N,isRegex:L}=_.detail;if(!y)return;const D=e.getModel();if(!D)return;let U="g";z||(U+="i");let G;L?G=y:G=y.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),N&&(G=`\\b${G}\\b`);let X;try{X=new RegExp(G,U)}catch{return}if(R){const q=D.getFullModelRange(),Y=D.getValue().replace(X,O);e.executeEdits("replace-all",[{range:q,text:Y}])}else{const q=e.getSelection();if(q&&!q.isEmpty()){const Y=D.getValueInRange(q),B=new RegExp(G,z?"":"i");B.test(Y)&&e.executeEdits("replace",[{range:q,text:Y.replace(B,O)}])}l(new CustomEvent("notemac-find",{detail:{query:y,direction:"next",isCaseSensitive:z,isWholeWord:N,isRegex:L}}))}},[e,n,l]),p=de.useCallback(_=>{if(!e||!n)return;const{query:y,isCaseSensitive:O,isWholeWord:R,isRegex:z,style:N}=_.detail;if(!y)return;const L=e.getModel();if(!L)return;let D="g";O||(D+="i");let U=z?y:y.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");R&&(U=`\\b${U}\\b`);let G;try{G=new RegExp(U,D)}catch{return}const X=L.getValue(),q=[];let Y;for(;(Y=G.exec(X))!==null;){const K=L.getPositionAt(Y.index);q.push({line:K.lineNumber,column:K.column,length:Y[0].length,style:N||1}),Y[0].length===0&&G.lastIndex++}const B=r.marks||[];o(r.id,{marks:[...B,...q]})},[e,n,r.id,r.marks,o]),f=de.useCallback(()=>{o(r.id,{marks:[]})},[r.id,o]),h=de.useCallback(_=>{if(!e)return;const{line:y}=_.detail;y&&(e.setPosition({lineNumber:y,column:1}),e.revealLineInCenter(y),e.focus())},[e]),x=de.useCallback(_=>{if(!e||!n)return;const{text:y,startLine:O,endLine:R,column:z}=_.detail,N=e.getModel();if(!N)return;const L=[],D=Math.min(R||N.getLineCount(),N.getLineCount());for(let U=O||1;U<=D;U++){const G=Math.min(z||1,N.getLineMaxColumn(U));L.push({range:new n.Range(U,G,U,G),text:y||""})}0<L.length&&e.executeEdits("column-edit",L)},[e,n]);de.useEffect(()=>(document.addEventListener("notemac-find",l),document.addEventListener("notemac-replace",u),document.addEventListener("notemac-mark",p),document.addEventListener("notemac-clear-marks",f),document.addEventListener("notemac-goto-line",h),document.addEventListener("notemac-column-edit",x),()=>{document.removeEventListener("notemac-find",l),document.removeEventListener("notemac-replace",u),document.removeEventListener("notemac-mark",p),document.removeEventListener("notemac-clear-marks",f),document.removeEventListener("notemac-goto-line",h),document.removeEventListener("notemac-column-edit",x)}),[l,u,p,f,h,x])}function Qn(){return Me.getState()}function C0(e){return{id:vr(),role:"user",content:e,timestamp:Date.now(),codeBlocks:[]}}function R0(e=""){const n=Fd(e);return{id:vr(),role:"assistant",content:e,timestamp:Date.now(),codeBlocks:n.map(r=>({language:r.language,code:r.code,action:"replace"}))}}function O0(e){const n=Qn();return{id:vr(),title:e,messages:[],modelId:n.activeModelId,providerId:n.activeProviderId,createdAt:Date.now()}}async function M0(e){const n=Qn();let r=n.activeConversationId;if(r===null){const _=e.length>50?e.substring(0,50)+"...":e,y=O0(_);n.AddConversation(y),r=y.id}const o=C0(e);n.AddMessageToConversation(r,o);const l=n.conversations.find(_=>_.id===r);if(!l)return;const u=Km(n.aiContextItems),p=[];0<u.length&&p.push({role:"system",content:`Here is relevant context:

${u}`});const f=l.messages.length;for(let _=0;_<f;_++)p.push({role:l.messages[_].role,content:l.messages[_].content});const h=R0();n.AddMessageToConversation(r,h),n.SetIsAiStreaming(!0),n.SetAiStreamContent(""),n.SetAiOperationError(null);let x="";try{await Ui(p,{temperature:n.aiSettings.chatTemperature},_=>{x+=_,n.SetAiStreamContent(x),n.UpdateLastMessage(r,x),Nn(Fr.AI_STREAM_CHUNK,{text:_})},_=>{n.UpdateLastMessage(r,_),Nn(Fr.AI_RESPONSE_COMPLETE,{conversationId:r,text:_})},_=>{n.SetAiOperationError(_),Nn(Fr.AI_ERROR,{error:_})})}catch(_){n.SetAiOperationError(_ instanceof Error?_.message:String(_))}finally{n.SetIsAiStreaming(!1),n.SetAiStreamContent(""),n.SaveAIState()}}async function ei(e,n,r){const o=Qn();o.SetIsAiStreaming(!0),o.SetAiOperationError(null);try{const l=await Ui([{role:"system",content:e},{role:"user",content:n}],{temperature:o.aiSettings.codeTemperature,stream:!1}),u=Fd(l);r(0<u.length?u[0].code:l)}catch(l){o.SetAiOperationError(l instanceof Error?l.message:String(l))}finally{o.SetIsAiStreaming(!1)}}async function Sh(e,n){Qn().setSidebarPanel("ai");const o=`Explain the following ${n} code in detail. What does it do, and why?

\`\`\`${n}
${e}
\`\`\``;await M0(o)}async function kh(e,n,r){await ei("You are a code refactoring assistant. Refactor the given code to improve readability, performance, and maintainability. Return ONLY the refactored code in a single code block. No explanations before or after.",`Refactor this ${n} code:

\`\`\`${n}
${e}
\`\`\``,r)}async function Eh(e,n,r){await ei("You are a test generation assistant. Generate comprehensive unit tests for the given code. Return ONLY the test code in a single code block. Use appropriate testing framework for the language. No explanations.",`Generate unit tests for this ${n} code:

\`\`\`${n}
${e}
\`\`\``,r)}async function Ah(e,n,r){await ei("You are a documentation assistant. Add comprehensive documentation (JSDoc, docstrings, or appropriate format) to the given code. Return ONLY the fully documented code in a single code block. No explanations.",`Add documentation to this ${n} code:

\`\`\`${n}
${e}
\`\`\``,r)}async function P0(e,n,r,o){await ei("You are a debugging assistant. Fix the error in the given code. Return ONLY the fixed code in a single code block. No explanations before or after.",`Fix this ${n} code.

Error: ${r}

Code:
\`\`\`${n}
${e}
\`\`\``,o)}async function Ih(e,n,r){await ei("You are a code simplification assistant. Simplify the given code while maintaining the same functionality. Return ONLY the simplified code in a single code block. No explanations.",`Simplify this ${n} code:

\`\`\`${n}
${e}
\`\`\``,r)}async function a1(e,n,r){const o=Qn();o.SetIsAiStreaming(!0),o.SetAiOperationError(null);const l=`You are a git commit message assistant. Write a clear, concise commit message following conventional commits style. First line should be a short summary (under ${em} chars). Optionally add a blank line and a longer description if the changes are complex. Output ONLY the commit message text, nothing else.`;let u="";try{return u=await Ui([{role:"system",content:l},{role:"user",content:`Generate a commit message for these changes:

${e}`}],{temperature:Qg,maxTokens:Jg},p=>{u+=p,o.SetCommitMessageDraft(u),n==null||n(p)},p=>{o.SetCommitMessageDraft(p),r==null||r(p)}),u}catch(p){return o.SetAiOperationError(p instanceof Error?p.message:String(p)),""}finally{o.SetIsAiStreaming(!1)}}function j0(e,n,r,o,l,u,p,f){return de.useCallback((x,_)=>{var O,R,z,N,L,D,U,G,X,q,Y,B,K,se;if(!e||!n)return;const y=e.getModel();if(y)switch(x){case"cut":e.trigger("keyboard","editor.action.clipboardCutAction",null);break;case"copy":e.trigger("keyboard","editor.action.clipboardCopyAction",null);break;case"paste":{navigator.clipboard.readText().then(S=>{e.trigger("keyboard","paste",{text:S})}).catch(()=>{e.focus(),document.execCommand("paste")});break}case"undo":e.trigger("keyboard","undo",null);break;case"redo":e.trigger("keyboard","redo",null);break;case"select-all":e.setSelection(y.getFullModelRange());break;case"duplicate-line":(O=e.getAction("editor.action.copyLinesDownAction"))==null||O.run();break;case"delete-line":(R=e.getAction("editor.action.deleteLines"))==null||R.run();break;case"move-line-up":(z=e.getAction("editor.action.moveLinesUpAction"))==null||z.run();break;case"move-line-down":(N=e.getAction("editor.action.moveLinesDownAction"))==null||N.run();break;case"toggle-comment":(L=e.getAction("editor.action.commentLine"))==null||L.run();break;case"block-comment":(D=e.getAction("editor.action.blockComment"))==null||D.run();break;case"transpose-line":{const S=e.getPosition();if(!S||S.lineNumber<=1)break;const ne=y.getLineContent(S.lineNumber),Q=y.getLineContent(S.lineNumber-1);e.executeEdits("transpose",[{range:new n.Range(S.lineNumber-1,1,S.lineNumber,y.getLineMaxColumn(S.lineNumber)),text:ne+`
`+Q}]);break}case"split-lines":{const S=e.getSelection();if(S&&!S.isEmpty()){const ne=y.getValueInRange(S);e.executeEdits("split",[{range:S,text:ne.split("").join(`
`)}])}break}case"join-lines":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("join",[{range:S,text:y.getValueInRange(S).replace(/\n/g," ")}]);break}case"uppercase":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("uppercase",[{range:S,text:y.getValueInRange(S).toUpperCase()}]);break}case"lowercase":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("lowercase",[{range:S,text:y.getValueInRange(S).toLowerCase()}]);break}case"proper-case":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("proper",[{range:S,text:y.getValueInRange(S).replace(/\w\S*/g,ne=>ne.charAt(0).toUpperCase()+ne.substr(1).toLowerCase())}]);break}case"sentence-case":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("sentence",[{range:S,text:y.getValueInRange(S).toLowerCase().replace(/(^\s*\w|[.!?]\s+\w)/g,ne=>ne.toUpperCase())}]);break}case"invert-case":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("invert",[{range:S,text:y.getValueInRange(S).split("").map(ne=>ne===ne.toUpperCase()?ne.toLowerCase():ne.toUpperCase()).join("")}]);break}case"random-case":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("random",[{range:S,text:y.getValueInRange(S).split("").map(ne=>Math.random()>.5?ne.toUpperCase():ne.toLowerCase()).join("")}]);break}case"insert-datetime":{const S=e.getPosition();if(S){const Q=new Date().toISOString().replace("T"," ").replace(/\.\d+Z/,"");e.executeEdits("datetime",[{range:new n.Range(S.lineNumber,S.column,S.lineNumber,S.column),text:Q}])}break}case"sort-asc":case"sort-desc":case"sort-asc-ci":case"sort-desc-ci":case"sort-len-asc":case"sort-len-desc":{const S=y.getFullModelRange(),ne=y.getValue().split(`
`);x==="sort-asc"?ne.sort((Q,oe)=>Q.localeCompare(oe)):x==="sort-desc"?ne.sort((Q,oe)=>oe.localeCompare(Q)):x==="sort-asc-ci"?ne.sort((Q,oe)=>Q.toLowerCase().localeCompare(oe.toLowerCase())):x==="sort-desc-ci"?ne.sort((Q,oe)=>oe.toLowerCase().localeCompare(Q.toLowerCase())):x==="sort-len-asc"?ne.sort((Q,oe)=>Q.length-oe.length):x==="sort-len-desc"&&ne.sort((Q,oe)=>oe.length-Q.length),e.executeEdits("sort",[{range:S,text:ne.join(`
`)}]);break}case"remove-duplicates":{const S=y.getFullModelRange();e.executeEdits("remove-dup",[{range:S,text:[...new Set(y.getValue().split(`
`))].join(`
`)}]);break}case"remove-consecutive-duplicates":{const S=y.getFullModelRange(),ne=y.getValue().split(`
`);e.executeEdits("remove-consec-dup",[{range:S,text:ne.filter((Q,oe)=>oe===0||Q!==ne[oe-1]).join(`
`)}]);break}case"remove-empty-lines":{e.executeEdits("remove-empty",[{range:y.getFullModelRange(),text:y.getValue().split(`
`).filter(S=>S.trim()!=="").join(`
`)}]);break}case"remove-blank-lines":{e.executeEdits("remove-blank",[{range:y.getFullModelRange(),text:y.getValue().split(`
`).filter(S=>S!=="").join(`
`)}]);break}case"trim-trailing":{e.executeEdits("trim",[{range:y.getFullModelRange(),text:y.getValue().split(`
`).map(S=>S.trimEnd()).join(`
`)}]);break}case"trim-leading":{e.executeEdits("trim-lead",[{range:y.getFullModelRange(),text:y.getValue().split(`
`).map(S=>S.trimStart()).join(`
`)}]);break}case"trim-both":{e.executeEdits("trim-both",[{range:y.getFullModelRange(),text:y.getValue().split(`
`).map(S=>S.trim()).join(`
`)}]);break}case"eol-to-space":{e.executeEdits("eol-space",[{range:y.getFullModelRange(),text:y.getValue().replace(/\n/g," ")}]);break}case"tab-to-space":{const S=" ".repeat(o.tabSize);e.executeEdits("tab-space",[{range:y.getFullModelRange(),text:y.getValue().replace(/\t/g,S)}]);break}case"space-to-tab-leading":{const S=o.tabSize,ne=new RegExp(`^( {${S}})+`,"gm");e.executeEdits("space-tab",[{range:y.getFullModelRange(),text:y.getValue().replace(ne,Q=>"	".repeat(Q.length/S))}]);break}case"space-to-tab-all":{const S=o.tabSize;e.executeEdits("space-tab-all",[{range:y.getFullModelRange(),text:y.getValue().split(" ".repeat(S)).join("	")}]);break}case"insert-blank-above":{const S=e.getPosition();S&&e.executeEdits("blank-above",[{range:new n.Range(S.lineNumber,1,S.lineNumber,1),text:`
`}]);break}case"insert-blank-below":{const S=e.getPosition();S&&e.executeEdits("blank-below",[{range:new n.Range(S.lineNumber,y.getLineMaxColumn(S.lineNumber),S.lineNumber,y.getLineMaxColumn(S.lineNumber)),text:`
`}]);break}case"reverse-lines":{e.executeEdits("reverse",[{range:y.getFullModelRange(),text:y.getValue().split(`
`).reverse().join(`
`)}]);break}case"fold-all":(U=e.getAction("editor.foldAll"))==null||U.run();break;case"unfold-all":(G=e.getAction("editor.unfoldAll"))==null||G.run();break;case"fold-level":{const S=_;(X=e.getAction(`editor.foldLevel${S}`))==null||X.run();break}case"select-to-bracket":(q=e.getAction("editor.action.selectToBracket"))==null||q.run();break;case"goto-bracket":(Y=e.getAction("editor.action.jumpToBracket"))==null||Y.run();break;case"toggle-bookmark":{const S=(B=e.getPosition())==null?void 0:B.lineNumber;if(S){const ne=[...r.bookmarks],Q=ne.indexOf(S);Q>=0?ne.splice(Q,1):ne.push(S),ne.sort((oe,W)=>oe-W),l(r.id,{bookmarks:ne})}break}case"next-bookmark":{const S=((K=e.getPosition())==null?void 0:K.lineNumber)||1,Q=r.bookmarks.find(oe=>oe>S)||r.bookmarks[0];Q&&e.setPosition({lineNumber:Q,column:1}),e.revealLineInCenter(Q||S);break}case"prev-bookmark":{const S=((se=e.getPosition())==null?void 0:se.lineNumber)||1,Q=[...r.bookmarks].reverse().find(oe=>oe<S)||r.bookmarks[r.bookmarks.length-1];Q&&e.setPosition({lineNumber:Q,column:1}),e.revealLineInCenter(Q||S);break}case"clear-bookmarks":{l(r.id,{bookmarks:[]});break}case"mark-style":{const S=e.getSelection();if(S&&!S.isEmpty()){const ne=[...r.marks||[]];ne.push({line:S.startLineNumber,column:S.startColumn,length:y.getValueInRange(S).length,style:_||1}),l(r.id,{marks:ne})}break}case"clear-marks":{l(r.id,{marks:[]});break}case"cut-marked-lines":case"copy-marked-lines":case"delete-marked-lines":case"delete-unmarked-lines":case"paste-marked-lines":case"inverse-marks":{const S=r.marks||[];if(S.length===0)break;const ne=new Set(S.map(W=>W.line)),Q=y.getValue().split(`
`),oe=(W,le)=>ne.has(le+1);if(x==="cut-marked-lines"){const W=Q.filter((te,ie)=>oe(te,ie));navigator.clipboard.writeText(W.join(`
`));const le=Q.filter((te,ie)=>!oe(te,ie));e.executeEdits("cut-marked",[{range:y.getFullModelRange(),text:le.join(`
`)}])}else if(x==="copy-marked-lines")navigator.clipboard.writeText(Q.filter((W,le)=>oe(W,le)).join(`
`));else if(x==="delete-marked-lines")e.executeEdits("del-marked",[{range:y.getFullModelRange(),text:Q.filter((W,le)=>!oe(W,le)).join(`
`)}]);else if(x==="delete-unmarked-lines")e.executeEdits("del-unmarked",[{range:y.getFullModelRange(),text:Q.filter((W,le)=>oe(W,le)).join(`
`)}]);else if(x==="paste-marked-lines")navigator.clipboard.readText().then(W=>{const le=Q.map((te,ie)=>oe(te,ie)?W:te);e.executeEdits("paste-marked",[{range:y.getFullModelRange(),text:le.join(`
`)}])}).catch(()=>{});else if(x==="inverse-marks"){const W=Q.map((le,te)=>te+1).filter(le=>!ne.has(le)).map(le=>({line:le,column:1,length:Q[le-1].length,style:1}));l(r.id,{marks:W})}break}case"macro-playback":case"macro-run-multiple":case"macro-save":{f(x,_);break}case"hash-md5-file":case"hash-sha256-file":{const S=document.createElement("input");S.type="file",S.onchange=async()=>{var ne;try{const Q=(ne=S.files)==null?void 0:ne[0];if(!Q)return;const oe=await Q.text(),W=x==="hash-md5-file"?"md5":"sha256",le=await cs(W,oe),te=e.getPosition();te&&e.executeEdits("hash-file",[{range:new n.Range(te.lineNumber,te.column,te.lineNumber,te.column),text:`
// ${W.toUpperCase()} (${Q.name}): ${le}
`}])}catch{}},S.click();break}case"json-format":{try{e.executeEdits("json-fmt",[{range:y.getFullModelRange(),text:JSON.stringify(JSON.parse(y.getValue()),null,2)}])}catch{}break}case"json-minify":{try{e.executeEdits("json-min",[{range:y.getFullModelRange(),text:JSON.stringify(JSON.parse(y.getValue()))}])}catch{}break}case"hash-md5":case"hash-sha1":case"hash-sha256":case"hash-sha512":{const S=e.getSelection();let ne=S&&!S.isEmpty()?y.getValueInRange(S):y.getValue();cs(x.replace("hash-",""),ne).then(Q=>{const oe=e.getPosition();oe&&e.executeEdits("hash",[{range:new n.Range(oe.lineNumber,oe.column,oe.lineNumber,oe.column),text:`
// ${x.replace("hash-","").toUpperCase()}: ${Q}
`}])}).catch(()=>{});break}case"hash-md5-clipboard":case"hash-sha1-clipboard":case"hash-sha256-clipboard":case"hash-sha512-clipboard":{const S=e.getSelection();let ne=S&&!S.isEmpty()?y.getValueInRange(S):y.getValue();cs(x.replace("hash-","").replace("-clipboard",""),ne).then(Q=>navigator.clipboard.writeText(Q)).catch(()=>{});break}case"base64-encode":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("b64enc",[{range:S,text:btoa(y.getValueInRange(S))}]);break}case"base64-decode":{const S=e.getSelection();if(S&&!S.isEmpty())try{e.executeEdits("b64dec",[{range:S,text:atob(y.getValueInRange(S))}])}catch{}break}case"url-encode":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("urlenc",[{range:S,text:encodeURIComponent(y.getValueInRange(S))}]);break}case"url-decode":{const S=e.getSelection();if(S&&!S.isEmpty())try{e.executeEdits("urldec",[{range:S,text:decodeURIComponent(y.getValueInRange(S))}])}catch{}break}case"copy-file-path":{r.path&&navigator.clipboard.writeText(r.path);break}case"copy-file-name":{navigator.clipboard.writeText(r.name);break}case"copy-file-dir":{r.path&&navigator.clipboard.writeText(r.path.substring(0,r.path.lastIndexOf("/")));break}case"toggle-readonly":{l(r.id,{isReadOnly:!r.isReadOnly});break}case"ai-explain":{const S=e.getSelection();S&&!S.isEmpty()&&Sh(y.getValueInRange(S),y.getLanguageId()||"plaintext");break}case"ai-refactor":{const S=e.getSelection();S&&!S.isEmpty()&&kh(y.getValueInRange(S),y.getLanguageId()||"plaintext",ne=>{e.executeEdits("ai-refactor",[{range:S,text:ne}])});break}case"ai-generate-tests":{const S=e.getSelection();S&&!S.isEmpty()&&Eh(y.getValueInRange(S),y.getLanguageId()||"plaintext",ne=>{const Q=y.getLineCount(),oe=y.getLineMaxColumn(Q);e.executeEdits("ai-tests",[{range:new n.Range(Q,oe,Q,oe),text:`

`+ne}])});break}case"ai-generate-docs":{const S=e.getSelection();S&&!S.isEmpty()&&Ah(y.getValueInRange(S),y.getLanguageId()||"plaintext",ne=>{e.executeEdits("ai-docs",[{range:S,text:ne}])});break}case"ai-simplify":{const S=e.getSelection();S&&!S.isEmpty()&&Ih(y.getValueInRange(S),y.getLanguageId()||"plaintext",ne=>{e.executeEdits("ai-simplify",[{range:S,text:ne}])});break}}},[e,n,r.id,r.bookmarks,r.marks,r.path,r.name,r.isReadOnly,o.tabSize,l,f])}function B0(e){rw(e)}function F0(){nw()}async function cs(e,n){const o=new TextEncoder().encode(n),l={md5:"MD5",sha1:"SHA-1",sha256:"SHA-256",sha512:"SHA-512"}[e];if(!l||e==="md5"){let u=0;for(let p=0;p<n.length;p++){const f=n.charCodeAt(p);u=(u<<5)-u+f,u=u&u}return Math.abs(u).toString(16).padStart(8,"0")}try{const u=await crypto.subtle.digest(l,o);return Array.from(new Uint8Array(u)).map(f=>f.toString(16).padStart(2,"0")).join("")}catch{return"error computing hash"}}function D0(e){return de.useCallback((n,r)=>{if(e)switch(n){case"macro-playback":{const l=Me.getState().currentMacroActions;if(l.length===0)break;for(const u of l)u.type==="type"?e.trigger("keyboard","type",{text:u.data}):u.type==="command"&&e.trigger("keyboard",u.data,null);break}case"macro-run-multiple":{const o=prompt("Run macro how many times?","10");if(!o)break;const l=parseInt(o,10);if(isNaN(l)||l<1)break;const p=Me.getState().currentMacroActions;if(p.length===0)break;for(let f=0;f<l;f++)for(const h of p)h.type==="type"?e.trigger("keyboard","type",{text:h.data}):h.type==="command"&&e.trigger("keyboard",h.data,null);break}case"macro-save":{const o=Me.getState();if(o.currentMacroActions.length===0)break;const l=prompt("Save macro as:","My Macro");l&&o.saveMacro(l);break}}},[e])}function L0(e,n,r){e.addAction({id:"ai-explain",label:"AI: Explain Code",contextMenuGroupId:"9_ai",contextMenuOrder:1,run:o=>{const l=o.getSelection(),u=o.getModel();if(l&&!l.isEmpty()&&u){const p=u.getValueInRange(l);Sh(p,u.getLanguageId()||"plaintext")}}}),e.addAction({id:"ai-refactor",label:"AI: Refactor Code",contextMenuGroupId:"9_ai",contextMenuOrder:2,run:o=>{const l=o.getSelection(),u=o.getModel();if(l&&!l.isEmpty()&&u){const p=u.getValueInRange(l);kh(p,u.getLanguageId()||"plaintext",f=>{o.executeEdits("ai-refactor",[{range:l,text:f}])})}}}),e.addAction({id:"ai-generate-tests",label:"AI: Generate Tests",contextMenuGroupId:"9_ai",contextMenuOrder:3,run:o=>{const l=o.getSelection(),u=o.getModel();if(l&&!l.isEmpty()&&u){const p=u.getValueInRange(l);Eh(p,u.getLanguageId()||"plaintext",f=>{const h=u.getLineCount(),x=u.getLineMaxColumn(h);o.executeEdits("ai-tests",[{range:new n.Range(h,x,h,x),text:`

`+f}])})}}}),e.addAction({id:"ai-generate-docs",label:"AI: Generate Documentation",contextMenuGroupId:"9_ai",contextMenuOrder:4,run:o=>{const l=o.getSelection(),u=o.getModel();if(l&&!l.isEmpty()&&u){const p=u.getValueInRange(l);Ah(p,u.getLanguageId()||"plaintext",f=>{o.executeEdits("ai-docs",[{range:l,text:f}])})}}}),e.addAction({id:"ai-fix-error",label:"AI: Fix Error",contextMenuGroupId:"9_ai",contextMenuOrder:5,run:o=>{const l=o.getSelection(),u=o.getModel();if(l&&!l.isEmpty()&&u){const p=u.getValueInRange(l),f=prompt("Describe the error (or paste error message):")||"Fix any issues";P0(p,u.getLanguageId()||"plaintext",f,h=>{o.executeEdits("ai-fix",[{range:l,text:h}])})}}}),e.addAction({id:"ai-simplify",label:"AI: Simplify Code",contextMenuGroupId:"9_ai",contextMenuOrder:6,run:o=>{const l=o.getSelection(),u=o.getModel();if(l&&!l.isEmpty()&&u){const p=u.getValueInRange(l);Ih(p,u.getLanguageId()||"plaintext",f=>{o.executeEdits("ai-simplify",[{range:l,text:f}])})}}})}function dd({tab:e,theme:n,settings:r,zoomLevel:o}){const l=de.useRef(null),u=de.useRef(null),{updateTabContent:p,updateTab:f}=Me(),[h,x]=de.useState(!1),_=A0(e,n,f,x),y=de.useCallback(N=>{N!==void 0&&p(e.id,N)},[e.id,p]),O=D0(l.current),R=j0(l.current,u.current,e,r,f,p,h,O);de.useEffect(()=>{u.current&&u.current.editor.setTheme(n.editorMonacoTheme)},[n.editorMonacoTheme]),de.useEffect(()=>{const N=L=>{l.current&&(L!=null&&L.body)&&(_0(l.current,L.body),l.current.focus())};return xy(Fr.INSERT_SNIPPET,N),()=>_y(Fr.INSERT_SNIPPET,N)},[]),de.useEffect(()=>()=>{I0(l.current)},[]),T0(l.current,u.current,e,f),de.useEffect(()=>{const N=l.current,L=u.current;if(!(!N||!L))return B0(R),L0(N,L),()=>{F0()}},[h,e.id,e.bookmarks,e.marks,R,f]),de.useEffect(()=>{const N=l.current,L=u.current;if(!N||!L||!h)return;const D=e.bookmarks.map(G=>({range:new L.Range(G,1,G,1),options:{isWholeLine:!0,linesDecorationsClassName:"bookmark-decoration",glyphMarginClassName:"bookmark-glyph",overviewRuler:{color:"#007acc",position:1}}})),U=N.deltaDecorations([],D);return()=>{N.deltaDecorations(U,[])}},[e.bookmarks,h]);const z=de.useCallback((N,L)=>{l.current=N,u.current=L,_(N,L)},[_]);return E.jsx("div",{style:{flex:1,overflow:"hidden"},children:E.jsx(v0,{height:"100%",language:e.language,value:e.content,onChange:y,onMount:z,theme:n.editorMonacoTheme,options:{fontSize:r.fontSize+o,fontFamily:r.fontFamily,tabSize:r.tabSize,insertSpaces:r.insertSpaces,wordWrap:r.wordWrap?"on":"off",lineNumbers:r.showLineNumbers?"on":"off",minimap:{enabled:r.showMinimap,scale:1,showSlider:"mouseover"},renderWhitespace:r.renderWhitespace,guides:{indentation:r.showIndentGuides,bracketPairs:!0},cursorBlinking:r.cursorBlinking,cursorStyle:r.cursorStyle,smoothScrolling:r.smoothScrolling,bracketPairColorization:{enabled:!0},matchBrackets:r.matchBrackets?"always":"never",autoClosingBrackets:r.autoCloseBrackets?"always":"never",autoClosingQuotes:r.autoCloseQuotes?"always":"never",renderLineHighlight:r.highlightCurrentLine?"all":"none",folding:!0,foldingStrategy:"indentation",showFoldingControls:"mouseover",glyphMargin:!0,scrollBeyondLastLine:!1,automaticLayout:!0,contextmenu:!0,dragAndDrop:!0,links:!0,multiCursorModifier:"alt",inlineSuggest:{enabled:!0},snippetSuggestions:"top",suggestOnTriggerCharacters:!0,wordBasedSuggestions:"currentDocument",padding:{top:8},readOnly:e.isReadOnly,overviewRulerBorder:!1,hideCursorInOverviewRuler:!1,colorDecorators:!0,columnSelection:!0,copyWithSyntaxHighlighting:!0,emptySelectionClipboard:!0,find:{addExtraSpaceOnTop:!1,autoFindInSelection:"never",seedSearchStringFromSelection:"always"}},loading:E.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:n.textMuted},children:"Loading editor..."})})})}function $0(e){return e.trim().split(/\s+/).filter(Boolean).length}function N0(e){return e?e.split(/\r\n|\r|\n/).length:0}function o1(e){return 1024>e?`${e} B`:1024*1024>e?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}function hd(e){return{plaintext:"Plain Text",javascript:"JavaScript",typescript:"TypeScript",python:"Python",ruby:"Ruby",go:"Go",rust:"Rust",c:"C",cpp:"C++",csharp:"C#",java:"Java",swift:"Swift",kotlin:"Kotlin",php:"PHP",html:"HTML",css:"CSS",scss:"SCSS",less:"LESS",json:"JSON",xml:"XML",yaml:"YAML",markdown:"Markdown",sql:"SQL",shell:"Shell",powershell:"PowerShell",r:"R",lua:"Lua",perl:"Perl",dart:"Dart",elixir:"Elixir",erlang:"Erlang",haskell:"Haskell",scala:"Scala",clojure:"Clojure",coffeescript:"CoffeeScript",bat:"Batch",ini:"INI",dockerfile:"Dockerfile",graphql:"GraphQL"}[e]||e}function U0({theme:e}){const{tabs:n,activeTabId:r,settings:o,zoomLevel:l,isRecordingMacro:u,updateTab:p,updateSettings:f,isRepoInitialized:h,currentBranch:x,gitStatus:_,setSidebarPanel:y,aiEnabled:O,isAiStreaming:R,activeModelId:z,inlineSuggestionEnabled:N,SetShowAiSettings:L}=Me(),D=n.find(ce=>ce.id===r),[U,G]=de.useState(!1),[X,q]=de.useState(!1),[Y,B]=de.useState(!1),[K,se]=de.useState(window.innerWidth<640);de.useEffect(()=>{const ce=()=>se(window.innerWidth<640);return window.addEventListener("resize",ce),()=>window.removeEventListener("resize",ce)},[]);const S=z0(e);if(D===void 0)return null;const ne=N0(D.content),Q=D.content.length,oe=$0(D.content),W=["plaintext","javascript","typescript","python","ruby","go","rust","c","cpp","csharp","java","swift","kotlin","php","html","css","scss","json","xml","yaml","markdown","sql","shell","lua","perl","r","dart","scala","haskell"],le=["utf-8","utf-8-bom","utf-16le","utf-16be","iso-8859-1","windows-1252"],te=[{value:"LF",label:"LF (Unix/Mac)"},{value:"CRLF",label:"CRLF (Windows)"},{value:"CR",label:"CR (Old Mac)"}],ie=St.memo(({children:ce,onClick:Fe,title:xe})=>{const[Te,Ne]=de.useState(!1),Je=de.useMemo(()=>({padding:"0 8px",cursor:Fe!==null?"pointer":"default",backgroundColor:Te&&Fe!==null?"rgba(255,255,255,0.1)":"transparent",height:"100%",display:"flex",alignItems:"center",borderRadius:2,position:"relative"}),[Fe,Te]);return E.jsx("div",{title:xe,onClick:Fe,onMouseEnter:()=>Ne(!0),onMouseLeave:()=>Ne(!1),style:Je,children:ce})});ie.displayName="StatusItem";const ue=St.memo(({items:ce,onSelect:Fe,onClose:xe})=>{const Te=de.useMemo(()=>({overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:lm},dropdown:{position:"absolute",bottom:"100%",left:0,minWidth:Math.min(180,window.innerWidth-16),maxWidth:"calc(100vw - 8px)",maxHeight:om,overflowY:"auto",backgroundColor:e.menuBg,border:`1px solid ${e.border}`,borderRadius:6,padding:"4px 0",zIndex:cm,boxShadow:"0 -4px 16px rgba(0,0,0,0.3)"},item:{padding:"6px 16px",cursor:"pointer",fontSize:13,color:e.menuText,"--hover-bg":e.bgHover}}),[e]);return E.jsxs(E.Fragment,{children:[E.jsx("div",{style:Te.overlay,onClick:xe}),E.jsx("div",{style:Te.dropdown,children:ce.map(Ne=>E.jsx("div",{onClick:()=>{Fe(Ne.value),xe()},className:"hover-bg hover-bg-reset",style:Te.item,children:Ne.label},Ne.value))})]})});return ue.displayName="Picker",E.jsxs("div",{style:S.container,children:[E.jsxs("div",{style:S.sectionLeft,children:[h===!0&&E.jsx(ie,{title:`Branch: ${x}${_!==null&&_.aheadBy!==void 0?` ${_.aheadBy}`:""}${_!==null&&_.behindBy!==void 0?` ${_.behindBy}`:""}`,onClick:()=>y("git"),children:E.jsxs("span",{style:S.branchContainer,children:[E.jsx("span",{style:S.branchIcon,children:""}),x,_!==null&&0<_.aheadBy&&E.jsxs("span",{style:S.gitAhead,children:["",_.aheadBy]}),_!==null&&0<_.behindBy&&E.jsxs("span",{style:S.gitBehind,children:["",_.behindBy]}),_!==null&&_.isRepoDirty===!0&&E.jsx("span",{style:S.gitDirty,children:""})]})}),u===!0&&E.jsx(ie,{children:E.jsxs("span",{className:"recording-indicator",style:S.recordingIndicator,children:[""," Recording"]})}),E.jsxs(ie,{title:"Cursor Position",children:["Ln ",D.cursorLine,", Col ",D.cursorColumn]}),!K&&E.jsxs(ie,{title:"Character Count",children:[Q," chars"]}),!K&&E.jsxs(ie,{title:"Word Count",children:[oe," words"]}),E.jsxs(ie,{title:"Line Count",children:[ne," lines"]})]}),E.jsxs("div",{style:S.sectionRight,children:[E.jsxs(ie,{title:"Tab Size",onClick:()=>{const ce=o.tabSize===4?2:4;f({tabSize:ce})},children:[o.insertSpaces?"Spaces":"Tabs",": ",o.tabSize]}),E.jsxs(ie,{title:"Line Ending",onClick:()=>B(!Y),children:[D.lineEnding,Y&&E.jsx(ue,{items:te.map(ce=>({value:ce.value,label:ce.label})),onSelect:ce=>p(D.id,{lineEnding:ce}),onClose:()=>B(!1)})]}),E.jsxs(ie,{title:"Encoding",onClick:()=>q(!X),children:[D.encoding.toUpperCase(),X&&E.jsx(ue,{items:le.map(ce=>({value:ce,label:ce.toUpperCase()})),onSelect:ce=>p(D.id,{encoding:ce}),onClose:()=>q(!1)})]}),E.jsxs(ie,{title:"Language",onClick:()=>G(!U),children:[hd(D.language),U&&E.jsx(ue,{items:W.map(ce=>({value:ce,label:hd(ce)})),onSelect:ce=>p(D.id,{language:ce}),onClose:()=>G(!1)})]}),O===!0&&E.jsx(ie,{title:`AI: ${z}${N===!0?" (Inline On)":""}`,onClick:()=>L(!0),children:E.jsx("span",{style:S.aiContainer,children:R===!0?E.jsxs("span",{style:S.aiGenerating,children:[""," Generating..."]}):E.jsxs("span",{style:S.aiIdle,children:[""," ",z||"No Model"]})})}),l!==0&&E.jsxs(ie,{title:"Zoom Level",children:[0<l?"+":"",l]})]})]})}function z0(e){return de.useMemo(()=>({container:{display:"flex",alignItems:"center",justifyContent:"space-between",height:24,backgroundColor:e.statusBarBg,color:e.statusBarText,fontSize:12,flexShrink:0,padding:"0 4px",overflowX:"auto",scrollbarWidth:"none"},sectionLeft:{display:"flex",alignItems:"center",height:"100%"},sectionRight:{display:"flex",alignItems:"center",height:"100%"},branchContainer:{display:"flex",alignItems:"center",gap:4},branchIcon:{fontSize:11},gitAhead:{fontSize:10},gitBehind:{fontSize:10},gitDirty:{fontSize:10,color:"#f9e2af"},recordingIndicator:{color:"#ff4444"},aiContainer:{display:"flex",alignItems:"center",gap:4},aiGenerating:{color:"#a6e3a1",animation:"pulse 1s infinite"},aiIdle:{color:e.statusBarText,opacity:.8}}),[e])}const G0=de.lazy(()=>ht(()=>import("./GitPanelViewPresenter-7iOiv9vY.js"),__vite__mapDeps([8,0,1,2,3,4,5]),import.meta.url).then(e=>({default:e.GitPanelViewPresenter}))),H0=de.lazy(()=>ht(()=>import("./AIChatPanelViewPresenter-qNDKKcIx.js"),__vite__mapDeps([9,1,2,3]),import.meta.url).then(e=>({default:e.AIChatPanelViewPresenter})));function W0({theme:e}){const{sidebarPanel:n,sidebarWidth:r,fileTree:o,workspacePath:l,tabs:u,activeTabId:p,setSidebarPanel:f,toggleTreeNode:h,addTab:x,setActiveTab:_,setFileTree:y,setWorkspacePath:O,GetChangedFileCount:R}=Me(),[z,N]=de.useState(!1),[L,D]=de.useState(r),[U,G]=de.useState(-1),X=de.useRef(null),q=de.useRef(null),Y=de.useRef(null),B=de.useCallback(W=>{W.preventDefault(),N(!0);const le=W.clientX,te=L,ie=ce=>{const Fe=Math.max(tm,Math.min(rm,te+ce.clientX-le));D(Fe)},ue=()=>{N(!1),X.current!==null&&document.removeEventListener("mousemove",X.current),q.current!==null&&document.removeEventListener("mouseup",q.current),X.current=null,q.current=null};X.current=ie,q.current=ue,document.addEventListener("mousemove",ie),document.addEventListener("mouseup",ue)},[L]);de.useEffect(()=>()=>{X.current!==null&&document.removeEventListener("mousemove",X.current),q.current!==null&&document.removeEventListener("mouseup",q.current)},[]);const K=async()=>{if("showDirectoryPicker"in window)try{const W=await window.showDirectoryPicker(),le=await Th(W);y(le),O(W.name),await uh(W)}catch{}},se=(W,le=[])=>{for(const te of W)le.push(te),te.isDirectory&&te.isExpanded&&te.children&&se(te.children,le);return le},S=async W=>{if(W.isDirectory){h(W.path);return}const le=u.find(te=>te.path===W.path||te.name===W.name);if(le){_(le.id);return}if(window.electronAPI){const te=await window.electronAPI.readFile(W.path);x({name:W.name,path:W.path,content:te,language:sr(W.name),lineEnding:br(te)})}else if(W.handle)try{const ie=await(await W.handle.getFile()).text();x({name:W.name,path:W.path,content:ie,language:sr(W.name),lineEnding:br(ie)})}catch{}},ne=W=>{if(n!=="explorer"||o.length===0)return;const le=se(o),te=U>=0?le[U]:null,ie=ue=>{ue>=0&&ue<le.length&&(G(ue),setTimeout(()=>{var Fe;const ce=(Fe=Y.current)==null?void 0:Fe.querySelector(`[data-tree-index="${ue}"]`);ce==null||ce.focus()},0))};switch(W.key){case"ArrowDown":W.preventDefault();const ue=U===-1?0:Math.min(U+1,le.length-1);ie(ue);break;case"ArrowUp":W.preventDefault();const ce=U===-1?le.length-1:Math.max(U-1,0);ie(ce);break;case"ArrowRight":W.preventDefault(),te!=null&&te.isDirectory&&(te.isExpanded?te.children&&te.children.length>0&&ie(U+1):h(te.path));break;case"ArrowLeft":W.preventDefault(),te!=null&&te.isDirectory&&te.isExpanded&&h(te.path);break;case"Enter":case" ":W.preventDefault(),te&&S(te);break;case"Home":W.preventDefault(),ie(0);break;case"End":W.preventDefault(),ie(le.length-1);break}},Q=St.memo(({node:W,depth:le=0,index:te})=>{var Te,Ne;const[ie,ue]=de.useState(!1),ce=W.isExpanded,Fe=((Te=u.find(Je=>Je.id===p))==null?void 0:Te.path)===W.path,xe=U===te;return E.jsxs("div",{children:[E.jsxs("div",{ref:xe?Je=>Je==null?void 0:Je.focus():null,"data-tree-index":te,role:"treeitem",tabIndex:xe?0:-1,"aria-expanded":W.isDirectory?W.isExpanded:void 0,onClick:()=>S(W),onMouseEnter:()=>ue(!0),onMouseLeave:()=>ue(!1),style:{display:"flex",alignItems:"center",gap:4,padding:"3px 8px",paddingLeft:8+le*16,cursor:"pointer",backgroundColor:Fe?e.bgActive:xe||ie?e.bgHover:"transparent",color:Fe?e.text:e.sidebarText,fontSize:13,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",outline:xe?`1px solid ${e.accent}`:"none",outlineOffset:"-1px"},children:[E.jsx("span",{style:{fontSize:10,width:16,textAlign:"center",flexShrink:0},children:W.isDirectory?ce?"":"":""}),E.jsx("span",{style:{marginRight:4,flexShrink:0},children:W.isDirectory?ce?"":"":X0(W.name)}),E.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis"},children:W.name})]}),W.isDirectory&&ce&&((Ne=W.children)==null?void 0:Ne.map((Je,it)=>{const He=se(o).findIndex(We=>We.path===Je.path);return E.jsx(Q,{node:Je,depth:le+1,index:He},Je.path||it)}))]})});Q.displayName="TreeNode";const oe=St.memo(()=>{const W=u.find(te=>te.id===p);if(W===void 0)return null;const le=Y0(W.content,W.language);return E.jsxs("div",{style:{padding:8},children:[E.jsx("div",{style:{fontSize:11,color:e.textMuted,marginBottom:8,textTransform:"uppercase",letterSpacing:1},children:"Functions"}),le.length===0?E.jsx("div",{style:{color:e.textMuted,fontSize:12,padding:8},children:"No functions found"}):le.map(te=>E.jsxs("div",{onClick:()=>{document.dispatchEvent(new CustomEvent("notemac-goto-line",{detail:{line:te.line}}))},className:"hover-bg hover-bg-reset",style:{padding:"4px 8px",cursor:"pointer",fontSize:13,color:e.sidebarText,borderRadius:4,"--hover-bg":e.bgHover},children:[E.jsx("span",{style:{color:e.accent,marginRight:4},children:"f"}),te.name,E.jsxs("span",{style:{color:e.textMuted,fontSize:11,marginLeft:8},children:[":",te.line]})]},`fn-${te.name}-${te.line}`))]})});return oe.displayName="FunctionListPanel",E.jsxs("div",{style:{display:"flex",flexShrink:0},children:[E.jsx("div",{style:{width:40,backgroundColor:e.bgSecondary,borderRight:`1px solid ${e.border}`,display:"flex",flexDirection:"column",alignItems:"center",paddingTop:8,gap:4},children:[{panel:"explorer",icon:"",title:"Explorer"},{panel:"search",icon:"",title:"Search"},{panel:"functions",icon:"",title:"Function List"},{panel:"docList",icon:"",title:"Document List"},{panel:"project",icon:"",title:"Project"},{panel:"clipboardHistory",icon:"",title:"Clipboard History"},{panel:"charPanel",icon:"",title:"Character Panel"},{panel:"git",icon:"",title:"Source Control"},{panel:"ai",icon:"",title:"AI Assistant"}].map(({panel:W,icon:le,title:te})=>{const ie=W==="git"?R():0;return E.jsxs("button",{"aria-label":te,onClick:()=>f(n===W?null:W),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",borderRadius:6,fontSize:16,backgroundColor:n===W?e.bgHover:"transparent",borderLeft:n===W?`2px solid ${e.accent}`:"2px solid transparent",border:"none",padding:0,position:"relative",color:"inherit"},children:[le,ie>0&&E.jsx("span",{style:{position:"absolute",top:2,right:2,minWidth:14,height:14,borderRadius:7,backgroundColor:e.accent,color:e.accentText,fontSize:9,fontWeight:700,display:"flex",alignItems:"center",justifyContent:"center",padding:"0 3px"},children:ie})]},W)})}),n!==null&&E.jsxs(E.Fragment,{children:[E.jsxs("div",{style:{width:L-40,backgroundColor:e.sidebarBg,borderRight:`1px solid ${e.border}`,overflow:"auto",display:"flex",flexDirection:"column"},children:[E.jsxs("div",{style:{padding:"8px 12px",fontSize:11,fontWeight:600,textTransform:"uppercase",letterSpacing:1,color:e.textSecondary,borderBottom:`1px solid ${e.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n==="explorer"?"Explorer":n==="search"?"Search":n==="functions"?"Functions":n==="docList"?"Document List":n==="project"?"Project":n==="clipboardHistory"?"Clipboard History":n==="charPanel"?"Character Panel":n==="git"?"Source Control":n==="ai"?"AI Assistant":"",E.jsx("button",{"aria-label":"Collapse panel",onClick:()=>f(null),className:"hover-bg-color",style:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",borderRadius:4,fontSize:12,color:e.textMuted,backgroundColor:"transparent",border:"none",padding:0,"--hover-bg":e.bgHover,"--hover-color":e.text},children:""})]}),E.jsxs("div",{style:{flex:1,overflow:"auto"},children:[n==="explorer"&&E.jsx(E.Fragment,{children:o.length>0?E.jsxs("div",{ref:Y,role:"tree",tabIndex:0,onKeyDown:ne,style:{paddingTop:4,outline:"none"},children:[l&&E.jsxs("div",{style:{padding:"6px 12px",fontSize:12,fontWeight:600,color:e.text,display:"flex",alignItems:"center",gap:6},children:[E.jsx("span",{children:""}),typeof l=="string"&&l.split("/").pop()||l]}),o.map((W,le)=>{const ie=se(o).findIndex(ue=>ue.path===W.path);return E.jsx(Q,{node:W,index:ie},W.path||le)})]}):E.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:24,gap:12},children:[E.jsx("div",{style:{color:e.textMuted,fontSize:13,textAlign:"center"},children:"No folder opened"}),E.jsx("button",{onClick:K,style:{backgroundColor:e.accent,color:e.accentText,border:"none",borderRadius:6,padding:"8px 16px",cursor:"pointer",fontSize:13},children:"Open Folder"})]})}),n==="search"&&E.jsx("div",{style:{padding:12},children:E.jsx(K0,{theme:e})}),n==="functions"&&E.jsx(oe,{}),n==="docList"&&E.jsx(q0,{theme:e}),n==="project"&&E.jsx("div",{style:{padding:16,color:e.textMuted,fontSize:13,textAlign:"center"},children:l?E.jsxs("div",{children:[E.jsxs("div",{style:{fontWeight:600,color:e.text,marginBottom:8},children:["Project: ",typeof l=="string"?l.split("/").pop():l]}),E.jsxs("div",{children:[o.length," items"]})]}):"No project opened. Open a folder to use the project panel."}),n==="clipboardHistory"&&E.jsx(V0,{theme:e}),n==="charPanel"&&E.jsx(Z0,{theme:e}),n==="git"&&E.jsx(de.Suspense,{fallback:E.jsx("div",{style:{padding:16,color:e.textMuted,fontSize:12},children:"Loading..."}),children:E.jsx(G0,{theme:e})}),n==="ai"&&E.jsx(de.Suspense,{fallback:E.jsx("div",{style:{padding:16,color:e.textMuted,fontSize:12},children:"Loading..."}),children:E.jsx(H0,{theme:e})})]})]}),E.jsx("div",{className:`resizer ${z?"active":""}`,onMouseDown:B,style:{backgroundColor:z?e.accent:e.border}})]})]})}const q0=St.memo(function({theme:n}){const{tabs:r,activeTabId:o,setActiveTab:l}=Me();return E.jsx("div",{style:{padding:4},children:r.map(u=>E.jsxs("div",{onClick:()=>l(u.id),style:{display:"flex",alignItems:"center",gap:6,padding:"5px 8px",cursor:"pointer",borderRadius:4,fontSize:13,color:u.id===o?n.text:n.sidebarText,backgroundColor:u.id===o?n.bgActive:"transparent"},children:[E.jsx("span",{style:{fontSize:10,color:u.isModified?n.accent:"transparent"},children:""}),E.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:u.name}),u.isPinned&&E.jsx("span",{style:{fontSize:10},children:""}),u.isReadOnly&&E.jsx("span",{style:{fontSize:10},children:""})]},u.id))})}),V0=St.memo(function({theme:n}){const{clipboardHistory:r}=Me();return E.jsxs("div",{style:{padding:8},children:[E.jsx("div",{style:{fontSize:11,color:n.textMuted,marginBottom:8,textTransform:"uppercase",letterSpacing:1},children:"Clipboard History"}),r.length===0?E.jsx("div",{style:{color:n.textMuted,fontSize:12,padding:8},children:"No clipboard entries yet"}):r.map(o=>E.jsxs("div",{onClick:()=>navigator.clipboard.writeText(o.text),style:{padding:"6px 8px",cursor:"pointer",fontSize:12,color:n.sidebarText,borderRadius:4,borderBottom:`1px solid ${n.border}`,marginBottom:2},title:"Click to copy",children:[E.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontFamily:"monospace"},children:o.text.slice(0,100)}),E.jsx("div",{style:{fontSize:10,color:n.textMuted,marginTop:2},children:new Date(o.timestamp).toLocaleTimeString()})]},`clipboard-${o.timestamp}`))]})}),Z0=St.memo(function({theme:n}){const{tabs:r,activeTabId:o}=Me(),l=r.find(x=>x.id===o),[u,p]=de.useState(65),f=[{label:"Common Symbols",chars:""},{label:"Currency",chars:"$"},{label:"Greek",chars:""},{label:"Math",chars:""},{label:"Box Drawing",chars:""}],h=x=>{const _=Ld();_!==null&&_("insert-text",x)};return E.jsxs("div",{style:{padding:8},children:[E.jsx("div",{style:{fontSize:11,color:n.textMuted,marginBottom:8,textTransform:"uppercase",letterSpacing:1},children:"Character Panel"}),l!==void 0&&E.jsxs("div",{style:{fontSize:12,color:n.textSecondary,marginBottom:8,padding:"4px 0",borderBottom:`1px solid ${n.border}`},children:["Cursor pos: Ln ",l.cursorLine,", Col ",l.cursorColumn]}),E.jsxs("div",{style:{display:"flex",gap:4,marginBottom:8},children:[E.jsx("input",{type:"number",value:u,onChange:x=>p(parseInt(x.target.value)||0),style:{width:60,height:24,fontSize:12,backgroundColor:n.bg,color:n.text,border:`1px solid ${n.border}`,borderRadius:3,padding:"0 4px"}}),E.jsx("div",{style:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:n.bg,border:`1px solid ${n.border}`,borderRadius:3,fontFamily:"monospace",fontSize:14,color:n.accent},children:String.fromCharCode(u)}),E.jsx("button",{onClick:()=>h(String.fromCharCode(u)),style:{height:24,fontSize:11,backgroundColor:n.accent,color:n.accentText,border:"none",borderRadius:3,padding:"0 8px",cursor:"pointer"},children:"Insert"})]}),f.map(x=>E.jsxs("div",{style:{marginBottom:8},children:[E.jsx("div",{style:{fontSize:11,color:n.textMuted,marginBottom:4},children:x.label}),E.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:2},children:x.chars.split("").map(_=>E.jsx("div",{onClick:()=>h(_),title:`U+${_.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")}`,style:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",fontSize:13,fontFamily:"monospace",backgroundColor:n.bg,border:`1px solid ${n.border}`,borderRadius:2,cursor:"pointer",color:n.text},children:_},`char-${_}-${_.charCodeAt(0)}`))})]},`chargroup-${x.label}`))]})}),K0=St.memo(function({theme:n}){const[r,o]=de.useState(""),[l,u]=de.useState([]),p=()=>{const f=Me.getState().tabs,h=[];for(const x of f)x.content.split(`
`).forEach((y,O)=>{y.toLowerCase().includes(r.toLowerCase())&&h.push({file:x.name,line:O+1,text:y.trim()})});u(h)};return E.jsxs("div",{children:[E.jsx("div",{style:{display:"flex",gap:6},children:E.jsx("input",{type:"text",placeholder:"Search in files...",value:r,onChange:f=>o(f.target.value),onKeyDown:f=>f.key==="Enter"&&p(),style:{flex:1,height:28,backgroundColor:n.bg,color:n.text,border:`1px solid ${n.border}`,borderRadius:4,padding:"0 8px",fontSize:13}})}),0<l.length&&E.jsxs("div",{style:{marginTop:8},children:[E.jsxs("div",{style:{fontSize:12,color:n.textMuted,marginBottom:4},children:[l.length," results"]}),l.map(f=>E.jsxs("div",{className:"hover-bg hover-bg-reset",style:{padding:"4px 8px",fontSize:12,color:n.sidebarText,cursor:"pointer",borderRadius:4,"--hover-bg":n.bgHover},children:[E.jsxs("div",{style:{color:n.accent,fontSize:11},children:[f.file,":",f.line]}),E.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:f.text})]},`search-${f.file}-${f.line}`))]})]})});function X0(e){var o;const n=(o=e.split(".").pop())==null?void 0:o.toLowerCase();return{js:"",jsx:"",ts:"",tsx:"",py:"",rb:"",go:"",rs:"",html:"",css:"",json:"",md:"",txt:"",svg:""}[n||""]||""}function Y0(e,n){const r=[],o=e.split(`
`),l={javascript:[/function\s+(\w+)/,/(?:const|let|var)\s+(\w+)\s*=\s*(?:async\s+)?(?:\([^)]*\)|(\w+))\s*=>/,/(\w+)\s*\([^)]*\)\s*\{/],typescript:[/function\s+(\w+)/,/(?:const|let|var)\s+(\w+)\s*=\s*(?:async\s+)?(?:\([^)]*\)|(\w+))\s*=>/,/(\w+)\s*\([^)]*\)\s*(?::\s*\w+)?\s*\{/],python:[/def\s+(\w+)/,/class\s+(\w+)/],ruby:[/def\s+(\w+)/,/class\s+(\w+)/],go:[/func\s+(?:\(\w+\s+\*?\w+\)\s+)?(\w+)/],rust:[/fn\s+(\w+)/,/struct\s+(\w+)/,/impl\s+(\w+)/],java:[/(?:public|private|protected|static|\s)+[\w<>\[\]]+\s+(\w+)\s*\(/],c:[/(?:void|int|char|float|double|long|short|unsigned|\w+)\s+(\w+)\s*\(/],cpp:[/(?:void|int|char|float|double|long|short|unsigned|\w+)\s+(\w+)\s*\(/],csharp:[/(?:public|private|protected|internal|static|\s)+[\w<>\[\]]+\s+(\w+)\s*\(/],swift:[/func\s+(\w+)/,/class\s+(\w+)/,/struct\s+(\w+)/],php:[/function\s+(\w+)/,/class\s+(\w+)/]},u=l[n]||l.javascript||[];return o.forEach((p,f)=>{for(const h of u){const x=p.match(h);if(x&&x[1]){const _=x[1];["if","else","for","while","switch","catch","return","new"].includes(_)||r.push({name:_,line:f+1});break}}}),r}async function Th(e,n=0){if(n>sm)return[];const r=[];for await(const o of e.values()){if(o.name.startsWith(".")||o.name==="node_modules")continue;const l=o.kind==="file"?o:void 0,u=o.kind==="directory"?o:void 0,p={name:o.name,path:o.name,isDirectory:o.kind==="directory",isExpanded:!1,handle:l};u&&(p.children=await Th(u,n+1)),r.push(p)}return r.sort((o,l)=>o.isDirectory&&!l.isDirectory?-1:!o.isDirectory&&l.isDirectory?1:o.name.localeCompare(l.name))}function J0(e){return de.useMemo(()=>({container:{display:"flex",flexDirection:"column",gap:6,padding:"8px 12px",background:e.bgSecondary,borderBottom:`1px solid ${e.border}`,fontSize:13},modesRow:{display:"flex",alignItems:"center",gap:4},modeTab:n=>({padding:"2px 8px",borderRadius:4,cursor:"pointer",fontSize:12,fontWeight:n?600:400,color:n?e.accent:e.textSecondary,background:n?e.bgHover:"transparent"}),spacer:{flex:1},closeButton:{background:"transparent",border:"none",color:e.textSecondary,cursor:"pointer",fontSize:16,padding:"0 4px",lineHeight:1},row:{display:"flex",alignItems:"center",gap:4},findInput:{flex:1,background:e.bg,color:e.text,border:`1px solid ${e.border}`,borderRadius:4,padding:"4px 8px",fontSize:13,outline:"none"},replaceInput:{flex:1,background:e.bg,color:e.text,border:`1px solid ${e.border}`,borderRadius:4,padding:"4px 8px",fontSize:13,outline:"none"},markRow:{display:"flex",alignItems:"center",gap:6},markLabel:{fontSize:12,color:e.textSecondary},markColor:(n,r)=>({width:20,height:20,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,fontWeight:600,cursor:"pointer",color:"#fff",background:tu[r]||"#888",border:n?"2px solid #fff":"2px solid transparent",boxShadow:n?`0 0 0 1px ${tu[r]}`:"none"}),optionsRow:{display:"flex",alignItems:"center",gap:12,fontSize:12,color:e.textSecondary},checkboxLabel:{display:"flex",alignItems:"center",gap:4,cursor:"pointer"},checkbox:{accentColor:e.accent}}),[e])}function Q0({theme:e}){const{findReplaceMode:n,searchOptions:r,updateSearchOptions:o,setShowFindReplace:l}=Me(),u=J0(e),p=de.useRef(null),[f,h]=de.useState(1);de.useEffect(()=>{var q,Y;(q=p.current)==null||q.focus(),(Y=p.current)==null||Y.select()},[n]);const x=de.useCallback(q=>{_(r.query,q,r)},[r]),_=(q,Y,B)=>{document.dispatchEvent(new CustomEvent("notemac-find",{detail:{query:q,direction:Y,isCaseSensitive:B.isCaseSensitive,isWholeWord:B.isWholeWord,isRegex:B.isRegex}}))},y=()=>x("next"),O=()=>x("prev"),R=()=>{document.dispatchEvent(new CustomEvent("notemac-replace",{detail:{find:r.query,replace:r.replaceText,all:!1,...r}}))},z=()=>{document.dispatchEvent(new CustomEvent("notemac-replace",{detail:{find:r.query,replace:r.replaceText,all:!0,...r}}))},N=()=>{document.dispatchEvent(new CustomEvent("notemac-mark",{detail:{...r,style:f}}))},L=()=>{document.dispatchEvent(new CustomEvent("notemac-clear-marks",{}))},D=q=>{q.key==="Enter"&&(q.preventDefault(),q.shiftKey?O():y()),q.key==="Escape"&&l(!1)},U=({active:q,onClick:Y,title:B,children:K})=>{const se=de.useMemo(()=>({background:q?e.accent:"transparent",color:q?e.accentText:e.textSecondary,border:`1px solid ${q?e.accent:e.border}`,borderRadius:4,padding:"2px 6px",cursor:"pointer",fontSize:12,fontWeight:q?600:400,minWidth:28,height:24,display:"flex",alignItems:"center",justifyContent:"center"}),[q,e]);return E.jsx("button",{title:B,"aria-label":B,onClick:Y,style:se,children:K})},G=({onClick:q,title:Y,children:B,primary:K})=>{const se=de.useMemo(()=>({background:K?e.accent:"transparent",color:K?e.accentText:e.textSecondary,border:`1px solid ${K?e.accent:e.border}`,borderRadius:4,padding:"2px 8px",cursor:"pointer",fontSize:12,height:24,display:"flex",alignItems:"center",justifyContent:"center"}),[K,e]);return E.jsx("button",{title:Y,"aria-label":Y,onClick:q,style:se,children:B})},X=[{key:"find",label:"Find"},{key:"replace",label:"Replace"},{key:"findInFiles",label:"Find in Files"},{key:"mark",label:"Mark"}];return E.jsxs("div",{style:u.container,children:[E.jsxs("div",{style:u.modesRow,children:[X.map(q=>E.jsx("span",{onClick:()=>Me.getState().setShowFindReplace(!0,q.key),style:u.modeTab(n===q.key),children:q.label},q.key)),E.jsx("div",{style:u.spacer}),E.jsx("button",{"aria-label":"Close find and replace",onClick:()=>l(!1),style:u.closeButton,children:""})]}),E.jsxs("div",{style:u.row,children:[E.jsx("input",{ref:p,type:"text",placeholder:"Find...",value:r.query,onChange:q=>o({query:q.target.value}),onKeyDown:D,style:u.findInput}),E.jsx(U,{active:r.isCaseSensitive,onClick:()=>o({isCaseSensitive:!r.isCaseSensitive}),title:"Match Case",children:"Aa"}),E.jsx(U,{active:r.isWholeWord,onClick:()=>o({isWholeWord:!r.isWholeWord}),title:"Whole Word",children:"W"}),E.jsx(U,{active:r.isRegex,onClick:()=>o({isRegex:!r.isRegex}),title:"Use Regular Expression",children:".*"}),E.jsx(G,{onClick:O,title:"Previous Match (Shift+Enter)",children:""}),E.jsx(G,{onClick:y,title:"Next Match (Enter)",children:""})]}),(n==="replace"||n==="findInFiles")&&E.jsxs("div",{style:u.row,children:[E.jsx("input",{type:"text",placeholder:"Replace...",value:r.replaceText,onChange:q=>o({replaceText:q.target.value}),onKeyDown:D,style:u.replaceInput}),E.jsx(G,{onClick:R,title:"Replace",children:"Replace"}),E.jsx(G,{onClick:z,title:"Replace All",primary:!0,children:"Replace All"})]}),n==="mark"&&E.jsxs("div",{style:u.markRow,children:[E.jsx("span",{style:u.markLabel,children:"Style:"}),[1,2,3,4,5].map(q=>E.jsx("div",{onClick:()=>h(q),style:u.markColor(f===q,q),children:q},q)),E.jsx("div",{style:u.spacer}),E.jsx(G,{onClick:N,title:"Mark All",primary:!0,children:"Mark All"}),E.jsx(G,{onClick:L,title:"Clear All Marks",children:"Clear Marks"})]}),E.jsxs("div",{style:u.optionsRow,children:[E.jsxs("label",{style:u.checkboxLabel,children:[E.jsx("input",{type:"checkbox",checked:r.wrapAround,onChange:q=>o({wrapAround:q.target.checked}),style:u.checkbox}),"Wrap around"]}),E.jsxs("label",{style:u.checkboxLabel,children:[E.jsx("input",{type:"checkbox",checked:r.searchInSelection,onChange:q=>o({searchInSelection:q.target.checked}),style:u.checkbox}),"In selection"]})]})]})}function ev({theme:e}){const{addTab:n,recentFiles:r}=Me(),o=tv(e),u=navigator.platform.includes("Mac")?"":"Ctrl";return E.jsxs("div",{style:o.container,children:[E.jsxs("div",{style:o.headerWrapper,children:[E.jsx("div",{style:o.logo,children:"N++"}),E.jsx("h1",{style:o.title,children:"Notemac++"}),E.jsx("p",{style:o.subtitle,children:"A powerful text editor for Mac & Web"})]}),E.jsxs("div",{style:o.quickActionsSection,children:[E.jsx(us,{theme:e,label:"New File",shortcut:`${u}N`,onClick:()=>n()}),E.jsx(us,{theme:e,label:"Open File",shortcut:`${u}O`,onClick:()=>{window.electronAPI||rv().then(p=>{p&&n({name:p.name,content:p.content,language:sr(p.name),lineEnding:br(p.content)})})}}),E.jsx(us,{theme:e,label:"Open Folder",onClick:async()=>{if("showDirectoryPicker"in window)try{await window.showDirectoryPicker(),Me.getState().setSidebarPanel("explorer")}catch{}}})]}),E.jsxs("div",{style:o.shortcutsContainer,children:[E.jsx("div",{style:o.shortcutsTitle,children:"Keyboard Shortcuts"}),E.jsx("div",{style:o.shortcutsGrid,children:[[`${u}N`,"New file"],[`${u}O`,"Open file"],[`${u}S`,"Save"],[`${u}F`,"Find"],[`${u}H`,"Find & Replace"],[`${u}G`,"Go to line"],[`${u}D`,"Duplicate line"],[`${u}B`,"Toggle sidebar"],[`${u},`,"Preferences"]].map(([p,f])=>E.jsxs(St.Fragment,{children:[E.jsx("kbd",{style:o.shortcutKey,children:p}),E.jsx("span",{style:o.shortcutDesc,children:f})]},`shortcut-${p}`))})]}),r.length>0&&E.jsxs("div",{style:o.recentFilesWrapper,children:[E.jsx("div",{style:o.recentFilesTitle,children:"Recent Files"}),r.slice(0,5).map(p=>E.jsxs("div",{onClick:async()=>{if(window.electronAPI){const f=await window.electronAPI.readFile(p.path);n({name:p.name,path:p.path,content:f,language:sr(p.name),lineEnding:br(f)})}},className:"hover-bg hover-bg-reset",style:o.recentFileItem,children:[p.name,E.jsx("span",{style:o.recentFilePath,children:p.path})]},`recent-${p.path||p.name}`))]})]})}function us({theme:e,label:n,shortcut:r,onClick:o}){const[l,u]=St.useState(!1),p=de.useMemo(()=>({button:{display:"flex",flexDirection:"column",alignItems:"center",gap:6,padding:"12px 20px",backgroundColor:l?e.bgHover:e.bgSecondary,color:e.text,border:`1px solid ${e.border}`,borderRadius:8,cursor:"pointer",fontSize:13,transition:"background-color 0.15s ease",minWidth:110},shortcutLabel:{fontSize:11,color:e.textMuted}}),[l,e]);return E.jsxs("button",{onClick:o,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),style:p.button,children:[E.jsx("span",{children:n}),r&&E.jsx("span",{style:p.shortcutLabel,children:r})]})}function tv(e){return de.useMemo(()=>({container:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:e.editorBg,gap:24},headerWrapper:{textAlign:"center"},logo:{fontSize:64,fontWeight:200,color:e.textMuted,letterSpacing:-2,marginBottom:8},title:{fontSize:28,fontWeight:300,color:e.textSecondary,marginBottom:4},subtitle:{color:e.textMuted,fontSize:14},quickActionsSection:{display:"flex",gap:12,marginTop:8},shortcutsContainer:{marginTop:24,padding:24,backgroundColor:e.bgSecondary,borderRadius:12,border:`1px solid ${e.border}`,width:400},shortcutsTitle:{fontSize:12,fontWeight:600,color:e.textSecondary,textTransform:"uppercase",letterSpacing:1,marginBottom:12},shortcutsGrid:{display:"grid",gridTemplateColumns:"auto 1fr",gap:"8px 16px",fontSize:13},shortcutKey:{backgroundColor:e.bgTertiary,color:e.textSecondary,padding:"2px 8px",borderRadius:4,fontSize:12,fontFamily:"-apple-system, system-ui, sans-serif",border:`1px solid ${e.border}`,textAlign:"center",minWidth:60},shortcutDesc:{color:e.textSecondary},recentFilesWrapper:{marginTop:8},recentFilesTitle:{fontSize:12,fontWeight:600,color:e.textSecondary,textTransform:"uppercase",letterSpacing:1,marginBottom:8},recentFileItem:{padding:"6px 12px",cursor:"pointer",color:e.accent,fontSize:13,borderRadius:4,"--hover-bg":e.bgHover},recentFilePath:{color:e.textMuted,fontSize:11,marginLeft:8}}),[e])}async function rv(){if("showOpenFilePicker"in window)try{const[e]=await window.showOpenFilePicker({multiple:!1}),n=await e.getFile(),r=await n.text();return{name:n.name,content:r}}catch{return null}return new Promise(e=>{const n=document.createElement("input");n.type="file",n.onchange=async r=>{var u;const o=(u=r.target.files)==null?void 0:u[0];if(!o){e(null);return}const l=await o.text();e({name:o.name,content:l})},n.click()})}function nv(e,n,r){const o=de.useRef(null);de.useEffect(()=>{if(!n||!e.current)return;o.current=document.activeElement instanceof HTMLElement?document.activeElement:null;const l=e.current,u='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])',p=l.querySelector(u);p==null||p.focus();const f=h=>{if(h.key==="Escape"){h.preventDefault(),r==null||r();return}if(h.key!=="Tab")return;const x=l.querySelectorAll(u);if(x.length===0)return;const _=x[0],y=x[x.length-1];h.shiftKey?document.activeElement===_&&(h.preventDefault(),y.focus()):document.activeElement===y&&(h.preventDefault(),_.focus())};return l.addEventListener("keydown",f),()=>{var h;l.removeEventListener("keydown",f),(h=o.current)==null||h.focus()}},[n,e,r])}const iv=1200*1e3,pd="notemac_feedback_shown_version";function av({theme:e}){const[n,r]=de.useState(!1),[o,l]=de.useState(null),u=de.useRef(null);if(de.useEffect(()=>{if(localStorage.getItem(pd)===eu)return;const O=setTimeout(()=>{r(!0),localStorage.setItem(pd,eu)},iv);return()=>clearTimeout(O)},[]),nv(u,n,()=>r(!1)),!n)return null;const p="I've been using Notemac++ and it's an awesome text editor for Mac & Web! Check it out:",f="https://sergioadevita.github.io/notemac-plus-plus/",h=encodeURIComponent("Check out Notemac++!"),x=encodeURIComponent(`Hey!

${p}
${f}

Give it a try!`),_=[{id:"github",label:"Open an issue",sublabel:"Report bugs or request features",icon:E.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:e.text,children:E.jsx("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})}),href:"https://github.com/sergioadevita/notemac-plus-plus/issues/new",color:e.bgTertiary,textColor:e.text,borderColor:e.border},{id:"twitter",label:"Share on X",sublabel:"Tell the world about it",icon:E.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"#fff",children:E.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),href:`https://twitter.com/intent/tweet?text=${encodeURIComponent(p)}&url=${encodeURIComponent(f)}`,color:"#000",textColor:"#fff",borderColor:"#333"},{id:"email",label:"Share via email",sublabel:"Send to a friend",icon:E.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:e.accent,children:E.jsx("path",{d:"M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})}),href:`mailto:?subject=${h}&body=${x}`,color:e.bgTertiary,textColor:e.text,borderColor:e.border},{id:"donate",label:"Buy me a coffee",sublabel:"Support development",icon:E.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"#fff",children:E.jsx("path",{d:"M23.881 8.948c-.773-4.085-4.859-4.593-4.859-4.593H.723c-.604 0-.679.798-.679.798s-.082 7.324-.022 11.822c.164 2.424 2.586 2.672 2.586 2.672s8.267-.023 11.966-.049c2.438-.426 2.683-2.566 2.658-3.734 4.352.24 7.422-2.831 6.649-6.916zm-11.062 3.511c-1.246 1.453-4.011 3.976-4.011 3.976s-.121.119-.31.023c-.076-.057-.108-.09-.108-.09-.443-.441-3.368-3.049-4.034-3.954-.709-.965-1.041-2.7-.091-3.71.951-1.01 3.005-1.086 4.363.407 0 0 1.565-1.782 3.468-.963 1.904.82 1.832 3.011.723 4.311zm6.173.478c-.928.116-1.682.028-1.682.028V7.284h1.77s1.971.551 1.971 2.638c0 1.913-.985 2.667-2.059 3.015z"})}),href:"https://ko-fi.com/sergioadevita",color:"#FF5E5B",textColor:"#fff",borderColor:"#FF5E5B"}];return E.jsx("div",{className:"dialog-overlay",onClick:()=>r(!1),style:{zIndex:Ed},children:E.jsxs("div",{ref:u,role:"dialog","aria-modal":"true","aria-labelledby":"feedback-title",onClick:y=>y.stopPropagation(),style:{backgroundColor:e.bgSecondary,border:`1px solid ${e.border}`,borderRadius:16,padding:32,width:440,boxShadow:"0 12px 48px rgba(0,0,0,0.5)",textAlign:"center",animation:"feedbackSlideIn 0.4s ease-out"},children:[E.jsx("style",{children:`
                    @keyframes feedbackSlideIn {
                        from { opacity: 0; transform: translateY(30px) scale(0.95); }
                        to { opacity: 1; transform: translateY(0) scale(1); }
                    }
                `}),E.jsx("div",{style:{fontSize:48,marginBottom:8},children:""}),E.jsx("h2",{id:"feedback-title",style:{color:e.text,fontSize:22,fontWeight:700,marginBottom:8},children:"Hey, you're still here!"}),E.jsxs("p",{style:{color:e.textSecondary,fontSize:14,lineHeight:1.6,marginBottom:8,padding:"0 8px"},children:["You've been coding for 20 minutes straight  that's either dedication or a really nasty bug. Either way, we're glad you're using ",E.jsx("span",{style:{color:e.accent,fontWeight:600},children:"Notemac++"}),"!"]}),E.jsx("p",{style:{color:e.textMuted,fontSize:13,marginBottom:24},children:"If this octopus has been helpful, here are some ways to spread the love:"}),E.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10,marginBottom:24},children:_.map(y=>{let O=o===y.id;return E.jsxs("a",{href:y.href,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",alignItems:"center",gap:12,backgroundColor:y.color,color:y.textColor,border:`1px solid ${y.borderColor}`,borderRadius:10,padding:"10px 16px",textDecoration:"none",transition:"all 0.2s ease",transform:O?"translateX(4px)":"none",opacity:O?.9:1},onMouseEnter:()=>l(y.id),onMouseLeave:()=>l(null),children:[E.jsx("div",{style:{flexShrink:0},children:y.icon}),E.jsxs("div",{style:{textAlign:"left"},children:[E.jsx("div",{style:{fontWeight:600,fontSize:14},children:y.label}),E.jsx("div",{style:{fontSize:11,opacity:.7},children:y.sublabel})]})]},y.id)})}),E.jsx("button",{onClick:()=>r(!1),className:"hover-color",style:{backgroundColor:"transparent",color:e.textMuted,border:"none",cursor:"pointer",fontSize:13,padding:"6px 16px",transition:"color 0.2s","--hover-color":e.text},children:"Maybe later  I'm in the zone"})]})})}class Ct extends de.Component{constructor(r){super(r);Lc(this,"handleRetry",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,o){}render(){var r;return this.state.hasError?E.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:32,gap:12,color:"#b0b0b0",fontFamily:"system-ui, sans-serif",fontSize:13,height:"100%"},children:[E.jsx("div",{style:{fontSize:18,fontWeight:600,color:"#e06c75"},children:this.props.fallbackMessage||"Something went wrong"}),E.jsx("div",{style:{maxWidth:400,textAlign:"center",lineHeight:1.5},children:((r=this.state.error)==null?void 0:r.message)||"An unexpected error occurred in this panel."}),E.jsx("button",{onClick:this.handleRetry,style:{marginTop:8,padding:"6px 16px",backgroundColor:"#3d3d3d",color:"#d4d4d4",border:"1px solid #555",borderRadius:4,cursor:"pointer",fontSize:12},children:"Retry"})]}):this.props.children}}const ov=de.lazy(()=>ht(()=>import("./SettingsDialogViewPresenter-DKTTQDJP.js"),__vite__mapDeps([10,1,2,3]),import.meta.url).then(e=>({default:e.SettingsDialog}))),sv=de.lazy(()=>ht(()=>import("./GoToLineDialogViewPresenter-tS6scjju.js"),__vite__mapDeps([11,1,2,3]),import.meta.url).then(e=>({default:e.GoToLineDialog}))),lv=de.lazy(()=>ht(()=>import("./AboutDialogViewPresenter-B1ObHtVD.js"),__vite__mapDeps([12,1,2,3]),import.meta.url).then(e=>({default:e.AboutDialog}))),cv=de.lazy(()=>ht(()=>import("./RunCommandDialogViewPresenter-C8oedrh3.js"),__vite__mapDeps([13,1,2,3]),import.meta.url).then(e=>({default:e.RunCommandDialog}))),uv=de.lazy(()=>ht(()=>import("./ColumnEditorDialogViewPresenter-BtI_5Cdk.js"),__vite__mapDeps([14,1,2,3]),import.meta.url).then(e=>({default:e.ColumnEditorDialog}))),fv=de.lazy(()=>ht(()=>import("./SummaryDialogViewPresenter-C4tXO6s6.js"),__vite__mapDeps([15,1,2,3]),import.meta.url).then(e=>({default:e.SummaryDialog}))),dv=de.lazy(()=>ht(()=>import("./CharInRangeDialogViewPresenter-DTCM-ZKH.js"),__vite__mapDeps([16,1,2,3]),import.meta.url).then(e=>({default:e.CharInRangeDialog}))),hv=de.lazy(()=>ht(()=>import("./ShortcutMapperDialogViewPresenter-CGZoCVGe.js"),__vite__mapDeps([17,18,1,2,3]),import.meta.url).then(e=>({default:e.ShortcutMapperDialog}))),pv=de.lazy(()=>ht(()=>import("./CommandPaletteViewPresenter-DkLpXWBr.js"),__vite__mapDeps([19,18,20,1,2,3]),import.meta.url).then(e=>({default:e.CommandPaletteViewPresenter}))),gv=de.lazy(()=>ht(()=>import("./QuickOpenViewPresenter-EL7cO8SX.js"),__vite__mapDeps([21,20,1,2,3]),import.meta.url).then(e=>({default:e.QuickOpenViewPresenter}))),mv=de.lazy(()=>ht(()=>import("./DiffViewerViewPresenter-Ckhmvfb4.js"),__vite__mapDeps([22,5,1,2,3]),import.meta.url).then(e=>({default:e.DiffViewerViewPresenter}))),wv=de.lazy(()=>ht(()=>import("./SnippetManagerViewPresenter-CmkzyxMC.js"),__vite__mapDeps([23,1,2,3]),import.meta.url).then(e=>({default:e.SnippetManagerViewPresenter}))),yv=de.lazy(()=>ht(()=>import("./TerminalPanelViewPresenter-C4dkvg4A.js"),__vite__mapDeps([24,1,2,3]),import.meta.url).then(e=>({default:e.TerminalPanelViewPresenter}))),bv=de.lazy(()=>ht(()=>import("./CloneRepositoryViewPresenter-CtGDRk_f.js"),__vite__mapDeps([25,2,3,1]),import.meta.url).then(e=>({default:e.CloneRepositoryViewPresenter}))),vv=de.lazy(()=>ht(()=>import("./GitSettingsViewPresenter-BjByPNMg.js"),__vite__mapDeps([26,1,2,3]),import.meta.url).then(e=>({default:e.GitSettingsViewPresenter}))),xv=de.lazy(()=>ht(()=>import("./AISettingsViewPresenter-B5bxd65I.js"),__vite__mapDeps([27,1,2,3]),import.meta.url).then(e=>({default:e.AISettingsViewPresenter})));function _v(){const e=Me(te=>te.tabs),n=Me(te=>te.activeTabId),r=Me(te=>te.showStatusBar),o=Me(te=>te.showToolbar),l=Me(te=>te.settings),u=Me(te=>te.showFindReplace),p=Me(te=>te.showSettings),f=Me(te=>te.showGoToLine),h=Me(te=>te.showAbout),x=Me(te=>te.showRunCommand),_=Me(te=>te.showColumnEditor),y=Me(te=>te.showSummary),O=Me(te=>te.showCharInRange),R=Me(te=>te.showShortcutMapper),z=Me(te=>te.showCommandPalette),N=Me(te=>te.showQuickOpen),L=Me(te=>te.showDiffViewer),D=Me(te=>te.showSnippetManager),U=Me(te=>te.showTerminalPanel),G=Me(te=>te.showCloneDialog),X=Me(te=>te.showGitSettings),q=Me(te=>te.showAiSettings),Y=Me(te=>te.splitView),B=Me(te=>te.splitTabId),K=Me(te=>te.addTab),se=Me(te=>te.zoomLevel),S=de.useMemo(()=>l.theme==="custom"?Jm(l.customThemeBase,l.customThemeColors):Ym(l.theme),[l.theme,l.customThemeBase,l.customThemeColors]),ne=de.useCallback(te=>{ew(te,n,se)},[n,se]);de.useEffect(()=>(window.addEventListener("keydown",ne),()=>window.removeEventListener("keydown",ne)),[ne]),de.useEffect(()=>(document.addEventListener("dragover",nd),document.addEventListener("drop",id),()=>{document.removeEventListener("dragover",nd),document.removeEventListener("drop",id)}),[]),de.useEffect(()=>{ib()},[]);const Q=de.useCallback((te,ie)=>{$d(te,n,e,se,ie)},[n,se,e]);de.useEffect(()=>{e.length===0&&K({name:"new 1",content:""})},[]),de.useEffect(()=>{Me.getState().LoadAIState()},[]),de.useEffect(()=>{const te=()=>{window.innerWidth<768&&Me.getState().sidebarPanel!==null&&Me.getState().setSidebarPanel(null)};return window.innerWidth<768&&Me.getState().sidebarPanel!==null&&Me.getState().setSidebarPanel(null),window.addEventListener("resize",te),()=>window.removeEventListener("resize",te)},[]);const oe=e.find(te=>te.id===n),W=l.distractionFreeMode,le=km();return E.jsxs("div",{className:"notemac-app",style:{backgroundColor:S.bg,color:S.text,fontSize:l.fontSize+se},children:[le&&!W&&E.jsx("div",{style:{height:38,backgroundColor:S.menuBg,borderBottom:`1px solid ${S.border}`,display:"flex",alignItems:"center",paddingLeft:78,flexShrink:0,WebkitAppRegion:"drag"},children:E.jsxs("span",{style:{fontWeight:600,fontSize:13,color:S.text,opacity:.7,WebkitAppRegion:"no-drag",userSelect:"none"},children:[oe?oe.name+(oe.isModified?" ":"")+"  ":"","Notemac++"]})}),!W&&!le&&E.jsx(cb,{theme:S,onAction:Q,isElectron:le}),o&&!W&&E.jsx(ub,{theme:S,onAction:Q}),!W&&E.jsx(fb,{theme:S}),E.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[!W&&E.jsx(W0,{theme:S}),E.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[u&&E.jsx(Q0,{theme:S}),E.jsx("div",{style:{flex:1,display:"flex",flexDirection:Y==="horizontal"?"column":"row",overflow:"hidden"},children:oe?E.jsxs(E.Fragment,{children:[E.jsx(Ct,{fallbackMessage:"Editor panel encountered an error",children:E.jsx(dd,{tab:oe,theme:S,settings:l,zoomLevel:se},oe.id)}),Y!=="none"&&B&&E.jsxs(E.Fragment,{children:[E.jsx("div",{style:{width:Y==="vertical"?4:void 0,height:Y==="horizontal"?4:void 0,backgroundColor:S.border,cursor:Y==="vertical"?"col-resize":"row-resize"}}),E.jsx(Ct,{fallbackMessage:"Split editor panel encountered an error",children:E.jsx(dd,{tab:e.find(te=>te.id===B)||oe,theme:S,settings:l,zoomLevel:se},B+"-split")})]})]}):E.jsx(ev,{theme:S})}),U&&E.jsx(Ct,{fallbackMessage:"Terminal panel failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(yv,{theme:S})})})]})]}),r&&!W&&E.jsx(U0,{theme:S}),p&&E.jsx(Ct,{fallbackMessage:"Settings failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(ov,{theme:S})})}),f&&E.jsx(Ct,{fallbackMessage:"Go to Line dialog failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(sv,{theme:S})})}),h&&E.jsx(Ct,{fallbackMessage:"About dialog failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(lv,{theme:S})})}),x&&E.jsx(Ct,{fallbackMessage:"Run Command dialog failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(cv,{theme:S})})}),_&&E.jsx(Ct,{fallbackMessage:"Column Editor dialog failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(uv,{theme:S})})}),y&&E.jsx(Ct,{fallbackMessage:"Summary dialog failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(fv,{theme:S})})}),O&&E.jsx(Ct,{fallbackMessage:"Char in Range dialog failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(dv,{theme:S})})}),R&&E.jsx(Ct,{fallbackMessage:"Shortcut Mapper dialog failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(hv,{theme:S})})}),z&&E.jsx(Ct,{fallbackMessage:"Command Palette failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(pv,{theme:S})})}),N&&E.jsx(Ct,{fallbackMessage:"Quick Open failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(gv,{theme:S})})}),L&&E.jsx(Ct,{fallbackMessage:"Diff Viewer failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(mv,{theme:S})})}),D&&E.jsx(Ct,{fallbackMessage:"Snippet Manager failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(wv,{theme:S})})}),G&&E.jsx(Ct,{fallbackMessage:"Clone Repository dialog failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(bv,{theme:S})})}),X&&E.jsx(Ct,{fallbackMessage:"Git Settings failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(vv,{theme:S})})}),q&&E.jsx(Ct,{fallbackMessage:"AI Settings failed to load",children:E.jsx(de.Suspense,{fallback:null,children:E.jsx(xv,{theme:S})})}),E.jsx(av,{theme:S})]})}ag.createRoot(document.getElementById("root")).render(E.jsx(St.StrictMode,{children:E.jsx(_v,{})}));export{eu as A,$v as B,Os as C,Nn as D,Ms as E,ch as F,Ym as G,$d as H,uh as I,a1 as J,r1 as K,jv as L,Bv as M,Fr as N,Fv as O,Dv as P,M0 as Q,St as R,jn as S,Nv as T,Ov as U,Mv as V,qm as W,Ld as X,zv as Y,Av as Z,t1 as _,nv as a,Ed as b,$0 as c,Rv as d,Cv as e,o1 as f,vr as g,n1 as h,ah as i,E as j,fr as k,Iv as l,gi as m,Tv as n,_d as o,Cs as p,vy as q,de as r,_a as s,Uv as t,Me as u,ym as v,i1 as w,Pv as x,Lv as y,yi as z};
