import{u as O,r as l,D as T,N as U,j as e,b as F}from"./index-DLc_IVaT.js";import"./react-vendor-P8ZuH1e3.js";import"./monaco-editor-C1KnpKkb.js";function _(n){return l.useMemo(()=>({overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.4)",zIndex:F,display:"flex",justifyContent:"center",alignItems:"center"},modal:{width:720,height:520,backgroundColor:n.bgSecondary,border:`1px solid ${n.border}`,borderRadius:8,boxShadow:"0 8px 32px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column",overflow:"hidden"},titleBar:{padding:"10px 16px",borderBottom:`1px solid ${n.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"},titleText:{fontSize:14,fontWeight:600,color:n.text},titleButtonsContainer:{display:"flex",gap:6},contentContainer:{flex:1,display:"flex",overflow:"hidden"},listPanel:{width:220,borderRight:`1px solid ${n.border}`,display:"flex",flexDirection:"column"},listHeader:{padding:8},listNewButton:s=>({...s,width:"100%"}),listScroll:{flex:1,overflowY:"auto"},getListItem:s=>({padding:"8px 12px",cursor:"pointer",backgroundColor:s?n.accent+"22":"transparent",borderLeft:s?`2px solid ${n.accent}`:"2px solid transparent"}),listItemName:{fontSize:13,color:n.text},listItemMeta:{fontSize:11,color:n.textSecondary},listEmpty:{padding:"16px 12px",fontSize:12,color:n.textSecondary,textAlign:"center"},editorPanel:{flex:1,padding:16,overflowY:"auto",display:"flex",flexDirection:"column",gap:10},editorEmpty:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",color:n.textSecondary,fontSize:13},fieldContainer:{display:"block"},fieldLabel:{fontSize:11,color:n.textSecondary,display:"block",marginBottom:4},twoColumnContainer:{display:"flex",gap:10},column:{flex:1},textareaContainer:{flex:1,minHeight:120},fieldButtonsContainer:{display:"flex",gap:8,justifyContent:"flex-end"},input:{width:"100%",padding:"6px 8px",fontSize:12,backgroundColor:n.bg,color:n.text,border:`1px solid ${n.border}`,borderRadius:4,outline:"none"},textarea:{width:"100%",padding:"6px 8px",fontSize:12,backgroundColor:n.bg,color:n.text,border:`1px solid ${n.border}`,borderRadius:4,outline:"none",height:140,resize:"vertical",fontFamily:"'SF Mono', 'Menlo', monospace"},button:{padding:"4px 12px",fontSize:12,backgroundColor:n.bg,color:n.text,border:`1px solid ${n.border}`,borderRadius:4,cursor:"pointer"},insertButton:{padding:"4px 12px",fontSize:12,backgroundColor:n.accent,color:"#fff",border:"none",borderRadius:4,cursor:"pointer"},deleteButton:{padding:"4px 12px",fontSize:12,color:"#ff4444",backgroundColor:n.bg,border:`1px solid ${n.border}`,borderRadius:4,cursor:"pointer"},saveButton:{padding:"4px 12px",fontSize:12,backgroundColor:n.accent,color:"#fff",border:"none",borderRadius:4,cursor:"pointer"}}),[n])}function V({theme:n}){const{setShowSnippetManager:s,savedSnippets:d,addSnippet:w,removeSnippet:E,updateSnippet:I,loadSnippets:B}=O(),[i,j]=l.useState(null),[c,S]=l.useState(""),[p,h]=l.useState(""),[g,v]=l.useState(""),[b,m]=l.useState("*"),[y,k]=l.useState(""),[u,C]=l.useState(!1);l.useEffect(()=>{B()},[]);const r=d.find(o=>o.id===i);l.useEffect(()=>{r&&(S(r.name),h(r.prefix),v(r.body),m(r.language),k(r.description||""),C(!1))},[i]);const N=l.useCallback(()=>{C(!0),j(null),S(""),h(""),v(""),m("*"),k("")},[]),L=l.useCallback(()=>{c.trim().length===0||p.trim().length===0||(u?(w({name:c.trim(),prefix:p.trim(),body:g,language:b,description:y.trim()||void 0}),C(!1)):i&&I(i,{name:c.trim(),prefix:p.trim(),body:g,language:b,description:y.trim()||void 0}))},[u,i,c,p,g,b,y]),z=l.useCallback(()=>{i&&(E(i),j(null),C(!1))},[i]),R=l.useCallback(()=>{r&&(T(U.INSERT_SNIPPET,{body:r.body}),s(!1))},[r]),D=l.useCallback(()=>{const o=new Blob([JSON.stringify(d,null,2)],{type:"application/json"}),x=URL.createObjectURL(o),a=document.createElement("a");a.href=x,a.download="notemac-snippets.json",a.click(),URL.revokeObjectURL(x)},[d]),P=l.useCallback(()=>{const o=document.createElement("input");o.type="file",o.accept=".json",o.onchange=async()=>{var a;const x=(a=o.files)==null?void 0:a[0];if(x)try{const $=await x.text(),M=JSON.parse($);for(const f of M)w({name:f.name,prefix:f.prefix,body:f.body,language:f.language||"*",description:f.description})}catch{}},o.click()},[]),t=_(n);return e.jsx("div",{style:t.overlay,onClick:()=>s(!1),children:e.jsxs("div",{style:t.modal,onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{style:t.titleBar,children:[e.jsx("span",{style:t.titleText,children:"Snippet Manager"}),e.jsxs("div",{style:t.titleButtonsContainer,children:[e.jsx("button",{onClick:P,style:t.button,children:"Import"}),e.jsx("button",{onClick:D,style:t.button,children:"Export"}),e.jsx("button",{onClick:()=>s(!1),style:t.button,children:"Close"})]})]}),e.jsxs("div",{style:t.contentContainer,children:[e.jsxs("div",{style:t.listPanel,children:[e.jsx("div",{style:t.listHeader,children:e.jsx("button",{onClick:N,style:t.listNewButton(t.button),children:"+ New Snippet"})}),e.jsxs("div",{style:t.listScroll,children:[d.map(o=>e.jsxs("div",{onClick:()=>j(o.id),style:t.getListItem(o.id===i),children:[e.jsx("div",{style:t.listItemName,children:o.name}),e.jsxs("div",{style:t.listItemMeta,children:[o.prefix," \\u2022 ",o.language]})]},o.id)),d.length===0&&e.jsx("div",{style:t.listEmpty,children:"No snippets yet"})]})]}),e.jsx("div",{style:t.editorPanel,children:i||u?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:t.fieldContainer,children:[e.jsx("label",{style:t.fieldLabel,children:"Name"}),e.jsx("input",{value:c,onChange:o=>S(o.target.value),style:t.input})]}),e.jsxs("div",{style:t.twoColumnContainer,children:[e.jsxs("div",{style:t.column,children:[e.jsx("label",{style:t.fieldLabel,children:"Prefix (trigger)"}),e.jsx("input",{value:p,onChange:o=>h(o.target.value),style:t.input,placeholder:"e.g. log, fn, cls"})]}),e.jsxs("div",{style:t.column,children:[e.jsx("label",{style:t.fieldLabel,children:"Language"}),e.jsx("input",{value:b,onChange:o=>m(o.target.value),style:t.input,placeholder:"* for all"})]})]}),e.jsxs("div",{style:t.fieldContainer,children:[e.jsx("label",{style:t.fieldLabel,children:"Description"}),e.jsx("input",{value:y,onChange:o=>k(o.target.value),style:t.input})]}),e.jsxs("div",{style:t.textareaContainer,children:[e.jsx("label",{style:t.fieldLabel,children:"Body (use $1, $2 for tab stops, $0 for final cursor)"}),e.jsx("textarea",{value:g,onChange:o=>v(o.target.value),style:t.textarea})]}),e.jsxs("div",{style:t.fieldButtonsContainer,children:[!u&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:R,style:t.insertButton,children:"Insert"}),e.jsx("button",{onClick:z,style:t.deleteButton,children:"Delete"})]}),e.jsx("button",{onClick:L,style:t.saveButton,children:u?"Create":"Save"})]})]}):e.jsx("div",{style:t.editorEmpty,children:"Select a snippet or create a new one"})})]})]})})}export{V as SnippetManagerViewPresenter};
