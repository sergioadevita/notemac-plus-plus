const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-BLISzHqN.js","./react-vendor-P8ZuH1e3.js","./monaco-editor-BYMRfcD5.js","./monaco-editor-C3yYqDe4.css","./index-CMGmaL8j.css"])))=>i.map(i=>d[i]);
import{_ as D}from"./monaco-editor-BYMRfcD5.js";import{u as c,r as a,g as U,C as _,h as I,i as $,I as L,j as e,k as E}from"./index-BLISzHqN.js";import"./react-vendor-P8ZuH1e3.js";function N(r){return a.useMemo(()=>({overlay:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},modal:{width:480,backgroundColor:r.bg,border:`1px solid ${r.border}`,borderRadius:8,boxShadow:"0 8px 32px rgba(0,0,0,0.4)",overflow:"hidden"},header:{padding:"12px 16px",borderBottom:`1px solid ${r.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"},headerTitle:{fontSize:14,fontWeight:600,color:r.text},closeIcon:{cursor:"pointer",color:r.textMuted,fontSize:18},body:{padding:16,display:"flex",flexDirection:"column",gap:12},errorBox:{padding:"8px 12px",backgroundColor:"#f38ba822",borderRadius:4,fontSize:12,color:"#f38ba8"},warningBox:{padding:"8px 12px",backgroundColor:"#f9e2af22",borderRadius:4,fontSize:11,color:"#f9e2af"},fieldContainer:{display:"block"},label:{fontSize:12,color:r.textSecondary,display:"block",marginBottom:4},input:{width:"100%",height:32,backgroundColor:r.bgSecondary,color:r.text,border:`1px solid ${r.border}`,borderRadius:4,padding:"0 10px",fontSize:13,boxSizing:"border-box"},checkboxContainer:{display:"flex",alignItems:"center",gap:8},checkboxLabel:{fontSize:12,color:r.textSecondary},authInputsContainer:{display:"flex",flexDirection:"column",gap:8,paddingLeft:24},authInput:{height:28,backgroundColor:r.bgSecondary,color:r.text,border:`1px solid ${r.border}`,borderRadius:4,padding:"0 8px",fontSize:12,boxSizing:"border-box"},progressContainer:{display:"block"},progressText:{fontSize:11,color:r.textMuted,marginBottom:4},progressBarOuter:{height:4,backgroundColor:r.border,borderRadius:2,overflow:"hidden"},getProgressBarInner:i=>({height:"100%",backgroundColor:r.accent,borderRadius:2,width:`${0<i?i:30}%`,transition:"width 0.3s"}),footer:{padding:"12px 16px",borderTop:`1px solid ${r.border}`,display:"flex",justifyContent:"flex-end",gap:8},cancelButton:{height:30,padding:"0 16px",backgroundColor:r.bgHover,color:r.text,border:`1px solid ${r.border}`,borderRadius:4,cursor:"pointer",fontSize:12},getCloneButton:i=>({height:30,padding:"0 16px",backgroundColor:r.accent,color:r.accentText,border:"none",borderRadius:4,cursor:i?"not-allowed":"pointer",fontSize:12,fontWeight:600,opacity:i?.5:1})}),[r])}function V({theme:r}){var S;const i=c(o=>o.setShowCloneDialog),n=c(o=>o.gitCredentials),h=c(o=>o.isGitOperationInProgress),y=c(o=>o.gitOperationProgress),j=c(o=>o.gitOperationError),[s,B]=a.useState(""),[x,R]=a.useState(!1),[f,P]=a.useState((n==null?void 0:n.username)||""),[C,z]=a.useState((n==null?void 0:n.token)||""),[p,A]=a.useState(!1),[k,F]=a.useState(""),g=E(),d=g==="webfs"||g==="electron",u=a.useCallback(()=>{i(!1)},[i]),T=a.useCallback(async()=>{var m;if(s.trim().length===0)return;const o=c.getState(),v=x?{type:"token",username:f,token:C}:n;try{if(p||!d){const l=U(),b=k||((m=s.split("/").pop())==null?void 0:m.replace(".git",""))||"cloned-repo",w=_(l);await I(s.trim(),w,"/",v),o.AddBrowserWorkspace({id:l,name:b,repoUrl:s.trim(),createdAt:Date.now(),lastOpenedAt:Date.now()}),o.SetIsBrowserWorkspace(!0),o.setWorkspacePath(b),o.setSidebarPanel("explorer")}else if(g==="webfs"){const l=await window.showDirectoryPicker({mode:"readwrite"}),{CreateWebFsAdapter:b}=await D(async()=>{const{CreateWebFsAdapter:W}=await import("./index-BLISzHqN.js").then(O=>O._);return{CreateWebFsAdapter:W}},__vite__mapDeps([0,1,2,3,4]),import.meta.url),w=b(l);$(l.name,l),await I(s.trim(),w,"/",v),o.setWorkspacePath(l.name),o.setSidebarPanel("explorer")}await L(),u()}catch{}},[s,x,f,C,n,p,d,g,k,u]),t=N(r);return e.jsx("div",{onClick:u,style:t.overlay,children:e.jsxs("div",{onClick:o=>o.stopPropagation(),style:t.modal,children:[e.jsxs("div",{style:t.header,children:[e.jsx("span",{style:t.headerTitle,children:"Clone Repository"}),e.jsx("span",{onClick:u,style:t.closeIcon,children:"✕"})]}),e.jsxs("div",{style:t.body,children:[j!==null&&e.jsx("div",{style:t.errorBox,children:j}),e.jsxs("div",{style:t.fieldContainer,children:[e.jsx("label",{style:t.label,children:"Repository URL"}),e.jsx("input",{autoFocus:!0,value:s,onChange:o=>B(o.target.value),placeholder:"https://github.com/user/repo.git",style:t.input})]}),d&&e.jsxs("div",{style:t.checkboxContainer,children:[e.jsx("input",{type:"checkbox",checked:p,onChange:o=>A(o.target.checked),id:"clone-to-browser"}),e.jsx("label",{htmlFor:"clone-to-browser",style:t.checkboxLabel,children:"Clone to browser workspace (stored in browser only)"})]}),(p||!d)&&e.jsxs("div",{style:t.fieldContainer,children:[e.jsx("label",{style:t.label,children:"Workspace Name"}),e.jsx("input",{value:k,onChange:o=>F(o.target.value),placeholder:((S=s.split("/").pop())==null?void 0:S.replace(".git",""))||"my-repo",style:t.input})]}),!d&&e.jsx("div",{style:t.warningBox,children:"⚠ Your browser doesn't support the File System Access API. The repository will be cloned to browser storage. Files may be lost if you clear browser data."}),e.jsxs("div",{style:t.fieldContainer,children:[e.jsxs("div",{style:t.checkboxContainer,children:[e.jsx("input",{type:"checkbox",checked:x,onChange:o=>R(o.target.checked),id:"custom-auth"}),e.jsx("label",{htmlFor:"custom-auth",style:t.checkboxLabel,children:n!==null?"Use different credentials":"Authenticate"})]}),x&&e.jsxs("div",{style:t.authInputsContainer,children:[e.jsx("input",{value:f,onChange:o=>P(o.target.value),placeholder:"Username",style:t.authInput}),e.jsx("input",{type:"password",value:C,onChange:o=>z(o.target.value),placeholder:"Personal Access Token",style:t.authInput})]})]}),h&&e.jsxs("div",{style:t.progressContainer,children:[e.jsxs("div",{style:t.progressText,children:["Cloning... ",0<y?`${y}%`:""]}),e.jsx("div",{style:t.progressBarOuter,children:e.jsx("div",{style:t.getProgressBarInner(y)})})]})]}),e.jsxs("div",{style:t.footer,children:[e.jsx("button",{onClick:u,style:t.cancelButton,children:"Cancel"}),e.jsx("button",{onClick:T,disabled:s.trim().length===0||h,style:t.getCloneButton(s.trim().length===0||h),children:d&&!p?"Choose Folder & Clone":"Clone"})]})]})})}export{V as CloneRepositoryViewPresenter};
