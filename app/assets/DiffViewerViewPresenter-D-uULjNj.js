import{u as D,r,G as E,j as t,w as G}from"./index-DZ2o6UUv.js";import"./react-vendor-P8ZuH1e3.js";import"./monaco-editor-BYMRfcD5.js";function O({theme:o}){var b,j,h;const{setShowDiffViewer:C,tabs:n,settings:l,activeTabId:p,isRepoInitialized:f}=D(),[s,k]=r.useState(f?"git":"files"),[a,w]=r.useState(((b=n[0])==null?void 0:b.id)||""),[c,z]=r.useState(((j=n[1])==null?void 0:j.id)||((h=n[0])==null?void 0:h.id)||""),[g,v]=r.useState(!0),[I,u]=r.useState(""),[y,M]=r.useState(""),d=r.useMemo(()=>n.find(e=>e.id===a),[n,a]),x=r.useMemo(()=>n.find(e=>e.id===c),[n,c]),i=r.useMemo(()=>n.find(e=>e.id===p),[n,p]);r.useEffect(()=>{if(s!=="git"||!(i!=null&&i.path))return;const e=i.path;M(e),E(e).then($=>{u($||"")}).catch(()=>{u("")})},[s,i==null?void 0:i.path]);const R=s==="git"?I:(d==null?void 0:d.content)||"",F=s==="git"?(i==null?void 0:i.content)||"":(x==null?void 0:x.content)||"",W=s==="git"?(i==null?void 0:i.language)||"plaintext":(d==null?void 0:d.language)||"plaintext",S=r.useCallback(()=>{C(!1)},[]);return t.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1e4,display:"flex",justifyContent:"center",alignItems:"center"},onClick:S,children:t.jsxs("div",{style:{width:"90vw",height:"85vh",backgroundColor:o.bgSecondary,border:`1px solid ${o.border}`,borderRadius:8,boxShadow:"0 8px 32px rgba(0,0,0,0.5)",display:"flex",flexDirection:"column",overflow:"hidden"},onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{style:{padding:"12px 16px",borderBottom:`1px solid ${o.border}`,display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[t.jsx("span",{style:{fontSize:14,fontWeight:600,color:o.text},children:"Compare Files"}),f&&t.jsx("div",{style:{display:"flex",gap:4},children:["files","git"].map(e=>t.jsx("button",{onClick:()=>k(e),style:{padding:"3px 10px",fontSize:11,borderRadius:4,cursor:"pointer",backgroundColor:s===e?o.accent:o.bg,color:s===e?o.accentText:o.text,border:`1px solid ${s===e?o.accent:o.border}`,fontWeight:s===e?600:400},children:e==="files"?"Files":"Git HEAD"},e))}),s==="files"?t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1},children:[t.jsx("label",{style:{fontSize:12,color:o.textSecondary},children:"Original:"}),t.jsx("select",{value:a,onChange:e=>w(e.target.value),style:{flex:1,padding:"4px 8px",fontSize:12,backgroundColor:o.bg,color:o.text,border:`1px solid ${o.border}`,borderRadius:4},children:n.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))}),t.jsx("span",{style:{color:o.textSecondary},children:"vs"}),t.jsx("label",{style:{fontSize:12,color:o.textSecondary},children:"Modified:"}),t.jsx("select",{value:c,onChange:e=>z(e.target.value),style:{flex:1,padding:"4px 8px",fontSize:12,backgroundColor:o.bg,color:o.text,border:`1px solid ${o.border}`,borderRadius:4},children:n.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))})]}):t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,fontSize:12,color:o.textSecondary},children:[t.jsx("span",{children:"HEAD"}),t.jsx("span",{style:{color:o.textMuted},children:"vs"}),t.jsx("span",{style:{color:o.text,fontWeight:600},children:(i==null?void 0:i.name)||"No file"}),y&&t.jsxs("span",{style:{color:o.textMuted,fontSize:10},children:["(",y,")"]})]}),t.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontSize:12,color:o.textSecondary,cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:g,onChange:e=>v(e.target.checked)}),"Side by Side"]}),t.jsx("button",{onClick:S,style:{padding:"4px 12px",fontSize:12,backgroundColor:o.bg,color:o.text,border:`1px solid ${o.border}`,borderRadius:4,cursor:"pointer"},children:"Close"})]}),t.jsx("div",{style:{flex:1,overflow:"hidden"},children:t.jsx(G,{original:R,modified:F,language:W,theme:o.editorMonacoTheme,options:{readOnly:!0,renderSideBySide:g,fontSize:l.fontSize,fontFamily:l.fontFamily,minimap:{enabled:!1},scrollBeyondLastLine:!1,renderOverviewRuler:!0,diffWordWrap:l.wordWrap?"on":"off"}})})]})})}export{O as DiffViewerViewPresenter};
