import{u as g,r as s,j as a}from"./index-CfgOFZwh.js";import"./react-vendor-P8ZuH1e3.js";import"./monaco-editor-BYMRfcD5.js";function U({theme:r}){const{tabs:v,setShowTerminalPanel:k,terminalHeight:m,setTerminalHeight:L}=g(),[S,h]=s.useState([{type:"info",text:'Notemac++ Terminal v1.0 — Type "help" for available commands.'}]),[f,l]=s.useState(""),[u,C]=s.useState([]),[c,d]=s.useState(-1),[$,D]=s.useState(!1),x=s.useRef(null),w=s.useRef(null),j=s.useRef(0),T=s.useRef(0);s.useEffect(()=>{x.current&&(x.current.scrollTop=x.current.scrollHeight)},[S]),s.useEffect(()=>{var e;(e=w.current)==null||e.focus()},[]);const E=s.useCallback(e=>{const n=e.trim();if(n.length===0)return;const t=[{type:"input",text:`$ ${n}`}],y=n.split(/\s+/),I=y[0].toLowerCase(),A=y.slice(1);switch(I){case"help":t.push({type:"output",text:"Available commands:"}),t.push({type:"output",text:"  help          Show this help message"}),t.push({type:"output",text:"  clear         Clear terminal output"}),t.push({type:"output",text:"  echo <text>   Print text to terminal"}),t.push({type:"output",text:"  date          Show current date and time"}),t.push({type:"output",text:"  pwd           Show current workspace path"}),t.push({type:"output",text:"  ls            List open files/tabs"}),t.push({type:"output",text:"  wc            Word count for active file"}),t.push({type:"output",text:"  env           Show environment info"}),t.push({type:"output",text:"  whoami        Show current user context"}),t.push({type:"output",text:"  history       Show command history"}),t.push({type:"output",text:"  exit          Close terminal"});break;case"clear":h([]),l(""),C(o=>[...o,n].slice(-100)),d(-1);return;case"echo":t.push({type:"output",text:A.join(" ")});break;case"date":t.push({type:"output",text:new Date().toString()});break;case"pwd":{const{workspacePath:o}=g.getState();t.push({type:"output",text:o||"/notemac++"});break}case"ls":{const o=g.getState().tabs;if(o.length===0)t.push({type:"output",text:"(no open files)"});else for(const i of o){const p=i.isModified?" *":"",b=i.isPinned?" [pinned]":"";t.push({type:"output",text:`  ${i.name}${p}${b}  (${i.language})`})}break}case"wc":{const o=g.getState(),i=o.tabs.find(p=>p.id===o.activeTabId);if(i){const p=i.content,b=p.split(`
`).length,H=p.split(/\s+/).filter(N=>0<N.length).length,z=p.length;t.push({type:"output",text:`  ${b} lines, ${H} words, ${z} characters`}),t.push({type:"output",text:`  File: ${i.name}`})}else t.push({type:"error",text:"No active file"});break}case"env":t.push({type:"output",text:`  Platform: ${navigator.platform}`}),t.push({type:"output",text:`  Electron: ${window.electronAPI?"yes":"no (web mode)"}`}),t.push({type:"output",text:`  Tabs open: ${v.length}`}),t.push({type:"output",text:`  User Agent: ${navigator.userAgent.substring(0,80)}...`});break;case"whoami":t.push({type:"output",text:"notemac-user"});break;case"history":if(u.length===0)t.push({type:"output",text:"(no history)"});else for(let o=0,i=u.length;o<i;o++)t.push({type:"output",text:`  ${o+1}  ${u[o]}`});break;case"exit":k(!1);return;default:t.push({type:"error",text:`Command not found: ${I}. Type "help" for available commands.`});break}h(o=>[...o,...t]),C(o=>[...o,n].slice(-100)),d(-1),l("")},[v,u]),M=s.useCallback(e=>{if(e.key==="Enter")e.preventDefault(),E(f);else if(e.key==="ArrowUp"){if(e.preventDefault(),0<u.length){const n=c===-1?u.length-1:Math.max(0,c-1);d(n),l(u[n])}}else if(e.key==="ArrowDown"){if(e.preventDefault(),c!==-1){const n=c+1;n>=u.length?(d(-1),l("")):(d(n),l(u[n]))}}else e.key==="c"&&e.ctrlKey?(e.preventDefault(),h(n=>[...n,{type:"input",text:`$ ${f}^C`}]),l("")):e.key==="l"&&e.ctrlKey&&(e.preventDefault(),h([]))},[f,u,c,E]),P=s.useCallback(e=>{e.preventDefault(),D(!0),j.current=e.clientY,T.current=m},[m]);s.useEffect(()=>{if(!$)return;const e=t=>{const y=j.current-t.clientY;L(T.current+y)},n=()=>{D(!1)};return window.addEventListener("mousemove",e),window.addEventListener("mouseup",n),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",n)}},[$]);const R=e=>{switch(e){case"input":return r.accent;case"error":return"#ff6b6b";case"info":return r.textSecondary;default:return r.text}};return a.jsxs("div",{style:{flexShrink:0,display:"flex",flexDirection:"column"},children:[a.jsx("div",{onMouseDown:P,style:{height:4,backgroundColor:r.border,cursor:"ns-resize",flexShrink:0}}),a.jsxs("div",{style:{height:m,backgroundColor:r.bg,display:"flex",flexDirection:"column",fontFamily:"'SF Mono', 'Menlo', 'Monaco', 'Courier New', monospace",fontSize:12},onClick:()=>{var e;return(e=w.current)==null?void 0:e.focus()},children:[a.jsxs("div",{style:{padding:"4px 12px",backgroundColor:r.bgSecondary,borderBottom:`1px solid ${r.border}`,display:"flex",justifyContent:"space-between",alignItems:"center",flexShrink:0},children:[a.jsx("span",{style:{fontSize:11,color:r.textSecondary,fontWeight:600},children:"TERMINAL"}),a.jsx("button",{onClick:()=>k(!1),style:{background:"none",border:"none",color:r.textSecondary,cursor:"pointer",fontSize:14,padding:"0 4px"},children:"×"})]}),a.jsx("div",{ref:x,style:{flex:1,overflowY:"auto",padding:"8px 12px"},children:S.map((e,n)=>a.jsx("div",{style:{color:R(e.type),lineHeight:1.6,whiteSpace:"pre-wrap",wordBreak:"break-all"},children:e.text},n))}),a.jsxs("div",{style:{padding:"6px 12px",borderTop:`1px solid ${r.border}`,display:"flex",alignItems:"center",gap:6,flexShrink:0},children:[a.jsx("span",{style:{color:r.accent,fontWeight:600},children:"$"}),a.jsx("input",{ref:w,type:"text",value:f,onChange:e=>l(e.target.value),onKeyDown:M,style:{flex:1,backgroundColor:"transparent",border:"none",outline:"none",color:r.text,fontFamily:"inherit",fontSize:"inherit"},spellCheck:!1})]})]})]})}export{U as TerminalPanelViewPresenter};
