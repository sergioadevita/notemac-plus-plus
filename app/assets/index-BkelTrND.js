const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./GitPanelViewPresenter-CRyTZJqF.js","./react-vendor-P8ZuH1e3.js","./monaco-editor-BYMRfcD5.js","./monaco-editor-C3yYqDe4.css","./AIChatPanelViewPresenter-D6xIYR09.js","./SettingsDialogViewPresenter-Bgi08qAW.js","./GoToLineDialogViewPresenter-DK0S00Ob.js","./AboutDialogViewPresenter-DQnO7Cpz.js","./RunCommandDialogViewPresenter-TLreVKQf.js","./ColumnEditorDialogViewPresenter-pMSLjWlv.js","./SummaryDialogViewPresenter-DM1qmkCY.js","./CharInRangeDialogViewPresenter-CHc4tc67.js","./ShortcutMapperDialogViewPresenter-Tda-K9uL.js","./ShortcutConfig-CNB-8NLK.js","./CommandPaletteViewPresenter-BXq7FT3D.js","./FuzzySearchHelpers-xz3AmAn2.js","./QuickOpenViewPresenter-Avre4FEf.js","./DiffViewerViewPresenter-C5dtgy5a.js","./SnippetManagerViewPresenter-CJxcUO3B.js","./TerminalPanelViewPresenter-VzX45gUQ.js","./CloneRepositoryViewPresenter-CNz6IQ0m.js","./GitSettingsViewPresenter-hXAslM7L.js","./AISettingsViewPresenter-CUp2ClSD.js"])))=>i.map(i=>d[i]);
var Hp=Object.defineProperty;var qp=(e,r,n)=>r in e?Hp(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n;var $l=(e,r,n)=>qp(e,typeof r!="symbol"?r+"":r,n);import{r as Fi,g as Xn,a as Wp,c as Ci,b as Vp}from"./react-vendor-P8ZuH1e3.js";import{_ as Ot}from"./monaco-editor-BYMRfcD5.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const g of u.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&s(g)}).observe(document,{childList:!0,subtree:!0});function n(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function s(c){if(c.ep)return;c.ep=!0;const u=n(c);fetch(c.href,u)}})();var ga={exports:{}},Ln={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nl;function Zp(){if(Nl)return Ln;Nl=1;var e=Fi(),r=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,c=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function g(d,h,S){var _,x={},R=null,y=null;S!==void 0&&(R=""+S),h.key!==void 0&&(R=""+h.key),h.ref!==void 0&&(y=h.ref);for(_ in h)s.call(h,_)&&!u.hasOwnProperty(_)&&(x[_]=h[_]);if(d&&d.defaultProps)for(_ in h=d.defaultProps,h)x[_]===void 0&&(x[_]=h[_]);return{$$typeof:r,type:d,key:R,ref:y,props:x,_owner:c.current}}return Ln.Fragment=n,Ln.jsx=g,Ln.jsxs=g,Ln}var Ul;function Kp(){return Ul||(Ul=1,ga.exports=Zp()),ga.exports}var E=Kp(),ye=Fi();const kt=Xn(ye);var gi={},zl;function Xp(){if(zl)return gi;zl=1;var e=Wp();return gi.createRoot=e.createRoot,gi.hydrateRoot=e.hydrateRoot,gi}var Yp=Xp();const Jp=Xn(Yp),Qp={},Gl=e=>{let r;const n=new Set,s=(_,x)=>{const R=typeof _=="function"?_(r):_;if(!Object.is(R,r)){const y=r;r=x??(typeof R!="object"||R===null)?R:Object.assign({},r,R),n.forEach(j=>j(r,y))}},c=()=>r,h={setState:s,getState:c,getInitialState:()=>S,subscribe:_=>(n.add(_),()=>n.delete(_)),destroy:()=>{n.clear()}},S=r=e(s,c,h);return h},eg=e=>e?Gl(e):Gl;var ma={exports:{}},wa={},ya={exports:{}},ba={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hl;function tg(){if(Hl)return ba;Hl=1;var e=Fi();function r(x,R){return x===R&&(x!==0||1/x===1/R)||x!==x&&R!==R}var n=typeof Object.is=="function"?Object.is:r,s=e.useState,c=e.useEffect,u=e.useLayoutEffect,g=e.useDebugValue;function d(x,R){var y=R(),j=s({inst:{value:y,getSnapshot:R}}),X=j[0].inst,L=j[1];return u(function(){X.value=y,X.getSnapshot=R,h(X)&&L({inst:X})},[x,y,R]),c(function(){return h(X)&&L({inst:X}),x(function(){h(X)&&L({inst:X})})},[x]),g(y),y}function h(x){var R=x.getSnapshot;x=x.value;try{var y=R();return!n(x,y)}catch{return!0}}function S(x,R){return R()}var _=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?S:d;return ba.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:_,ba}var ql;function rg(){return ql||(ql=1,ya.exports=tg()),ya.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wl;function ng(){if(Wl)return wa;Wl=1;var e=Fi(),r=rg();function n(S,_){return S===_&&(S!==0||1/S===1/_)||S!==S&&_!==_}var s=typeof Object.is=="function"?Object.is:n,c=r.useSyncExternalStore,u=e.useRef,g=e.useEffect,d=e.useMemo,h=e.useDebugValue;return wa.useSyncExternalStoreWithSelector=function(S,_,x,R,y){var j=u(null);if(j.current===null){var X={hasValue:!1,value:null};j.current=X}else X=j.current;j=d(function(){function F(Z){if(!U){if(U=!0,G=Z,Z=R(Z),y!==void 0&&X.hasValue){var z=X.value;if(y(z,Z))return W=z}return W=Z}if(z=W,s(G,Z))return z;var B=R(Z);return y!==void 0&&y(z,B)?(G=Z,z):(G=Z,W=B)}var U=!1,G,W,te=x===void 0?null:x;return[function(){return F(_())},te===null?void 0:function(){return F(te())}]},[_,x,R,y]);var L=c(S,j[0],j[1]);return g(function(){X.hasValue=!0,X.value=L},[L]),h(L),L},wa}var Vl;function ig(){return Vl||(Vl=1,ma.exports=ng()),ma.exports}var ag=ig();const og=Xn(ag),_d={},{useDebugValue:sg}=kt,{useSyncExternalStoreWithSelector:cg}=og;let Zl=!1;const lg=e=>e;function ug(e,r=lg,n){(_d?"production":void 0)!=="production"&&n&&!Zl&&(Zl=!0);const s=cg(e.subscribe,e.getState,e.getServerState||e.getInitialState,r,n);return sg(s),s}const fg=e=>{const r=typeof e=="function"?eg(e):e,n=(s,c)=>ug(r,s,c);return Object.assign(n,r),n},dg=e=>fg;var Sd=Symbol.for("immer-nothing"),Kl=Symbol.for("immer-draftable"),Yt=Symbol.for("immer-state");function cr(e,...r){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Wn=Object.getPrototypeOf;function fn(e){return!!e&&!!e[Yt]}function zr(e){var r;return e?kd(e)||Array.isArray(e)||!!e[Kl]||!!((r=e.constructor)!=null&&r[Kl])||Yn(e)||Li(e):!1}var hg=Object.prototype.constructor.toString(),Xl=new WeakMap;function kd(e){if(!e||typeof e!="object")return!1;const r=Object.getPrototypeOf(e);if(r===null||r===Object.prototype)return!0;const n=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let s=Xl.get(n);return s===void 0&&(s=Function.toString.call(n),Xl.set(n,s)),s===hg}function Ti(e,r,n=!0){Di(e)===0?(n?Reflect.ownKeys(e):Object.keys(e)).forEach(c=>{r(c,e[c],e)}):e.forEach((s,c)=>r(c,s,e))}function Di(e){const r=e[Yt];return r?r.type_:Array.isArray(e)?1:Yn(e)?2:Li(e)?3:0}function ps(e,r){return Di(e)===2?e.has(r):Object.prototype.hasOwnProperty.call(e,r)}function Ed(e,r,n){const s=Di(e);s===2?e.set(r,n):s===3?e.add(n):e[r]=n}function pg(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}function Yn(e){return e instanceof Map}function Li(e){return e instanceof Set}function Nr(e){return e.copy_||e.base_}function gs(e,r){if(Yn(e))return new Map(e);if(Li(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=kd(e);if(r===!0||r==="class_only"&&!n){const s=Object.getOwnPropertyDescriptors(e);delete s[Yt];let c=Reflect.ownKeys(s);for(let u=0;u<c.length;u++){const g=c[u],d=s[g];d.writable===!1&&(d.writable=!0,d.configurable=!0),(d.get||d.set)&&(s[g]={configurable:!0,writable:!0,enumerable:d.enumerable,value:e[g]})}return Object.create(Wn(e),s)}else{const s=Wn(e);if(s!==null&&n)return{...e};const c=Object.create(s);return Object.assign(c,e)}}function vs(e,r=!1){return $i(e)||fn(e)||!zr(e)||(Di(e)>1&&Object.defineProperties(e,{set:mi,add:mi,clear:mi,delete:mi}),Object.freeze(e),r&&Object.values(e).forEach(n=>vs(n,!0))),e}function gg(){cr(2)}var mi={value:gg};function $i(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var mg={};function Gr(e){const r=mg[e];return r||cr(0,e),r}var Vn;function Ad(){return Vn}function wg(e,r){return{drafts_:[],parent_:e,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Yl(e,r){r&&(Gr("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function ms(e){ws(e),e.drafts_.forEach(yg),e.drafts_=null}function ws(e){e===Vn&&(Vn=e.parent_)}function Jl(e){return Vn=wg(Vn,e)}function yg(e){const r=e[Yt];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function Ql(e,r){r.unfinalizedDrafts_=r.drafts_.length;const n=r.drafts_[0];return e!==void 0&&e!==n?(n[Yt].modified_&&(ms(r),cr(4)),zr(e)&&(e=Ri(r,e),r.parent_||Oi(r,e)),r.patches_&&Gr("Patches").generateReplacementPatches_(n[Yt].base_,e,r.patches_,r.inversePatches_)):e=Ri(r,n,[]),ms(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==Sd?e:void 0}function Ri(e,r,n){if($i(r))return r;const s=e.immer_.shouldUseStrictIteration(),c=r[Yt];if(!c)return Ti(r,(u,g)=>eu(e,c,r,u,g,n),s),r;if(c.scope_!==e)return r;if(!c.modified_)return Oi(e,c.base_,!0),c.base_;if(!c.finalized_){c.finalized_=!0,c.scope_.unfinalizedDrafts_--;const u=c.copy_;let g=u,d=!1;c.type_===3&&(g=new Set(u),u.clear(),d=!0),Ti(g,(h,S)=>eu(e,c,u,h,S,n,d),s),Oi(e,u,!1),n&&e.patches_&&Gr("Patches").generatePatches_(c,n,e.patches_,e.inversePatches_)}return c.copy_}function eu(e,r,n,s,c,u,g){if(c==null||typeof c!="object"&&!g)return;const d=$i(c);if(!(d&&!g)){if(fn(c)){const h=u&&r&&r.type_!==3&&!ps(r.assigned_,s)?u.concat(s):void 0,S=Ri(e,c,h);if(Ed(n,s,S),fn(S))e.canAutoFreeze_=!1;else return}else g&&n.add(c);if(zr(c)&&!d){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||r&&r.base_&&r.base_[s]===c&&d)return;Ri(e,c),(!r||!r.scope_.parent_)&&typeof s!="symbol"&&(Yn(n)?n.has(s):Object.prototype.propertyIsEnumerable.call(n,s))&&Oi(e,c)}}}function Oi(e,r,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&vs(r,n)}function bg(e,r){const n=Array.isArray(e),s={type_:n?1:0,scope_:r?r.scope_:Ad(),modified_:!1,finalized_:!1,assigned_:{},parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let c=s,u=xs;n&&(c=[s],u=Zn);const{revoke:g,proxy:d}=Proxy.revocable(c,u);return s.draft_=d,s.revoke_=g,d}var xs={get(e,r){if(r===Yt)return e;const n=Nr(e);if(!ps(n,r))return vg(e,n,r);const s=n[r];return e.finalized_||!zr(s)?s:s===va(e.base_,r)?(xa(e),e.copy_[r]=bs(s,e)):s},has(e,r){return r in Nr(e)},ownKeys(e){return Reflect.ownKeys(Nr(e))},set(e,r,n){const s=Id(Nr(e),r);if(s!=null&&s.set)return s.set.call(e.draft_,n),!0;if(!e.modified_){const c=va(Nr(e),r),u=c==null?void 0:c[Yt];if(u&&u.base_===n)return e.copy_[r]=n,e.assigned_[r]=!1,!0;if(pg(n,c)&&(n!==void 0||ps(e.base_,r)))return!0;xa(e),ys(e)}return e.copy_[r]===n&&(n!==void 0||r in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[r])||(e.copy_[r]=n,e.assigned_[r]=!0),!0},deleteProperty(e,r){return va(e.base_,r)!==void 0||r in e.base_?(e.assigned_[r]=!1,xa(e),ys(e)):delete e.assigned_[r],e.copy_&&delete e.copy_[r],!0},getOwnPropertyDescriptor(e,r){const n=Nr(e),s=Reflect.getOwnPropertyDescriptor(n,r);return s&&{writable:!0,configurable:e.type_!==1||r!=="length",enumerable:s.enumerable,value:n[r]}},defineProperty(){cr(11)},getPrototypeOf(e){return Wn(e.base_)},setPrototypeOf(){cr(12)}},Zn={};Ti(xs,(e,r)=>{Zn[e]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}});Zn.deleteProperty=function(e,r){return Zn.set.call(this,e,r,void 0)};Zn.set=function(e,r,n){return xs.set.call(this,e[0],r,n,e[0])};function va(e,r){const n=e[Yt];return(n?Nr(n):e)[r]}function vg(e,r,n){var c;const s=Id(r,n);return s?"value"in s?s.value:(c=s.get)==null?void 0:c.call(e.draft_):void 0}function Id(e,r){if(!(r in e))return;let n=Wn(e);for(;n;){const s=Object.getOwnPropertyDescriptor(n,r);if(s)return s;n=Wn(n)}}function ys(e){e.modified_||(e.modified_=!0,e.parent_&&ys(e.parent_))}function xa(e){e.copy_||(e.copy_=gs(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var xg=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(r,n,s)=>{if(typeof r=="function"&&typeof n!="function"){const u=n;n=r;const g=this;return function(h=u,...S){return g.produce(h,_=>n.call(this,_,...S))}}typeof n!="function"&&cr(6),s!==void 0&&typeof s!="function"&&cr(7);let c;if(zr(r)){const u=Jl(this),g=bs(r,void 0);let d=!0;try{c=n(g),d=!1}finally{d?ms(u):ws(u)}return Yl(u,s),Ql(c,u)}else if(!r||typeof r!="object"){if(c=n(r),c===void 0&&(c=r),c===Sd&&(c=void 0),this.autoFreeze_&&vs(c,!0),s){const u=[],g=[];Gr("Patches").generateReplacementPatches_(r,c,u,g),s(u,g)}return c}else cr(1,r)},this.produceWithPatches=(r,n)=>{if(typeof r=="function")return(g,...d)=>this.produceWithPatches(g,h=>r(h,...d));let s,c;return[this.produce(r,n,(g,d)=>{s=g,c=d}),s,c]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){zr(e)||cr(8),fn(e)&&(e=_g(e));const r=Jl(this),n=bs(e,void 0);return n[Yt].isManual_=!0,ws(r),n}finishDraft(e,r){const n=e&&e[Yt];(!n||!n.isManual_)&&cr(9);const{scope_:s}=n;return Yl(s,r),Ql(void 0,s)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,r){let n;for(n=r.length-1;n>=0;n--){const c=r[n];if(c.path.length===0&&c.op==="replace"){e=c.value;break}}n>-1&&(r=r.slice(n+1));const s=Gr("Patches").applyPatches_;return fn(e)?s(e,r):this.produce(e,c=>s(c,r))}};function bs(e,r){const n=Yn(e)?Gr("MapSet").proxyMap_(e,r):Li(e)?Gr("MapSet").proxySet_(e,r):bg(e,r);return(r?r.scope_:Ad()).drafts_.push(n),n}function _g(e){return fn(e)||cr(10,e),Cd(e)}function Cd(e){if(!zr(e)||$i(e))return e;const r=e[Yt];let n,s=!0;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,n=gs(e,r.scope_.immer_.useStrictShallowCopy_),s=r.scope_.immer_.shouldUseStrictIteration()}else n=gs(e,!0);return Ti(n,(c,u)=>{Ed(n,c,Cd(u))},s),r&&(r.finalized_=!1),n}var Sg=new xg,nt=Sg.produce;const kg={".js":"javascript",".jsx":"javascript",".ts":"typescript",".tsx":"typescript",".py":"python",".rb":"ruby",".go":"go",".rs":"rust",".c":"c",".h":"c",".cpp":"cpp",".cc":"cpp",".cxx":"cpp",".hpp":"cpp",".cs":"csharp",".java":"java",".swift":"swift",".kt":"kotlin",".php":"php",".html":"html",".htm":"html",".css":"css",".scss":"scss",".less":"less",".json":"json",".xml":"xml",".yaml":"yaml",".yml":"yaml",".md":"markdown",".sql":"sql",".sh":"shell",".bash":"shell",".zsh":"shell",".ps1":"powershell",".r":"r",".lua":"lua",".pl":"perl",".pm":"perl",".dart":"dart",".ex":"elixir",".exs":"elixir",".erl":"erlang",".hs":"haskell",".scala":"scala",".clj":"clojure",".coffee":"coffeescript",".bat":"bat",".cmd":"bat",".ini":"ini",".toml":"ini",".dockerfile":"dockerfile",".graphql":"graphql",".gql":"graphql",".vue":"html",".svelte":"html",".log":"plaintext",".txt":"plaintext",".env":"plaintext",".gitignore":"plaintext",".makefile":"plaintext"};function hr(e){if(!e)return"plaintext";const r=e.toLowerCase();if(r==="dockerfile")return"dockerfile";if(r==="makefile")return"makefile";if(r==="cmakelists.txt")return"cmake";const n=r.lastIndexOf(".");if(n===-1)return"plaintext";const s=r.substring(n);return kg[s]||"plaintext"}function Er(e){const r=(e.match(/\r\n/g)||[]).length,n=(e.match(new RegExp("(?<!\\r)\\n","g"))||[]).length,s=(e.match(/\r(?!\n)/g)||[]).length;return r>=n&&r>=s?"CRLF":s>n?"CR":"LF"}function Ar(){return Math.random().toString(36).substring(2,11)+Date.now().toString(36)}const wi="SavedSnippets",Eg={1:"#ff4444",2:"#44ff44",3:"#4488ff",4:"#ff44ff",5:"#ffaa00"},tu={none:"transparent",color1:"#ff4444",color2:"#44bb44",color3:"#4488ff",color4:"#ff8800",color5:"#cc44cc"},Ag=14,Ig=4,Cg="'SF Mono', 'Menlo', 'Monaco', 'Courier New', monospace",Tg=5e3,Rg="https://www.google.com/search?q=",Og="yyyy-MM-dd HH:mm:ss",Pg=20,Mg=20,jg=50,Bg=-5,Fg=10,Dg=200,Lg=100,$g=600,yi="GitCredentials",_a="GitAuthor",Sa="GitSettings",bi="BrowserWorkspaces",Ng=50,Td="https://cors.isomorphic-git.org",Ug="Notemac++ User",zg="user@notemac.app",ru="AIProviders",or="AICredentials",ka="AISettings",nu="AIConversations",Rd=500,Gg=8e3,Hg=.3,qg=.7,iu=50,Wg=256,vi=2e3,Vg=256,Zg=.3,Kg=72,Xg="2023-06-01",xi=24,rv=8,nv="Iv1.CONFIGURE_YOUR_APP",Yg=150,Jg=500,Ea=36,Qg=100,em=200,au=18,tm=32,rm=300,iv=560,av=420,ov=80,nm=4,im=9998,am=9999,Od=1e4,sv=2e3,cv=5,lv=60,uv=3600,fv=86400,dv=604800,om=(e,r)=>({tabs:[],activeTabId:null,closedTabs:[],recentFiles:[],addTab:n=>{const s=Ar(),c={id:s,name:(n==null?void 0:n.name)||`new ${r().tabs.length+1}`,path:(n==null?void 0:n.path)||null,content:(n==null?void 0:n.content)||"",originalContent:(n==null?void 0:n.content)||"",language:(n==null?void 0:n.language)||hr((n==null?void 0:n.name)||""),encoding:(n==null?void 0:n.encoding)||"utf-8",lineEnding:(n==null?void 0:n.lineEnding)||"LF",isModified:!1,isReadOnly:(n==null?void 0:n.isReadOnly)||!1,isPinned:!1,tabColor:"none",cursorLine:1,cursorColumn:1,scrollTop:0,bookmarks:[],marks:[],hiddenLines:[],isMonitoring:!1};return e(nt(u=>{u.tabs.push(c),u.activeTabId=s})),s},closeTab:n=>{e(nt(s=>{const c=s.tabs.findIndex(u=>u.id===n);if(c!==-1&&(s.closedTabs.push({...s.tabs[c]}),s.closedTabs.length>Pg&&s.closedTabs.shift(),s.tabs.splice(c,1),s.activeTabId===n))if(0<s.tabs.length){const u=Math.min(c,s.tabs.length-1);s.activeTabId=s.tabs[u].id}else s.activeTabId=null}))},closeAllTabs:()=>{const n=r().tabs;e(nt(s=>{s.closedTabs.push(...n),s.tabs=[],s.activeTabId=null}))},closeOtherTabs:n=>{e(nt(s=>{const c=s.tabs.filter(u=>u.id!==n);s.closedTabs.push(...c),s.tabs=s.tabs.filter(u=>u.id===n),s.activeTabId=n}))},closeTabsToLeft:n=>{e(nt(s=>{const c=s.tabs.findIndex(g=>g.id===n);if(0>=c)return;const u=s.tabs.splice(0,c);s.closedTabs.push(...u)}))},closeTabsToRight:n=>{e(nt(s=>{const c=s.tabs.findIndex(g=>g.id===n);if(c===-1||c>=s.tabs.length-1)return;const u=s.tabs.splice(c+1);s.closedTabs.push(...u)}))},closeUnchangedTabs:()=>{e(nt(n=>{const s=n.tabs.filter(c=>!c.isModified);n.closedTabs.push(...s),n.tabs=n.tabs.filter(c=>c.isModified),0<n.tabs.length&&!n.tabs.find(c=>c.id===n.activeTabId)?n.activeTabId=n.tabs[0].id:n.tabs.length===0&&(n.activeTabId=null)}))},closeAllButPinned:()=>{e(nt(n=>{const s=n.tabs.filter(c=>!c.isPinned);n.closedTabs.push(...s),n.tabs=n.tabs.filter(c=>c.isPinned),0<n.tabs.length&&!n.tabs.find(c=>c.id===n.activeTabId)?n.activeTabId=n.tabs[0].id:n.tabs.length===0&&(n.activeTabId=null)}))},restoreLastClosedTab:()=>{e(nt(n=>{if(n.closedTabs.length===0)return;const s=n.closedTabs.pop();s.id=Ar(),n.tabs.push(s),n.activeTabId=s.id}))},setActiveTab:n=>e({activeTabId:n}),updateTab:(n,s)=>{e(nt(c=>{const u=c.tabs.find(g=>g.id===n);u&&Object.assign(u,s)}))},updateTabContent:(n,s)=>{e(nt(c=>{const u=c.tabs.find(g=>g.id===n);u&&(u.content=s,u.isModified=s!==u.originalContent)}))},togglePinTab:n=>{e(nt(s=>{const c=s.tabs.find(u=>u.id===n);c&&(c.isPinned=!c.isPinned)}))},setTabColor:(n,s)=>{e(nt(c=>{const u=c.tabs.find(g=>g.id===n);u&&(u.tabColor=s)}))},moveTab:(n,s)=>{e(nt(c=>{const[u]=c.tabs.splice(n,1);c.tabs.splice(s,0,u)}))},nextTab:()=>{const{tabs:n,activeTabId:s}=r();if(1>=n.length)return;const u=(n.findIndex(g=>g.id===s)+1)%n.length;e({activeTabId:n[u].id})},prevTab:()=>{const{tabs:n,activeTabId:s}=r();if(1>=n.length)return;const u=(n.findIndex(g=>g.id===s)-1+n.length)%n.length;e({activeTabId:n[u].id})},goToTab:n=>{const{tabs:s}=r();0<=n&&n<s.length&&e({activeTabId:s[n].id})},moveTabForward:()=>{const{tabs:n,activeTabId:s}=r(),c=n.findIndex(u=>u.id===s);c<n.length-1&&e(nt(u=>{const[g]=u.tabs.splice(c,1);u.tabs.splice(c+1,0,g)}))},moveTabBackward:()=>{const{tabs:n,activeTabId:s}=r(),c=n.findIndex(u=>u.id===s);0<c&&e(nt(u=>{const[g]=u.tabs.splice(c,1);u.tabs.splice(c-1,0,g)}))},addRecentFile:(n,s)=>{e(nt(c=>{c.recentFiles=c.recentFiles.filter(u=>u.path!==n),c.recentFiles.unshift({path:n,name:s}),c.recentFiles.length>Mg&&c.recentFiles.pop()}))}}),sm={query:"",replaceText:"",isRegex:!1,isCaseSensitive:!1,isWholeWord:!1,searchInSelection:!1,wrapAround:!0},cm=(e,r)=>({showFindReplace:!1,findReplaceMode:"find",searchOptions:{...sm},searchResults:[],showIncrementalSearch:!1,setShowFindReplace:(n,s)=>e({showFindReplace:n,findReplaceMode:s||r().findReplaceMode}),updateSearchOptions:n=>{e(s=>({searchOptions:{...s.searchOptions,...n}}))},setShowIncrementalSearch:n=>e({showIncrementalSearch:n})}),lm=(e,r)=>({isRecordingMacro:!1,currentMacroActions:[],savedMacros:[],startRecordingMacro:()=>e({isRecordingMacro:!0,currentMacroActions:[]}),stopRecordingMacro:()=>e({isRecordingMacro:!1}),addMacroAction:n=>{r().isRecordingMacro&&e(nt(s=>{s.currentMacroActions.push(n)}))},saveMacro:n=>{const s=r().currentMacroActions;s.length!==0&&e(nt(c=>{c.savedMacros.push({id:Ar(),name:n,actions:[...s]})}))}}),um={theme:"dark",fontSize:Ag,fontFamily:Cg,tabSize:Ig,insertSpaces:!0,wordWrap:!1,showWhitespace:!1,showLineNumbers:!0,showMinimap:!0,showIndentGuides:!0,showEOL:!1,showNonPrintable:!1,showWrapSymbol:!1,autoSave:!1,autoSaveDelay:Tg,highlightCurrentLine:!0,matchBrackets:!0,autoCloseBrackets:!0,autoCloseQuotes:!0,autoIndent:!0,smoothScrolling:!0,cursorBlinking:"blink",cursorStyle:"line",renderWhitespace:"none",virtualSpace:!1,alwaysOnTop:!1,distractionFreeMode:!1,darkMode:!0,syncScrollVertical:!1,syncScrollHorizontal:!1,rememberLastSession:!0,searchEngine:Rg,dateTimeFormat:Og};function fm(){return{...um}}const dm=(e,r)=>({sidebarPanel:null,sidebarWidth:260,showStatusBar:!0,showToolbar:!0,splitView:"none",splitTabId:null,zoomLevel:0,foldAllState:!1,clipboardHistory:[],settings:fm(),showSettings:!1,showGoToLine:!1,showAbout:!1,showRunCommand:!1,showColumnEditor:!1,showSummary:!1,showCharInRange:!1,showShortcutMapper:!1,showCommandPalette:!1,showQuickOpen:!1,showDiffViewer:!1,showSnippetManager:!1,showTerminalPanel:!1,terminalHeight:Dg,showCloneDialog:!1,showGitSettings:!1,setSidebarPanel:n=>e({sidebarPanel:n}),toggleSidebar:()=>{const n=r().sidebarPanel;e({sidebarPanel:n?null:"explorer"})},setZoomLevel:n=>e({zoomLevel:Math.max(Bg,Math.min(Fg,n))}),setSplitView:(n,s)=>e({splitView:n,splitTabId:s||null}),addClipboardEntry:n=>{e(nt(s=>{s.clipboardHistory.unshift({text:n,timestamp:Date.now()}),s.clipboardHistory.length>jg&&s.clipboardHistory.pop()}))},updateSettings:n=>{e(nt(s=>{Object.assign(s.settings,n)}))},setShowSettings:n=>e({showSettings:n}),setShowGoToLine:n=>e({showGoToLine:n}),setShowAbout:n=>e({showAbout:n}),setShowRunCommand:n=>e({showRunCommand:n}),setShowColumnEditor:n=>e({showColumnEditor:n}),setShowSummary:n=>e({showSummary:n}),setShowCharInRange:n=>e({showCharInRange:n}),setShowShortcutMapper:n=>e({showShortcutMapper:n}),setShowCommandPalette:n=>e({showCommandPalette:n}),setShowQuickOpen:n=>e({showQuickOpen:n}),setShowDiffViewer:n=>e({showDiffViewer:n}),setShowSnippetManager:n=>e({showSnippetManager:n}),setShowTerminalPanel:n=>e({showTerminalPanel:n}),setShowCloneDialog:n=>e({showCloneDialog:n}),setShowGitSettings:n=>e({showGitSettings:n}),setTerminalHeight:n=>e({terminalHeight:Math.max(Lg,Math.min($g,n))}),saveSession:()=>{const n=r();return{tabs:n.tabs.map(s=>({path:s.path,name:s.name,language:s.language,cursorLine:s.cursorLine,cursorColumn:s.cursorColumn,scrollTop:s.scrollTop,content:s.path?void 0:s.content})),activeTabIndex:n.tabs.findIndex(s=>s.id===n.activeTabId),sidebarPanel:n.sidebarPanel}},loadSession:n=>{var c,u;const s=n.tabs.map(g=>({id:Ar(),name:g.name,path:g.path,content:g.content||"",originalContent:g.content||"",language:g.language,encoding:"utf-8",lineEnding:"LF",isModified:!1,isReadOnly:!1,isPinned:!1,tabColor:"none",cursorLine:g.cursorLine,cursorColumn:g.cursorColumn,scrollTop:g.scrollTop,bookmarks:[],marks:[],hiddenLines:[],isMonitoring:!1}));e({tabs:s,activeTabId:((c=s[n.activeTabIndex])==null?void 0:c.id)||((u=s[0])==null?void 0:u.id)||null,sidebarPanel:n.sidebarPanel})}}),hm=e=>({fileTree:[],workspacePath:null,setFileTree:r=>e({fileTree:r}),setWorkspacePath:r=>e({workspacePath:r}),toggleTreeNode:r=>{e(nt(n=>{const s=c=>{for(const u of c){if(u.path===r)return u.isExpanded=!u.isExpanded,!0;if(u.children&&s(u.children))return!0}return!1};s(n.fileTree)}))}});function wr(e,r){try{const n=localStorage.getItem(e);return n===null?r??null:JSON.parse(n)}catch{return null}}function Ft(e,r){try{localStorage.setItem(e,JSON.stringify(r))}catch{}}function pm(e){try{localStorage.removeItem(e)}catch{}}const gm=(e,r)=>({savedSnippets:[],addSnippet:n=>{e(nt(s=>{const c={...n,id:Ar()};s.savedSnippets.push(c)})),Ft(wi,r().savedSnippets)},removeSnippet:n=>{e(nt(s=>{const c=s.savedSnippets.findIndex(u=>u.id===n);c!==-1&&s.savedSnippets.splice(c,1)})),Ft(wi,r().savedSnippets)},updateSnippet:(n,s)=>{e(nt(c=>{const u=c.savedSnippets.find(g=>g.id===n);u&&Object.assign(u,s)})),Ft(wi,r().savedSnippets)},loadSnippets:()=>{const n=wr(wi);n&&e({savedSnippets:n})}});function ou(){return{autoFetch:!0,autoFetchInterval:3e5,showUntracked:!0,showIgnored:!1,corsProxy:Td}}function su(){return{name:Ug,email:zg}}const mm=(e,r)=>({isRepoInitialized:!1,currentBranch:"main",branches:[],remotes:[],gitStatus:null,commitLog:[],gitCredentials:null,gitAuthor:su(),gitSettings:ou(),isBrowserWorkspace:!1,browserWorkspaces:[],isGitOperationInProgress:!1,currentGitOperation:null,gitOperationProgress:0,gitOperationError:null,SetRepoInitialized:n=>e({isRepoInitialized:n}),SetCurrentBranch:n=>e({currentBranch:n}),SetBranches:n=>e({branches:n}),SetRemotes:n=>e({remotes:n}),SetGitStatus:n=>e({gitStatus:n}),SetCommitLog:n=>e({commitLog:n}),SetGitCredentials:n=>{e({gitCredentials:n}),n!==null?Ft(yi,{type:n.type,username:n.username}):Ft(yi,null)},SetGitAuthor:n=>{e({gitAuthor:n}),Ft(_a,n)},UpdateGitSettings:n=>{e(nt(c=>{Object.assign(c.gitSettings,n)}));const s=r().gitSettings;Ft(Sa,s)},SetIsBrowserWorkspace:n=>e({isBrowserWorkspace:n}),AddBrowserWorkspace:n=>{e(nt(s=>{const c=s.browserWorkspaces.findIndex(u=>u.id===n.id);c!==-1?s.browserWorkspaces[c]=n:s.browserWorkspaces.push(n)})),Ft(bi,r().browserWorkspaces)},RemoveBrowserWorkspace:n=>{e(nt(s=>{const c=s.browserWorkspaces.findIndex(u=>u.id===n);c!==-1&&s.browserWorkspaces.splice(c,1)})),Ft(bi,r().browserWorkspaces)},SetGitOperationInProgress:n=>e({isGitOperationInProgress:n}),SetCurrentGitOperation:n=>e({currentGitOperation:n}),SetGitOperationProgress:n=>e({gitOperationProgress:n}),SetGitOperationError:n=>e({gitOperationError:n}),LoadGitState:()=>{const n=wr(yi),s=wr(_a),c=wr(Sa),u=wr(bi);e({gitCredentials:n||null,gitAuthor:s||su(),gitSettings:c||ou(),browserWorkspaces:u||[]})},SaveGitState:()=>{const n=r();n.gitCredentials!==null&&Ft(yi,{type:n.gitCredentials.type,username:n.gitCredentials.username}),Ft(_a,n.gitAuthor),Ft(Sa,n.gitSettings),Ft(bi,n.browserWorkspaces)},GetStagedFileCount:()=>{var n;return((n=r().gitStatus)==null?void 0:n.stagedFiles.length)||0},GetChangedFileCount:()=>{const n=r().gitStatus;return n===null?0:n.stagedFiles.length+n.unstagedFiles.length+n.untrackedFiles.length}});function cu(){return{inlineCompletionEnabled:!0,inlineDebounceMs:Rd,inlineMaxTokens:Wg,chatTemperature:qg,codeTemperature:Hg,maxContextTokens:Gg,systemPrompt:"",showAiStatusIndicator:!0}}function lu(){return[{id:"openai",name:"OpenAI",type:"openai",baseUrl:"https://api.openai.com",isBuiltIn:!0,models:wm()},{id:"anthropic",name:"Anthropic",type:"anthropic",baseUrl:"https://api.anthropic.com",isBuiltIn:!0,models:ym()},{id:"google",name:"Google AI",type:"google",baseUrl:"https://generativelanguage.googleapis.com",isBuiltIn:!0,models:bm()}]}function wm(){return[{id:"gpt-4o",name:"GPT-4o",providerId:"openai",contextWindow:128e3,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-4o-mini",name:"GPT-4o Mini",providerId:"openai",contextWindow:128e3,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-4-turbo",name:"GPT-4 Turbo",providerId:"openai",contextWindow:128e3,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo",providerId:"openai",contextWindow:16385,supportsStreaming:!0,supportsFIM:!1},{id:"o1",name:"o1",providerId:"openai",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1},{id:"o1-mini",name:"o1-mini",providerId:"openai",contextWindow:128e3,supportsStreaming:!0,supportsFIM:!1}]}function ym(){return[{id:"claude-sonnet-4-5-20250514",name:"Claude Sonnet 4.5",providerId:"anthropic",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1},{id:"claude-sonnet-4-20250514",name:"Claude Sonnet 4",providerId:"anthropic",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1},{id:"claude-haiku-4-5-20251001",name:"Claude Haiku 4.5",providerId:"anthropic",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1},{id:"claude-opus-4-20250514",name:"Claude Opus 4",providerId:"anthropic",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1}]}function bm(){return[{id:"gemini-2.0-flash",name:"Gemini 2.0 Flash",providerId:"google",contextWindow:1048576,supportsStreaming:!0,supportsFIM:!1},{id:"gemini-2.0-flash-lite",name:"Gemini 2.0 Flash Lite",providerId:"google",contextWindow:1048576,supportsStreaming:!0,supportsFIM:!1},{id:"gemini-1.5-pro",name:"Gemini 1.5 Pro",providerId:"google",contextWindow:2097152,supportsStreaming:!0,supportsFIM:!1}]}function hv(e,r,n,s){return{id:e,name:r,type:"custom",baseUrl:n,isBuiltIn:!1,models:s}}function pv(e,r,n,s=8192){return{id:e,name:r,providerId:n,contextWindow:s,supportsStreaming:!0,supportsFIM:!1}}function Ni(){const e=window.electronAPI;return e==null||typeof e.safeStorageEncrypt!="function"?null:e}function vm(){return Ni()!==null}async function xm(){const e=Ni();if(e===null)return!1;try{return await e.isSafeStorageAvailable()}catch{return!1}}async function _m(e){const r=Ni();if(r===null)throw new Error("Electron safeStorage not available");return await r.safeStorageEncrypt(e)}async function Sm(e){const r=Ni();if(r===null)throw new Error("Electron safeStorage not available");return await r.safeStorageDecrypt(e)}const km="NotemacKeyStore",dn="keys",Pd="NotemacCryptoKey_v1",_s="AES-GCM",Em=256,Hn=12;let nn=null;function Ss(){return typeof crypto<"u"&&crypto.subtle!==null&&typeof crypto.subtle<"u"}function Md(){return new Promise((e,r)=>{const n=indexedDB.open(km,1);n.onupgradeneeded=()=>{const s=n.result;s.objectStoreNames.contains(dn)||s.createObjectStore(dn,{keyPath:"id"})},n.onsuccess=()=>e(n.result),n.onerror=()=>r(n.error)})}async function Am(){try{const e=await Md();return new Promise(r=>{const c=e.transaction(dn,"readonly").objectStore(dn).get(Pd);c.onsuccess=()=>{const u=c.result;r(u!=null?u.key:null)},c.onerror=()=>r(null)})}catch{return null}}async function Im(e){try{const r=await Md();return new Promise((n,s)=>{const c=r.transaction(dn,"readwrite");c.objectStore(dn).put({id:Pd,key:e}),c.oncomplete=()=>n(),c.onerror=()=>s(c.error)})}catch{}}async function jd(){if(nn!==null)return nn;const e=await Am();if(e!==null)return nn=e,nn;const r=await crypto.subtle.generateKey({name:_s,length:Em},!1,["encrypt","decrypt"]);return await Im(r),nn=r,nn}async function Cm(e){if(!Ss())return e;try{const r=await jd(),n=crypto.getRandomValues(new Uint8Array(Hn)),c=new TextEncoder().encode(e),u=await crypto.subtle.encrypt({name:_s,iv:n},r,c),g=new Uint8Array(Hn+u.byteLength);g.set(n,0),g.set(new Uint8Array(u),Hn);let d="";const h=g.byteLength;for(let S=0;S<h;S++)d+=String.fromCharCode(g[S]);return btoa(d)}catch{return e}}async function Tm(e){if(!Ss())return e;try{const r=await jd(),n=atob(e),s=new Uint8Array(n.length);for(let h=0,S=n.length;h<S;h++)s[h]=n.charCodeAt(h);const c=s.slice(0,Hn),u=s.slice(Hn),g=await crypto.subtle.decrypt({name:_s,iv:c},r,u);return new TextDecoder().decode(g)}catch{return e}}const Rm="SecureCred_",Pi=new Map;function Mi(e){return`${Rm}${e}`}async function Om(){return vm()&&await xm()?"safeStorage":Ss()?"cryptoSubtle":"none"}async function Pm(e,r){return r==="safeStorage"?await _m(e):r==="cryptoSubtle"?await Cm(e):e}async function Mm(e,r){return r==="safeStorage"?await Sm(e):r==="cryptoSubtle"?await Tm(e):e}function jm(e){return e.expiresAt===null?!1:Date.now()>e.expiresAt}async function $n(e,r,n){if(n===0){Pi.set(e,r);return}try{const s=await Om(),u={encrypted:await Pm(r,s),method:s,storedAt:Date.now(),expiresAt:n!=null?Date.now()+n*1e3:null};localStorage.setItem(Mi(e),JSON.stringify(u))}catch{Pi.set(e,r)}}async function Bm(e){const r=Pi.get(e);if(r!==void 0)return r;try{const n=localStorage.getItem(Mi(e));if(n===null)return null;const s=JSON.parse(n);return jm(s)?(localStorage.removeItem(Mi(e)),null):await Mm(s.encrypted,s.method)}catch{return null}}function Aa(e){Pi.delete(e);try{localStorage.removeItem(Mi(e))}catch{}}const Fm=(e,r)=>({aiEnabled:!1,activeProviderId:"openai",activeModelId:"gpt-4o-mini",providers:lu(),credentials:[],aiSettings:cu(),conversations:[],activeConversationId:null,isAiStreaming:!1,aiStreamContent:"",inlineSuggestionEnabled:!0,currentInlineSuggestion:null,aiContextItems:[],commitMessageDraft:"",showAiSettings:!1,aiOperationError:null,SetAiEnabled:n=>e({aiEnabled:n}),SetActiveProvider:n=>e({activeProviderId:n}),SetActiveModel:n=>e({activeModelId:n}),SetProviders:n=>e({providers:n}),AddProvider:n=>{e(nt(s=>{const c=s.providers.findIndex(u=>u.id===n.id);c!==-1?s.providers[c]=n:s.providers.push(n)})),r().SaveAIState()},RemoveProvider:n=>{e(nt(s=>{const c=s.providers.findIndex(u=>u.id===n);c!==-1&&!s.providers[c].isBuiltIn&&s.providers.splice(c,1)})),r().SaveAIState()},SetCredentials:n=>e({credentials:n}),SetCredentialForProvider:(n,s,c)=>{e(nt(h=>{const S=h.credentials.findIndex(x=>x.providerId===n),_={providerId:n,apiKey:s,rememberKey:c};S!==-1?h.credentials[S]=_:h.credentials.push(_)}));const u=r().credentials,g=u.filter(h=>h.rememberKey).map(h=>({providerId:h.providerId,apiKey:h.apiKey,rememberKey:!0}));0<g.length?$n(or,JSON.stringify(g),xi*3600):Aa(or);const d=u.filter(h=>!h.rememberKey);0<d.length&&$n(or+"_session",JSON.stringify(d),0)},RemoveCredentialForProvider:n=>{e(nt(u=>{const g=u.credentials.findIndex(d=>d.providerId===n);g!==-1&&u.credentials.splice(g,1)}));const c=r().credentials.filter(u=>u.rememberKey);0<c.length?$n(or,JSON.stringify(c),xi*3600):Aa(or)},UpdateAISettings:n=>{e(nt(s=>{Object.assign(s.aiSettings,n)})),Ft(ka,r().aiSettings)},SetConversations:n=>e({conversations:n}),AddConversation:n=>{e(nt(s=>{s.conversations.unshift(n),iu<s.conversations.length&&(s.conversations.length=iu)})),e({activeConversationId:n.id})},RemoveConversation:n=>{e(nt(s=>{const c=s.conversations.findIndex(u=>u.id===n);c!==-1&&s.conversations.splice(c,1),n===s.activeConversationId&&(s.activeConversationId=0<s.conversations.length?s.conversations[0].id:null)}))},SetActiveConversation:n=>e({activeConversationId:n}),AddMessageToConversation:(n,s)=>{e(nt(c=>{const u=c.conversations.find(g=>g.id===n);u&&u.messages.push(s)}))},UpdateLastMessage:(n,s)=>{e(nt(c=>{const u=c.conversations.find(g=>g.id===n);if(u&&0<u.messages.length){const g=u.messages[u.messages.length-1];g.content=s}}))},SetIsAiStreaming:n=>e({isAiStreaming:n}),SetAiStreamContent:n=>e({aiStreamContent:n}),SetInlineSuggestionEnabled:n=>e({inlineSuggestionEnabled:n}),SetCurrentInlineSuggestion:n=>e({currentInlineSuggestion:n}),AddAiContextItem:n=>{e(nt(s=>{s.aiContextItems.push(n)}))},RemoveAiContextItem:n=>{e(nt(s=>{0<=n&&n<s.aiContextItems.length&&s.aiContextItems.splice(n,1)}))},ClearAiContext:()=>e({aiContextItems:[]}),SetCommitMessageDraft:n=>e({commitMessageDraft:n}),SetShowAiSettings:n=>e({showAiSettings:n}),SetAiOperationError:n=>e({aiOperationError:n}),LoadAIState:()=>{const n=wr(ka),s=wr(ru),c=wr(nu),u=lu();let g=u;if(s!=null){const d=s.filter(h=>!h.isBuiltIn);g=[...u,...d]}e({aiSettings:n||cu(),credentials:[],providers:g,conversations:c||[],aiEnabled:!1}),Bm(or).then(d=>{let h=[];if(d!==null)try{h=JSON.parse(d)}catch{h=[]}else{const S=wr(or);if(S!==null&&0<S.length){h=S;const _=S.filter(x=>x.rememberKey);0<_.length&&$n(or,JSON.stringify(_),xi*3600),pm(or)}}e({credentials:h,aiEnabled:0<h.length})}).catch(()=>{})},SaveAIState:()=>{const n=r();Ft(ka,n.aiSettings);const s=n.providers.filter(u=>!u.isBuiltIn);0<s.length&&Ft(ru,s);const c=n.credentials.filter(u=>u.rememberKey);0<c.length?$n(or,JSON.stringify(c),xi*3600):Aa(or),Ft(nu,n.conversations)},GetActiveProvider:()=>{const n=r();return n.providers.find(s=>s.id===n.activeProviderId)||null},GetActiveModel:()=>{const n=r(),s=n.providers.find(c=>c.id===n.activeProviderId);return s==null?null:s.models.find(c=>c.id===n.activeModelId)||null},GetCredentialForProvider:n=>r().credentials.find(s=>s.providerId===n)||null,GetActiveConversation:()=>{const n=r();return n.activeConversationId===null?null:n.conversations.find(s=>s.id===n.activeConversationId)||null}}),$e=dg()((...e)=>({...om(...e),...cm(...e),...lm(...e),...dm(...e),...hm(...e),...gm(...e),...mm(...e),...Fm(...e)})),uu={dark:{bg:"#1e1e1e",bgSecondary:"#252526",bgTertiary:"#2d2d30",bgHover:"#3e3e42",bgActive:"#094771",text:"#cccccc",textSecondary:"#969696",textMuted:"#6e6e6e",border:"#3e3e42",accent:"#007acc",accentHover:"#1a8ad4",accentText:"#ffffff",danger:"#f44747",warning:"#cca700",success:"#89d185",tabBg:"#2d2d30",tabActiveBg:"#1e1e1e",tabActiveText:"#ffffff",tabBorder:"#3e3e42",menuBg:"#2d2d30",menuHover:"#094771",menuText:"#cccccc",statusBarBg:"#007acc",statusBarText:"#ffffff",sidebarBg:"#252526",sidebarText:"#cccccc",scrollbarBg:"transparent",scrollbarThumb:"#424242",editorBg:"#1e1e1e",editorMonacoTheme:"vs-dark",findBg:"#252526"},light:{bg:"#ffffff",bgSecondary:"#f3f3f3",bgTertiary:"#ececec",bgHover:"#e0e0e0",bgActive:"#cce5ff",text:"#333333",textSecondary:"#666666",textMuted:"#999999",border:"#d4d4d4",accent:"#0078d4",accentHover:"#106ebe",accentText:"#ffffff",danger:"#d32f2f",warning:"#f9a825",success:"#2e7d32",tabBg:"#ececec",tabActiveBg:"#ffffff",tabActiveText:"#333333",tabBorder:"#d4d4d4",menuBg:"#f3f3f3",menuHover:"#0078d4",menuText:"#333333",statusBarBg:"#0078d4",statusBarText:"#ffffff",sidebarBg:"#f3f3f3",sidebarText:"#333333",scrollbarBg:"transparent",scrollbarThumb:"#c4c4c4",editorBg:"#ffffff",editorMonacoTheme:"vs",findBg:"#f3f3f3"},monokai:{bg:"#272822",bgSecondary:"#1e1f1c",bgTertiary:"#3e3d32",bgHover:"#49483e",bgActive:"#49483e",text:"#f8f8f2",textSecondary:"#a6a69c",textMuted:"#75715e",border:"#3e3d32",accent:"#a6e22e",accentHover:"#b8f340",accentText:"#272822",danger:"#f92672",warning:"#e6db74",success:"#a6e22e",tabBg:"#1e1f1c",tabActiveBg:"#272822",tabActiveText:"#f8f8f2",tabBorder:"#3e3d32",menuBg:"#1e1f1c",menuHover:"#49483e",menuText:"#f8f8f2",statusBarBg:"#49483e",statusBarText:"#f8f8f2",sidebarBg:"#1e1f1c",sidebarText:"#f8f8f2",scrollbarBg:"transparent",scrollbarThumb:"#49483e",editorBg:"#272822",editorMonacoTheme:"monokai",findBg:"#1e1f1c"},dracula:{bg:"#282a36",bgSecondary:"#21222c",bgTertiary:"#343746",bgHover:"#44475a",bgActive:"#44475a",text:"#f8f8f2",textSecondary:"#bd93f9",textMuted:"#6272a4",border:"#44475a",accent:"#bd93f9",accentHover:"#caa9fa",accentText:"#282a36",danger:"#ff5555",warning:"#f1fa8c",success:"#50fa7b",tabBg:"#21222c",tabActiveBg:"#282a36",tabActiveText:"#f8f8f2",tabBorder:"#44475a",menuBg:"#21222c",menuHover:"#44475a",menuText:"#f8f8f2",statusBarBg:"#44475a",statusBarText:"#f8f8f2",sidebarBg:"#21222c",sidebarText:"#f8f8f2",scrollbarBg:"transparent",scrollbarThumb:"#44475a",editorBg:"#282a36",editorMonacoTheme:"dracula",findBg:"#21222c"},"solarized-dark":{bg:"#002b36",bgSecondary:"#073642",bgTertiary:"#073642",bgHover:"#0a4858",bgActive:"#0a4858",text:"#839496",textSecondary:"#657b83",textMuted:"#586e75",border:"#073642",accent:"#268bd2",accentHover:"#2aa7f5",accentText:"#fdf6e3",danger:"#dc322f",warning:"#b58900",success:"#859900",tabBg:"#073642",tabActiveBg:"#002b36",tabActiveText:"#93a1a1",tabBorder:"#073642",menuBg:"#073642",menuHover:"#0a4858",menuText:"#839496",statusBarBg:"#073642",statusBarText:"#839496",sidebarBg:"#073642",sidebarText:"#839496",scrollbarBg:"transparent",scrollbarThumb:"#0a4858",editorBg:"#002b36",editorMonacoTheme:"solarized-dark",findBg:"#073642"},"solarized-light":{bg:"#fdf6e3",bgSecondary:"#eee8d5",bgTertiary:"#eee8d5",bgHover:"#e4ddc8",bgActive:"#e4ddc8",text:"#657b83",textSecondary:"#839496",textMuted:"#93a1a1",border:"#eee8d5",accent:"#268bd2",accentHover:"#2aa7f5",accentText:"#fdf6e3",danger:"#dc322f",warning:"#b58900",success:"#859900",tabBg:"#eee8d5",tabActiveBg:"#fdf6e3",tabActiveText:"#586e75",tabBorder:"#eee8d5",menuBg:"#eee8d5",menuHover:"#e4ddc8",menuText:"#657b83",statusBarBg:"#eee8d5",statusBarText:"#657b83",sidebarBg:"#eee8d5",sidebarText:"#657b83",scrollbarBg:"transparent",scrollbarThumb:"#d3cbb7",editorBg:"#fdf6e3",editorMonacoTheme:"solarized-light",findBg:"#eee8d5"}};function Dm(e){return uu[e]||uu.dark}function Lm(e){e.editor.defineTheme("monokai",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"75715e",fontStyle:"italic"},{token:"keyword",foreground:"f92672"},{token:"string",foreground:"e6db74"},{token:"number",foreground:"ae81ff"},{token:"type",foreground:"66d9ef",fontStyle:"italic"},{token:"function",foreground:"a6e22e"},{token:"variable",foreground:"f8f8f2"}],colors:{"editor.background":"#272822","editor.foreground":"#f8f8f2","editor.lineHighlightBackground":"#3e3d32","editor.selectionBackground":"#49483e","editorCursor.foreground":"#f8f8f0"}}),e.editor.defineTheme("dracula",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"6272a4",fontStyle:"italic"},{token:"keyword",foreground:"ff79c6"},{token:"string",foreground:"f1fa8c"},{token:"number",foreground:"bd93f9"},{token:"type",foreground:"8be9fd",fontStyle:"italic"},{token:"function",foreground:"50fa7b"},{token:"variable",foreground:"f8f8f2"}],colors:{"editor.background":"#282a36","editor.foreground":"#f8f8f2","editor.lineHighlightBackground":"#44475a","editor.selectionBackground":"#44475a","editorCursor.foreground":"#f8f8f2"}}),e.editor.defineTheme("solarized-dark",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"586e75",fontStyle:"italic"},{token:"keyword",foreground:"859900"},{token:"string",foreground:"2aa198"},{token:"number",foreground:"d33682"},{token:"type",foreground:"b58900"},{token:"function",foreground:"268bd2"}],colors:{"editor.background":"#002b36","editor.foreground":"#839496","editor.lineHighlightBackground":"#073642","editor.selectionBackground":"#073642"}}),e.editor.defineTheme("solarized-light",{base:"vs",inherit:!0,rules:[{token:"comment",foreground:"93a1a1",fontStyle:"italic"},{token:"keyword",foreground:"859900"},{token:"string",foreground:"2aa198"},{token:"number",foreground:"d33682"},{token:"type",foreground:"b58900"},{token:"function",foreground:"268bd2"}],colors:{"editor.background":"#fdf6e3","editor.foreground":"#657b83","editor.lineHighlightBackground":"#eee8d5","editor.selectionBackground":"#eee8d5"}})}function $m(e,r,n){const s=e.metaKey||e.ctrlKey,c=$e.getState();s&&e.key==="n"?(e.preventDefault(),c.addTab()):s&&e.key==="w"?(e.preventDefault(),r!==null&&c.closeTab(r)):s&&e.shiftKey&&e.key==="T"?(e.preventDefault(),c.restoreLastClosedTab()):s&&e.key==="f"?(e.preventDefault(),c.setShowFindReplace(!0,"find")):s&&e.key==="h"?(e.preventDefault(),c.setShowFindReplace(!0,"replace")):s&&e.key==="g"?(e.preventDefault(),c.setShowGoToLine(!0)):s&&e.key==="b"?(e.preventDefault(),c.toggleSidebar()):s&&e.key===","?(e.preventDefault(),c.setShowSettings(!0)):s&&e.key==="="?(e.preventDefault(),c.setZoomLevel(n+1)):s&&e.key==="-"?(e.preventDefault(),c.setZoomLevel(n-1)):s&&e.key==="0"?(e.preventDefault(),c.setZoomLevel(0)):s&&e.shiftKey&&e.key==="P"?(e.preventDefault(),c.setShowCommandPalette(!0)):s&&e.shiftKey&&e.key==="F"?(e.preventDefault(),c.setShowFindReplace(!0,"findInFiles")):s&&e.key==="p"?(e.preventDefault(),c.setShowQuickOpen(!0)):e.ctrlKey&&e.key==="`"?(e.preventDefault(),c.setShowTerminalPanel(!c.showTerminalPanel)):e.ctrlKey&&e.shiftKey&&e.key==="G"?(e.preventDefault(),c.setSidebarPanel(c.sidebarPanel==="git"?null:"git")):e.key==="Escape"&&(c.setShowFindReplace(!1),c.setShowSettings(!1),c.setShowGoToLine(!1),c.setShowAbout(!1),c.setShowRunCommand(!1),c.setShowColumnEditor(!1),c.setShowSummary(!1),c.setShowCharInRange(!1),c.setShowShortcutMapper(!1),c.setShowCommandPalette(!1),c.setShowQuickOpen(!1),c.setShowDiffViewer(!1),c.setShowSnippetManager(!1),c.setShowCloneDialog(!1),c.setShowGitSettings(!1))}let ks=null,Es=null;function Nm(e){ks=e}function gv(){return ks}function Um(){ks=null}function zm(e){Es=e}function Bd(){return Es}function Gm(){Es=null}function Fd(e,r,n,s,c){var d,h,S,_;const u=$e.getState(),g=Bd();switch(e){case"new":u.addTab();break;case"open":Hm();break;case"open-folder":qm();break;case"save":Ia(r,n,!1);break;case"save-as":Ia(r,n,!0);break;case"save-copy-as":Ia(r,n,!0);break;case"save-all":Wm(n);break;case"reload-from-disk":Vm(r,n);break;case"rename-file":Zm(r,n);break;case"delete-file":r!==null&&u.closeTab(r);break;case"close-tab":r!==null&&u.closeTab(r);break;case"close-all":u.closeAllTabs();break;case"close-others":r!==null&&u.closeOtherTabs(r);break;case"close-tabs-to-left":r!==null&&u.closeTabsToLeft(r);break;case"close-tabs-to-right":r!==null&&u.closeTabsToRight(r);break;case"close-unchanged":u.closeUnchangedTabs();break;case"close-all-but-pinned":u.closeAllButPinned();break;case"restore-last-closed":u.restoreLastClosedTab();break;case"pin-tab":r!==null&&u.togglePinTab(r);break;case"print":window.print();break;case"find":u.setShowFindReplace(!0,"find");break;case"replace":u.setShowFindReplace(!0,"replace");break;case"find-in-files":u.setShowFindReplace(!0,"findInFiles");break;case"mark":u.setShowFindReplace(!0,"mark");break;case"incremental-search":u.setShowIncrementalSearch(!0);break;case"goto-line":u.setShowGoToLine(!0);break;case"find-char-in-range":u.setShowCharInRange(!0);break;case"word-wrap":u.updateSettings({wordWrap:c});break;case"show-whitespace":u.updateSettings({showWhitespace:c,renderWhitespace:c?"all":"none"});break;case"show-eol":u.updateSettings({showEOL:c});break;case"show-non-printable":u.updateSettings({showNonPrintable:c});break;case"show-wrap-symbol":u.updateSettings({showWrapSymbol:c});break;case"indent-guide":u.updateSettings({showIndentGuides:c});break;case"show-line-numbers":u.updateSettings({showLineNumbers:c});break;case"toggle-minimap":u.updateSettings({showMinimap:c});break;case"zoom-in":u.setZoomLevel(s+1);break;case"zoom-out":u.setZoomLevel(s-1);break;case"zoom-reset":u.setZoomLevel(0);break;case"toggle-sidebar":u.toggleSidebar();break;case"show-doc-list":u.setSidebarPanel("docList");break;case"show-function-list":u.setSidebarPanel("functions");break;case"show-project-panel":u.setSidebarPanel("project");break;case"distraction-free":u.updateSettings({distractionFreeMode:c});break;case"always-on-top":{u.updateSettings({alwaysOnTop:c}),window.electronAPI&&((h=(d=window.electronAPI).setAlwaysOnTop)==null||h.call(d,c));break}case"sync-scroll-v":u.updateSettings({syncScrollVertical:c});break;case"sync-scroll-h":u.updateSettings({syncScrollHorizontal:c});break;case"split-right":r!==null&&u.setSplitView("vertical",r);break;case"split-down":r!==null&&u.setSplitView("horizontal",r);break;case"close-split":u.setSplitView("none");break;case"show-summary":u.setShowSummary(!0);break;case"toggle-monitoring":{if(r!==null){const x=n.find(R=>R.id===r);x&&u.updateTab(r,{isMonitoring:!x.isMonitoring})}break}case"language":r!==null&&u.updateTab(r,{language:c});break;case"encoding":r!==null&&u.updateTab(r,{encoding:c});break;case"line-ending":r!==null&&u.updateTab(r,{lineEnding:c});break;case"macro-start":u.startRecordingMacro();break;case"macro-stop":u.stopRecordingMacro();break;case"command-palette":u.setShowCommandPalette(!0);break;case"quick-open":u.setShowQuickOpen(!0);break;case"compare-files":u.setShowDiffViewer(!0);break;case"snippet-manager":u.setShowSnippetManager(!0);break;case"toggle-terminal":u.setShowTerminalPanel(!u.showTerminalPanel);break;case"clone-repository":u.setShowCloneDialog(!0);break;case"git-settings":u.setShowGitSettings(!0);break;case"show-git-panel":u.setSidebarPanel("git");break;case"ai-chat":u.setSidebarPanel("ai");break;case"ai-settings":u.SetShowAiSettings(!0);break;case"ai-explain":case"ai-refactor":case"ai-generate-tests":case"ai-generate-docs":case"ai-fix-error":case"ai-simplify":case"ai-convert-language":g&&g(e);break;case"ai-toggle-inline":u.SetInlineSuggestionEnabled(!u.inlineSuggestionEnabled);break;case"preferences":u.setShowSettings(!0);break;case"about":u.setShowAbout(!0);break;case"run-command":u.setShowRunCommand(!0);break;case"column-editor":u.setShowColumnEditor(!0);break;case"shortcut-mapper":u.setShowShortcutMapper(!0);break;case"clipboard-history":u.setSidebarPanel("clipboardHistory");break;case"char-panel":u.setSidebarPanel("charPanel");break;case"search-google":{const x=(S=window.getSelection())==null?void 0:S.toString();x&&window.open(`https://www.google.com/search?q=${encodeURIComponent(x)}`,"_blank");break}case"search-wikipedia":{const x=(_=window.getSelection())==null?void 0:_.toString();x&&window.open(`https://en.wikipedia.org/wiki/${encodeURIComponent(x)}`,"_blank");break}case"open-in-browser":{const x=n.find(R=>R.id===r);x&&x.path&&window.open(`file://${x.path}`,"_blank");break}case"save-session":{const x=u.saveSession(),R=new Blob([JSON.stringify(x,null,2)],{type:"application/json"}),y=URL.createObjectURL(R),j=document.createElement("a");j.href=y,j.download="session.json",j.click(),URL.revokeObjectURL(y);break}case"load-session":{const x=document.createElement("input");x.type="file",x.accept=".json",x.onchange=async R=>{var j;const y=(j=R.target.files)==null?void 0:j[0];if(y)try{const X=await y.text();$e.getState().loadSession(JSON.parse(X))}catch{}},x.click();break}default:g&&g(e,c);break}}function Hm(){var r,n;if(window.electronAPI){(n=(r=window.electronAPI).openFile)==null||n.call(r);return}const e=document.createElement("input");e.type="file",e.multiple=!0,e.onchange=async()=>{if(e.files)try{const s=$e.getState();for(const c of Array.from(e.files)){const u=await c.text();s.addTab({name:c.name,content:u,language:hr(c.name),lineEnding:Er(u)})}}catch{}},e.click()}function qm(){var r,n;if(window.electronAPI){(n=(r=window.electronAPI).openFolder)==null||n.call(r);return}const e=document.createElement("input");e.type="file",e.webkitdirectory=!0,e.onchange=async()=>{if(!(!e.files||e.files.length===0))try{const s=$e.getState();for(const c of Array.from(e.files)){const u=await c.text();s.addTab({name:c.name,content:u,language:hr(c.name),lineEnding:Er(u)})}}catch{}},e.click()}function Ia(e,r,n){var d,h,S,_;if(e===null)return;const s=r.find(x=>x.id===e);if(!s)return;if(window.electronAPI){n||!s.path?(h=(d=window.electronAPI).saveFileAs)==null||h.call(d,s.content,s.name):(_=(S=window.electronAPI).saveFile)==null||_.call(S,s.content,s.path),$e.getState().updateTab(e,{isModified:!1});return}const c=new Blob([s.content],{type:"text/plain;charset=utf-8"}),u=URL.createObjectURL(c),g=document.createElement("a");g.href=u,g.download=s.name,g.click(),URL.revokeObjectURL(u),$e.getState().updateTab(e,{isModified:!1})}function Wm(e){var n,s;const r=$e.getState();for(const c of e)if(c.isModified)if(window.electronAPI&&c.path)(s=(n=window.electronAPI).saveFile)==null||s.call(n,c.content,c.path),r.updateTab(c.id,{isModified:!1});else{const u=new Blob([c.content],{type:"text/plain;charset=utf-8"}),g=URL.createObjectURL(u),d=document.createElement("a");d.href=g,d.download=c.name,d.click(),URL.revokeObjectURL(g),r.updateTab(c.id,{isModified:!1})}}function Vm(e,r){var c,u;if(e===null)return;const n=r.find(g=>g.id===e);if(!n)return;if(window.electronAPI&&n.path){(u=(c=window.electronAPI).readFile)==null||u.call(c,n.path).then(g=>{$e.getState().updateTabContent(e,g),$e.getState().updateTab(e,{isModified:!1})}).catch(g=>{const d=g instanceof Error?g.message:String(g);window.alert(`Failed to reload file from disk: ${d}`)});return}const s=document.createElement("input");s.type="file",s.onchange=async()=>{var g;try{const d=(g=s.files)==null?void 0:g[0];if(d){const h=await d.text();$e.getState().updateTabContent(e,h),$e.getState().updateTab(e,{isModified:!1,name:d.name})}}catch{}},s.click()}function Zm(e,r){var c,u;if(e===null)return;const n=r.find(g=>g.id===e);if(!n)return;const s=prompt("Enter new file name:",n.name);s&&s!==n.name&&($e.getState().updateTab(e,{name:s}),window.electronAPI&&n.path&&((u=(c=window.electronAPI).renameFile)==null||u.call(c,n.path,s)))}var De={},Ca,fu;function Km(){if(fu)return Ca;fu=1;var e=function(r){if(r=r||{},this.Promise=r.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=r.domainReentrant||!1,this.domainReentrant){if(typeof process>"u"||typeof process.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=r.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=r.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=r.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,r.maxPending===1/0||Number.isInteger(r.maxPending)&&r.maxPending>=0?this.maxPending=r.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(r,n,s,c){if(Array.isArray(r))return this._acquireBatch(r,n,s,c);if(typeof n!="function")throw new Error("You must pass a function to execute");var u=null,g=null,d=null;typeof s!="function"&&(c=s,s=null,d=new this.Promise(function(G,W){u=G,g=W})),c=c||{};var h=!1,S=null,_=null,x=null,R=this,y=function(G,W,te){_&&(clearTimeout(_),_=null),x&&(clearTimeout(x),x=null),G&&(R.queues[r]&&R.queues[r].length===0&&delete R.queues[r],R.domainReentrant&&delete R.domains[r]),h||(d?W?g(W):u(te):typeof s=="function"&&s(W,te),h=!0),G&&R.queues[r]&&R.queues[r].length>0&&R.queues[r].shift()()},j=function(G){if(h)return y(G);S&&(clearTimeout(S),S=null),R.domainReentrant&&G&&(R.domains[r]=process.domain);var W=c.maxExecutionTime||R.maxExecutionTime;if(W&&(x=setTimeout(function(){R.queues[r]&&y(G,new Error("Maximum execution time is exceeded "+r))},W)),n.length===1){var te=!1;try{n(function(Z,z){te||(te=!0,y(G,Z,z))})}catch(Z){te||(te=!0,y(G,Z))}}else R._promiseTry(function(){return n()}).then(function(Z){y(G,void 0,Z)},function(Z){y(G,Z)})};R.domainReentrant&&process.domain&&(j=process.domain.bind(j));var X=c.maxPending||R.maxPending;if(!R.queues[r])R.queues[r]=[],j(!0);else if(R.domainReentrant&&process.domain&&process.domain===R.domains[r])j(!1);else if(R.queues[r].length>=X)y(!1,new Error("Too many pending tasks in queue "+r));else{var L=function(){j(!0)};c.skipQueue?R.queues[r].unshift(L):R.queues[r].push(L);var F=c.timeout||R.timeout;F&&(S=setTimeout(function(){S=null,y(!1,new Error("async-lock timed out in queue "+r))},F))}var U=c.maxOccupationTime||R.maxOccupationTime;if(U&&(_=setTimeout(function(){R.queues[r]&&y(!1,new Error("Maximum occupation time is exceeded in queue "+r))},U)),d)return d},e.prototype._acquireBatch=function(r,n,s,c){typeof s!="function"&&(c=s,s=null);var u=this,g=function(h,S){return function(_){u.acquire(h,S,_,c)}},d=r.reduceRight(function(h,S){return g(S,h)},n);if(typeof s=="function")d(s);else return new this.Promise(function(h,S){d.length===1?d(function(_,x){_?S(_):h(x)}):h(d())})},e.prototype.isBusy=function(r){return r?!!this.queues[r]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(r){try{return this.Promise.resolve(r())}catch(n){return this.Promise.reject(n)}},Ca=e,Ca}var Ta,du;function Xm(){return du||(du=1,Ta=Km()),Ta}var _i={exports:{}},hu;function Ym(){return hu||(hu=1,typeof Object.create=="function"?_i.exports=function(r,n){n&&(r.super_=n,r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:_i.exports=function(r,n){if(n){r.super_=n;var s=function(){};s.prototype=n.prototype,r.prototype=new s,r.prototype.constructor=r}}),_i.exports}var Si={exports:{}},Ra={},Nn={},pu;function Jm(){if(pu)return Nn;pu=1,Nn.byteLength=d,Nn.toByteArray=S,Nn.fromByteArray=R;for(var e=[],r=[],n=typeof Uint8Array<"u"?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,u=s.length;c<u;++c)e[c]=s[c],r[s.charCodeAt(c)]=c;r[45]=62,r[95]=63;function g(y){var j=y.length;if(j%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var X=y.indexOf("=");X===-1&&(X=j);var L=X===j?0:4-X%4;return[X,L]}function d(y){var j=g(y),X=j[0],L=j[1];return(X+L)*3/4-L}function h(y,j,X){return(j+X)*3/4-X}function S(y){var j,X=g(y),L=X[0],F=X[1],U=new n(h(y,L,F)),G=0,W=F>0?L-4:L,te;for(te=0;te<W;te+=4)j=r[y.charCodeAt(te)]<<18|r[y.charCodeAt(te+1)]<<12|r[y.charCodeAt(te+2)]<<6|r[y.charCodeAt(te+3)],U[G++]=j>>16&255,U[G++]=j>>8&255,U[G++]=j&255;return F===2&&(j=r[y.charCodeAt(te)]<<2|r[y.charCodeAt(te+1)]>>4,U[G++]=j&255),F===1&&(j=r[y.charCodeAt(te)]<<10|r[y.charCodeAt(te+1)]<<4|r[y.charCodeAt(te+2)]>>2,U[G++]=j>>8&255,U[G++]=j&255),U}function _(y){return e[y>>18&63]+e[y>>12&63]+e[y>>6&63]+e[y&63]}function x(y,j,X){for(var L,F=[],U=j;U<X;U+=3)L=(y[U]<<16&16711680)+(y[U+1]<<8&65280)+(y[U+2]&255),F.push(_(L));return F.join("")}function R(y){for(var j,X=y.length,L=X%3,F=[],U=16383,G=0,W=X-L;G<W;G+=U)F.push(x(y,G,G+U>W?W:G+U));return L===1?(j=y[X-1],F.push(e[j>>2]+e[j<<4&63]+"==")):L===2&&(j=(y[X-2]<<8)+y[X-1],F.push(e[j>>10]+e[j>>4&63]+e[j<<2&63]+"=")),F.join("")}return Nn}var ki={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var gu;function Qm(){return gu||(gu=1,ki.read=function(e,r,n,s,c){var u,g,d=c*8-s-1,h=(1<<d)-1,S=h>>1,_=-7,x=n?c-1:0,R=n?-1:1,y=e[r+x];for(x+=R,u=y&(1<<-_)-1,y>>=-_,_+=d;_>0;u=u*256+e[r+x],x+=R,_-=8);for(g=u&(1<<-_)-1,u>>=-_,_+=s;_>0;g=g*256+e[r+x],x+=R,_-=8);if(u===0)u=1-S;else{if(u===h)return g?NaN:(y?-1:1)*(1/0);g=g+Math.pow(2,s),u=u-S}return(y?-1:1)*g*Math.pow(2,u-s)},ki.write=function(e,r,n,s,c,u){var g,d,h,S=u*8-c-1,_=(1<<S)-1,x=_>>1,R=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=s?0:u-1,j=s?1:-1,X=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(d=isNaN(r)?1:0,g=_):(g=Math.floor(Math.log(r)/Math.LN2),r*(h=Math.pow(2,-g))<1&&(g--,h*=2),g+x>=1?r+=R/h:r+=R*Math.pow(2,1-x),r*h>=2&&(g++,h/=2),g+x>=_?(d=0,g=_):g+x>=1?(d=(r*h-1)*Math.pow(2,c),g=g+x):(d=r*Math.pow(2,x-1)*Math.pow(2,c),g=0));c>=8;e[n+y]=d&255,y+=j,d/=256,c-=8);for(g=g<<c|d,S+=c;S>0;e[n+y]=g&255,y+=j,g/=256,S-=8);e[n+y-j]|=X*128}),ki}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var mu;function ew(){return mu||(mu=1,(function(e){var r=Jm(),n=Qm(),s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=d,e.SlowBuffer=U,e.INSPECT_MAX_BYTES=50;var c=2147483647;e.kMaxLength=c,d.TYPED_ARRAY_SUPPORT=u(),!d.TYPED_ARRAY_SUPPORT&&typeof console<"u";function u(){try{var O=new Uint8Array(1),p={foo:function(){return 42}};return Object.setPrototypeOf(p,Uint8Array.prototype),Object.setPrototypeOf(O,p),O.foo()===42}catch{return!1}}Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}});function g(O){if(O>c)throw new RangeError('The value "'+O+'" is invalid for option "size"');var p=new Uint8Array(O);return Object.setPrototypeOf(p,d.prototype),p}function d(O,p,b){if(typeof O=="number"){if(typeof p=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return x(O)}return h(O,p,b)}d.poolSize=8192;function h(O,p,b){if(typeof O=="string")return R(O,p);if(ArrayBuffer.isView(O))return j(O);if(O==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof O);if(Qe(O,ArrayBuffer)||O&&Qe(O.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Qe(O,SharedArrayBuffer)||O&&Qe(O.buffer,SharedArrayBuffer)))return X(O,p,b);if(typeof O=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var $=O.valueOf&&O.valueOf();if($!=null&&$!==O)return d.from($,p,b);var re=L(O);if(re)return re;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof O[Symbol.toPrimitive]=="function")return d.from(O[Symbol.toPrimitive]("string"),p,b);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof O)}d.from=function(O,p,b){return h(O,p,b)},Object.setPrototypeOf(d.prototype,Uint8Array.prototype),Object.setPrototypeOf(d,Uint8Array);function S(O){if(typeof O!="number")throw new TypeError('"size" argument must be of type number');if(O<0)throw new RangeError('The value "'+O+'" is invalid for option "size"')}function _(O,p,b){return S(O),O<=0?g(O):p!==void 0?typeof b=="string"?g(O).fill(p,b):g(O).fill(p):g(O)}d.alloc=function(O,p,b){return _(O,p,b)};function x(O){return S(O),g(O<0?0:F(O)|0)}d.allocUnsafe=function(O){return x(O)},d.allocUnsafeSlow=function(O){return x(O)};function R(O,p){if((typeof p!="string"||p==="")&&(p="utf8"),!d.isEncoding(p))throw new TypeError("Unknown encoding: "+p);var b=G(O,p)|0,$=g(b),re=$.write(O,p);return re!==b&&($=$.slice(0,re)),$}function y(O){for(var p=O.length<0?0:F(O.length)|0,b=g(p),$=0;$<p;$+=1)b[$]=O[$]&255;return b}function j(O){if(Qe(O,Uint8Array)){var p=new Uint8Array(O);return X(p.buffer,p.byteOffset,p.byteLength)}return y(O)}function X(O,p,b){if(p<0||O.byteLength<p)throw new RangeError('"offset" is outside of buffer bounds');if(O.byteLength<p+(b||0))throw new RangeError('"length" is outside of buffer bounds');var $;return p===void 0&&b===void 0?$=new Uint8Array(O):b===void 0?$=new Uint8Array(O,p):$=new Uint8Array(O,p,b),Object.setPrototypeOf($,d.prototype),$}function L(O){if(d.isBuffer(O)){var p=F(O.length)|0,b=g(p);return b.length===0||O.copy(b,0,0,p),b}if(O.length!==void 0)return typeof O.length!="number"||ht(O.length)?g(0):y(O);if(O.type==="Buffer"&&Array.isArray(O.data))return y(O.data)}function F(O){if(O>=c)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c.toString(16)+" bytes");return O|0}function U(O){return+O!=O&&(O=0),d.alloc(+O)}d.isBuffer=function(p){return p!=null&&p._isBuffer===!0&&p!==d.prototype},d.compare=function(p,b){if(Qe(p,Uint8Array)&&(p=d.from(p,p.offset,p.byteLength)),Qe(b,Uint8Array)&&(b=d.from(b,b.offset,b.byteLength)),!d.isBuffer(p)||!d.isBuffer(b))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(p===b)return 0;for(var $=p.length,re=b.length,be=0,xe=Math.min($,re);be<xe;++be)if(p[be]!==b[be]){$=p[be],re=b[be];break}return $<re?-1:re<$?1:0},d.isEncoding=function(p){switch(String(p).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(p,b){if(!Array.isArray(p))throw new TypeError('"list" argument must be an Array of Buffers');if(p.length===0)return d.alloc(0);var $;if(b===void 0)for(b=0,$=0;$<p.length;++$)b+=p[$].length;var re=d.allocUnsafe(b),be=0;for($=0;$<p.length;++$){var xe=p[$];if(Qe(xe,Uint8Array))be+xe.length>re.length?d.from(xe).copy(re,be):Uint8Array.prototype.set.call(re,xe,be);else if(d.isBuffer(xe))xe.copy(re,be);else throw new TypeError('"list" argument must be an Array of Buffers');be+=xe.length}return re};function G(O,p){if(d.isBuffer(O))return O.length;if(ArrayBuffer.isView(O)||Qe(O,ArrayBuffer))return O.byteLength;if(typeof O!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof O);var b=O.length,$=arguments.length>2&&arguments[2]===!0;if(!$&&b===0)return 0;for(var re=!1;;)switch(p){case"ascii":case"latin1":case"binary":return b;case"utf8":case"utf-8":return Fe(O).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b*2;case"hex":return b>>>1;case"base64":return at(O).length;default:if(re)return $?-1:Fe(O).length;p=(""+p).toLowerCase(),re=!0}}d.byteLength=G;function W(O,p,b){var $=!1;if((p===void 0||p<0)&&(p=0),p>this.length||((b===void 0||b>this.length)&&(b=this.length),b<=0)||(b>>>=0,p>>>=0,b<=p))return"";for(O||(O="utf8");;)switch(O){case"hex":return he(this,p,b);case"utf8":case"utf-8":return ne(this,p,b);case"ascii":return ie(this,p,b);case"latin1":case"binary":return se(this,p,b);case"base64":return de(this,p,b);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ze(this,p,b);default:if($)throw new TypeError("Unknown encoding: "+O);O=(O+"").toLowerCase(),$=!0}}d.prototype._isBuffer=!0;function te(O,p,b){var $=O[p];O[p]=O[b],O[b]=$}d.prototype.swap16=function(){var p=this.length;if(p%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<p;b+=2)te(this,b,b+1);return this},d.prototype.swap32=function(){var p=this.length;if(p%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<p;b+=4)te(this,b,b+3),te(this,b+1,b+2);return this},d.prototype.swap64=function(){var p=this.length;if(p%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<p;b+=8)te(this,b,b+7),te(this,b+1,b+6),te(this,b+2,b+5),te(this,b+3,b+4);return this},d.prototype.toString=function(){var p=this.length;return p===0?"":arguments.length===0?ne(this,0,p):W.apply(this,arguments)},d.prototype.toLocaleString=d.prototype.toString,d.prototype.equals=function(p){if(!d.isBuffer(p))throw new TypeError("Argument must be a Buffer");return this===p?!0:d.compare(this,p)===0},d.prototype.inspect=function(){var p="",b=e.INSPECT_MAX_BYTES;return p=this.toString("hex",0,b).replace(/(.{2})/g,"$1 ").trim(),this.length>b&&(p+=" ... "),"<Buffer "+p+">"},s&&(d.prototype[s]=d.prototype.inspect),d.prototype.compare=function(p,b,$,re,be){if(Qe(p,Uint8Array)&&(p=d.from(p,p.offset,p.byteLength)),!d.isBuffer(p))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof p);if(b===void 0&&(b=0),$===void 0&&($=p?p.length:0),re===void 0&&(re=0),be===void 0&&(be=this.length),b<0||$>p.length||re<0||be>this.length)throw new RangeError("out of range index");if(re>=be&&b>=$)return 0;if(re>=be)return-1;if(b>=$)return 1;if(b>>>=0,$>>>=0,re>>>=0,be>>>=0,this===p)return 0;for(var xe=be-re,Je=$-b,tt=Math.min(xe,Je),it=this.slice(re,be),ft=p.slice(b,$),st=0;st<tt;++st)if(it[st]!==ft[st]){xe=it[st],Je=ft[st];break}return xe<Je?-1:Je<xe?1:0};function Z(O,p,b,$,re){if(O.length===0)return-1;if(typeof b=="string"?($=b,b=0):b>2147483647?b=2147483647:b<-2147483648&&(b=-2147483648),b=+b,ht(b)&&(b=re?0:O.length-1),b<0&&(b=O.length+b),b>=O.length){if(re)return-1;b=O.length-1}else if(b<0)if(re)b=0;else return-1;if(typeof p=="string"&&(p=d.from(p,$)),d.isBuffer(p))return p.length===0?-1:z(O,p,b,$,re);if(typeof p=="number")return p=p&255,typeof Uint8Array.prototype.indexOf=="function"?re?Uint8Array.prototype.indexOf.call(O,p,b):Uint8Array.prototype.lastIndexOf.call(O,p,b):z(O,[p],b,$,re);throw new TypeError("val must be string, number or Buffer")}function z(O,p,b,$,re){var be=1,xe=O.length,Je=p.length;if($!==void 0&&($=String($).toLowerCase(),$==="ucs2"||$==="ucs-2"||$==="utf16le"||$==="utf-16le")){if(O.length<2||p.length<2)return-1;be=2,xe/=2,Je/=2,b/=2}function tt(Lt,nr){return be===1?Lt[nr]:Lt.readUInt16BE(nr*be)}var it;if(re){var ft=-1;for(it=b;it<xe;it++)if(tt(O,it)===tt(p,ft===-1?0:it-ft)){if(ft===-1&&(ft=it),it-ft+1===Je)return ft*be}else ft!==-1&&(it-=it-ft),ft=-1}else for(b+Je>xe&&(b=xe-Je),it=b;it>=0;it--){for(var st=!0,wt=0;wt<Je;wt++)if(tt(O,it+wt)!==tt(p,wt)){st=!1;break}if(st)return it}return-1}d.prototype.includes=function(p,b,$){return this.indexOf(p,b,$)!==-1},d.prototype.indexOf=function(p,b,$){return Z(this,p,b,$,!0)},d.prototype.lastIndexOf=function(p,b,$){return Z(this,p,b,$,!1)};function B(O,p,b,$){b=Number(b)||0;var re=O.length-b;$?($=Number($),$>re&&($=re)):$=re;var be=p.length;$>be/2&&($=be/2);for(var xe=0;xe<$;++xe){var Je=parseInt(p.substr(xe*2,2),16);if(ht(Je))return xe;O[b+xe]=Je}return xe}function J(O,p,b,$){return Ze(Fe(p,O.length-b),O,b,$)}function N(O,p,b,$){return Ze(Ke(p),O,b,$)}function ce(O,p,b,$){return Ze(at(p),O,b,$)}function oe(O,p,b,$){return Ze(Ye(p,O.length-b),O,b,$)}d.prototype.write=function(p,b,$,re){if(b===void 0)re="utf8",$=this.length,b=0;else if($===void 0&&typeof b=="string")re=b,$=this.length,b=0;else if(isFinite(b))b=b>>>0,isFinite($)?($=$>>>0,re===void 0&&(re="utf8")):(re=$,$=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var be=this.length-b;if(($===void 0||$>be)&&($=be),p.length>0&&($<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");re||(re="utf8");for(var xe=!1;;)switch(re){case"hex":return B(this,p,b,$);case"utf8":case"utf-8":return J(this,p,b,$);case"ascii":case"latin1":case"binary":return N(this,p,b,$);case"base64":return ce(this,p,b,$);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe(this,p,b,$);default:if(xe)throw new TypeError("Unknown encoding: "+re);re=(""+re).toLowerCase(),xe=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function de(O,p,b){return p===0&&b===O.length?r.fromByteArray(O):r.fromByteArray(O.slice(p,b))}function ne(O,p,b){b=Math.min(O.length,b);for(var $=[],re=p;re<b;){var be=O[re],xe=null,Je=be>239?4:be>223?3:be>191?2:1;if(re+Je<=b){var tt,it,ft,st;switch(Je){case 1:be<128&&(xe=be);break;case 2:tt=O[re+1],(tt&192)===128&&(st=(be&31)<<6|tt&63,st>127&&(xe=st));break;case 3:tt=O[re+1],it=O[re+2],(tt&192)===128&&(it&192)===128&&(st=(be&15)<<12|(tt&63)<<6|it&63,st>2047&&(st<55296||st>57343)&&(xe=st));break;case 4:tt=O[re+1],it=O[re+2],ft=O[re+3],(tt&192)===128&&(it&192)===128&&(ft&192)===128&&(st=(be&15)<<18|(tt&63)<<12|(it&63)<<6|ft&63,st>65535&&st<1114112&&(xe=st))}}xe===null?(xe=65533,Je=1):xe>65535&&(xe-=65536,$.push(xe>>>10&1023|55296),xe=56320|xe&1023),$.push(xe),re+=Je}return ae($)}var me=4096;function ae(O){var p=O.length;if(p<=me)return String.fromCharCode.apply(String,O);for(var b="",$=0;$<p;)b+=String.fromCharCode.apply(String,O.slice($,$+=me));return b}function ie(O,p,b){var $="";b=Math.min(O.length,b);for(var re=p;re<b;++re)$+=String.fromCharCode(O[re]&127);return $}function se(O,p,b){var $="";b=Math.min(O.length,b);for(var re=p;re<b;++re)$+=String.fromCharCode(O[re]);return $}function he(O,p,b){var $=O.length;(!p||p<0)&&(p=0),(!b||b<0||b>$)&&(b=$);for(var re="",be=p;be<b;++be)re+=mt[O[be]];return re}function ze(O,p,b){for(var $=O.slice(p,b),re="",be=0;be<$.length-1;be+=2)re+=String.fromCharCode($[be]+$[be+1]*256);return re}d.prototype.slice=function(p,b){var $=this.length;p=~~p,b=b===void 0?$:~~b,p<0?(p+=$,p<0&&(p=0)):p>$&&(p=$),b<0?(b+=$,b<0&&(b=0)):b>$&&(b=$),b<p&&(b=p);var re=this.subarray(p,b);return Object.setPrototypeOf(re,d.prototype),re};function _e(O,p,b){if(O%1!==0||O<0)throw new RangeError("offset is not uint");if(O+p>b)throw new RangeError("Trying to access beyond buffer length")}d.prototype.readUintLE=d.prototype.readUIntLE=function(p,b,$){p=p>>>0,b=b>>>0,$||_e(p,b,this.length);for(var re=this[p],be=1,xe=0;++xe<b&&(be*=256);)re+=this[p+xe]*be;return re},d.prototype.readUintBE=d.prototype.readUIntBE=function(p,b,$){p=p>>>0,b=b>>>0,$||_e(p,b,this.length);for(var re=this[p+--b],be=1;b>0&&(be*=256);)re+=this[p+--b]*be;return re},d.prototype.readUint8=d.prototype.readUInt8=function(p,b){return p=p>>>0,b||_e(p,1,this.length),this[p]},d.prototype.readUint16LE=d.prototype.readUInt16LE=function(p,b){return p=p>>>0,b||_e(p,2,this.length),this[p]|this[p+1]<<8},d.prototype.readUint16BE=d.prototype.readUInt16BE=function(p,b){return p=p>>>0,b||_e(p,2,this.length),this[p]<<8|this[p+1]},d.prototype.readUint32LE=d.prototype.readUInt32LE=function(p,b){return p=p>>>0,b||_e(p,4,this.length),(this[p]|this[p+1]<<8|this[p+2]<<16)+this[p+3]*16777216},d.prototype.readUint32BE=d.prototype.readUInt32BE=function(p,b){return p=p>>>0,b||_e(p,4,this.length),this[p]*16777216+(this[p+1]<<16|this[p+2]<<8|this[p+3])},d.prototype.readIntLE=function(p,b,$){p=p>>>0,b=b>>>0,$||_e(p,b,this.length);for(var re=this[p],be=1,xe=0;++xe<b&&(be*=256);)re+=this[p+xe]*be;return be*=128,re>=be&&(re-=Math.pow(2,8*b)),re},d.prototype.readIntBE=function(p,b,$){p=p>>>0,b=b>>>0,$||_e(p,b,this.length);for(var re=b,be=1,xe=this[p+--re];re>0&&(be*=256);)xe+=this[p+--re]*be;return be*=128,xe>=be&&(xe-=Math.pow(2,8*b)),xe},d.prototype.readInt8=function(p,b){return p=p>>>0,b||_e(p,1,this.length),this[p]&128?(255-this[p]+1)*-1:this[p]},d.prototype.readInt16LE=function(p,b){p=p>>>0,b||_e(p,2,this.length);var $=this[p]|this[p+1]<<8;return $&32768?$|4294901760:$},d.prototype.readInt16BE=function(p,b){p=p>>>0,b||_e(p,2,this.length);var $=this[p+1]|this[p]<<8;return $&32768?$|4294901760:$},d.prototype.readInt32LE=function(p,b){return p=p>>>0,b||_e(p,4,this.length),this[p]|this[p+1]<<8|this[p+2]<<16|this[p+3]<<24},d.prototype.readInt32BE=function(p,b){return p=p>>>0,b||_e(p,4,this.length),this[p]<<24|this[p+1]<<16|this[p+2]<<8|this[p+3]},d.prototype.readFloatLE=function(p,b){return p=p>>>0,b||_e(p,4,this.length),n.read(this,p,!0,23,4)},d.prototype.readFloatBE=function(p,b){return p=p>>>0,b||_e(p,4,this.length),n.read(this,p,!1,23,4)},d.prototype.readDoubleLE=function(p,b){return p=p>>>0,b||_e(p,8,this.length),n.read(this,p,!0,52,8)},d.prototype.readDoubleBE=function(p,b){return p=p>>>0,b||_e(p,8,this.length),n.read(this,p,!1,52,8)};function Me(O,p,b,$,re,be){if(!d.isBuffer(O))throw new TypeError('"buffer" argument must be a Buffer instance');if(p>re||p<be)throw new RangeError('"value" argument is out of bounds');if(b+$>O.length)throw new RangeError("Index out of range")}d.prototype.writeUintLE=d.prototype.writeUIntLE=function(p,b,$,re){if(p=+p,b=b>>>0,$=$>>>0,!re){var be=Math.pow(2,8*$)-1;Me(this,p,b,$,be,0)}var xe=1,Je=0;for(this[b]=p&255;++Je<$&&(xe*=256);)this[b+Je]=p/xe&255;return b+$},d.prototype.writeUintBE=d.prototype.writeUIntBE=function(p,b,$,re){if(p=+p,b=b>>>0,$=$>>>0,!re){var be=Math.pow(2,8*$)-1;Me(this,p,b,$,be,0)}var xe=$-1,Je=1;for(this[b+xe]=p&255;--xe>=0&&(Je*=256);)this[b+xe]=p/Je&255;return b+$},d.prototype.writeUint8=d.prototype.writeUInt8=function(p,b,$){return p=+p,b=b>>>0,$||Me(this,p,b,1,255,0),this[b]=p&255,b+1},d.prototype.writeUint16LE=d.prototype.writeUInt16LE=function(p,b,$){return p=+p,b=b>>>0,$||Me(this,p,b,2,65535,0),this[b]=p&255,this[b+1]=p>>>8,b+2},d.prototype.writeUint16BE=d.prototype.writeUInt16BE=function(p,b,$){return p=+p,b=b>>>0,$||Me(this,p,b,2,65535,0),this[b]=p>>>8,this[b+1]=p&255,b+2},d.prototype.writeUint32LE=d.prototype.writeUInt32LE=function(p,b,$){return p=+p,b=b>>>0,$||Me(this,p,b,4,4294967295,0),this[b+3]=p>>>24,this[b+2]=p>>>16,this[b+1]=p>>>8,this[b]=p&255,b+4},d.prototype.writeUint32BE=d.prototype.writeUInt32BE=function(p,b,$){return p=+p,b=b>>>0,$||Me(this,p,b,4,4294967295,0),this[b]=p>>>24,this[b+1]=p>>>16,this[b+2]=p>>>8,this[b+3]=p&255,b+4},d.prototype.writeIntLE=function(p,b,$,re){if(p=+p,b=b>>>0,!re){var be=Math.pow(2,8*$-1);Me(this,p,b,$,be-1,-be)}var xe=0,Je=1,tt=0;for(this[b]=p&255;++xe<$&&(Je*=256);)p<0&&tt===0&&this[b+xe-1]!==0&&(tt=1),this[b+xe]=(p/Je>>0)-tt&255;return b+$},d.prototype.writeIntBE=function(p,b,$,re){if(p=+p,b=b>>>0,!re){var be=Math.pow(2,8*$-1);Me(this,p,b,$,be-1,-be)}var xe=$-1,Je=1,tt=0;for(this[b+xe]=p&255;--xe>=0&&(Je*=256);)p<0&&tt===0&&this[b+xe+1]!==0&&(tt=1),this[b+xe]=(p/Je>>0)-tt&255;return b+$},d.prototype.writeInt8=function(p,b,$){return p=+p,b=b>>>0,$||Me(this,p,b,1,127,-128),p<0&&(p=255+p+1),this[b]=p&255,b+1},d.prototype.writeInt16LE=function(p,b,$){return p=+p,b=b>>>0,$||Me(this,p,b,2,32767,-32768),this[b]=p&255,this[b+1]=p>>>8,b+2},d.prototype.writeInt16BE=function(p,b,$){return p=+p,b=b>>>0,$||Me(this,p,b,2,32767,-32768),this[b]=p>>>8,this[b+1]=p&255,b+2},d.prototype.writeInt32LE=function(p,b,$){return p=+p,b=b>>>0,$||Me(this,p,b,4,2147483647,-2147483648),this[b]=p&255,this[b+1]=p>>>8,this[b+2]=p>>>16,this[b+3]=p>>>24,b+4},d.prototype.writeInt32BE=function(p,b,$){return p=+p,b=b>>>0,$||Me(this,p,b,4,2147483647,-2147483648),p<0&&(p=4294967295+p+1),this[b]=p>>>24,this[b+1]=p>>>16,this[b+2]=p>>>8,this[b+3]=p&255,b+4};function q(O,p,b,$,re,be){if(b+$>O.length)throw new RangeError("Index out of range");if(b<0)throw new RangeError("Index out of range")}function ke(O,p,b,$,re){return p=+p,b=b>>>0,re||q(O,p,b,4),n.write(O,p,b,$,23,4),b+4}d.prototype.writeFloatLE=function(p,b,$){return ke(this,p,b,!0,$)},d.prototype.writeFloatBE=function(p,b,$){return ke(this,p,b,!1,$)};function Ae(O,p,b,$,re){return p=+p,b=b>>>0,re||q(O,p,b,8),n.write(O,p,b,$,52,8),b+8}d.prototype.writeDoubleLE=function(p,b,$){return Ae(this,p,b,!0,$)},d.prototype.writeDoubleBE=function(p,b,$){return Ae(this,p,b,!1,$)},d.prototype.copy=function(p,b,$,re){if(!d.isBuffer(p))throw new TypeError("argument should be a Buffer");if($||($=0),!re&&re!==0&&(re=this.length),b>=p.length&&(b=p.length),b||(b=0),re>0&&re<$&&(re=$),re===$||p.length===0||this.length===0)return 0;if(b<0)throw new RangeError("targetStart out of bounds");if($<0||$>=this.length)throw new RangeError("Index out of range");if(re<0)throw new RangeError("sourceEnd out of bounds");re>this.length&&(re=this.length),p.length-b<re-$&&(re=p.length-b+$);var be=re-$;return this===p&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(b,$,re):Uint8Array.prototype.set.call(p,this.subarray($,re),b),be},d.prototype.fill=function(p,b,$,re){if(typeof p=="string"){if(typeof b=="string"?(re=b,b=0,$=this.length):typeof $=="string"&&(re=$,$=this.length),re!==void 0&&typeof re!="string")throw new TypeError("encoding must be a string");if(typeof re=="string"&&!d.isEncoding(re))throw new TypeError("Unknown encoding: "+re);if(p.length===1){var be=p.charCodeAt(0);(re==="utf8"&&be<128||re==="latin1")&&(p=be)}}else typeof p=="number"?p=p&255:typeof p=="boolean"&&(p=Number(p));if(b<0||this.length<b||this.length<$)throw new RangeError("Out of range index");if($<=b)return this;b=b>>>0,$=$===void 0?this.length:$>>>0,p||(p=0);var xe;if(typeof p=="number")for(xe=b;xe<$;++xe)this[xe]=p;else{var Je=d.isBuffer(p)?p:d.from(p,re),tt=Je.length;if(tt===0)throw new TypeError('The value "'+p+'" is invalid for argument "value"');for(xe=0;xe<$-b;++xe)this[xe+b]=Je[xe%tt]}return this};var Oe=/[^+/0-9A-Za-z-_]/g;function je(O){if(O=O.split("=")[0],O=O.trim().replace(Oe,""),O.length<2)return"";for(;O.length%4!==0;)O=O+"=";return O}function Fe(O,p){p=p||1/0;for(var b,$=O.length,re=null,be=[],xe=0;xe<$;++xe){if(b=O.charCodeAt(xe),b>55295&&b<57344){if(!re){if(b>56319){(p-=3)>-1&&be.push(239,191,189);continue}else if(xe+1===$){(p-=3)>-1&&be.push(239,191,189);continue}re=b;continue}if(b<56320){(p-=3)>-1&&be.push(239,191,189),re=b;continue}b=(re-55296<<10|b-56320)+65536}else re&&(p-=3)>-1&&be.push(239,191,189);if(re=null,b<128){if((p-=1)<0)break;be.push(b)}else if(b<2048){if((p-=2)<0)break;be.push(b>>6|192,b&63|128)}else if(b<65536){if((p-=3)<0)break;be.push(b>>12|224,b>>6&63|128,b&63|128)}else if(b<1114112){if((p-=4)<0)break;be.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw new Error("Invalid code point")}return be}function Ke(O){for(var p=[],b=0;b<O.length;++b)p.push(O.charCodeAt(b)&255);return p}function Ye(O,p){for(var b,$,re,be=[],xe=0;xe<O.length&&!((p-=2)<0);++xe)b=O.charCodeAt(xe),$=b>>8,re=b%256,be.push(re),be.push($);return be}function at(O){return r.toByteArray(je(O))}function Ze(O,p,b,$){for(var re=0;re<$&&!(re+b>=p.length||re>=O.length);++re)p[re+b]=O[re];return re}function Qe(O,p){return O instanceof p||O!=null&&O.constructor!=null&&O.constructor.name!=null&&O.constructor.name===p.name}function ht(O){return O!==O}var mt=(function(){for(var O="0123456789abcdef",p=new Array(256),b=0;b<16;++b)for(var $=b*16,re=0;re<16;++re)p[$+re]=O[b]+O[re];return p})()})(Ra)),Ra}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var wu;function As(){return wu||(wu=1,(function(e,r){var n=ew(),s=n.Buffer;function c(g,d){for(var h in g)d[h]=g[h]}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=n:(c(n,r),r.Buffer=u);function u(g,d,h){return s(g,d,h)}u.prototype=Object.create(s.prototype),c(s,u),u.from=function(g,d,h){if(typeof g=="number")throw new TypeError("Argument must not be a number");return s(g,d,h)},u.alloc=function(g,d,h){if(typeof g!="number")throw new TypeError("Argument must be a number");var S=s(g);return d!==void 0?typeof h=="string"?S.fill(d,h):S.fill(d):S.fill(0),S},u.allocUnsafe=function(g){if(typeof g!="number")throw new TypeError("Argument must be a number");return s(g)},u.allocUnsafeSlow=function(g){if(typeof g!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(g)}})(Si,Si.exports)),Si.exports}var Oa,yu;function tw(){if(yu)return Oa;yu=1;var e={}.toString;return Oa=Array.isArray||function(r){return e.call(r)=="[object Array]"},Oa}var Pa,bu;function Jn(){return bu||(bu=1,Pa=TypeError),Pa}var Ma,vu;function Dd(){return vu||(vu=1,Ma=Object),Ma}var ja,xu;function rw(){return xu||(xu=1,ja=Error),ja}var Ba,_u;function nw(){return _u||(_u=1,Ba=EvalError),Ba}var Fa,Su;function iw(){return Su||(Su=1,Fa=RangeError),Fa}var Da,ku;function aw(){return ku||(ku=1,Da=ReferenceError),Da}var La,Eu;function Ld(){return Eu||(Eu=1,La=SyntaxError),La}var $a,Au;function ow(){return Au||(Au=1,$a=URIError),$a}var Na,Iu;function sw(){return Iu||(Iu=1,Na=Math.abs),Na}var Ua,Cu;function cw(){return Cu||(Cu=1,Ua=Math.floor),Ua}var za,Tu;function lw(){return Tu||(Tu=1,za=Math.max),za}var Ga,Ru;function uw(){return Ru||(Ru=1,Ga=Math.min),Ga}var Ha,Ou;function fw(){return Ou||(Ou=1,Ha=Math.pow),Ha}var qa,Pu;function dw(){return Pu||(Pu=1,qa=Math.round),qa}var Wa,Mu;function hw(){return Mu||(Mu=1,Wa=Number.isNaN||function(r){return r!==r}),Wa}var Va,ju;function pw(){if(ju)return Va;ju=1;var e=hw();return Va=function(n){return e(n)||n===0?n:n<0?-1:1},Va}var Za,Bu;function gw(){return Bu||(Bu=1,Za=Object.getOwnPropertyDescriptor),Za}var Ka,Fu;function Qn(){if(Fu)return Ka;Fu=1;var e=gw();if(e)try{e([],"length")}catch{e=null}return Ka=e,Ka}var Xa,Du;function Ui(){if(Du)return Xa;Du=1;var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return Xa=e,Xa}var Ya,Lu;function $d(){return Lu||(Lu=1,Ya=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var r={},n=Symbol("test"),s=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(s)!=="[object Symbol]")return!1;var c=42;r[n]=c;for(var u in r)return!1;if(typeof Object.keys=="function"&&Object.keys(r).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(r).length!==0)return!1;var g=Object.getOwnPropertySymbols(r);if(g.length!==1||g[0]!==n||!Object.prototype.propertyIsEnumerable.call(r,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var d=Object.getOwnPropertyDescriptor(r,n);if(d.value!==c||d.enumerable!==!0)return!1}return!0}),Ya}var Ja,$u;function mw(){if($u)return Ja;$u=1;var e=typeof Symbol<"u"&&Symbol,r=$d();return Ja=function(){return typeof e!="function"||typeof Symbol!="function"||typeof e("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:r()},Ja}var Qa,Nu;function Nd(){return Nu||(Nu=1,Qa=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Qa}var eo,Uu;function Ud(){if(Uu)return eo;Uu=1;var e=Dd();return eo=e.getPrototypeOf||null,eo}var to,zu;function ww(){if(zu)return to;zu=1;var e="Function.prototype.bind called on incompatible ",r=Object.prototype.toString,n=Math.max,s="[object Function]",c=function(h,S){for(var _=[],x=0;x<h.length;x+=1)_[x]=h[x];for(var R=0;R<S.length;R+=1)_[R+h.length]=S[R];return _},u=function(h,S){for(var _=[],x=S,R=0;x<h.length;x+=1,R+=1)_[R]=h[x];return _},g=function(d,h){for(var S="",_=0;_<d.length;_+=1)S+=d[_],_+1<d.length&&(S+=h);return S};return to=function(h){var S=this;if(typeof S!="function"||r.apply(S)!==s)throw new TypeError(e+S);for(var _=u(arguments,1),x,R=function(){if(this instanceof x){var F=S.apply(this,c(_,arguments));return Object(F)===F?F:this}return S.apply(h,c(_,arguments))},y=n(0,S.length-_.length),j=[],X=0;X<y;X++)j[X]="$"+X;if(x=Function("binder","return function ("+g(j,",")+"){ return binder.apply(this,arguments); }")(R),S.prototype){var L=function(){};L.prototype=S.prototype,x.prototype=new L,L.prototype=null}return x},to}var ro,Gu;function ei(){if(Gu)return ro;Gu=1;var e=ww();return ro=Function.prototype.bind||e,ro}var no,Hu;function Is(){return Hu||(Hu=1,no=Function.prototype.call),no}var io,qu;function Cs(){return qu||(qu=1,io=Function.prototype.apply),io}var ao,Wu;function yw(){return Wu||(Wu=1,ao=typeof Reflect<"u"&&Reflect&&Reflect.apply),ao}var oo,Vu;function zd(){if(Vu)return oo;Vu=1;var e=ei(),r=Cs(),n=Is(),s=yw();return oo=s||e.call(n,r),oo}var so,Zu;function Ts(){if(Zu)return so;Zu=1;var e=ei(),r=Jn(),n=Is(),s=zd();return so=function(u){if(u.length<1||typeof u[0]!="function")throw new r("a function is required");return s(e,n,u)},so}var co,Ku;function bw(){if(Ku)return co;Ku=1;var e=Ts(),r=Qn(),n;try{n=[].__proto__===Array.prototype}catch(g){if(!g||typeof g!="object"||!("code"in g)||g.code!=="ERR_PROTO_ACCESS")throw g}var s=!!n&&r&&r(Object.prototype,"__proto__"),c=Object,u=c.getPrototypeOf;return co=s&&typeof s.get=="function"?e([s.get]):typeof u=="function"?function(d){return u(d==null?d:c(d))}:!1,co}var lo,Xu;function Gd(){if(Xu)return lo;Xu=1;var e=Nd(),r=Ud(),n=bw();return lo=e?function(c){return e(c)}:r?function(c){if(!c||typeof c!="object"&&typeof c!="function")throw new TypeError("getProto: not an object");return r(c)}:n?function(c){return n(c)}:null,lo}var uo,Yu;function vw(){if(Yu)return uo;Yu=1;var e=Function.prototype.call,r=Object.prototype.hasOwnProperty,n=ei();return uo=n.call(e,r),uo}var fo,Ju;function Hd(){if(Ju)return fo;Ju=1;var e,r=Dd(),n=rw(),s=nw(),c=iw(),u=aw(),g=Ld(),d=Jn(),h=ow(),S=sw(),_=cw(),x=lw(),R=uw(),y=fw(),j=dw(),X=pw(),L=Function,F=function(Ke){try{return L('"use strict"; return ('+Ke+").constructor;")()}catch{}},U=Qn(),G=Ui(),W=function(){throw new d},te=U?(function(){try{return arguments.callee,W}catch{try{return U(arguments,"callee").get}catch{return W}}})():W,Z=mw()(),z=Gd(),B=Ud(),J=Nd(),N=Cs(),ce=Is(),oe={},de=typeof Uint8Array>"u"||!z?e:z(Uint8Array),ne={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?e:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?e:ArrayBuffer,"%ArrayIteratorPrototype%":Z&&z?z([][Symbol.iterator]()):e,"%AsyncFromSyncIteratorPrototype%":e,"%AsyncFunction%":oe,"%AsyncGenerator%":oe,"%AsyncGeneratorFunction%":oe,"%AsyncIteratorPrototype%":oe,"%Atomics%":typeof Atomics>"u"?e:Atomics,"%BigInt%":typeof BigInt>"u"?e:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?e:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":n,"%eval%":eval,"%EvalError%":s,"%Float16Array%":typeof Float16Array>"u"?e:Float16Array,"%Float32Array%":typeof Float32Array>"u"?e:Float32Array,"%Float64Array%":typeof Float64Array>"u"?e:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?e:FinalizationRegistry,"%Function%":L,"%GeneratorFunction%":oe,"%Int8Array%":typeof Int8Array>"u"?e:Int8Array,"%Int16Array%":typeof Int16Array>"u"?e:Int16Array,"%Int32Array%":typeof Int32Array>"u"?e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Z&&z?z(z([][Symbol.iterator]())):e,"%JSON%":typeof JSON=="object"?JSON:e,"%Map%":typeof Map>"u"?e:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Z||!z?e:z(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":r,"%Object.getOwnPropertyDescriptor%":U,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?e:Promise,"%Proxy%":typeof Proxy>"u"?e:Proxy,"%RangeError%":c,"%ReferenceError%":u,"%Reflect%":typeof Reflect>"u"?e:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?e:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Z||!z?e:z(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Z&&z?z(""[Symbol.iterator]()):e,"%Symbol%":Z?Symbol:e,"%SyntaxError%":g,"%ThrowTypeError%":te,"%TypedArray%":de,"%TypeError%":d,"%Uint8Array%":typeof Uint8Array>"u"?e:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?e:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?e:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?e:Uint32Array,"%URIError%":h,"%WeakMap%":typeof WeakMap>"u"?e:WeakMap,"%WeakRef%":typeof WeakRef>"u"?e:WeakRef,"%WeakSet%":typeof WeakSet>"u"?e:WeakSet,"%Function.prototype.call%":ce,"%Function.prototype.apply%":N,"%Object.defineProperty%":G,"%Object.getPrototypeOf%":B,"%Math.abs%":S,"%Math.floor%":_,"%Math.max%":x,"%Math.min%":R,"%Math.pow%":y,"%Math.round%":j,"%Math.sign%":X,"%Reflect.getPrototypeOf%":J};if(z)try{null.error}catch(Ke){var me=z(z(Ke));ne["%Error.prototype%"]=me}var ae=function Ke(Ye){var at;if(Ye==="%AsyncFunction%")at=F("async function () {}");else if(Ye==="%GeneratorFunction%")at=F("function* () {}");else if(Ye==="%AsyncGeneratorFunction%")at=F("async function* () {}");else if(Ye==="%AsyncGenerator%"){var Ze=Ke("%AsyncGeneratorFunction%");Ze&&(at=Ze.prototype)}else if(Ye==="%AsyncIteratorPrototype%"){var Qe=Ke("%AsyncGenerator%");Qe&&z&&(at=z(Qe.prototype))}return ne[Ye]=at,at},ie={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},se=ei(),he=vw(),ze=se.call(ce,Array.prototype.concat),_e=se.call(N,Array.prototype.splice),Me=se.call(ce,String.prototype.replace),q=se.call(ce,String.prototype.slice),ke=se.call(ce,RegExp.prototype.exec),Ae=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Oe=/\\(\\)?/g,je=function(Ye){var at=q(Ye,0,1),Ze=q(Ye,-1);if(at==="%"&&Ze!=="%")throw new g("invalid intrinsic syntax, expected closing `%`");if(Ze==="%"&&at!=="%")throw new g("invalid intrinsic syntax, expected opening `%`");var Qe=[];return Me(Ye,Ae,function(ht,mt,O,p){Qe[Qe.length]=O?Me(p,Oe,"$1"):mt||ht}),Qe},Fe=function(Ye,at){var Ze=Ye,Qe;if(he(ie,Ze)&&(Qe=ie[Ze],Ze="%"+Qe[0]+"%"),he(ne,Ze)){var ht=ne[Ze];if(ht===oe&&(ht=ae(Ze)),typeof ht>"u"&&!at)throw new d("intrinsic "+Ye+" exists, but is not available. Please file an issue!");return{alias:Qe,name:Ze,value:ht}}throw new g("intrinsic "+Ye+" does not exist!")};return fo=function(Ye,at){if(typeof Ye!="string"||Ye.length===0)throw new d("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof at!="boolean")throw new d('"allowMissing" argument must be a boolean');if(ke(/^%?[^%]*%?$/,Ye)===null)throw new g("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var Ze=je(Ye),Qe=Ze.length>0?Ze[0]:"",ht=Fe("%"+Qe+"%",at),mt=ht.name,O=ht.value,p=!1,b=ht.alias;b&&(Qe=b[0],_e(Ze,ze([0,1],b)));for(var $=1,re=!0;$<Ze.length;$+=1){var be=Ze[$],xe=q(be,0,1),Je=q(be,-1);if((xe==='"'||xe==="'"||xe==="`"||Je==='"'||Je==="'"||Je==="`")&&xe!==Je)throw new g("property names with quotes must have matching quotes");if((be==="constructor"||!re)&&(p=!0),Qe+="."+be,mt="%"+Qe+"%",he(ne,mt))O=ne[mt];else if(O!=null){if(!(be in O)){if(!at)throw new d("base intrinsic for "+Ye+" exists, but the property is not available.");return}if(U&&$+1>=Ze.length){var tt=U(O,be);re=!!tt,re&&"get"in tt&&!("originalValue"in tt.get)?O=tt.get:O=O[be]}else re=he(O,be),O=O[be];re&&!p&&(ne[mt]=O)}}return O},fo}var ho,Qu;function qd(){if(Qu)return ho;Qu=1;var e=Hd(),r=Ts(),n=r([e("%String.prototype.indexOf%")]);return ho=function(c,u){var g=e(c,!!u);return typeof g=="function"&&n(c,".prototype.")>-1?r([g]):g},ho}var po,ef;function xw(){if(ef)return po;ef=1;var e=Function.prototype.toString,r=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,n,s;if(typeof r=="function"&&typeof Object.defineProperty=="function")try{n=Object.defineProperty({},"length",{get:function(){throw s}}),s={},r(function(){throw 42},null,n)}catch(U){U!==s&&(r=null)}else r=null;var c=/^\s*class\b/,u=function(G){try{var W=e.call(G);return c.test(W)}catch{return!1}},g=function(G){try{return u(G)?!1:(e.call(G),!0)}catch{return!1}},d=Object.prototype.toString,h="[object Object]",S="[object Function]",_="[object GeneratorFunction]",x="[object HTMLAllCollection]",R="[object HTML document.all class]",y="[object HTMLCollection]",j=typeof Symbol=="function"&&!!Symbol.toStringTag,X=!(0 in[,]),L=function(){return!1};if(typeof document=="object"){var F=document.all;d.call(F)===d.call(document.all)&&(L=function(G){if((X||!G)&&(typeof G>"u"||typeof G=="object"))try{var W=d.call(G);return(W===x||W===R||W===y||W===h)&&G("")==null}catch{}return!1})}return po=r?function(G){if(L(G))return!0;if(!G||typeof G!="function"&&typeof G!="object")return!1;try{r(G,null,n)}catch(W){if(W!==s)return!1}return!u(G)&&g(G)}:function(G){if(L(G))return!0;if(!G||typeof G!="function"&&typeof G!="object")return!1;if(j)return g(G);if(u(G))return!1;var W=d.call(G);return W!==S&&W!==_&&!/^\[object HTML/.test(W)?!1:g(G)},po}var go,tf;function _w(){if(tf)return go;tf=1;var e=xw(),r=Object.prototype.toString,n=Object.prototype.hasOwnProperty,s=function(h,S,_){for(var x=0,R=h.length;x<R;x++)n.call(h,x)&&(_==null?S(h[x],x,h):S.call(_,h[x],x,h))},c=function(h,S,_){for(var x=0,R=h.length;x<R;x++)_==null?S(h.charAt(x),x,h):S.call(_,h.charAt(x),x,h)},u=function(h,S,_){for(var x in h)n.call(h,x)&&(_==null?S(h[x],x,h):S.call(_,h[x],x,h))};function g(d){return r.call(d)==="[object Array]"}return go=function(h,S,_){if(!e(S))throw new TypeError("iterator must be a function");var x;arguments.length>=3&&(x=_),g(h)?s(h,S,x):typeof h=="string"?c(h,S,x):u(h,S,x)},go}var mo,rf;function Sw(){return rf||(rf=1,mo=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),mo}var wo,nf;function kw(){if(nf)return wo;nf=1;var e=Sw(),r=typeof globalThis>"u"?Ci:globalThis;return wo=function(){for(var s=[],c=0;c<e.length;c++)typeof r[e[c]]=="function"&&(s[s.length]=e[c]);return s},wo}var yo={exports:{}},bo,af;function Ew(){if(af)return bo;af=1;var e=Ui(),r=Ld(),n=Jn(),s=Qn();return bo=function(u,g,d){if(!u||typeof u!="object"&&typeof u!="function")throw new n("`obj` must be an object or a function`");if(typeof g!="string"&&typeof g!="symbol")throw new n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new n("`loose`, if provided, must be a boolean");var h=arguments.length>3?arguments[3]:null,S=arguments.length>4?arguments[4]:null,_=arguments.length>5?arguments[5]:null,x=arguments.length>6?arguments[6]:!1,R=!!s&&s(u,g);if(e)e(u,g,{configurable:_===null&&R?R.configurable:!_,enumerable:h===null&&R?R.enumerable:!h,value:d,writable:S===null&&R?R.writable:!S});else if(x||!h&&!S&&!_)u[g]=d;else throw new r("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},bo}var vo,of;function Aw(){if(of)return vo;of=1;var e=Ui(),r=function(){return!!e};return r.hasArrayLengthDefineBug=function(){if(!e)return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},vo=r,vo}var xo,sf;function Iw(){if(sf)return xo;sf=1;var e=Hd(),r=Ew(),n=Aw()(),s=Qn(),c=Jn(),u=e("%Math.floor%");return xo=function(d,h){if(typeof d!="function")throw new c("`fn` is not a function");if(typeof h!="number"||h<0||h>4294967295||u(h)!==h)throw new c("`length` must be a positive 32-bit integer");var S=arguments.length>2&&!!arguments[2],_=!0,x=!0;if("length"in d&&s){var R=s(d,"length");R&&!R.configurable&&(_=!1),R&&!R.writable&&(x=!1)}return(_||x||!S)&&(n?r(d,"length",h,!0,!0):r(d,"length",h)),d},xo}var _o,cf;function Cw(){if(cf)return _o;cf=1;var e=ei(),r=Cs(),n=zd();return _o=function(){return n(e,r,arguments)},_o}var lf;function Tw(){return lf||(lf=1,(function(e){var r=Iw(),n=Ui(),s=Ts(),c=Cw();e.exports=function(g){var d=s(arguments),h=g.length-(arguments.length-1);return r(d,1+(h>0?h:0),!0)},n?n(e.exports,"apply",{value:c}):e.exports.apply=c})(yo)),yo.exports}var So,uf;function Rw(){if(uf)return So;uf=1;var e=$d();return So=function(){return e()&&!!Symbol.toStringTag},So}var ko,ff;function Ow(){if(ff)return ko;ff=1;var e=_w(),r=kw(),n=Tw(),s=qd(),c=Qn(),u=Gd(),g=s("Object.prototype.toString"),d=Rw()(),h=typeof globalThis>"u"?Ci:globalThis,S=r(),_=s("String.prototype.slice"),x=s("Array.prototype.indexOf",!0)||function(L,F){for(var U=0;U<L.length;U+=1)if(L[U]===F)return U;return-1},R={__proto__:null};d&&c&&u?e(S,function(X){var L=new h[X];if(Symbol.toStringTag in L&&u){var F=u(L),U=c(F,Symbol.toStringTag);if(!U&&F){var G=u(F);U=c(G,Symbol.toStringTag)}if(U&&U.get){var W=n(U.get);R["$"+X]=W}}}):e(S,function(X){var L=new h[X],F=L.slice||L.set;if(F){var U=n(F);R["$"+X]=U}});var y=function(L){var F=!1;return e(R,function(U,G){if(!F)try{"$"+U(L)===G&&(F=_(G,1))}catch{}}),F},j=function(L){var F=!1;return e(R,function(U,G){if(!F)try{U(L),F=_(G,1)}catch{}}),F};return ko=function(L){if(!L||typeof L!="object")return!1;if(!d){var F=_(g(L),8,-1);return x(S,F)>-1?F:F!=="Object"?!1:j(L)}return c?y(L):null},ko}var Eo,df;function Pw(){if(df)return Eo;df=1;var e=Ow();return Eo=function(n){return!!e(n)},Eo}var Ao,hf;function Mw(){if(hf)return Ao;hf=1;var e=Jn(),r=qd(),n=r("TypedArray.prototype.buffer",!0),s=Pw();return Ao=n||function(u){if(!s(u))throw new e("Not a Typed Array");return u.buffer},Ao}var Io,pf;function jw(){if(pf)return Io;pf=1;var e=As().Buffer,r=tw(),n=Mw(),s=ArrayBuffer.isView||function(h){try{return n(h),!0}catch{return!1}},c=typeof Uint8Array<"u",u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",g=u&&(e.prototype instanceof Uint8Array||e.TYPED_ARRAY_SUPPORT);return Io=function(h,S){if(e.isBuffer(h))return h.constructor&&!("isBuffer"in h)?e.from(h):h;if(typeof h=="string")return e.from(h,S);if(u&&s(h)){if(h.byteLength===0)return e.alloc(0);if(g){var _=e.from(h.buffer,h.byteOffset,h.byteLength);if(_.byteLength===h.byteLength)return _}var x=h instanceof Uint8Array?h:new Uint8Array(h.buffer,h.byteOffset,h.byteLength),R=e.from(x);if(R.length===h.byteLength)return R}if(c&&h instanceof Uint8Array)return e.from(h);var y=r(h);if(y)for(var j=0;j<h.length;j+=1){var X=h[j];if(typeof X!="number"||X<0||X>255||~~X!==X)throw new RangeError("Array items must be numbers in the range 0-255.")}if(y||e.isBuffer(h)&&h.constructor&&typeof h.constructor.isBuffer=="function"&&h.constructor.isBuffer(h))return e.from(h);throw new TypeError('The "data" argument must be a string, an Array, a Buffer, a Uint8Array, or a DataView.')},Io}var Co,gf;function Bw(){if(gf)return Co;gf=1;var e=As().Buffer,r=jw();function n(s,c){this._block=e.alloc(s),this._finalSize=c,this._blockSize=s,this._len=0}return n.prototype.update=function(s,c){s=r(s,c||"utf8");for(var u=this._block,g=this._blockSize,d=s.length,h=this._len,S=0;S<d;){for(var _=h%g,x=Math.min(d-S,g-_),R=0;R<x;R++)u[_+R]=s[S+R];h+=x,S+=x,h%g===0&&this._update(u)}return this._len+=d,this},n.prototype.digest=function(s){var c=this._len%this._blockSize;this._block[c]=128,this._block.fill(0,c+1),c>=this._finalSize&&(this._update(this._block),this._block.fill(0));var u=this._len*8;if(u<=4294967295)this._block.writeUInt32BE(u,this._blockSize-4);else{var g=(u&4294967295)>>>0,d=(u-g)/4294967296;this._block.writeUInt32BE(d,this._blockSize-8),this._block.writeUInt32BE(g,this._blockSize-4)}this._update(this._block);var h=this._hash();return s?h.toString(s):h},n.prototype._update=function(){throw new Error("_update must be implemented by subclass")},Co=n,Co}var To,mf;function Fw(){if(mf)return To;mf=1;var e=Ym(),r=Bw(),n=As().Buffer,s=[1518500249,1859775393,-1894007588,-899497514],c=new Array(80);function u(){this.init(),this._w=c,r.call(this,64,56)}e(u,r),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function g(_){return _<<1|_>>>31}function d(_){return _<<5|_>>>27}function h(_){return _<<30|_>>>2}function S(_,x,R,y){return _===0?x&R|~x&y:_===2?x&R|x&y|R&y:x^R^y}return u.prototype._update=function(_){for(var x=this._w,R=this._a|0,y=this._b|0,j=this._c|0,X=this._d|0,L=this._e|0,F=0;F<16;++F)x[F]=_.readInt32BE(F*4);for(;F<80;++F)x[F]=g(x[F-3]^x[F-8]^x[F-14]^x[F-16]);for(var U=0;U<80;++U){var G=~~(U/20),W=d(R)+S(G,y,j,X)+L+x[U]+s[G]|0;L=X,X=j,j=h(y),y=R,R=W}this._a=R+this._a|0,this._b=y+this._b|0,this._c=j+this._c|0,this._d=X+this._d|0,this._e=L+this._e|0},u.prototype._hash=function(){var _=n.allocUnsafe(20);return _.writeInt32BE(this._a|0,0),_.writeInt32BE(this._b|0,4),_.writeInt32BE(this._c|0,8),_.writeInt32BE(this._d|0,12),_.writeInt32BE(this._e|0,16),_},To=u,To}var Ro={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var wf;function Dw(){return wf||(wf=1,(function(e){(function(r){r(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(r){r.version="1.2.2";function n(){for(var B=0,J=new Array(256),N=0;N!=256;++N)B=N,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,B=B&1?-306674912^B>>>1:B>>>1,J[N]=B;return typeof Int32Array<"u"?new Int32Array(J):J}var s=n();function c(B){var J=0,N=0,ce=0,oe=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ce=0;ce!=256;++ce)oe[ce]=B[ce];for(ce=0;ce!=256;++ce)for(N=B[ce],J=256+ce;J<4096;J+=256)N=oe[J]=N>>>8^B[N&255];var de=[];for(ce=1;ce!=16;++ce)de[ce-1]=typeof Int32Array<"u"?oe.subarray(ce*256,ce*256+256):oe.slice(ce*256,ce*256+256);return de}var u=c(s),g=u[0],d=u[1],h=u[2],S=u[3],_=u[4],x=u[5],R=u[6],y=u[7],j=u[8],X=u[9],L=u[10],F=u[11],U=u[12],G=u[13],W=u[14];function te(B,J){for(var N=J^-1,ce=0,oe=B.length;ce<oe;)N=N>>>8^s[(N^B.charCodeAt(ce++))&255];return~N}function Z(B,J){for(var N=J^-1,ce=B.length-15,oe=0;oe<ce;)N=W[B[oe++]^N&255]^G[B[oe++]^N>>8&255]^U[B[oe++]^N>>16&255]^F[B[oe++]^N>>>24]^L[B[oe++]]^X[B[oe++]]^j[B[oe++]]^y[B[oe++]]^R[B[oe++]]^x[B[oe++]]^_[B[oe++]]^S[B[oe++]]^h[B[oe++]]^d[B[oe++]]^g[B[oe++]]^s[B[oe++]];for(ce+=15;oe<ce;)N=N>>>8^s[(N^B[oe++])&255];return~N}function z(B,J){for(var N=J^-1,ce=0,oe=B.length,de=0,ne=0;ce<oe;)de=B.charCodeAt(ce++),de<128?N=N>>>8^s[(N^de)&255]:de<2048?(N=N>>>8^s[(N^(192|de>>6&31))&255],N=N>>>8^s[(N^(128|de&63))&255]):de>=55296&&de<57344?(de=(de&1023)+64,ne=B.charCodeAt(ce++)&1023,N=N>>>8^s[(N^(240|de>>8&7))&255],N=N>>>8^s[(N^(128|de>>2&63))&255],N=N>>>8^s[(N^(128|ne>>6&15|(de&3)<<4))&255],N=N>>>8^s[(N^(128|ne&63))&255]):(N=N>>>8^s[(N^(224|de>>12&15))&255],N=N>>>8^s[(N^(128|de>>6&63))&255],N=N>>>8^s[(N^(128|de&63))&255]);return~N}r.table=s,r.bstr=te,r.buf=Z,r.str=z})})(Ro)),Ro}var Oo={},yf;function Ir(){return yf||(yf=1,(function(e){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function n(u,g){return Object.prototype.hasOwnProperty.call(u,g)}e.assign=function(u){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var d=g.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var h in d)n(d,h)&&(u[h]=d[h])}}return u},e.shrinkBuf=function(u,g){return u.length===g?u:u.subarray?u.subarray(0,g):(u.length=g,u)};var s={arraySet:function(u,g,d,h,S){if(g.subarray&&u.subarray){u.set(g.subarray(d,d+h),S);return}for(var _=0;_<h;_++)u[S+_]=g[d+_]},flattenChunks:function(u){var g,d,h,S,_,x;for(h=0,g=0,d=u.length;g<d;g++)h+=u[g].length;for(x=new Uint8Array(h),S=0,g=0,d=u.length;g<d;g++)_=u[g],x.set(_,S),S+=_.length;return x}},c={arraySet:function(u,g,d,h,S){for(var _=0;_<h;_++)u[S+_]=g[d+_]},flattenChunks:function(u){return[].concat.apply([],u)}};e.setTyped=function(u){u?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,s)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,c))},e.setTyped(r)})(Oo)),Oo}var an={},sr={},Lr={},bf;function Lw(){if(bf)return Lr;bf=1;var e=Ir(),r=4,n=0,s=1,c=2;function u(P){for(var Se=P.length;--Se>=0;)P[Se]=0}var g=0,d=1,h=2,S=3,_=258,x=29,R=256,y=R+1+x,j=30,X=19,L=2*y+1,F=15,U=16,G=7,W=256,te=16,Z=17,z=18,B=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],J=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],N=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=512,de=new Array((y+2)*2);u(de);var ne=new Array(j*2);u(ne);var me=new Array(oe);u(me);var ae=new Array(_-S+1);u(ae);var ie=new Array(x);u(ie);var se=new Array(j);u(se);function he(P,Se,Ie,Ue,Q){this.static_tree=P,this.extra_bits=Se,this.extra_base=Ie,this.elems=Ue,this.max_length=Q,this.has_stree=P&&P.length}var ze,_e,Me;function q(P,Se){this.dyn_tree=P,this.max_code=0,this.stat_desc=Se}function ke(P){return P<256?me[P]:me[256+(P>>>7)]}function Ae(P,Se){P.pending_buf[P.pending++]=Se&255,P.pending_buf[P.pending++]=Se>>>8&255}function Oe(P,Se,Ie){P.bi_valid>U-Ie?(P.bi_buf|=Se<<P.bi_valid&65535,Ae(P,P.bi_buf),P.bi_buf=Se>>U-P.bi_valid,P.bi_valid+=Ie-U):(P.bi_buf|=Se<<P.bi_valid&65535,P.bi_valid+=Ie)}function je(P,Se,Ie){Oe(P,Ie[Se*2],Ie[Se*2+1])}function Fe(P,Se){var Ie=0;do Ie|=P&1,P>>>=1,Ie<<=1;while(--Se>0);return Ie>>>1}function Ke(P){P.bi_valid===16?(Ae(P,P.bi_buf),P.bi_buf=0,P.bi_valid=0):P.bi_valid>=8&&(P.pending_buf[P.pending++]=P.bi_buf&255,P.bi_buf>>=8,P.bi_valid-=8)}function Ye(P,Se){var Ie=Se.dyn_tree,Ue=Se.max_code,Q=Se.stat_desc.static_tree,ue=Se.stat_desc.has_stree,A=Se.stat_desc.extra_bits,Ee=Se.stat_desc.extra_base,Xe=Se.stat_desc.max_length,m,H,pe,C,K,le,Ve=0;for(C=0;C<=F;C++)P.bl_count[C]=0;for(Ie[P.heap[P.heap_max]*2+1]=0,m=P.heap_max+1;m<L;m++)H=P.heap[m],C=Ie[Ie[H*2+1]*2+1]+1,C>Xe&&(C=Xe,Ve++),Ie[H*2+1]=C,!(H>Ue)&&(P.bl_count[C]++,K=0,H>=Ee&&(K=A[H-Ee]),le=Ie[H*2],P.opt_len+=le*(C+K),ue&&(P.static_len+=le*(Q[H*2+1]+K)));if(Ve!==0){do{for(C=Xe-1;P.bl_count[C]===0;)C--;P.bl_count[C]--,P.bl_count[C+1]+=2,P.bl_count[Xe]--,Ve-=2}while(Ve>0);for(C=Xe;C!==0;C--)for(H=P.bl_count[C];H!==0;)pe=P.heap[--m],!(pe>Ue)&&(Ie[pe*2+1]!==C&&(P.opt_len+=(C-Ie[pe*2+1])*Ie[pe*2],Ie[pe*2+1]=C),H--)}}function at(P,Se,Ie){var Ue=new Array(F+1),Q=0,ue,A;for(ue=1;ue<=F;ue++)Ue[ue]=Q=Q+Ie[ue-1]<<1;for(A=0;A<=Se;A++){var Ee=P[A*2+1];Ee!==0&&(P[A*2]=Fe(Ue[Ee]++,Ee))}}function Ze(){var P,Se,Ie,Ue,Q,ue=new Array(F+1);for(Ie=0,Ue=0;Ue<x-1;Ue++)for(ie[Ue]=Ie,P=0;P<1<<B[Ue];P++)ae[Ie++]=Ue;for(ae[Ie-1]=Ue,Q=0,Ue=0;Ue<16;Ue++)for(se[Ue]=Q,P=0;P<1<<J[Ue];P++)me[Q++]=Ue;for(Q>>=7;Ue<j;Ue++)for(se[Ue]=Q<<7,P=0;P<1<<J[Ue]-7;P++)me[256+Q++]=Ue;for(Se=0;Se<=F;Se++)ue[Se]=0;for(P=0;P<=143;)de[P*2+1]=8,P++,ue[8]++;for(;P<=255;)de[P*2+1]=9,P++,ue[9]++;for(;P<=279;)de[P*2+1]=7,P++,ue[7]++;for(;P<=287;)de[P*2+1]=8,P++,ue[8]++;for(at(de,y+1,ue),P=0;P<j;P++)ne[P*2+1]=5,ne[P*2]=Fe(P,5);ze=new he(de,B,R+1,y,F),_e=new he(ne,J,0,j,F),Me=new he(new Array(0),N,0,X,G)}function Qe(P){var Se;for(Se=0;Se<y;Se++)P.dyn_ltree[Se*2]=0;for(Se=0;Se<j;Se++)P.dyn_dtree[Se*2]=0;for(Se=0;Se<X;Se++)P.bl_tree[Se*2]=0;P.dyn_ltree[W*2]=1,P.opt_len=P.static_len=0,P.last_lit=P.matches=0}function ht(P){P.bi_valid>8?Ae(P,P.bi_buf):P.bi_valid>0&&(P.pending_buf[P.pending++]=P.bi_buf),P.bi_buf=0,P.bi_valid=0}function mt(P,Se,Ie,Ue){ht(P),Ae(P,Ie),Ae(P,~Ie),e.arraySet(P.pending_buf,P.window,Se,Ie,P.pending),P.pending+=Ie}function O(P,Se,Ie,Ue){var Q=Se*2,ue=Ie*2;return P[Q]<P[ue]||P[Q]===P[ue]&&Ue[Se]<=Ue[Ie]}function p(P,Se,Ie){for(var Ue=P.heap[Ie],Q=Ie<<1;Q<=P.heap_len&&(Q<P.heap_len&&O(Se,P.heap[Q+1],P.heap[Q],P.depth)&&Q++,!O(Se,Ue,P.heap[Q],P.depth));)P.heap[Ie]=P.heap[Q],Ie=Q,Q<<=1;P.heap[Ie]=Ue}function b(P,Se,Ie){var Ue,Q,ue=0,A,Ee;if(P.last_lit!==0)do Ue=P.pending_buf[P.d_buf+ue*2]<<8|P.pending_buf[P.d_buf+ue*2+1],Q=P.pending_buf[P.l_buf+ue],ue++,Ue===0?je(P,Q,Se):(A=ae[Q],je(P,A+R+1,Se),Ee=B[A],Ee!==0&&(Q-=ie[A],Oe(P,Q,Ee)),Ue--,A=ke(Ue),je(P,A,Ie),Ee=J[A],Ee!==0&&(Ue-=se[A],Oe(P,Ue,Ee)));while(ue<P.last_lit);je(P,W,Se)}function $(P,Se){var Ie=Se.dyn_tree,Ue=Se.stat_desc.static_tree,Q=Se.stat_desc.has_stree,ue=Se.stat_desc.elems,A,Ee,Xe=-1,m;for(P.heap_len=0,P.heap_max=L,A=0;A<ue;A++)Ie[A*2]!==0?(P.heap[++P.heap_len]=Xe=A,P.depth[A]=0):Ie[A*2+1]=0;for(;P.heap_len<2;)m=P.heap[++P.heap_len]=Xe<2?++Xe:0,Ie[m*2]=1,P.depth[m]=0,P.opt_len--,Q&&(P.static_len-=Ue[m*2+1]);for(Se.max_code=Xe,A=P.heap_len>>1;A>=1;A--)p(P,Ie,A);m=ue;do A=P.heap[1],P.heap[1]=P.heap[P.heap_len--],p(P,Ie,1),Ee=P.heap[1],P.heap[--P.heap_max]=A,P.heap[--P.heap_max]=Ee,Ie[m*2]=Ie[A*2]+Ie[Ee*2],P.depth[m]=(P.depth[A]>=P.depth[Ee]?P.depth[A]:P.depth[Ee])+1,Ie[A*2+1]=Ie[Ee*2+1]=m,P.heap[1]=m++,p(P,Ie,1);while(P.heap_len>=2);P.heap[--P.heap_max]=P.heap[1],Ye(P,Se),at(Ie,Xe,P.bl_count)}function re(P,Se,Ie){var Ue,Q=-1,ue,A=Se[1],Ee=0,Xe=7,m=4;for(A===0&&(Xe=138,m=3),Se[(Ie+1)*2+1]=65535,Ue=0;Ue<=Ie;Ue++)ue=A,A=Se[(Ue+1)*2+1],!(++Ee<Xe&&ue===A)&&(Ee<m?P.bl_tree[ue*2]+=Ee:ue!==0?(ue!==Q&&P.bl_tree[ue*2]++,P.bl_tree[te*2]++):Ee<=10?P.bl_tree[Z*2]++:P.bl_tree[z*2]++,Ee=0,Q=ue,A===0?(Xe=138,m=3):ue===A?(Xe=6,m=3):(Xe=7,m=4))}function be(P,Se,Ie){var Ue,Q=-1,ue,A=Se[1],Ee=0,Xe=7,m=4;for(A===0&&(Xe=138,m=3),Ue=0;Ue<=Ie;Ue++)if(ue=A,A=Se[(Ue+1)*2+1],!(++Ee<Xe&&ue===A)){if(Ee<m)do je(P,ue,P.bl_tree);while(--Ee!==0);else ue!==0?(ue!==Q&&(je(P,ue,P.bl_tree),Ee--),je(P,te,P.bl_tree),Oe(P,Ee-3,2)):Ee<=10?(je(P,Z,P.bl_tree),Oe(P,Ee-3,3)):(je(P,z,P.bl_tree),Oe(P,Ee-11,7));Ee=0,Q=ue,A===0?(Xe=138,m=3):ue===A?(Xe=6,m=3):(Xe=7,m=4)}}function xe(P){var Se;for(re(P,P.dyn_ltree,P.l_desc.max_code),re(P,P.dyn_dtree,P.d_desc.max_code),$(P,P.bl_desc),Se=X-1;Se>=3&&P.bl_tree[ce[Se]*2+1]===0;Se--);return P.opt_len+=3*(Se+1)+5+5+4,Se}function Je(P,Se,Ie,Ue){var Q;for(Oe(P,Se-257,5),Oe(P,Ie-1,5),Oe(P,Ue-4,4),Q=0;Q<Ue;Q++)Oe(P,P.bl_tree[ce[Q]*2+1],3);be(P,P.dyn_ltree,Se-1),be(P,P.dyn_dtree,Ie-1)}function tt(P){var Se=4093624447,Ie;for(Ie=0;Ie<=31;Ie++,Se>>>=1)if(Se&1&&P.dyn_ltree[Ie*2]!==0)return n;if(P.dyn_ltree[18]!==0||P.dyn_ltree[20]!==0||P.dyn_ltree[26]!==0)return s;for(Ie=32;Ie<R;Ie++)if(P.dyn_ltree[Ie*2]!==0)return s;return n}var it=!1;function ft(P){it||(Ze(),it=!0),P.l_desc=new q(P.dyn_ltree,ze),P.d_desc=new q(P.dyn_dtree,_e),P.bl_desc=new q(P.bl_tree,Me),P.bi_buf=0,P.bi_valid=0,Qe(P)}function st(P,Se,Ie,Ue){Oe(P,(g<<1)+(Ue?1:0),3),mt(P,Se,Ie)}function wt(P){Oe(P,d<<1,3),je(P,W,de),Ke(P)}function Lt(P,Se,Ie,Ue){var Q,ue,A=0;P.level>0?(P.strm.data_type===c&&(P.strm.data_type=tt(P)),$(P,P.l_desc),$(P,P.d_desc),A=xe(P),Q=P.opt_len+3+7>>>3,ue=P.static_len+3+7>>>3,ue<=Q&&(Q=ue)):Q=ue=Ie+5,Ie+4<=Q&&Se!==-1?st(P,Se,Ie,Ue):P.strategy===r||ue===Q?(Oe(P,(d<<1)+(Ue?1:0),3),b(P,de,ne)):(Oe(P,(h<<1)+(Ue?1:0),3),Je(P,P.l_desc.max_code+1,P.d_desc.max_code+1,A+1),b(P,P.dyn_ltree,P.dyn_dtree)),Qe(P),Ue&&ht(P)}function nr(P,Se,Ie){return P.pending_buf[P.d_buf+P.last_lit*2]=Se>>>8&255,P.pending_buf[P.d_buf+P.last_lit*2+1]=Se&255,P.pending_buf[P.l_buf+P.last_lit]=Ie&255,P.last_lit++,Se===0?P.dyn_ltree[Ie*2]++:(P.matches++,Se--,P.dyn_ltree[(ae[Ie]+R+1)*2]++,P.dyn_dtree[ke(Se)*2]++),P.last_lit===P.lit_bufsize-1}return Lr._tr_init=ft,Lr._tr_stored_block=st,Lr._tr_flush_block=Lt,Lr._tr_tally=nr,Lr._tr_align=wt,Lr}var Po,vf;function Wd(){if(vf)return Po;vf=1;function e(r,n,s,c){for(var u=r&65535|0,g=r>>>16&65535|0,d=0;s!==0;){d=s>2e3?2e3:s,s-=d;do u=u+n[c++]|0,g=g+u|0;while(--d);u%=65521,g%=65521}return u|g<<16|0}return Po=e,Po}var Mo,xf;function Vd(){if(xf)return Mo;xf=1;function e(){for(var s,c=[],u=0;u<256;u++){s=u;for(var g=0;g<8;g++)s=s&1?3988292384^s>>>1:s>>>1;c[u]=s}return c}var r=e();function n(s,c,u,g){var d=r,h=g+u;s^=-1;for(var S=g;S<h;S++)s=s>>>8^d[(s^c[S])&255];return s^-1}return Mo=n,Mo}var jo,_f;function Rs(){return _f||(_f=1,jo={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),jo}var Sf;function $w(){if(Sf)return sr;Sf=1;var e=Ir(),r=Lw(),n=Wd(),s=Vd(),c=Rs(),u=0,g=1,d=3,h=4,S=5,_=0,x=1,R=-2,y=-3,j=-5,X=-1,L=1,F=2,U=3,G=4,W=0,te=2,Z=8,z=9,B=15,J=8,N=29,ce=256,oe=ce+1+N,de=30,ne=19,me=2*oe+1,ae=15,ie=3,se=258,he=se+ie+1,ze=32,_e=42,Me=69,q=73,ke=91,Ae=103,Oe=113,je=666,Fe=1,Ke=2,Ye=3,at=4,Ze=3;function Qe(m,H){return m.msg=c[H],H}function ht(m){return(m<<1)-(m>4?9:0)}function mt(m){for(var H=m.length;--H>=0;)m[H]=0}function O(m){var H=m.state,pe=H.pending;pe>m.avail_out&&(pe=m.avail_out),pe!==0&&(e.arraySet(m.output,H.pending_buf,H.pending_out,pe,m.next_out),m.next_out+=pe,H.pending_out+=pe,m.total_out+=pe,m.avail_out-=pe,H.pending-=pe,H.pending===0&&(H.pending_out=0))}function p(m,H){r._tr_flush_block(m,m.block_start>=0?m.block_start:-1,m.strstart-m.block_start,H),m.block_start=m.strstart,O(m.strm)}function b(m,H){m.pending_buf[m.pending++]=H}function $(m,H){m.pending_buf[m.pending++]=H>>>8&255,m.pending_buf[m.pending++]=H&255}function re(m,H,pe,C){var K=m.avail_in;return K>C&&(K=C),K===0?0:(m.avail_in-=K,e.arraySet(H,m.input,m.next_in,K,pe),m.state.wrap===1?m.adler=n(m.adler,H,K,pe):m.state.wrap===2&&(m.adler=s(m.adler,H,K,pe)),m.next_in+=K,m.total_in+=K,K)}function be(m,H){var pe=m.max_chain_length,C=m.strstart,K,le,Ve=m.prev_length,Le=m.nice_match,Pe=m.strstart>m.w_size-he?m.strstart-(m.w_size-he):0,rt=m.window,Jt=m.w_mask,pt=m.prev,ot=m.strstart+se,bt=rt[C+Ve-1],Et=rt[C+Ve];m.prev_length>=m.good_match&&(pe>>=2),Le>m.lookahead&&(Le=m.lookahead);do if(K=H,!(rt[K+Ve]!==Et||rt[K+Ve-1]!==bt||rt[K]!==rt[C]||rt[++K]!==rt[C+1])){C+=2,K++;do;while(rt[++C]===rt[++K]&&rt[++C]===rt[++K]&&rt[++C]===rt[++K]&&rt[++C]===rt[++K]&&rt[++C]===rt[++K]&&rt[++C]===rt[++K]&&rt[++C]===rt[++K]&&rt[++C]===rt[++K]&&C<ot);if(le=se-(ot-C),C=ot-se,le>Ve){if(m.match_start=H,Ve=le,le>=Le)break;bt=rt[C+Ve-1],Et=rt[C+Ve]}}while((H=pt[H&Jt])>Pe&&--pe!==0);return Ve<=m.lookahead?Ve:m.lookahead}function xe(m){var H=m.w_size,pe,C,K,le,Ve;do{if(le=m.window_size-m.lookahead-m.strstart,m.strstart>=H+(H-he)){e.arraySet(m.window,m.window,H,H,0),m.match_start-=H,m.strstart-=H,m.block_start-=H,C=m.hash_size,pe=C;do K=m.head[--pe],m.head[pe]=K>=H?K-H:0;while(--C);C=H,pe=C;do K=m.prev[--pe],m.prev[pe]=K>=H?K-H:0;while(--C);le+=H}if(m.strm.avail_in===0)break;if(C=re(m.strm,m.window,m.strstart+m.lookahead,le),m.lookahead+=C,m.lookahead+m.insert>=ie)for(Ve=m.strstart-m.insert,m.ins_h=m.window[Ve],m.ins_h=(m.ins_h<<m.hash_shift^m.window[Ve+1])&m.hash_mask;m.insert&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[Ve+ie-1])&m.hash_mask,m.prev[Ve&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=Ve,Ve++,m.insert--,!(m.lookahead+m.insert<ie)););}while(m.lookahead<he&&m.strm.avail_in!==0)}function Je(m,H){var pe=65535;for(pe>m.pending_buf_size-5&&(pe=m.pending_buf_size-5);;){if(m.lookahead<=1){if(xe(m),m.lookahead===0&&H===u)return Fe;if(m.lookahead===0)break}m.strstart+=m.lookahead,m.lookahead=0;var C=m.block_start+pe;if((m.strstart===0||m.strstart>=C)&&(m.lookahead=m.strstart-C,m.strstart=C,p(m,!1),m.strm.avail_out===0)||m.strstart-m.block_start>=m.w_size-he&&(p(m,!1),m.strm.avail_out===0))return Fe}return m.insert=0,H===h?(p(m,!0),m.strm.avail_out===0?Ye:at):(m.strstart>m.block_start&&(p(m,!1),m.strm.avail_out===0),Fe)}function tt(m,H){for(var pe,C;;){if(m.lookahead<he){if(xe(m),m.lookahead<he&&H===u)return Fe;if(m.lookahead===0)break}if(pe=0,m.lookahead>=ie&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+ie-1])&m.hash_mask,pe=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),pe!==0&&m.strstart-pe<=m.w_size-he&&(m.match_length=be(m,pe)),m.match_length>=ie)if(C=r._tr_tally(m,m.strstart-m.match_start,m.match_length-ie),m.lookahead-=m.match_length,m.match_length<=m.max_lazy_match&&m.lookahead>=ie){m.match_length--;do m.strstart++,m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+ie-1])&m.hash_mask,pe=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart;while(--m.match_length!==0);m.strstart++}else m.strstart+=m.match_length,m.match_length=0,m.ins_h=m.window[m.strstart],m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+1])&m.hash_mask;else C=r._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++;if(C&&(p(m,!1),m.strm.avail_out===0))return Fe}return m.insert=m.strstart<ie-1?m.strstart:ie-1,H===h?(p(m,!0),m.strm.avail_out===0?Ye:at):m.last_lit&&(p(m,!1),m.strm.avail_out===0)?Fe:Ke}function it(m,H){for(var pe,C,K;;){if(m.lookahead<he){if(xe(m),m.lookahead<he&&H===u)return Fe;if(m.lookahead===0)break}if(pe=0,m.lookahead>=ie&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+ie-1])&m.hash_mask,pe=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),m.prev_length=m.match_length,m.prev_match=m.match_start,m.match_length=ie-1,pe!==0&&m.prev_length<m.max_lazy_match&&m.strstart-pe<=m.w_size-he&&(m.match_length=be(m,pe),m.match_length<=5&&(m.strategy===L||m.match_length===ie&&m.strstart-m.match_start>4096)&&(m.match_length=ie-1)),m.prev_length>=ie&&m.match_length<=m.prev_length){K=m.strstart+m.lookahead-ie,C=r._tr_tally(m,m.strstart-1-m.prev_match,m.prev_length-ie),m.lookahead-=m.prev_length-1,m.prev_length-=2;do++m.strstart<=K&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+ie-1])&m.hash_mask,pe=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart);while(--m.prev_length!==0);if(m.match_available=0,m.match_length=ie-1,m.strstart++,C&&(p(m,!1),m.strm.avail_out===0))return Fe}else if(m.match_available){if(C=r._tr_tally(m,0,m.window[m.strstart-1]),C&&p(m,!1),m.strstart++,m.lookahead--,m.strm.avail_out===0)return Fe}else m.match_available=1,m.strstart++,m.lookahead--}return m.match_available&&(C=r._tr_tally(m,0,m.window[m.strstart-1]),m.match_available=0),m.insert=m.strstart<ie-1?m.strstart:ie-1,H===h?(p(m,!0),m.strm.avail_out===0?Ye:at):m.last_lit&&(p(m,!1),m.strm.avail_out===0)?Fe:Ke}function ft(m,H){for(var pe,C,K,le,Ve=m.window;;){if(m.lookahead<=se){if(xe(m),m.lookahead<=se&&H===u)return Fe;if(m.lookahead===0)break}if(m.match_length=0,m.lookahead>=ie&&m.strstart>0&&(K=m.strstart-1,C=Ve[K],C===Ve[++K]&&C===Ve[++K]&&C===Ve[++K])){le=m.strstart+se;do;while(C===Ve[++K]&&C===Ve[++K]&&C===Ve[++K]&&C===Ve[++K]&&C===Ve[++K]&&C===Ve[++K]&&C===Ve[++K]&&C===Ve[++K]&&K<le);m.match_length=se-(le-K),m.match_length>m.lookahead&&(m.match_length=m.lookahead)}if(m.match_length>=ie?(pe=r._tr_tally(m,1,m.match_length-ie),m.lookahead-=m.match_length,m.strstart+=m.match_length,m.match_length=0):(pe=r._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++),pe&&(p(m,!1),m.strm.avail_out===0))return Fe}return m.insert=0,H===h?(p(m,!0),m.strm.avail_out===0?Ye:at):m.last_lit&&(p(m,!1),m.strm.avail_out===0)?Fe:Ke}function st(m,H){for(var pe;;){if(m.lookahead===0&&(xe(m),m.lookahead===0)){if(H===u)return Fe;break}if(m.match_length=0,pe=r._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++,pe&&(p(m,!1),m.strm.avail_out===0))return Fe}return m.insert=0,H===h?(p(m,!0),m.strm.avail_out===0?Ye:at):m.last_lit&&(p(m,!1),m.strm.avail_out===0)?Fe:Ke}function wt(m,H,pe,C,K){this.good_length=m,this.max_lazy=H,this.nice_length=pe,this.max_chain=C,this.func=K}var Lt;Lt=[new wt(0,0,0,0,Je),new wt(4,4,8,4,tt),new wt(4,5,16,8,tt),new wt(4,6,32,32,tt),new wt(4,4,16,16,it),new wt(8,16,32,32,it),new wt(8,16,128,128,it),new wt(8,32,128,256,it),new wt(32,128,258,1024,it),new wt(32,258,258,4096,it)];function nr(m){m.window_size=2*m.w_size,mt(m.head),m.max_lazy_match=Lt[m.level].max_lazy,m.good_match=Lt[m.level].good_length,m.nice_match=Lt[m.level].nice_length,m.max_chain_length=Lt[m.level].max_chain,m.strstart=0,m.block_start=0,m.lookahead=0,m.insert=0,m.match_length=m.prev_length=ie-1,m.match_available=0,m.ins_h=0}function P(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(me*2),this.dyn_dtree=new e.Buf16((2*de+1)*2),this.bl_tree=new e.Buf16((2*ne+1)*2),mt(this.dyn_ltree),mt(this.dyn_dtree),mt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(ae+1),this.heap=new e.Buf16(2*oe+1),mt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*oe+1),mt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Se(m){var H;return!m||!m.state?Qe(m,R):(m.total_in=m.total_out=0,m.data_type=te,H=m.state,H.pending=0,H.pending_out=0,H.wrap<0&&(H.wrap=-H.wrap),H.status=H.wrap?_e:Oe,m.adler=H.wrap===2?0:1,H.last_flush=u,r._tr_init(H),_)}function Ie(m){var H=Se(m);return H===_&&nr(m.state),H}function Ue(m,H){return!m||!m.state||m.state.wrap!==2?R:(m.state.gzhead=H,_)}function Q(m,H,pe,C,K,le){if(!m)return R;var Ve=1;if(H===X&&(H=6),C<0?(Ve=0,C=-C):C>15&&(Ve=2,C-=16),K<1||K>z||pe!==Z||C<8||C>15||H<0||H>9||le<0||le>G)return Qe(m,R);C===8&&(C=9);var Le=new P;return m.state=Le,Le.strm=m,Le.wrap=Ve,Le.gzhead=null,Le.w_bits=C,Le.w_size=1<<Le.w_bits,Le.w_mask=Le.w_size-1,Le.hash_bits=K+7,Le.hash_size=1<<Le.hash_bits,Le.hash_mask=Le.hash_size-1,Le.hash_shift=~~((Le.hash_bits+ie-1)/ie),Le.window=new e.Buf8(Le.w_size*2),Le.head=new e.Buf16(Le.hash_size),Le.prev=new e.Buf16(Le.w_size),Le.lit_bufsize=1<<K+6,Le.pending_buf_size=Le.lit_bufsize*4,Le.pending_buf=new e.Buf8(Le.pending_buf_size),Le.d_buf=1*Le.lit_bufsize,Le.l_buf=3*Le.lit_bufsize,Le.level=H,Le.strategy=le,Le.method=pe,Ie(m)}function ue(m,H){return Q(m,H,Z,B,J,W)}function A(m,H){var pe,C,K,le;if(!m||!m.state||H>S||H<0)return m?Qe(m,R):R;if(C=m.state,!m.output||!m.input&&m.avail_in!==0||C.status===je&&H!==h)return Qe(m,m.avail_out===0?j:R);if(C.strm=m,pe=C.last_flush,C.last_flush=H,C.status===_e)if(C.wrap===2)m.adler=0,b(C,31),b(C,139),b(C,8),C.gzhead?(b(C,(C.gzhead.text?1:0)+(C.gzhead.hcrc?2:0)+(C.gzhead.extra?4:0)+(C.gzhead.name?8:0)+(C.gzhead.comment?16:0)),b(C,C.gzhead.time&255),b(C,C.gzhead.time>>8&255),b(C,C.gzhead.time>>16&255),b(C,C.gzhead.time>>24&255),b(C,C.level===9?2:C.strategy>=F||C.level<2?4:0),b(C,C.gzhead.os&255),C.gzhead.extra&&C.gzhead.extra.length&&(b(C,C.gzhead.extra.length&255),b(C,C.gzhead.extra.length>>8&255)),C.gzhead.hcrc&&(m.adler=s(m.adler,C.pending_buf,C.pending,0)),C.gzindex=0,C.status=Me):(b(C,0),b(C,0),b(C,0),b(C,0),b(C,0),b(C,C.level===9?2:C.strategy>=F||C.level<2?4:0),b(C,Ze),C.status=Oe);else{var Ve=Z+(C.w_bits-8<<4)<<8,Le=-1;C.strategy>=F||C.level<2?Le=0:C.level<6?Le=1:C.level===6?Le=2:Le=3,Ve|=Le<<6,C.strstart!==0&&(Ve|=ze),Ve+=31-Ve%31,C.status=Oe,$(C,Ve),C.strstart!==0&&($(C,m.adler>>>16),$(C,m.adler&65535)),m.adler=1}if(C.status===Me)if(C.gzhead.extra){for(K=C.pending;C.gzindex<(C.gzhead.extra.length&65535)&&!(C.pending===C.pending_buf_size&&(C.gzhead.hcrc&&C.pending>K&&(m.adler=s(m.adler,C.pending_buf,C.pending-K,K)),O(m),K=C.pending,C.pending===C.pending_buf_size));)b(C,C.gzhead.extra[C.gzindex]&255),C.gzindex++;C.gzhead.hcrc&&C.pending>K&&(m.adler=s(m.adler,C.pending_buf,C.pending-K,K)),C.gzindex===C.gzhead.extra.length&&(C.gzindex=0,C.status=q)}else C.status=q;if(C.status===q)if(C.gzhead.name){K=C.pending;do{if(C.pending===C.pending_buf_size&&(C.gzhead.hcrc&&C.pending>K&&(m.adler=s(m.adler,C.pending_buf,C.pending-K,K)),O(m),K=C.pending,C.pending===C.pending_buf_size)){le=1;break}C.gzindex<C.gzhead.name.length?le=C.gzhead.name.charCodeAt(C.gzindex++)&255:le=0,b(C,le)}while(le!==0);C.gzhead.hcrc&&C.pending>K&&(m.adler=s(m.adler,C.pending_buf,C.pending-K,K)),le===0&&(C.gzindex=0,C.status=ke)}else C.status=ke;if(C.status===ke)if(C.gzhead.comment){K=C.pending;do{if(C.pending===C.pending_buf_size&&(C.gzhead.hcrc&&C.pending>K&&(m.adler=s(m.adler,C.pending_buf,C.pending-K,K)),O(m),K=C.pending,C.pending===C.pending_buf_size)){le=1;break}C.gzindex<C.gzhead.comment.length?le=C.gzhead.comment.charCodeAt(C.gzindex++)&255:le=0,b(C,le)}while(le!==0);C.gzhead.hcrc&&C.pending>K&&(m.adler=s(m.adler,C.pending_buf,C.pending-K,K)),le===0&&(C.status=Ae)}else C.status=Ae;if(C.status===Ae&&(C.gzhead.hcrc?(C.pending+2>C.pending_buf_size&&O(m),C.pending+2<=C.pending_buf_size&&(b(C,m.adler&255),b(C,m.adler>>8&255),m.adler=0,C.status=Oe)):C.status=Oe),C.pending!==0){if(O(m),m.avail_out===0)return C.last_flush=-1,_}else if(m.avail_in===0&&ht(H)<=ht(pe)&&H!==h)return Qe(m,j);if(C.status===je&&m.avail_in!==0)return Qe(m,j);if(m.avail_in!==0||C.lookahead!==0||H!==u&&C.status!==je){var Pe=C.strategy===F?st(C,H):C.strategy===U?ft(C,H):Lt[C.level].func(C,H);if((Pe===Ye||Pe===at)&&(C.status=je),Pe===Fe||Pe===Ye)return m.avail_out===0&&(C.last_flush=-1),_;if(Pe===Ke&&(H===g?r._tr_align(C):H!==S&&(r._tr_stored_block(C,0,0,!1),H===d&&(mt(C.head),C.lookahead===0&&(C.strstart=0,C.block_start=0,C.insert=0))),O(m),m.avail_out===0))return C.last_flush=-1,_}return H!==h?_:C.wrap<=0?x:(C.wrap===2?(b(C,m.adler&255),b(C,m.adler>>8&255),b(C,m.adler>>16&255),b(C,m.adler>>24&255),b(C,m.total_in&255),b(C,m.total_in>>8&255),b(C,m.total_in>>16&255),b(C,m.total_in>>24&255)):($(C,m.adler>>>16),$(C,m.adler&65535)),O(m),C.wrap>0&&(C.wrap=-C.wrap),C.pending!==0?_:x)}function Ee(m){var H;return!m||!m.state?R:(H=m.state.status,H!==_e&&H!==Me&&H!==q&&H!==ke&&H!==Ae&&H!==Oe&&H!==je?Qe(m,R):(m.state=null,H===Oe?Qe(m,y):_))}function Xe(m,H){var pe=H.length,C,K,le,Ve,Le,Pe,rt,Jt;if(!m||!m.state||(C=m.state,Ve=C.wrap,Ve===2||Ve===1&&C.status!==_e||C.lookahead))return R;for(Ve===1&&(m.adler=n(m.adler,H,pe,0)),C.wrap=0,pe>=C.w_size&&(Ve===0&&(mt(C.head),C.strstart=0,C.block_start=0,C.insert=0),Jt=new e.Buf8(C.w_size),e.arraySet(Jt,H,pe-C.w_size,C.w_size,0),H=Jt,pe=C.w_size),Le=m.avail_in,Pe=m.next_in,rt=m.input,m.avail_in=pe,m.next_in=0,m.input=H,xe(C);C.lookahead>=ie;){K=C.strstart,le=C.lookahead-(ie-1);do C.ins_h=(C.ins_h<<C.hash_shift^C.window[K+ie-1])&C.hash_mask,C.prev[K&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=K,K++;while(--le);C.strstart=K,C.lookahead=ie-1,xe(C)}return C.strstart+=C.lookahead,C.block_start=C.strstart,C.insert=C.lookahead,C.lookahead=0,C.match_length=C.prev_length=ie-1,C.match_available=0,m.next_in=Pe,m.input=rt,m.avail_in=Le,C.wrap=Ve,_}return sr.deflateInit=ue,sr.deflateInit2=Q,sr.deflateReset=Ie,sr.deflateResetKeep=Se,sr.deflateSetHeader=Ue,sr.deflate=A,sr.deflateEnd=Ee,sr.deflateSetDictionary=Xe,sr.deflateInfo="pako deflate (from Nodeca project)",sr}var $r={},kf;function Zd(){if(kf)return $r;kf=1;var e=Ir(),r=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var s=new e.Buf8(256),c=0;c<256;c++)s[c]=c>=252?6:c>=248?5:c>=240?4:c>=224?3:c>=192?2:1;s[254]=s[254]=1,$r.string2buf=function(g){var d,h,S,_,x,R=g.length,y=0;for(_=0;_<R;_++)h=g.charCodeAt(_),(h&64512)===55296&&_+1<R&&(S=g.charCodeAt(_+1),(S&64512)===56320&&(h=65536+(h-55296<<10)+(S-56320),_++)),y+=h<128?1:h<2048?2:h<65536?3:4;for(d=new e.Buf8(y),x=0,_=0;x<y;_++)h=g.charCodeAt(_),(h&64512)===55296&&_+1<R&&(S=g.charCodeAt(_+1),(S&64512)===56320&&(h=65536+(h-55296<<10)+(S-56320),_++)),h<128?d[x++]=h:h<2048?(d[x++]=192|h>>>6,d[x++]=128|h&63):h<65536?(d[x++]=224|h>>>12,d[x++]=128|h>>>6&63,d[x++]=128|h&63):(d[x++]=240|h>>>18,d[x++]=128|h>>>12&63,d[x++]=128|h>>>6&63,d[x++]=128|h&63);return d};function u(g,d){if(d<65534&&(g.subarray&&n||!g.subarray&&r))return String.fromCharCode.apply(null,e.shrinkBuf(g,d));for(var h="",S=0;S<d;S++)h+=String.fromCharCode(g[S]);return h}return $r.buf2binstring=function(g){return u(g,g.length)},$r.binstring2buf=function(g){for(var d=new e.Buf8(g.length),h=0,S=d.length;h<S;h++)d[h]=g.charCodeAt(h);return d},$r.buf2string=function(g,d){var h,S,_,x,R=d||g.length,y=new Array(R*2);for(S=0,h=0;h<R;){if(_=g[h++],_<128){y[S++]=_;continue}if(x=s[_],x>4){y[S++]=65533,h+=x-1;continue}for(_&=x===2?31:x===3?15:7;x>1&&h<R;)_=_<<6|g[h++]&63,x--;if(x>1){y[S++]=65533;continue}_<65536?y[S++]=_:(_-=65536,y[S++]=55296|_>>10&1023,y[S++]=56320|_&1023)}return u(y,S)},$r.utf8border=function(g,d){var h;for(d=d||g.length,d>g.length&&(d=g.length),h=d-1;h>=0&&(g[h]&192)===128;)h--;return h<0||h===0?d:h+s[g[h]]>d?h:d},$r}var Bo,Ef;function Kd(){if(Ef)return Bo;Ef=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return Bo=e,Bo}var Af;function Nw(){if(Af)return an;Af=1;var e=$w(),r=Ir(),n=Zd(),s=Rs(),c=Kd(),u=Object.prototype.toString,g=0,d=4,h=0,S=1,_=2,x=-1,R=0,y=8;function j(U){if(!(this instanceof j))return new j(U);this.options=r.assign({level:x,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:R,to:""},U||{});var G=this.options;G.raw&&G.windowBits>0?G.windowBits=-G.windowBits:G.gzip&&G.windowBits>0&&G.windowBits<16&&(G.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var W=e.deflateInit2(this.strm,G.level,G.method,G.windowBits,G.memLevel,G.strategy);if(W!==h)throw new Error(s[W]);if(G.header&&e.deflateSetHeader(this.strm,G.header),G.dictionary){var te;if(typeof G.dictionary=="string"?te=n.string2buf(G.dictionary):u.call(G.dictionary)==="[object ArrayBuffer]"?te=new Uint8Array(G.dictionary):te=G.dictionary,W=e.deflateSetDictionary(this.strm,te),W!==h)throw new Error(s[W]);this._dict_set=!0}}j.prototype.push=function(U,G){var W=this.strm,te=this.options.chunkSize,Z,z;if(this.ended)return!1;z=G===~~G?G:G===!0?d:g,typeof U=="string"?W.input=n.string2buf(U):u.call(U)==="[object ArrayBuffer]"?W.input=new Uint8Array(U):W.input=U,W.next_in=0,W.avail_in=W.input.length;do{if(W.avail_out===0&&(W.output=new r.Buf8(te),W.next_out=0,W.avail_out=te),Z=e.deflate(W,z),Z!==S&&Z!==h)return this.onEnd(Z),this.ended=!0,!1;(W.avail_out===0||W.avail_in===0&&(z===d||z===_))&&(this.options.to==="string"?this.onData(n.buf2binstring(r.shrinkBuf(W.output,W.next_out))):this.onData(r.shrinkBuf(W.output,W.next_out)))}while((W.avail_in>0||W.avail_out===0)&&Z!==S);return z===d?(Z=e.deflateEnd(this.strm),this.onEnd(Z),this.ended=!0,Z===h):(z===_&&(this.onEnd(h),W.avail_out=0),!0)},j.prototype.onData=function(U){this.chunks.push(U)},j.prototype.onEnd=function(U){U===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=U,this.msg=this.strm.msg};function X(U,G){var W=new j(G);if(W.push(U,!0),W.err)throw W.msg||s[W.err];return W.result}function L(U,G){return G=G||{},G.raw=!0,X(U,G)}function F(U,G){return G=G||{},G.gzip=!0,X(U,G)}return an.Deflate=j,an.deflate=X,an.deflateRaw=L,an.gzip=F,an}var on={},rr={},Fo,If;function Uw(){if(If)return Fo;If=1;var e=30,r=12;return Fo=function(s,c){var u,g,d,h,S,_,x,R,y,j,X,L,F,U,G,W,te,Z,z,B,J,N,ce,oe,de;u=s.state,g=s.next_in,oe=s.input,d=g+(s.avail_in-5),h=s.next_out,de=s.output,S=h-(c-s.avail_out),_=h+(s.avail_out-257),x=u.dmax,R=u.wsize,y=u.whave,j=u.wnext,X=u.window,L=u.hold,F=u.bits,U=u.lencode,G=u.distcode,W=(1<<u.lenbits)-1,te=(1<<u.distbits)-1;e:do{F<15&&(L+=oe[g++]<<F,F+=8,L+=oe[g++]<<F,F+=8),Z=U[L&W];t:for(;;){if(z=Z>>>24,L>>>=z,F-=z,z=Z>>>16&255,z===0)de[h++]=Z&65535;else if(z&16){B=Z&65535,z&=15,z&&(F<z&&(L+=oe[g++]<<F,F+=8),B+=L&(1<<z)-1,L>>>=z,F-=z),F<15&&(L+=oe[g++]<<F,F+=8,L+=oe[g++]<<F,F+=8),Z=G[L&te];r:for(;;){if(z=Z>>>24,L>>>=z,F-=z,z=Z>>>16&255,z&16){if(J=Z&65535,z&=15,F<z&&(L+=oe[g++]<<F,F+=8,F<z&&(L+=oe[g++]<<F,F+=8)),J+=L&(1<<z)-1,J>x){s.msg="invalid distance too far back",u.mode=e;break e}if(L>>>=z,F-=z,z=h-S,J>z){if(z=J-z,z>y&&u.sane){s.msg="invalid distance too far back",u.mode=e;break e}if(N=0,ce=X,j===0){if(N+=R-z,z<B){B-=z;do de[h++]=X[N++];while(--z);N=h-J,ce=de}}else if(j<z){if(N+=R+j-z,z-=j,z<B){B-=z;do de[h++]=X[N++];while(--z);if(N=0,j<B){z=j,B-=z;do de[h++]=X[N++];while(--z);N=h-J,ce=de}}}else if(N+=j-z,z<B){B-=z;do de[h++]=X[N++];while(--z);N=h-J,ce=de}for(;B>2;)de[h++]=ce[N++],de[h++]=ce[N++],de[h++]=ce[N++],B-=3;B&&(de[h++]=ce[N++],B>1&&(de[h++]=ce[N++]))}else{N=h-J;do de[h++]=de[N++],de[h++]=de[N++],de[h++]=de[N++],B-=3;while(B>2);B&&(de[h++]=de[N++],B>1&&(de[h++]=de[N++]))}}else if((z&64)===0){Z=G[(Z&65535)+(L&(1<<z)-1)];continue r}else{s.msg="invalid distance code",u.mode=e;break e}break}}else if((z&64)===0){Z=U[(Z&65535)+(L&(1<<z)-1)];continue t}else if(z&32){u.mode=r;break e}else{s.msg="invalid literal/length code",u.mode=e;break e}break}}while(g<d&&h<_);B=F>>3,g-=B,F-=B<<3,L&=(1<<F)-1,s.next_in=g,s.next_out=h,s.avail_in=g<d?5+(d-g):5-(g-d),s.avail_out=h<_?257+(_-h):257-(h-_),u.hold=L,u.bits=F},Fo}var Do,Cf;function zw(){if(Cf)return Do;Cf=1;var e=Ir(),r=15,n=852,s=592,c=0,u=1,g=2,d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],h=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],_=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return Do=function(R,y,j,X,L,F,U,G){var W=G.bits,te=0,Z=0,z=0,B=0,J=0,N=0,ce=0,oe=0,de=0,ne=0,me,ae,ie,se,he,ze=null,_e=0,Me,q=new e.Buf16(r+1),ke=new e.Buf16(r+1),Ae=null,Oe=0,je,Fe,Ke;for(te=0;te<=r;te++)q[te]=0;for(Z=0;Z<X;Z++)q[y[j+Z]]++;for(J=W,B=r;B>=1&&q[B]===0;B--);if(J>B&&(J=B),B===0)return L[F++]=1<<24|64<<16|0,L[F++]=1<<24|64<<16|0,G.bits=1,0;for(z=1;z<B&&q[z]===0;z++);for(J<z&&(J=z),oe=1,te=1;te<=r;te++)if(oe<<=1,oe-=q[te],oe<0)return-1;if(oe>0&&(R===c||B!==1))return-1;for(ke[1]=0,te=1;te<r;te++)ke[te+1]=ke[te]+q[te];for(Z=0;Z<X;Z++)y[j+Z]!==0&&(U[ke[y[j+Z]]++]=Z);if(R===c?(ze=Ae=U,Me=19):R===u?(ze=d,_e-=257,Ae=h,Oe-=257,Me=256):(ze=S,Ae=_,Me=-1),ne=0,Z=0,te=z,he=F,N=J,ce=0,ie=-1,de=1<<J,se=de-1,R===u&&de>n||R===g&&de>s)return 1;for(;;){je=te-ce,U[Z]<Me?(Fe=0,Ke=U[Z]):U[Z]>Me?(Fe=Ae[Oe+U[Z]],Ke=ze[_e+U[Z]]):(Fe=96,Ke=0),me=1<<te-ce,ae=1<<N,z=ae;do ae-=me,L[he+(ne>>ce)+ae]=je<<24|Fe<<16|Ke|0;while(ae!==0);for(me=1<<te-1;ne&me;)me>>=1;if(me!==0?(ne&=me-1,ne+=me):ne=0,Z++,--q[te]===0){if(te===B)break;te=y[j+U[Z]]}if(te>J&&(ne&se)!==ie){for(ce===0&&(ce=J),he+=z,N=te-ce,oe=1<<N;N+ce<B&&(oe-=q[N+ce],!(oe<=0));)N++,oe<<=1;if(de+=1<<N,R===u&&de>n||R===g&&de>s)return 1;ie=ne&se,L[ie]=J<<24|N<<16|he-F|0}}return ne!==0&&(L[he+ne]=te-ce<<24|64<<16|0),G.bits=J,0},Do}var Tf;function Gw(){if(Tf)return rr;Tf=1;var e=Ir(),r=Wd(),n=Vd(),s=Uw(),c=zw(),u=0,g=1,d=2,h=4,S=5,_=6,x=0,R=1,y=2,j=-2,X=-3,L=-4,F=-5,U=8,G=1,W=2,te=3,Z=4,z=5,B=6,J=7,N=8,ce=9,oe=10,de=11,ne=12,me=13,ae=14,ie=15,se=16,he=17,ze=18,_e=19,Me=20,q=21,ke=22,Ae=23,Oe=24,je=25,Fe=26,Ke=27,Ye=28,at=29,Ze=30,Qe=31,ht=32,mt=852,O=592,p=15,b=p;function $(Q){return(Q>>>24&255)+(Q>>>8&65280)+((Q&65280)<<8)+((Q&255)<<24)}function re(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function be(Q){var ue;return!Q||!Q.state?j:(ue=Q.state,Q.total_in=Q.total_out=ue.total=0,Q.msg="",ue.wrap&&(Q.adler=ue.wrap&1),ue.mode=G,ue.last=0,ue.havedict=0,ue.dmax=32768,ue.head=null,ue.hold=0,ue.bits=0,ue.lencode=ue.lendyn=new e.Buf32(mt),ue.distcode=ue.distdyn=new e.Buf32(O),ue.sane=1,ue.back=-1,x)}function xe(Q){var ue;return!Q||!Q.state?j:(ue=Q.state,ue.wsize=0,ue.whave=0,ue.wnext=0,be(Q))}function Je(Q,ue){var A,Ee;return!Q||!Q.state||(Ee=Q.state,ue<0?(A=0,ue=-ue):(A=(ue>>4)+1,ue<48&&(ue&=15)),ue&&(ue<8||ue>15))?j:(Ee.window!==null&&Ee.wbits!==ue&&(Ee.window=null),Ee.wrap=A,Ee.wbits=ue,xe(Q))}function tt(Q,ue){var A,Ee;return Q?(Ee=new re,Q.state=Ee,Ee.window=null,A=Je(Q,ue),A!==x&&(Q.state=null),A):j}function it(Q){return tt(Q,b)}var ft=!0,st,wt;function Lt(Q){if(ft){var ue;for(st=new e.Buf32(512),wt=new e.Buf32(32),ue=0;ue<144;)Q.lens[ue++]=8;for(;ue<256;)Q.lens[ue++]=9;for(;ue<280;)Q.lens[ue++]=7;for(;ue<288;)Q.lens[ue++]=8;for(c(g,Q.lens,0,288,st,0,Q.work,{bits:9}),ue=0;ue<32;)Q.lens[ue++]=5;c(d,Q.lens,0,32,wt,0,Q.work,{bits:5}),ft=!1}Q.lencode=st,Q.lenbits=9,Q.distcode=wt,Q.distbits=5}function nr(Q,ue,A,Ee){var Xe,m=Q.state;return m.window===null&&(m.wsize=1<<m.wbits,m.wnext=0,m.whave=0,m.window=new e.Buf8(m.wsize)),Ee>=m.wsize?(e.arraySet(m.window,ue,A-m.wsize,m.wsize,0),m.wnext=0,m.whave=m.wsize):(Xe=m.wsize-m.wnext,Xe>Ee&&(Xe=Ee),e.arraySet(m.window,ue,A-Ee,Xe,m.wnext),Ee-=Xe,Ee?(e.arraySet(m.window,ue,A-Ee,Ee,0),m.wnext=Ee,m.whave=m.wsize):(m.wnext+=Xe,m.wnext===m.wsize&&(m.wnext=0),m.whave<m.wsize&&(m.whave+=Xe))),0}function P(Q,ue){var A,Ee,Xe,m,H,pe,C,K,le,Ve,Le,Pe,rt,Jt,pt=0,ot,bt,Et,$t,Cr,Tr,vt,Ht,At=new e.Buf8(4),Qt,er,ii=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Q||!Q.state||!Q.output||!Q.input&&Q.avail_in!==0)return j;A=Q.state,A.mode===ne&&(A.mode=me),H=Q.next_out,Xe=Q.output,C=Q.avail_out,m=Q.next_in,Ee=Q.input,pe=Q.avail_in,K=A.hold,le=A.bits,Ve=pe,Le=C,Ht=x;e:for(;;)switch(A.mode){case G:if(A.wrap===0){A.mode=me;break}for(;le<16;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}if(A.wrap&2&&K===35615){A.check=0,At[0]=K&255,At[1]=K>>>8&255,A.check=n(A.check,At,2,0),K=0,le=0,A.mode=W;break}if(A.flags=0,A.head&&(A.head.done=!1),!(A.wrap&1)||(((K&255)<<8)+(K>>8))%31){Q.msg="incorrect header check",A.mode=Ze;break}if((K&15)!==U){Q.msg="unknown compression method",A.mode=Ze;break}if(K>>>=4,le-=4,vt=(K&15)+8,A.wbits===0)A.wbits=vt;else if(vt>A.wbits){Q.msg="invalid window size",A.mode=Ze;break}A.dmax=1<<vt,Q.adler=A.check=1,A.mode=K&512?oe:ne,K=0,le=0;break;case W:for(;le<16;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}if(A.flags=K,(A.flags&255)!==U){Q.msg="unknown compression method",A.mode=Ze;break}if(A.flags&57344){Q.msg="unknown header flags set",A.mode=Ze;break}A.head&&(A.head.text=K>>8&1),A.flags&512&&(At[0]=K&255,At[1]=K>>>8&255,A.check=n(A.check,At,2,0)),K=0,le=0,A.mode=te;case te:for(;le<32;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}A.head&&(A.head.time=K),A.flags&512&&(At[0]=K&255,At[1]=K>>>8&255,At[2]=K>>>16&255,At[3]=K>>>24&255,A.check=n(A.check,At,4,0)),K=0,le=0,A.mode=Z;case Z:for(;le<16;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}A.head&&(A.head.xflags=K&255,A.head.os=K>>8),A.flags&512&&(At[0]=K&255,At[1]=K>>>8&255,A.check=n(A.check,At,2,0)),K=0,le=0,A.mode=z;case z:if(A.flags&1024){for(;le<16;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}A.length=K,A.head&&(A.head.extra_len=K),A.flags&512&&(At[0]=K&255,At[1]=K>>>8&255,A.check=n(A.check,At,2,0)),K=0,le=0}else A.head&&(A.head.extra=null);A.mode=B;case B:if(A.flags&1024&&(Pe=A.length,Pe>pe&&(Pe=pe),Pe&&(A.head&&(vt=A.head.extra_len-A.length,A.head.extra||(A.head.extra=new Array(A.head.extra_len)),e.arraySet(A.head.extra,Ee,m,Pe,vt)),A.flags&512&&(A.check=n(A.check,Ee,Pe,m)),pe-=Pe,m+=Pe,A.length-=Pe),A.length))break e;A.length=0,A.mode=J;case J:if(A.flags&2048){if(pe===0)break e;Pe=0;do vt=Ee[m+Pe++],A.head&&vt&&A.length<65536&&(A.head.name+=String.fromCharCode(vt));while(vt&&Pe<pe);if(A.flags&512&&(A.check=n(A.check,Ee,Pe,m)),pe-=Pe,m+=Pe,vt)break e}else A.head&&(A.head.name=null);A.length=0,A.mode=N;case N:if(A.flags&4096){if(pe===0)break e;Pe=0;do vt=Ee[m+Pe++],A.head&&vt&&A.length<65536&&(A.head.comment+=String.fromCharCode(vt));while(vt&&Pe<pe);if(A.flags&512&&(A.check=n(A.check,Ee,Pe,m)),pe-=Pe,m+=Pe,vt)break e}else A.head&&(A.head.comment=null);A.mode=ce;case ce:if(A.flags&512){for(;le<16;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}if(K!==(A.check&65535)){Q.msg="header crc mismatch",A.mode=Ze;break}K=0,le=0}A.head&&(A.head.hcrc=A.flags>>9&1,A.head.done=!0),Q.adler=A.check=0,A.mode=ne;break;case oe:for(;le<32;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}Q.adler=A.check=$(K),K=0,le=0,A.mode=de;case de:if(A.havedict===0)return Q.next_out=H,Q.avail_out=C,Q.next_in=m,Q.avail_in=pe,A.hold=K,A.bits=le,y;Q.adler=A.check=1,A.mode=ne;case ne:if(ue===S||ue===_)break e;case me:if(A.last){K>>>=le&7,le-=le&7,A.mode=Ke;break}for(;le<3;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}switch(A.last=K&1,K>>>=1,le-=1,K&3){case 0:A.mode=ae;break;case 1:if(Lt(A),A.mode=Me,ue===_){K>>>=2,le-=2;break e}break;case 2:A.mode=he;break;case 3:Q.msg="invalid block type",A.mode=Ze}K>>>=2,le-=2;break;case ae:for(K>>>=le&7,le-=le&7;le<32;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}if((K&65535)!==(K>>>16^65535)){Q.msg="invalid stored block lengths",A.mode=Ze;break}if(A.length=K&65535,K=0,le=0,A.mode=ie,ue===_)break e;case ie:A.mode=se;case se:if(Pe=A.length,Pe){if(Pe>pe&&(Pe=pe),Pe>C&&(Pe=C),Pe===0)break e;e.arraySet(Xe,Ee,m,Pe,H),pe-=Pe,m+=Pe,C-=Pe,H+=Pe,A.length-=Pe;break}A.mode=ne;break;case he:for(;le<14;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}if(A.nlen=(K&31)+257,K>>>=5,le-=5,A.ndist=(K&31)+1,K>>>=5,le-=5,A.ncode=(K&15)+4,K>>>=4,le-=4,A.nlen>286||A.ndist>30){Q.msg="too many length or distance symbols",A.mode=Ze;break}A.have=0,A.mode=ze;case ze:for(;A.have<A.ncode;){for(;le<3;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}A.lens[ii[A.have++]]=K&7,K>>>=3,le-=3}for(;A.have<19;)A.lens[ii[A.have++]]=0;if(A.lencode=A.lendyn,A.lenbits=7,Qt={bits:A.lenbits},Ht=c(u,A.lens,0,19,A.lencode,0,A.work,Qt),A.lenbits=Qt.bits,Ht){Q.msg="invalid code lengths set",A.mode=Ze;break}A.have=0,A.mode=_e;case _e:for(;A.have<A.nlen+A.ndist;){for(;pt=A.lencode[K&(1<<A.lenbits)-1],ot=pt>>>24,bt=pt>>>16&255,Et=pt&65535,!(ot<=le);){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}if(Et<16)K>>>=ot,le-=ot,A.lens[A.have++]=Et;else{if(Et===16){for(er=ot+2;le<er;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}if(K>>>=ot,le-=ot,A.have===0){Q.msg="invalid bit length repeat",A.mode=Ze;break}vt=A.lens[A.have-1],Pe=3+(K&3),K>>>=2,le-=2}else if(Et===17){for(er=ot+3;le<er;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}K>>>=ot,le-=ot,vt=0,Pe=3+(K&7),K>>>=3,le-=3}else{for(er=ot+7;le<er;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}K>>>=ot,le-=ot,vt=0,Pe=11+(K&127),K>>>=7,le-=7}if(A.have+Pe>A.nlen+A.ndist){Q.msg="invalid bit length repeat",A.mode=Ze;break}for(;Pe--;)A.lens[A.have++]=vt}}if(A.mode===Ze)break;if(A.lens[256]===0){Q.msg="invalid code -- missing end-of-block",A.mode=Ze;break}if(A.lenbits=9,Qt={bits:A.lenbits},Ht=c(g,A.lens,0,A.nlen,A.lencode,0,A.work,Qt),A.lenbits=Qt.bits,Ht){Q.msg="invalid literal/lengths set",A.mode=Ze;break}if(A.distbits=6,A.distcode=A.distdyn,Qt={bits:A.distbits},Ht=c(d,A.lens,A.nlen,A.ndist,A.distcode,0,A.work,Qt),A.distbits=Qt.bits,Ht){Q.msg="invalid distances set",A.mode=Ze;break}if(A.mode=Me,ue===_)break e;case Me:A.mode=q;case q:if(pe>=6&&C>=258){Q.next_out=H,Q.avail_out=C,Q.next_in=m,Q.avail_in=pe,A.hold=K,A.bits=le,s(Q,Le),H=Q.next_out,Xe=Q.output,C=Q.avail_out,m=Q.next_in,Ee=Q.input,pe=Q.avail_in,K=A.hold,le=A.bits,A.mode===ne&&(A.back=-1);break}for(A.back=0;pt=A.lencode[K&(1<<A.lenbits)-1],ot=pt>>>24,bt=pt>>>16&255,Et=pt&65535,!(ot<=le);){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}if(bt&&(bt&240)===0){for($t=ot,Cr=bt,Tr=Et;pt=A.lencode[Tr+((K&(1<<$t+Cr)-1)>>$t)],ot=pt>>>24,bt=pt>>>16&255,Et=pt&65535,!($t+ot<=le);){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}K>>>=$t,le-=$t,A.back+=$t}if(K>>>=ot,le-=ot,A.back+=ot,A.length=Et,bt===0){A.mode=Fe;break}if(bt&32){A.back=-1,A.mode=ne;break}if(bt&64){Q.msg="invalid literal/length code",A.mode=Ze;break}A.extra=bt&15,A.mode=ke;case ke:if(A.extra){for(er=A.extra;le<er;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}A.length+=K&(1<<A.extra)-1,K>>>=A.extra,le-=A.extra,A.back+=A.extra}A.was=A.length,A.mode=Ae;case Ae:for(;pt=A.distcode[K&(1<<A.distbits)-1],ot=pt>>>24,bt=pt>>>16&255,Et=pt&65535,!(ot<=le);){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}if((bt&240)===0){for($t=ot,Cr=bt,Tr=Et;pt=A.distcode[Tr+((K&(1<<$t+Cr)-1)>>$t)],ot=pt>>>24,bt=pt>>>16&255,Et=pt&65535,!($t+ot<=le);){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}K>>>=$t,le-=$t,A.back+=$t}if(K>>>=ot,le-=ot,A.back+=ot,bt&64){Q.msg="invalid distance code",A.mode=Ze;break}A.offset=Et,A.extra=bt&15,A.mode=Oe;case Oe:if(A.extra){for(er=A.extra;le<er;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}A.offset+=K&(1<<A.extra)-1,K>>>=A.extra,le-=A.extra,A.back+=A.extra}if(A.offset>A.dmax){Q.msg="invalid distance too far back",A.mode=Ze;break}A.mode=je;case je:if(C===0)break e;if(Pe=Le-C,A.offset>Pe){if(Pe=A.offset-Pe,Pe>A.whave&&A.sane){Q.msg="invalid distance too far back",A.mode=Ze;break}Pe>A.wnext?(Pe-=A.wnext,rt=A.wsize-Pe):rt=A.wnext-Pe,Pe>A.length&&(Pe=A.length),Jt=A.window}else Jt=Xe,rt=H-A.offset,Pe=A.length;Pe>C&&(Pe=C),C-=Pe,A.length-=Pe;do Xe[H++]=Jt[rt++];while(--Pe);A.length===0&&(A.mode=q);break;case Fe:if(C===0)break e;Xe[H++]=A.length,C--,A.mode=q;break;case Ke:if(A.wrap){for(;le<32;){if(pe===0)break e;pe--,K|=Ee[m++]<<le,le+=8}if(Le-=C,Q.total_out+=Le,A.total+=Le,Le&&(Q.adler=A.check=A.flags?n(A.check,Xe,Le,H-Le):r(A.check,Xe,Le,H-Le)),Le=C,(A.flags?K:$(K))!==A.check){Q.msg="incorrect data check",A.mode=Ze;break}K=0,le=0}A.mode=Ye;case Ye:if(A.wrap&&A.flags){for(;le<32;){if(pe===0)break e;pe--,K+=Ee[m++]<<le,le+=8}if(K!==(A.total&4294967295)){Q.msg="incorrect length check",A.mode=Ze;break}K=0,le=0}A.mode=at;case at:Ht=R;break e;case Ze:Ht=X;break e;case Qe:return L;case ht:default:return j}return Q.next_out=H,Q.avail_out=C,Q.next_in=m,Q.avail_in=pe,A.hold=K,A.bits=le,(A.wsize||Le!==Q.avail_out&&A.mode<Ze&&(A.mode<Ke||ue!==h))&&nr(Q,Q.output,Q.next_out,Le-Q.avail_out),Ve-=Q.avail_in,Le-=Q.avail_out,Q.total_in+=Ve,Q.total_out+=Le,A.total+=Le,A.wrap&&Le&&(Q.adler=A.check=A.flags?n(A.check,Xe,Le,Q.next_out-Le):r(A.check,Xe,Le,Q.next_out-Le)),Q.data_type=A.bits+(A.last?64:0)+(A.mode===ne?128:0)+(A.mode===Me||A.mode===ie?256:0),(Ve===0&&Le===0||ue===h)&&Ht===x&&(Ht=F),Ht}function Se(Q){if(!Q||!Q.state)return j;var ue=Q.state;return ue.window&&(ue.window=null),Q.state=null,x}function Ie(Q,ue){var A;return!Q||!Q.state||(A=Q.state,(A.wrap&2)===0)?j:(A.head=ue,ue.done=!1,x)}function Ue(Q,ue){var A=ue.length,Ee,Xe,m;return!Q||!Q.state||(Ee=Q.state,Ee.wrap!==0&&Ee.mode!==de)?j:Ee.mode===de&&(Xe=1,Xe=r(Xe,ue,A,0),Xe!==Ee.check)?X:(m=nr(Q,ue,A,A),m?(Ee.mode=Qe,L):(Ee.havedict=1,x))}return rr.inflateReset=xe,rr.inflateReset2=Je,rr.inflateResetKeep=be,rr.inflateInit=it,rr.inflateInit2=tt,rr.inflate=P,rr.inflateEnd=Se,rr.inflateGetHeader=Ie,rr.inflateSetDictionary=Ue,rr.inflateInfo="pako inflate (from Nodeca project)",rr}var Lo,Rf;function Xd(){return Rf||(Rf=1,Lo={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),Lo}var $o,Of;function Hw(){if(Of)return $o;Of=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return $o=e,$o}var Pf;function qw(){if(Pf)return on;Pf=1;var e=Gw(),r=Ir(),n=Zd(),s=Xd(),c=Rs(),u=Kd(),g=Hw(),d=Object.prototype.toString;function h(x){if(!(this instanceof h))return new h(x);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},x||{});var R=this.options;R.raw&&R.windowBits>=0&&R.windowBits<16&&(R.windowBits=-R.windowBits,R.windowBits===0&&(R.windowBits=-15)),R.windowBits>=0&&R.windowBits<16&&!(x&&x.windowBits)&&(R.windowBits+=32),R.windowBits>15&&R.windowBits<48&&(R.windowBits&15)===0&&(R.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var y=e.inflateInit2(this.strm,R.windowBits);if(y!==s.Z_OK)throw new Error(c[y]);if(this.header=new g,e.inflateGetHeader(this.strm,this.header),R.dictionary&&(typeof R.dictionary=="string"?R.dictionary=n.string2buf(R.dictionary):d.call(R.dictionary)==="[object ArrayBuffer]"&&(R.dictionary=new Uint8Array(R.dictionary)),R.raw&&(y=e.inflateSetDictionary(this.strm,R.dictionary),y!==s.Z_OK)))throw new Error(c[y])}h.prototype.push=function(x,R){var y=this.strm,j=this.options.chunkSize,X=this.options.dictionary,L,F,U,G,W,te=!1;if(this.ended)return!1;F=R===~~R?R:R===!0?s.Z_FINISH:s.Z_NO_FLUSH,typeof x=="string"?y.input=n.binstring2buf(x):d.call(x)==="[object ArrayBuffer]"?y.input=new Uint8Array(x):y.input=x,y.next_in=0,y.avail_in=y.input.length;do{if(y.avail_out===0&&(y.output=new r.Buf8(j),y.next_out=0,y.avail_out=j),L=e.inflate(y,s.Z_NO_FLUSH),L===s.Z_NEED_DICT&&X&&(L=e.inflateSetDictionary(this.strm,X)),L===s.Z_BUF_ERROR&&te===!0&&(L=s.Z_OK,te=!1),L!==s.Z_STREAM_END&&L!==s.Z_OK)return this.onEnd(L),this.ended=!0,!1;y.next_out&&(y.avail_out===0||L===s.Z_STREAM_END||y.avail_in===0&&(F===s.Z_FINISH||F===s.Z_SYNC_FLUSH))&&(this.options.to==="string"?(U=n.utf8border(y.output,y.next_out),G=y.next_out-U,W=n.buf2string(y.output,U),y.next_out=G,y.avail_out=j-G,G&&r.arraySet(y.output,y.output,U,G,0),this.onData(W)):this.onData(r.shrinkBuf(y.output,y.next_out))),y.avail_in===0&&y.avail_out===0&&(te=!0)}while((y.avail_in>0||y.avail_out===0)&&L!==s.Z_STREAM_END);return L===s.Z_STREAM_END&&(F=s.Z_FINISH),F===s.Z_FINISH?(L=e.inflateEnd(this.strm),this.onEnd(L),this.ended=!0,L===s.Z_OK):(F===s.Z_SYNC_FLUSH&&(this.onEnd(s.Z_OK),y.avail_out=0),!0)},h.prototype.onData=function(x){this.chunks.push(x)},h.prototype.onEnd=function(x){x===s.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg};function S(x,R){var y=new h(R);if(y.push(x,!0),y.err)throw y.msg||c[y.err];return y.result}function _(x,R){return R=R||{},R.raw=!0,S(x,R)}return on.Inflate=h,on.inflate=S,on.inflateRaw=_,on.ungzip=S,on}var No,Mf;function Ww(){if(Mf)return No;Mf=1;var e=Ir().assign,r=Nw(),n=qw(),s=Xd(),c={};return e(c,r,n,s),No=c,No}var Uo,jf;function Vw(){if(jf)return Uo;jf=1;const e=(r,n)=>function(...s){const c=n.promiseModule;return new c((u,g)=>{n.multiArgs?s.push((...d)=>{n.errorFirst?d[0]?g(d):(d.shift(),u(d)):u(d)}):n.errorFirst?s.push((d,h)=>{d?g(d):u(h)}):s.push(u),r.apply(this,s)})};return Uo=(r,n)=>{n=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},n);const s=typeof r;if(!(r!==null&&(s==="object"||s==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${r===null?"null":s}\``);const c=g=>{const d=h=>typeof h=="string"?g===h:h.test(g);return n.include?n.include.some(d):!n.exclude.some(d)};let u;s==="function"?u=function(...g){return n.excludeMain?r(...g):e(r,n).apply(this,g)}:u=Object.create(Object.getPrototypeOf(r));for(const g in r){const d=r[g];u[g]=typeof d=="function"&&c(g)?e(d,n):d}return u},Uo}var zo,Bf;function Zw(){if(Bf)return zo;Bf=1;var e={};function r(ie){return Array.isArray(ie)?ie:[ie]}const n="",s=" ",c="\\",u=/^\s+$/,g=/(?:[^\\]|^)\\$/,d=/^\\!/,h=/^\\#/,S=/\r?\n/g,_=/^\.*\/|^\.+$/,x="/";let R="node-ignore";typeof Symbol<"u"&&(R=Symbol.for("node-ignore"));const y=R,j=(ie,se,he)=>Object.defineProperty(ie,se,{value:he}),X=/([0-z])-([0-z])/g,L=()=>!1,F=ie=>ie.replace(X,(se,he,ze)=>he.charCodeAt(0)<=ze.charCodeAt(0)?se:n),U=ie=>{const{length:se}=ie;return ie.slice(0,se-se%2)},G=[[/^\uFEFF/,()=>n],[/((?:\\\\)*?)(\\?\s+)$/,(ie,se,he)=>se+(he.indexOf("\\")===0?s:n)],[/(\\+?)\s/g,(ie,se)=>{const{length:he}=se;return se.slice(0,he-he%2)+s}],[/[\\$.|*+(){^]/g,ie=>`\\${ie}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(ie,se,he)=>se+6<he.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(ie,se,he)=>{const ze=he.replace(/\\\*/g,"[^\\/]*");return se+ze}],[/\\\\\\(?=[$.|*+(){^])/g,()=>c],[/\\\\/g,()=>c],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(ie,se,he,ze,_e)=>se===c?`\\[${he}${U(ze)}${_e}`:_e==="]"&&ze.length%2===0?`[${F(he)}${ze}]`:"[]"],[/(?:[^*])$/,ie=>/\/$/.test(ie)?`${ie}$`:`${ie}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(ie,se)=>`${se?`${se}[^/]+`:"[^/]*"}(?=$|\\/$)`]],W=Object.create(null),te=(ie,se)=>{let he=W[ie];return he||(he=G.reduce((ze,[_e,Me])=>ze.replace(_e,Me.bind(ie)),ie),W[ie]=he),se?new RegExp(he,"i"):new RegExp(he)},Z=ie=>typeof ie=="string",z=ie=>ie&&Z(ie)&&!u.test(ie)&&!g.test(ie)&&ie.indexOf("#")!==0,B=ie=>ie.split(S);class J{constructor(se,he,ze,_e){this.origin=se,this.pattern=he,this.negative=ze,this.regex=_e}}const N=(ie,se)=>{const he=ie;let ze=!1;ie.indexOf("!")===0&&(ze=!0,ie=ie.substr(1)),ie=ie.replace(d,"!").replace(h,"#");const _e=te(ie,se);return new J(he,ie,ze,_e)},ce=(ie,se)=>{throw new se(ie)},oe=(ie,se,he)=>Z(ie)?ie?oe.isNotRelative(ie)?he(`path should be a \`path.relative()\`d string, but got "${se}"`,RangeError):!0:he("path must not be empty",TypeError):he(`path must be a string, but got \`${se}\``,TypeError),de=ie=>_.test(ie);oe.isNotRelative=de,oe.convert=ie=>ie;class ne{constructor({ignorecase:se=!0,ignoreCase:he=se,allowRelativePaths:ze=!1}={}){j(this,y,!0),this._rules=[],this._ignoreCase=he,this._allowRelativePaths=ze,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(se){if(se&&se[y]){this._rules=this._rules.concat(se._rules),this._added=!0;return}if(z(se)){const he=N(se,this._ignoreCase);this._added=!0,this._rules.push(he)}}add(se){return this._added=!1,r(Z(se)?B(se):se).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(se){return this.add(se)}_testOne(se,he){let ze=!1,_e=!1;return this._rules.forEach(Me=>{const{negative:q}=Me;if(_e===q&&ze!==_e||q&&!ze&&!_e&&!he)return;Me.regex.test(se)&&(ze=!q,_e=q)}),{ignored:ze,unignored:_e}}_test(se,he,ze,_e){const Me=se&&oe.convert(se);return oe(Me,se,this._allowRelativePaths?L:ce),this._t(Me,he,ze,_e)}_t(se,he,ze,_e){if(se in he)return he[se];if(_e||(_e=se.split(x)),_e.pop(),!_e.length)return he[se]=this._testOne(se,ze);const Me=this._t(_e.join(x)+x,he,ze,_e);return he[se]=Me.ignored?Me:this._testOne(se,ze)}ignores(se){return this._test(se,this._ignoreCache,!1).ignored}createFilter(){return se=>!this.ignores(se)}filter(se){return r(se).filter(this.createFilter())}test(se){return this._test(se,this._testCache,!0)}}const me=ie=>new ne(ie),ae=ie=>oe(ie&&oe.convert(ie),ie,L);if(me.isPathValid=ae,me.default=me,zo=me,typeof process<"u"&&(e&&e.IGNORE_TEST_WIN32||process.platform==="win32")){const ie=he=>/^\\\\\?\\/.test(he)||/["<>|\u0000-\u001F]+/u.test(he)?he:he.replace(/\\/g,"/");oe.convert=ie;const se=/^[a-z]:\//i;oe.isNotRelative=he=>se.test(he)||de(he)}return zo}var Go,Ff;function Kw(){if(Ff)return Go;Ff=1;function e(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function r(s,c,u){return c=c instanceof RegExp?c:new RegExp(e(c),"g"),s.replace(c,u)}var n={clean:function(c){if(typeof c!="string")throw new Error("Expected a string, received: "+c);return c=r(c,"./","/"),c=r(c,"..","."),c=r(c," ","-"),c=r(c,/^[~^:?*\\\-]/g,""),c=r(c,/[~^:?*\\]/g,"-"),c=r(c,/[~^:?*\\\-]$/g,""),c=r(c,"@{","-"),c=r(c,/\.$/g,""),c=r(c,/\/$/g,""),c=r(c,/\.lock$/g,""),c}};return Go=n,Go}var Ho,Df;function Xw(){return Df||(Df=1,Ho=function(e,r){var n=e,s=r,c=n.length,u=s.length,g=!1,d=null,h=c+1,S=[],_=[],x=[],R="",y=-1,j=0,X=1,L,F,U=function(){c>=u&&(L=n,F=c,n=s,s=L,c=u,u=F,g=!0,h=c+1)},G=function(z,B,J){return{x:z,y:B,k:J}},W=function(z,B){return{elem:z,t:B}},te=function(z,B,J){var N,ce,oe;for(B>J?N=S[z-1+h]:N=S[z+1+h],oe=Math.max(B,J),ce=oe-z;ce<c&&oe<u&&n[ce]===s[oe];)++ce,++oe;return S[z+h]=_.length,_[_.length]=new G(ce,oe,N),oe},Z=function(z){var B,J,N;for(B=J=0,N=z.length-1;N>=0;--N)for(;B<z[N].x||J<z[N].y;)z[N].y-z[N].x>J-B?(g?x[x.length]=new W(s[J],y):x[x.length]=new W(s[J],X),++J):z[N].y-z[N].x<J-B?(g?x[x.length]=new W(n[B],X):x[x.length]=new W(n[B],y),++B):(x[x.length]=new W(n[B],j),R+=n[B],++B,++J)};return U(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return d},getlcs:function(){return R},getses:function(){return x},compose:function(){var z,B,J,N,ce,oe,de,ne;for(z=u-c,B=c+u+3,J={},de=0;de<B;++de)J[de]=-1,S[de]=-1;N=-1;do{for(++N,ne=-N;ne<=z-1;++ne)J[ne+h]=te(ne,J[ne-1+h]+1,J[ne+1+h]);for(ne=z+N;ne>=z+1;--ne)J[ne+h]=te(ne,J[ne-1+h]+1,J[ne+1+h]);J[z+h]=te(z,J[z-1+h]+1,J[z+1+h])}while(J[z+h]!==u);for(d=z+2*N,ce=S[z+h],oe=[];ce!==-1;)oe[oe.length]=new G(_[ce].x,_[ce].y,null),ce=_[ce].k;Z(oe)}}}),Ho}var qo,Lf;function Yw(){if(Lf)return qo;Lf=1;var e=Xw();function r(u,g){var d=new e(u,g);d.compose();for(var h=d.getses(),S,_,x=u.length-1,R=g.length-1,y=h.length-1;y>=0;--y)h[y].t===d.SES_COMMON?(_?(_.chain={file1index:x,file2index:R,chain:null},_=_.chain):(S={file1index:x,file2index:R,chain:null},_=S),x--,R--):h[y].t===d.SES_DELETE?x--:h[y].t===d.SES_ADD&&R--;var j={file1index:-1,file2index:-1,chain:null};return _?(_.chain=j,S):j}function n(u,g){for(var d=[],h=u.length,S=g.length,_=r(u,g);_!==null;_=_.chain){var x=h-_.file1index-1,R=S-_.file2index-1;h=_.file1index,S=_.file2index,(x||R)&&d.push({file1:[h+1,x],file2:[S+1,R]})}return d.reverse(),d}function s(u,g,d){var h,S=n(g,u),_=n(g,d),x=[];function R(se,he){x.push([se.file1[0],he,se.file1[1],se.file2[0],se.file2[1]])}for(h=0;h<S.length;h++)R(S[h],0);for(h=0;h<_.length;h++)R(_[h],2);x.sort(function(se,he){return se[0]-he[0]});var y=[],j=0;function X(se){se>j&&(y.push([1,j,se-j]),j=se)}for(var L=0;L<x.length;L++){for(var F=L,U=x[L],G=U[0],W=G+U[2];L<x.length-1;){var te=x[L+1],Z=te[0];if(Z>W)break;W=Math.max(W,Z+te[2]),L++}if(X(G),F==L)U[4]>0&&y.push([U[1],U[3],U[4]]);else{var z={0:[u.length,-1,g.length,-1],2:[d.length,-1,g.length,-1]};for(h=F;h<=L;h++){U=x[h];var B=U[1],J=z[B],N=U[0],ce=N+U[2],oe=U[3],de=oe+U[4];J[0]=Math.min(oe,J[0]),J[1]=Math.max(de,J[1]),J[2]=Math.min(N,J[2]),J[3]=Math.max(ce,J[3])}var ne=z[0][0]+(G-z[0][2]),me=z[0][1]+(W-z[0][3]),ae=z[2][0]+(G-z[2][2]),ie=z[2][1]+(W-z[2][3]);y.push([-1,ne,me-ne,G,W-G,ae,ie-ae])}j=W}return X(g.length),y}function c(u,g,d){var h=[],S=[u,g,d],_=s(u,g,d),x=[];function R(){x.length&&h.push({ok:x}),x=[]}function y(U){for(var G=0;G<U.length;G++)x.push(U[G])}function j(U){if(U[2]!=U[6])return!0;for(var G=U[1],W=U[5],te=0;te<U[2];te++)if(u[te+G]!=d[te+W])return!0;return!1}for(var X=0;X<_.length;X++){var L=_[X],F=L[0];F==-1?j(L)?(R(),h.push({conflict:{a:u.slice(L[1],L[1]+L[2]),aIndex:L[1],o:g.slice(L[3],L[3]+L[4]),oIndex:L[3],b:d.slice(L[5],L[5]+L[6]),bIndex:L[5]}})):y(S[0].slice(L[1],L[1]+L[2])):y(S[F].slice(L[1],L[1]+L[2]))}return R(),h}return qo=c,qo}var $f;function Jw(){if($f)return De;$f=1,Object.defineProperty(De,"__esModule",{value:!0});function e(a){return a&&typeof a=="object"&&"default"in a?a.default:a}var r=e(Xm()),n=e(Fw()),s=e(Dw()),c=e(Ww()),u=e(Vw()),g=e(Zw()),d=e(Kw()),h=e(Yw());class S extends Error{constructor(t){super(t),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(t){const i=new S(t.message);return i.code=t.code,i.data=t.data,i.caller=t.caller,i.stack=t.stack,i}get isIsomorphicGitError(){return!0}}class _ extends S{constructor(t){super(`Modifying the index is not possible because you have unmerged files: ${t.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=_.code,this.data={filepaths:t}}}_.code="UnmergedPathsError";class x extends S{constructor(t){super(`An internal error caused this command to fail.

If you're not a developer, report the bug to the developers of the application you're using. If this is a bug in isomorphic-git then you should create a proper bug yourselves. The bug should include a minimal reproduction and details about the version and environment.

Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${t}`),this.code=this.name=x.code,this.data={message:t}}}x.code="InternalError";class R extends S{constructor(t){super(`The filepath "${t}" contains unsafe character sequences`),this.code=this.name=R.code,this.data={filepath:t}}}R.code="UnsafeFilepathError";class y{constructor(t){this.buffer=t,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(t){this._start=t}slice(t){const i=this.buffer.slice(this._start,this._start+t);return this._start+=t,i}toString(t,i){const o=this.buffer.toString(t,this._start,this._start+i);return this._start+=i,o}write(t,i,o){const l=this.buffer.write(t,this._start,i,o);return this._start+=i,l}copy(t,i,o){const l=t.copy(this.buffer,this._start,i,o);return this._start+=l,l}readUInt8(){const t=this.buffer.readUInt8(this._start);return this._start+=1,t}writeUInt8(t){const i=this.buffer.writeUInt8(t,this._start);return this._start+=1,i}readUInt16BE(){const t=this.buffer.readUInt16BE(this._start);return this._start+=2,t}writeUInt16BE(t){const i=this.buffer.writeUInt16BE(t,this._start);return this._start+=2,i}readUInt32BE(){const t=this.buffer.readUInt32BE(this._start);return this._start+=4,t}writeUInt32BE(t){const i=this.buffer.writeUInt32BE(t,this._start);return this._start+=4,i}}function j(a,t){return-(a<t)||+(a>t)}function X(a,t){return j(a.path,t.path)}function L(a){let t=a>0?a>>12:0;t!==4&&t!==8&&t!==10&&t!==14&&(t=8);let i=a&511;return i&73?i=493:i=420,t!==8&&(i=0),(t<<12)+i}const F=2**32;function U(a,t,i,o){if(a!==void 0&&t!==void 0)return[a,t];i===void 0&&(i=o.valueOf());const l=Math.floor(i/1e3),f=(i-l*1e3)*1e6;return[l,f]}function G(a){const[t,i]=U(a.ctimeSeconds,a.ctimeNanoseconds,a.ctimeMs,a.ctime),[o,l]=U(a.mtimeSeconds,a.mtimeNanoseconds,a.mtimeMs,a.mtime);return{ctimeSeconds:t%F,ctimeNanoseconds:i%F,mtimeSeconds:o%F,mtimeNanoseconds:l%F,dev:a.dev%F,ino:a.ino%F,mode:L(a.mode%F),uid:a.uid%F,gid:a.gid%F,size:a.size>-1?a.size%F:0}}function W(a){let t="";for(const i of new Uint8Array(a))i<16&&(t+="0"),t+=i.toString(16);return t}let te=null;async function Z(a){return te===null&&(te=await J()),te?B(a):z(a)}function z(a){return new n().update(a).digest("hex")}async function B(a){const t=await crypto.subtle.digest("SHA-1",a);return W(t)}async function J(){try{return await B(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709"}catch{}return!1}function N(a){return{assumeValid:!!(a&32768),extended:!!(a&16384),stage:(a&12288)>>12,nameLength:a&4095}}function ce(a){const t=a.flags;return t.extended=!1,t.nameLength=Math.min(Buffer.from(a.path).length,4095),(t.assumeValid?32768:0)+(t.extended?16384:0)+((t.stage&3)<<12)+(t.nameLength&4095)}class oe{constructor(t,i){this._dirty=!1,this._unmergedPaths=i||new Set,this._entries=t||new Map}_addEntry(t){if(t.flags.stage===0)t.stages=[t],this._entries.set(t.path,t),this._unmergedPaths.delete(t.path);else{let i=this._entries.get(t.path);i||(this._entries.set(t.path,t),i=t),i.stages[t.flags.stage]=t,this._unmergedPaths.add(t.path)}}static async from(t){if(Buffer.isBuffer(t))return oe.fromBuffer(t);if(t===null)return new oe(null);throw new x("invalid type passed to GitIndex.from")}static async fromBuffer(t){if(t.length===0)throw new x("Index file is empty (.git/index)");const i=new oe,o=new y(t),l=o.toString("utf8",4);if(l!=="DIRC")throw new x(`Invalid dircache magic file number: ${l}`);const f=await Z(t.slice(0,-20)),w=t.slice(-20).toString("hex");if(w!==f)throw new x(`Invalid checksum in GitIndex buffer: expected ${w} but saw ${f}`);const v=o.readUInt32BE();if(v!==2)throw new x(`Unsupported dircache version: ${v}`);const I=o.readUInt32BE();let T=0;for(;!o.eof()&&T<I;){const k={};k.ctimeSeconds=o.readUInt32BE(),k.ctimeNanoseconds=o.readUInt32BE(),k.mtimeSeconds=o.readUInt32BE(),k.mtimeNanoseconds=o.readUInt32BE(),k.dev=o.readUInt32BE(),k.ino=o.readUInt32BE(),k.mode=o.readUInt32BE(),k.uid=o.readUInt32BE(),k.gid=o.readUInt32BE(),k.size=o.readUInt32BE(),k.oid=o.slice(20).toString("hex");const M=o.readUInt16BE();k.flags=N(M);const D=t.indexOf(0,o.tell()+1)-o.tell();if(D<1)throw new x(`Got a path length of: ${D}`);if(k.path=o.toString("utf8",D),k.path.includes("..\\")||k.path.includes("../"))throw new R(k.path);let V=8-(o.tell()-12)%8;for(V===0&&(V=8);V--;){const ee=o.readUInt8();if(ee!==0)throw new x(`Expected 1-8 null characters but got '${ee}' after ${k.path}`);if(o.eof())throw new x("Unexpected end of file")}k.stages=[],i._addEntry(k),T++}return i}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(X)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(t=>t.stages.length>1?t.stages.filter(i=>i):t)}*[Symbol.iterator](){for(const t of this.entries)yield t}insert({filepath:t,stats:i,oid:o,stage:l=0}){i||(i={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),i=G(i);const f=Buffer.from(t),w={ctimeSeconds:i.ctimeSeconds,ctimeNanoseconds:i.ctimeNanoseconds,mtimeSeconds:i.mtimeSeconds,mtimeNanoseconds:i.mtimeNanoseconds,dev:i.dev,ino:i.ino,mode:i.mode||33188,uid:i.uid,gid:i.gid,size:i.size,path:t,oid:o,flags:{assumeValid:!1,extended:!1,stage:l,nameLength:f.length<4095?f.length:4095},stages:[]};this._addEntry(w),this._dirty=!0}delete({filepath:t}){if(this._entries.has(t))this._entries.delete(t);else for(const i of this._entries.keys())i.startsWith(t+"/")&&this._entries.delete(i);this._unmergedPaths.has(t)&&this._unmergedPaths.delete(t),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:t}){return this._entries.has(t)}render(){return this.entries.map(t=>`${t.mode.toString(8)} ${t.oid}    ${t.path}`).join(`
`)}static async _entryToBuffer(t){const i=Buffer.from(t.path),o=Math.ceil((62+i.length+1)/8)*8,l=Buffer.alloc(o),f=new y(l),w=G(t);return f.writeUInt32BE(w.ctimeSeconds),f.writeUInt32BE(w.ctimeNanoseconds),f.writeUInt32BE(w.mtimeSeconds),f.writeUInt32BE(w.mtimeNanoseconds),f.writeUInt32BE(w.dev),f.writeUInt32BE(w.ino),f.writeUInt32BE(w.mode),f.writeUInt32BE(w.uid),f.writeUInt32BE(w.gid),f.writeUInt32BE(w.size),f.write(t.oid,20,"hex"),f.writeUInt16BE(ce(t)),f.write(t.path,i.length,"utf8"),l}async toObject(){const t=Buffer.alloc(12),i=new y(t);i.write("DIRC",4,"utf8"),i.writeUInt32BE(2),i.writeUInt32BE(this.entriesFlat.length);let o=[];for(const v of this.entries)if(o.push(oe._entryToBuffer(v)),v.stages.length>1)for(const I of v.stages)I&&I!==v&&o.push(oe._entryToBuffer(I));o=await Promise.all(o);const l=Buffer.concat(o),f=Buffer.concat([t,l]),w=await Z(f);return Buffer.concat([f,Buffer.from(w,"hex")])}}function de(a,t,i=!0,o=!0){const l=G(a),f=G(t);return i&&l.mode!==f.mode||l.mtimeSeconds!==f.mtimeSeconds||l.ctimeSeconds!==f.ctimeSeconds||l.uid!==f.uid||l.gid!==f.gid||o&&l.ino!==f.ino||l.size!==f.size}let ne=null;const me=Symbol("IndexCache");function ae(){return{map:new Map,stats:new Map}}async function ie(a,t,i){const[o,l]=await Promise.all([a.lstat(t),a.read(t)]),f=await oe.from(l);i.map.set(t,f),i.stats.set(t,o)}async function se(a,t,i){const o=i.stats.get(t);if(o===void 0)return!0;if(o===null)return!1;const l=await a.lstat(t);return l===null?!1:de(o,l)}class he{static async acquire({fs:t,gitdir:i,cache:o,allowUnmerged:l=!0},f){o[me]||(o[me]=ae());const w=`${i}/index`;ne===null&&(ne=new r({maxPending:1/0}));let v,I=[];return await ne.acquire(w,async()=>{const T=o[me];await se(t,w,T)&&await ie(t,w,T);const k=T.map.get(w);if(I=k.unmergedPaths,I.length&&!l)throw new _(I);if(v=await f(k),k._dirty){const M=await k.toObject();await t.write(w,M),T.stats.set(w,await t.lstat(w)),k._dirty=!1}}),v}}function ze(a){const t=Math.max(a.lastIndexOf("/"),a.lastIndexOf("\\"));return t>-1&&(a=a.slice(t+1)),a}function _e(a){const t=Math.max(a.lastIndexOf("/"),a.lastIndexOf("\\"));return t===-1?".":t===0?"/":a.slice(0,t)}function Me(a){const t=new Map,i=function(l){if(!t.has(l)){const f={type:"tree",fullpath:l,basename:ze(l),metadata:{},children:[]};t.set(l,f),f.parent=i(_e(l)),f.parent&&f.parent!==f&&f.parent.children.push(f)}return t.get(l)},o=function(l,f){if(!t.has(l)){const w={type:"blob",fullpath:l,basename:ze(l),metadata:f,parent:i(_e(l)),children:[]};w.parent&&w.parent.children.push(w),t.set(l,w)}return t.get(l)};i(".");for(const l of a)o(l.path,l);return t}function q(a){switch(a){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new x(`Unexpected GitTree entry mode: ${a.toString(8)}`)}class ke{constructor({fs:t,gitdir:i,cache:o}){this.treePromise=he.acquire({fs:t,gitdir:i,cache:o},async function(f){return Me(f.entries)});const l=this;this.ConstructEntry=class{constructor(w){this._fullpath=w,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return l.type(this)}async mode(){return l.mode(this)}async stat(){return l.stat(this)}async content(){return l.content(this)}async oid(){return l.oid(this)}}}async readdir(t){const i=t._fullpath,l=(await this.treePromise).get(i);if(!l||l.type==="blob")return null;if(l.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${i}'`);const f=l.children.map(w=>w.fullpath);return f.sort(j),f}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const o=(await this.treePromise).get(t._fullpath);if(!o)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);const l=o.type==="tree"?{}:G(o.metadata);t._type=o.type==="tree"?"tree":q(l.mode),t._mode=l.mode,o.type==="tree"?t._stat=void 0:t._stat=l}return t._stat}async content(t){}async oid(t){if(t._oid===!1){const o=(await this.treePromise).get(t._fullpath);t._oid=o.metadata.oid}return t._oid}}const Ae=Symbol("GitWalkSymbol");function Oe(){const a=Object.create(null);return Object.defineProperty(a,Ae,{value:function({fs:t,gitdir:i,cache:o}){return new ke({fs:t,gitdir:i,cache:o})}}),Object.freeze(a),a}class je extends S{constructor(t){super(`Could not find ${t}.`),this.code=this.name=je.code,this.data={what:t}}}je.code="NotFoundError";class Fe extends S{constructor(t,i,o,l){super(`Object ${t} ${l?`at ${l}`:""}was anticipated to be a ${o} but it is a ${i}.`),this.code=this.name=Fe.code,this.data={oid:t,actual:i,expected:o,filepath:l}}}Fe.code="ObjectTypeError";class Ke extends S{constructor(t){super(`Expected a 40-char hex object id but saw "${t}".`),this.code=this.name=Ke.code,this.data={value:t}}}Ke.code="InvalidOidError";class Ye extends S{constructor(t){super(`Could not find a fetch refspec for remote "${t}". Make sure the config file has an entry like the following:
[remote "${t}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=Ye.code,this.data={remote:t}}}Ye.code="NoRefspecError";class at{constructor(t){if(this.refs=new Map,this.parsedConfig=[],t){let i=null;this.parsedConfig=t.trim().split(`
`).map(o=>{if(/^\s*#/.test(o))return{line:o,comment:!0};const l=o.indexOf(" ");if(o.startsWith("^")){const f=o.slice(1);return this.refs.set(i+"^{}",f),{line:o,ref:i,peeled:f}}else{const f=o.slice(0,l);return i=o.slice(l+1),this.refs.set(i,f),{line:o,ref:i,oid:f}}})}return this}static from(t){return new at(t)}delete(t){this.parsedConfig=this.parsedConfig.filter(i=>i.ref!==t),this.refs.delete(t)}toString(){return this.parsedConfig.map(({line:t})=>t).join(`
`)+`
`}}class Ze{constructor({remotePath:t,localPath:i,force:o,matchPrefix:l}){Object.assign(this,{remotePath:t,localPath:i,force:o,matchPrefix:l})}static from(t){const[i,o,l,f,w]=t.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),v=i==="+",I=l==="*";if(I!==(w==="*"))throw new x("Invalid refspec");return new Ze({remotePath:o,localPath:f,force:v,matchPrefix:I})}translate(t){if(this.matchPrefix){if(t.startsWith(this.remotePath))return this.localPath+t.replace(this.remotePath,"")}else if(t===this.remotePath)return this.localPath;return null}reverseTranslate(t){if(this.matchPrefix){if(t.startsWith(this.localPath))return this.remotePath+t.replace(this.localPath,"")}else if(t===this.localPath)return this.remotePath;return null}}class Qe{constructor(t=[]){this.rules=t}static from(t){const i=[];for(const o of t)i.push(Ze.from(o));return new Qe(i)}add(t){const i=Ze.from(t);this.rules.push(i)}translate(t){const i=[];for(const o of this.rules)for(const l of t){const f=o.translate(l);f&&i.push([l,f])}return i}translateOne(t){let i=null;for(const o of this.rules){const l=o.translate(t);l&&(i=l)}return i}localNamespaces(){return this.rules.filter(t=>t.matchPrefix).map(t=>t.localPath.replace(/\/$/,""))}}function ht(a,t){const i=a.replace(/\^\{\}$/,""),o=t.replace(/\^\{\}$/,""),l=-(i<o)||+(i>o);return l===0?a.endsWith("^{}")?1:-1:l}/*!
 * This code for `path.join` is directly copied from @zenfs/core/path for bundle size improvements.
 * SPDX-License-Identifier: LGPL-3.0-or-later
 * Copyright (c) James Prevett and other ZenFS contributors.
 */function mt(a,t){let i="",o=0,l=-1,f=0,w="\0";for(let v=0;v<=a.length;++v){if(v<a.length)w=a[v];else{if(w==="/")break;w="/"}if(w==="/"){if(!(l===v-1||f===1))if(f===2){if(i.length<2||o!==2||i.at(-1)!=="."||i.at(-2)!=="."){if(i.length>2){const I=i.lastIndexOf("/");I===-1?(i="",o=0):(i=i.slice(0,I),o=i.length-1-i.lastIndexOf("/")),l=v,f=0;continue}else if(i.length!==0){i="",o=0,l=v,f=0;continue}}t&&(i+=i.length>0?"/..":"..",o=2)}else i.length>0?i+="/"+a.slice(l+1,v):i=a.slice(l+1,v),o=v-l-1;l=v,f=0}else w==="."&&f!==-1?++f:f=-1}return i}function O(a){if(!a.length)return".";const t=a[0]==="/",i=a.at(-1)==="/";return a=mt(a,!t),a.length?(i&&(a+="/"),t?`/${a}`:a):t?"/":i?"./":"."}function p(...a){if(a.length===0)return".";let t;for(let i=0;i<a.length;++i){const o=a[i];o.length>0&&(t===void 0?t=o:t+="/"+o)}return t===void 0?".":O(t)}const b=a=>{if(typeof a=="number")return a;a=a.toLowerCase();let t=parseInt(a);return a.endsWith("k")&&(t*=1024),a.endsWith("m")&&(t*=1024*1024),a.endsWith("g")&&(t*=1024*1024*1024),t},$=a=>{if(typeof a=="boolean")return a;if(a=a.trim().toLowerCase(),a==="true"||a==="yes"||a==="on")return!0;if(a==="false"||a==="no"||a==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${a}`)},re={core:{filemode:$,bare:$,logallrefupdates:$,symlinks:$,ignorecase:$,bigFileThreshold:b}},be=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,xe=/^[A-Za-z0-9-.]+$/,Je=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,tt=/^[A-Za-z][A-Za-z-]*$/,it=/^(.*?)( *[#;].*)$/,ft=a=>{const t=be.exec(a);if(t!=null){const[i,o]=t.slice(1);return[i,o]}return null},st=a=>{const t=Je.exec(a);if(t!=null){const[i,o="true"]=t.slice(1),l=wt(o),f=nr(l);return[i,f]}return null},wt=a=>{const t=it.exec(a);if(t==null)return a;const[i,o]=t.slice(1);return Lt(i)&&Lt(o)?`${i}${o}`:i},Lt=a=>(a.match(/(?:^|[^\\])"/g)||[]).length%2!==0,nr=a=>a.split("").reduce((t,i,o,l)=>{const f=i==='"'&&l[o-1]!=="\\",w=i==="\\"&&l[o+1]==='"';return f||w?t:t+i},""),P=a=>a!=null?a.toLowerCase():null,Se=(a,t,i)=>[P(a),t,P(i)].filter(o=>o!=null).join("."),Ie=a=>{const t=a.split("."),i=t.shift(),o=t.pop(),l=t.length?t.join("."):void 0;return{section:i,subsection:l,name:o,path:Se(i,l,o),sectionPath:Se(i,l,null),isSection:!!i}},Ue=(a,t)=>a.reduce((i,o,l)=>t(o)?l:i,-1);class Q{constructor(t){let i=null,o=null;this.parsedConfig=t?t.split(`
`).map(l=>{let f=null,w=null;const v=l.trim(),I=ft(v),T=I!=null;if(T)[i,o]=I;else{const M=st(v);M!=null&&([f,w]=M)}const k=Se(i,o,f);return{line:l,isSection:T,section:i,subsection:o,name:f,value:w,path:k}}):[]}static from(t){return new Q(t)}async get(t,i=!1){const o=Ie(t).path,l=this.parsedConfig.filter(f=>f.path===o).map(({section:f,name:w,value:v})=>{const I=re[f]&&re[f][w];return I?I(v):v});return i?l:l.pop()}async getall(t){return this.get(t,!0)}async getSubsections(t){return this.parsedConfig.filter(i=>i.isSection&&i.section===t).map(i=>i.subsection)}async deleteSection(t,i){this.parsedConfig=this.parsedConfig.filter(o=>!(o.section===t&&o.subsection===i))}async append(t,i){return this.set(t,i,!0)}async set(t,i,o=!1){const{section:l,subsection:f,name:w,path:v,sectionPath:I,isSection:T}=Ie(t),k=Ue(this.parsedConfig,M=>M.path===v);if(i==null)k!==-1&&this.parsedConfig.splice(k,1);else if(k!==-1){const M=this.parsedConfig[k],D=Object.assign({},M,{name:w,value:i,modified:!0});o?this.parsedConfig.splice(k+1,0,D):this.parsedConfig[k]=D}else{const M=this.parsedConfig.findIndex(V=>V.path===I),D={section:l,subsection:f,name:w,value:i,modified:!0,path:v};if(xe.test(l)&&tt.test(w))if(M>=0)this.parsedConfig.splice(M+1,0,D);else{const V={isSection:T,section:l,subsection:f,modified:!0,path:I};this.parsedConfig.push(V,D)}}}toString(){return this.parsedConfig.map(({line:t,section:i,subsection:o,name:l,value:f,modified:w=!1})=>w?l!=null&&f!=null?typeof f=="string"&&/[#;]/.test(f)?`	${l} = "${f}"`:`	${l} = ${f}`:o!=null?`[${i} "${o}"]`:`[${i}]`:t).join(`
`)}}class ue{static async get({fs:t,gitdir:i}){const o=await t.read(`${i}/config`,{encoding:"utf8"});return Q.from(o)}static async save({fs:t,gitdir:i,config:o}){await t.write(`${i}/config`,o.toString(),{encoding:"utf8"})}}const A=a=>[`${a}`,`refs/${a}`,`refs/tags/${a}`,`refs/heads/${a}`,`refs/remotes/${a}`,`refs/remotes/${a}/HEAD`],Ee=["config","description","index","shallow","commondir"];let Xe;async function m(a,t){return Xe===void 0&&(Xe=new r),Xe.acquire(a,t)}class H{static async updateRemoteRefs({fs:t,gitdir:i,remote:o,refs:l,symrefs:f,tags:w,refspecs:v=void 0,prune:I=!1,pruneTags:T=!1}){for(const fe of l.values())if(!fe.match(/[0-9a-f]{40}/))throw new Ke(fe);const k=await ue.get({fs:t,gitdir:i});if(!v){if(v=await k.getall(`remote.${o}.fetch`),v.length===0)throw new Ye(o);v.unshift(`+HEAD:refs/remotes/${o}/HEAD`)}const M=Qe.from(v),D=new Map;if(T){const fe=await H.listRefs({fs:t,gitdir:i,filepath:"refs/tags"});await H.deleteRefs({fs:t,gitdir:i,refs:fe.map(we=>`refs/tags/${we}`)})}if(w){for(const fe of l.keys())if(fe.startsWith("refs/tags")&&!fe.endsWith("^{}")&&!await H.exists({fs:t,gitdir:i,ref:fe})){const we=l.get(fe);D.set(fe,we)}}const V=M.translate([...l.keys()]);for(const[fe,we]of V){const ve=l.get(fe);D.set(we,ve)}const ee=M.translate([...f.keys()]);for(const[fe,we]of ee){const ve=f.get(fe),Re=M.translateOne(ve);Re&&D.set(we,`ref: ${Re}`)}const ge=[];if(I){for(const fe of M.localNamespaces()){const we=(await H.listRefs({fs:t,gitdir:i,filepath:fe})).map(ve=>`${fe}/${ve}`);for(const ve of we)D.has(ve)||ge.push(ve)}ge.length>0&&await H.deleteRefs({fs:t,gitdir:i,refs:ge})}for(const[fe,we]of D)await m(fe,async()=>t.write(p(i,fe),`${we.trim()}
`,"utf8"));return{pruned:ge}}static async writeRef({fs:t,gitdir:i,ref:o,value:l}){if(!l.match(/[0-9a-f]{40}/))throw new Ke(l);await m(o,async()=>t.write(p(i,o),`${l.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:t,gitdir:i,ref:o,value:l}){await m(o,async()=>t.write(p(i,o),`ref: ${l.trim()}
`,"utf8"))}static async deleteRef({fs:t,gitdir:i,ref:o}){return H.deleteRefs({fs:t,gitdir:i,refs:[o]})}static async deleteRefs({fs:t,gitdir:i,refs:o}){await Promise.all(o.map(v=>t.rm(p(i,v))));let l=await m("packed-refs",async()=>t.read(`${i}/packed-refs`,{encoding:"utf8"}));const f=at.from(l),w=f.refs.size;for(const v of o)f.refs.has(v)&&f.delete(v);f.refs.size<w&&(l=f.toString(),await m("packed-refs",async()=>t.write(`${i}/packed-refs`,l,{encoding:"utf8"})))}static async resolve({fs:t,gitdir:i,ref:o,depth:l=void 0}){if(l!==void 0&&(l--,l===-1))return o;if(o.startsWith("ref: "))return o=o.slice(5),H.resolve({fs:t,gitdir:i,ref:o,depth:l});if(o.length===40&&/[0-9a-f]{40}/.test(o))return o;const f=await H.packedRefs({fs:t,gitdir:i}),w=A(o).filter(v=>!Ee.includes(v));for(const v of w){const I=await m(v,async()=>await t.read(`${i}/${v}`,{encoding:"utf8"})||f.get(v));if(I)return H.resolve({fs:t,gitdir:i,ref:I.trim(),depth:l})}throw new je(o)}static async exists({fs:t,gitdir:i,ref:o}){try{return await H.expand({fs:t,gitdir:i,ref:o}),!0}catch{return!1}}static async expand({fs:t,gitdir:i,ref:o}){if(o.length===40&&/[0-9a-f]{40}/.test(o))return o;const l=await H.packedRefs({fs:t,gitdir:i}),f=A(o);for(const w of f)if(await m(w,async()=>t.exists(`${i}/${w}`))||l.has(w))return w;throw new je(o)}static async expandAgainstMap({ref:t,map:i}){const o=A(t);for(const l of o)if(await i.has(l))return l;throw new je(t)}static resolveAgainstMap({ref:t,fullref:i=t,depth:o=void 0,map:l}){if(o!==void 0&&(o--,o===-1))return{fullref:i,oid:t};if(t.startsWith("ref: "))return t=t.slice(5),H.resolveAgainstMap({ref:t,fullref:i,depth:o,map:l});if(t.length===40&&/[0-9a-f]{40}/.test(t))return{fullref:i,oid:t};const f=A(t);for(const w of f){const v=l.get(w);if(v)return H.resolveAgainstMap({ref:v.trim(),fullref:w,depth:o,map:l})}throw new je(t)}static async packedRefs({fs:t,gitdir:i}){const o=await m("packed-refs",async()=>t.read(`${i}/packed-refs`,{encoding:"utf8"}));return at.from(o).refs}static async listRefs({fs:t,gitdir:i,filepath:o}){const l=H.packedRefs({fs:t,gitdir:i});let f=null;try{f=await t.readdirDeep(`${i}/${o}`),f=f.map(w=>w.replace(`${i}/${o}/`,""))}catch{f=[]}for(let w of(await l).keys())w.startsWith(o)&&(w=w.replace(o+"/",""),f.includes(w)||f.push(w));return f.sort(ht),f}static async listBranches({fs:t,gitdir:i,remote:o}){return o?H.listRefs({fs:t,gitdir:i,filepath:`refs/remotes/${o}`}):H.listRefs({fs:t,gitdir:i,filepath:"refs/heads"})}static async listTags({fs:t,gitdir:i}){return(await H.listRefs({fs:t,gitdir:i,filepath:"refs/tags"})).filter(l=>!l.endsWith("^{}"))}}function pe(a,t){return j(C(a),C(t))}function C(a){return a.mode==="040000"?a.path+"/":a.path}function K(a){switch(a){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new x(`Unexpected GitTree entry mode: ${a}`)}function le(a){const t=[];let i=0;for(;i<a.length;){const o=a.indexOf(32,i);if(o===-1)throw new x(`GitTree: Error parsing buffer at byte location ${i}: Could not find the next space character.`);const l=a.indexOf(0,i);if(l===-1)throw new x(`GitTree: Error parsing buffer at byte location ${i}: Could not find the next null character.`);let f=a.slice(i,o).toString("utf8");f==="40000"&&(f="040000");const w=K(f),v=a.slice(o+1,l).toString("utf8");if(v.includes("\\")||v.includes("/"))throw new R(v);const I=a.slice(l+1,l+21).toString("hex");i=l+21,t.push({mode:f,path:v,oid:I,type:w})}return t}function Ve(a){if(typeof a=="number"&&(a=a.toString(8)),a.match(/^0?4.*/))return"040000";if(a.match(/^1006.*/))return"100644";if(a.match(/^1007.*/))return"100755";if(a.match(/^120.*/))return"120000";if(a.match(/^160.*/))return"160000";throw new x(`Could not understand file mode: ${a}`)}function Le(a){return!a.oid&&a.sha&&(a.oid=a.sha),a.mode=Ve(a.mode),a.type||(a.type=K(a.mode)),a}class Pe{constructor(t){if(Buffer.isBuffer(t))this._entries=le(t);else if(Array.isArray(t))this._entries=t.map(Le);else throw new x("invalid type passed to GitTree constructor");this._entries.sort(X)}static from(t){return new Pe(t)}render(){return this._entries.map(t=>`${t.mode} ${t.type} ${t.oid}    ${t.path}`).join(`
`)}toObject(){const t=[...this._entries];return t.sort(pe),Buffer.concat(t.map(i=>{const o=Buffer.from(i.mode.replace(/^0/,"")),l=Buffer.from(" "),f=Buffer.from(i.path,"utf8"),w=Buffer.from([0]),v=Buffer.from(i.oid,"hex");return Buffer.concat([o,l,f,w,v])}))}entries(){return this._entries}*[Symbol.iterator](){for(const t of this._entries)yield t}}class rt{static wrap({type:t,object:i}){const o=`${t} ${i.length}\0`,l=o.length,f=l+i.length,w=new Uint8Array(f);for(let v=0;v<l;v++)w[v]=o.charCodeAt(v);return w.set(i,l),w}static unwrap(t){const i=t.indexOf(32),o=t.indexOf(0),l=t.slice(0,i).toString("utf8"),f=t.slice(i+1,o).toString("utf8"),w=t.length-(o+1);if(parseInt(f)!==w)throw new x(`Length mismatch: expected ${f} bytes but got ${w} instead.`);return{type:l,object:Buffer.from(t.slice(o+1))}}}async function Jt({fs:a,gitdir:t,oid:i}){const o=`objects/${i.slice(0,2)}/${i.slice(2)}`,l=await a.read(`${t}/${o}`);return l?{object:l,format:"deflated",source:o}:null}function pt(a,t){const i=new y(a),o=ot(i);if(o!==t.byteLength)throw new x(`applyDelta expected source buffer to be ${o} bytes but the provided buffer was ${t.length} bytes`);const l=ot(i);let f;const w=Et(i,t);if(w.byteLength===l)f=w;else{f=Buffer.alloc(l);const v=new y(f);for(v.copy(w);!i.eof();)v.copy(Et(i,t));const I=v.tell();if(l!==I)throw new x(`applyDelta expected target buffer to be ${l} bytes but the resulting buffer was ${I} bytes`)}return f}function ot(a){let t=0,i=0,o=null;do o=a.readUInt8(),t|=(o&127)<<i,i+=7;while(o&128);return t}function bt(a,t,i){let o=0,l=0;for(;i--;)t&1&&(o|=a.readUInt8()<<l),t>>=1,l+=8;return o}function Et(a,t){const i=a.readUInt8(),o=128,l=15,f=112;if(i&o){const w=bt(a,i&l,4);let v=bt(a,(i&f)>>4,3);return v===0&&(v=65536),t.slice(w,w+v)}else return a.slice(i)}function $t(a){let t=[a];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function Cr(a){return a[Symbol.asyncIterator]?a[Symbol.asyncIterator]():a[Symbol.iterator]?a[Symbol.iterator]():a.next?a:$t(a)}class Tr{constructor(t){if(typeof Buffer>"u")throw new Error("Missing Buffer dependency");this.stream=Cr(t),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(t){if(!this.eof())return this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t),this.buffer.slice(this.undoCursor,this.cursor)}async skip(t){this.eof()||(this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:t,value:i}=await this.stream.next();return t&&(this._ended=!0,!i)?Buffer.alloc(0):(i&&(i=Buffer.from(i)),i)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(t){this.undoCursor=this.cursor,this.cursor+=t,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(t){if(this._ended)return;const i=[this.buffer];for(;this.cursor+t>vt(i);){const o=await this._next();if(this._ended)break;i.push(o)}this.buffer=Buffer.concat(i)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function vt(a){return a.reduce((t,i)=>t+i.length,0)}async function Ht(a,t){const i=new Tr(a);let o=await i.read(4);if(o=o.toString("utf8"),o!=="PACK")throw new x(`Invalid PACK header '${o}'`);let l=await i.read(4);if(l=l.readUInt32BE(0),l!==2)throw new x(`Invalid packfile version: ${l}`);let f=await i.read(4);if(f=f.readUInt32BE(0),!(f<1))for(;!i.eof()&&f--;){const w=i.tell(),{type:v,length:I,ofs:T,reference:k}=await At(i),M=new c.Inflate;for(;!M.result;){const D=await i.chunk();if(!D)break;if(M.push(D,!1),M.err)throw new x(`Pako error: ${M.msg}`);if(M.result){if(M.result.length!==I)throw new x("Inflated object size is different from that stated in packfile.");await i.undo(),await i.read(D.length-M.strm.avail_in);const V=i.tell();await t({data:M.result,type:v,num:f,offset:w,end:V,reference:k,ofs:T})}}}}async function At(a){let t=await a.byte();const i=t>>4&7;let o=t&15;if(t&128){let w=4;do t=await a.byte(),o|=(t&127)<<w,w+=7;while(t&128)}let l,f;if(i===6){let w=0;l=0;const v=[];do t=await a.byte(),l|=(t&127)<<w,w+=7,v.push(t);while(t&128);f=Buffer.from(v)}return i===7&&(f=await a.read(20)),{type:i,length:o,ofs:l,reference:f}}async function Qt(a){return c.inflate(a)}function er(a){const t=[];let i=0,o=0;do{i=a.readUInt8();const l=i&127;t.push(l),o=i&128}while(o);return t.reduce((l,f)=>l+1<<7|f,-1)}function ii(a,t){let i=t,o=4,l=null;do l=a.readUInt8(),i|=(l&127)<<o,o+=7;while(l&128);return i}class Wr{constructor(t){Object.assign(this,t),this.offsetCache={}}static async fromIdx({idx:t,getExternalRefDelta:i}){const o=new y(t);if(o.slice(4).toString("hex")!=="ff744f63")return;const f=o.readUInt32BE();if(f!==2)throw new x(`Unable to read version ${f} packfile IDX. (Only version 2 supported)`);if(t.byteLength>2048*1024*1024)throw new x("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");o.seek(o.tell()+1020);const w=o.readUInt32BE(),v=[];for(let k=0;k<w;k++){const M=o.slice(20).toString("hex");v[k]=M}o.seek(o.tell()+4*w);const I=new Map;for(let k=0;k<w;k++)I.set(v[k],o.readUInt32BE());const T=o.slice(20).toString("hex");return new Wr({hashes:v,crcs:{},offsets:I,packfileSha:T,getExternalRefDelta:i})}static async fromPack({pack:t,getExternalRefDelta:i,onProgress:o}){const l={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},f={},w=t.slice(-20).toString("hex"),v=[],I={},T=new Map;let k=null,M=null;await Ht([t],async({data:fe,type:we,reference:ve,offset:Re,num:Ne})=>{k===null&&(k=Ne);const Ge=Math.floor((k-Ne)*100/k);Ge!==M&&o&&await o({phase:"Receiving objects",loaded:k-Ne,total:k}),M=Ge,we=l[we],["commit","tree","blob","tag"].includes(we)?f[Re]={type:we,offset:Re}:we==="ofs-delta"?f[Re]={type:we,offset:Re}:we==="ref-delta"&&(f[Re]={type:we,offset:Re})});const D=Object.keys(f).map(Number);for(const[fe,we]of D.entries()){const ve=fe+1===D.length?t.byteLength-20:D[fe+1],Re=f[we],Ne=s.buf(t.slice(we,ve))>>>0;Re.end=ve,Re.crc=Ne}const V=new Wr({pack:Promise.resolve(t),packfileSha:w,crcs:I,hashes:v,offsets:T,getExternalRefDelta:i});M=null;let ee=0;const ge=[0,0,0,0,0,0,0,0,0,0,0,0];for(let fe in f){fe=Number(fe);const we=Math.floor(ee*100/k);we!==M&&o&&await o({phase:"Resolving deltas",loaded:ee,total:k}),ee++,M=we;const ve=f[fe];if(!ve.oid)try{V.readDepth=0,V.externalReadDepth=0;const{type:Re,object:Ne}=await V.readSlice({start:fe});ge[V.readDepth]+=1;const Ge=await Z(rt.wrap({type:Re,object:Ne}));ve.oid=Ge,v.push(Ge),T.set(Ge,fe),I[Ge]=ve.crc}catch{continue}}return v.sort(),V}async toBuffer(){const t=[],i=(T,k)=>{t.push(Buffer.from(T,k))};i("ff744f63","hex"),i("00000002","hex");const o=new y(Buffer.alloc(256*4));for(let T=0;T<256;T++){let k=0;for(const M of this.hashes)parseInt(M.slice(0,2),16)<=T&&k++;o.writeUInt32BE(k)}t.push(o.buffer);for(const T of this.hashes)i(T,"hex");const l=new y(Buffer.alloc(this.hashes.length*4));for(const T of this.hashes)l.writeUInt32BE(this.crcs[T]);t.push(l.buffer);const f=new y(Buffer.alloc(this.hashes.length*4));for(const T of this.hashes)f.writeUInt32BE(this.offsets.get(T));t.push(f.buffer),i(this.packfileSha,"hex");const w=Buffer.concat(t),v=await Z(w),I=Buffer.alloc(20);return I.write(v,"hex"),Buffer.concat([w,I])}async load({pack:t}){this.pack=t}async unload(){this.pack=null}async read({oid:t}){if(!this.offsets.get(t)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(t);throw new x(`Could not read object ${t} from packfile`)}const i=this.offsets.get(t);return this.readSlice({start:i})}async readSlice({start:t}){if(this.offsetCache[t])return Object.assign({},this.offsetCache[t]);this.readDepth++;const i={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new x("Tried to read from a GitPackIndex with no packfile loaded into memory");const o=(await this.pack).slice(t),l=new y(o),f=l.readUInt8(),w=f&112;let v=i[w];if(v===void 0)throw new x("Unrecognized type: 0b"+w.toString(2));const I=f&15;let T=I;f&128&&(T=ii(l,I));let M=null,D=null;if(v==="ofs_delta"){const ee=er(l),ge=t-ee;({object:M,type:v}=await this.readSlice({start:ge}))}if(v==="ref_delta"){const ee=l.slice(20).toString("hex");({object:M,type:v}=await this.read({oid:ee}))}const V=o.slice(l.tell());if(D=Buffer.from(await Qt(V)),D.byteLength!==T)throw new x(`Packfile told us object would have length ${T} but it had length ${D.byteLength}`);return M&&(D=Buffer.from(pt(D,M))),this.readDepth>3&&(this.offsetCache[t]={type:v,object:D}),{type:v,format:"content",object:D}}}const ai=Symbol("PackfileCache");async function _h({fs:a,filename:t,getExternalRefDelta:i,emitter:o,emitterPrefix:l}){const f=await a.read(t);return Wr.fromIdx({idx:f,getExternalRefDelta:i})}function Zi({fs:a,cache:t,filename:i,getExternalRefDelta:o,emitter:l,emitterPrefix:f}){t[ai]||(t[ai]=new Map);let w=t[ai].get(i);return w||(w=_h({fs:a,filename:i,getExternalRefDelta:o,emitter:l,emitterPrefix:f}),t[ai].set(i,w)),w}async function Sh({fs:a,cache:t,gitdir:i,oid:o,format:l="content",getExternalRefDelta:f}){let w=await a.readdir(p(i,"objects/pack"));w=w.filter(v=>v.endsWith(".idx"));for(const v of w){const I=`${i}/objects/pack/${v}`,T=await Zi({fs:a,cache:t,filename:I,getExternalRefDelta:f});if(T.error)throw new x(T.error);if(T.offsets.has(o)){if(!T.pack){const M=I.replace(/idx$/,"pack");T.pack=a.read(M)}const k=await T.read({oid:o,getExternalRefDelta:f});return k.format="content",k.source=`objects/pack/${v.replace(/idx$/,"pack")}`,k}}return null}async function dt({fs:a,cache:t,gitdir:i,oid:o,format:l="content"}){const f=k=>dt({fs:a,cache:t,gitdir:i,oid:k});let w;if(o==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(w={format:"wrapped",object:Buffer.from("tree 0\0")}),w||(w=await Jt({fs:a,gitdir:i,oid:o})),!w){if(w=await Sh({fs:a,cache:t,gitdir:i,oid:o,getExternalRefDelta:f}),!w)throw new je(o);return w}if(l==="deflated"||(w.format==="deflated"&&(w.object=Buffer.from(await Qt(w.object)),w.format="wrapped"),l==="wrapped"))return w;const v=await Z(w.object);if(v!==o)throw new x(`SHA check failed! Expected ${o}, computed ${v}`);const{object:I,type:T}=rt.unwrap(w.object);if(w.type=T,w.object=I,w.format="content",l==="content")return w;throw new x(`invalid requested format "${l}"`)}class ir extends S{constructor(t,i,o=!0){super(`Failed to create ${t} at ${i} because it already exists.${o?` (Hint: use 'force: true' parameter to overwrite existing ${t}.)`:""}`),this.code=this.name=ir.code,this.data={noun:t,where:i,canForce:o}}}ir.code="AlreadyExistsError";class hn extends S{constructor(t,i,o){super(`Found multiple ${t} matching "${i}" (${o.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=hn.code,this.data={nouns:t,short:i,matches:o}}}hn.code="AmbiguousError";class pn extends S{constructor(t){super(`Your local changes to the following files would be overwritten by checkout: ${t.join(", ")}`),this.code=this.name=pn.code,this.data={filepaths:t}}}pn.code="CheckoutConflictError";class gn extends S{constructor(t,i){super(`Cannot cherry-pick merge commit ${t}. Merge commits have ${i} parents and require specifying which parent to use as the base.`),this.code=this.name=gn.code,this.data={oid:t,parentCount:i}}}gn.code="CherryPickMergeCommitError";class mn extends S{constructor(t){super(`Cannot cherry-pick root commit ${t}. Root commits have no parents.`),this.code=this.name=mn.code,this.data={oid:t}}}mn.code="CherryPickRootCommitError";class wn extends S{constructor(t,i){super(`Failed to checkout "${t}" because commit ${i} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=wn.code,this.data={ref:t,oid:i}}}wn.code="CommitNotFetchedError";class yn extends S{constructor(){super("Empty response from git server."),this.code=this.name=yn.code,this.data={}}}yn.code="EmptyServerResponseError";class bn extends S{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=bn.code,this.data={}}}bn.code="FastForwardError";class vn extends S{constructor(t,i){super(`One or more branches were not updated: ${t}`),this.code=this.name=vn.code,this.data={prettyDetails:t,result:i}}}vn.code="GitPushError";class Vr extends S{constructor(t,i,o){super(`HTTP Error: ${t} ${i}`),this.code=this.name=Vr.code,this.data={statusCode:t,statusMessage:i,response:o}}}Vr.code="HttpError";class yr extends S{constructor(t){let i="invalid filepath";t==="leading-slash"||t==="trailing-slash"?i='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':t==="directory"&&(i='"filepath" should not be a directory.'),super(i),this.code=this.name=yr.code,this.data={reason:t}}}yr.code="InvalidFilepathError";class ar extends S{constructor(t,i){super(`"${t}" would be an invalid git reference. (Hint: a valid alternative would be "${i}".)`),this.code=this.name=ar.code,this.data={ref:t,suggestion:i}}}ar.code="InvalidRefNameError";class xn extends S{constructor(t){super(`Maximum search depth of ${t} exceeded.`),this.code=this.name=xn.code,this.data={depth:t}}}xn.code="MaxDepthError";class Zr extends S{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=Zr.code,this.data={}}}Zr.code="MergeNotSupportedError";class Rr extends S{constructor(t,i,o,l){super(`Automatic merge failed with one or more merge conflicts in the following files: ${t.toString()}. Fix conflicts then commit the result.`),this.code=this.name=Rr.code,this.data={filepaths:t,bothModified:i,deleteByUs:o,deleteByTheirs:l}}}Rr.code="MergeConflictError";class Pt extends S{constructor(t){super(`No name was provided for ${t} in the argument or in the .git/config file.`),this.code=this.name=Pt.code,this.data={role:t}}}Pt.code="MissingNameError";class qt extends S{constructor(t){super(`The function requires a "${t}" parameter but none was provided.`),this.code=this.name=qt.code,this.data={parameter:t}}}qt.code="MissingParameterError";class _n extends S{constructor(t){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=_n.code,this.data={errors:t},this.errors=t}}_n.code="MultipleGitError";class Or extends S{constructor(t,i){super(`Expected "${t}" but received "${i}".`),this.code=this.name=Or.code,this.data={expected:t,actual:i}}}Or.code="ParseError";class Kr extends S{constructor(t){let i="";t==="not-fast-forward"?i=" because it was not a simple fast-forward":t==="tag-exists"&&(i=" because tag already exists"),super(`Push rejected${i}. Use "force: true" to override.`),this.code=this.name=Kr.code,this.data={reason:t}}}Kr.code="PushRejectedError";class br extends S{constructor(t,i){super(`Remote does not support the "${t}" so the "${i}" parameter cannot be used.`),this.code=this.name=br.code,this.data={capability:t,parameter:i}}}br.code="RemoteCapabilityError";class Sn extends S{constructor(t,i){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${t}`),this.code=this.name=Sn.code,this.data={preview:t,response:i}}}Sn.code="SmartHttpError";class kn extends S{constructor(t,i,o){super(`Git remote "${t}" uses an unrecognized transport protocol: "${i}"`),this.code=this.name=kn.code,this.data={url:t,transport:i,suggestion:o}}}kn.code="UnknownTransportError";class En extends S{constructor(t){super(`Cannot parse remote URL: "${t}"`),this.code=this.name=En.code,this.data={url:t}}}En.code="UrlParseError";class Xr extends S{constructor(){super("The operation was canceled."),this.code=this.name=Xr.code,this.data={}}}Xr.code="UserCanceledError";class An extends S{constructor(t){super(`Could not merge index: Entry for '${t}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=An.code,this.data={filepath:t}}}An.code="IndexResetError";class In extends S{constructor(t){super(`"${t}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=In.code,this.data={ref:t}}}In.code="NoCommitError";var js=Object.freeze({__proto__:null,AlreadyExistsError:ir,AmbiguousError:hn,CheckoutConflictError:pn,CherryPickMergeCommitError:gn,CherryPickRootCommitError:mn,CommitNotFetchedError:wn,EmptyServerResponseError:yn,FastForwardError:bn,GitPushError:vn,HttpError:Vr,InternalError:x,InvalidFilepathError:yr,InvalidOidError:Ke,InvalidRefNameError:ar,MaxDepthError:xn,MergeNotSupportedError:Zr,MergeConflictError:Rr,MissingNameError:Pt,MissingParameterError:qt,MultipleGitError:_n,NoRefspecError:Ye,NotFoundError:je,ObjectTypeError:Fe,ParseError:Or,PushRejectedError:Kr,RemoteCapabilityError:br,SmartHttpError:Sn,UnknownTransportError:kn,UnsafeFilepathError:R,UrlParseError:En,UserCanceledError:Xr,UnmergedPathsError:_,IndexResetError:An,NoCommitError:In});function Ki({name:a,email:t,timestamp:i,timezoneOffset:o}){return o=kh(o),`${a} <${t}> ${i} ${o}`}function kh(a){const t=Eh(Ah(a));a=Math.abs(a);const i=Math.floor(a/60);a-=i*60;let o=String(i),l=String(a);return o.length<2&&(o="0"+o),l.length<2&&(l="0"+l),(t===-1?"-":"+")+o+l}function Eh(a){return Math.sign(a)||(Object.is(a,-0)?-1:1)}function Ah(a){return a===0?a:-a}function gr(a){return a=a.replace(/\r/g,""),a=a.replace(/^\n+/,""),a=a.replace(/\n+$/,"")+`
`,a}function oi(a){const[,t,i,o,l]=a.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:t,email:i,timestamp:Number(o),timezoneOffset:Ih(l)}}function Ih(a){let[,t,i,o]=a.match(/(\+|-)(\d\d)(\d\d)/);return o=(t==="+"?1:-1)*(Number(i)*60+Number(o)),Ch(o)}function Ch(a){return a===0?a:-a}class Gt{constructor(t){if(typeof t=="string")this._tag=t;else if(Buffer.isBuffer(t))this._tag=t.toString("utf8");else if(typeof t=="object")this._tag=Gt.render(t);else throw new x("invalid type passed to GitAnnotatedTag constructor")}static from(t){return new Gt(t)}static render(t){return`object ${t.object}
type ${t.type}
tag ${t.tag}
tagger ${Ki(t.tagger)}

${t.message}
${t.gpgsig?t.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const t=this.withoutSignature();return t.slice(t.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const t=this.justHeaders().split(`
`),i=[];for(const l of t)l[0]===" "?i[i.length-1]+=`
`+l.slice(1):i.push(l);const o={};for(const l of i){const f=l.slice(0,l.indexOf(" ")),w=l.slice(l.indexOf(" ")+1);Array.isArray(o[f])?o[f].push(w):o[f]=w}return o.tagger&&(o.tagger=oi(o.tagger)),o.committer&&(o.committer=oi(o.committer)),o}withoutSignature(){const t=gr(this._tag);return t.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?t:t.slice(0,t.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const t=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return gr(t)}payload(){return this.withoutSignature()+`
`}toObject(){return Buffer.from(this._tag,"utf8")}static async sign(t,i,o){const l=t.payload();let{signature:f}=await i({payload:l,secretKey:o});f=gr(f);const w=l+f;return Gt.from(w)}}function Xi(a){return a.trim().split(`
`).map(t=>" "+t).join(`
`)+`
`}function Th(a){return a.split(`
`).map(t=>t.replace(/^ /,"")).join(`
`)}class gt{constructor(t){if(typeof t=="string")this._commit=t;else if(Buffer.isBuffer(t))this._commit=t.toString("utf8");else if(typeof t=="object")this._commit=gt.render(t);else throw new x("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:t,signature:i}){const o=gt.justHeaders(t),l=gt.justMessage(t),f=gr(o+`
gpgsig`+Xi(i)+`
`+l);return new gt(f)}static from(t){return new gt(t)}toObject(){return Buffer.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return gt.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(t){return gr(t.slice(t.indexOf(`

`)+2))}static justHeaders(t){return t.slice(0,t.indexOf(`

`))}parseHeaders(){const t=gt.justHeaders(this._commit).split(`
`),i=[];for(const l of t)l[0]===" "?i[i.length-1]+=`
`+l.slice(1):i.push(l);const o={parent:[]};for(const l of i){const f=l.slice(0,l.indexOf(" ")),w=l.slice(l.indexOf(" ")+1);Array.isArray(o[f])?o[f].push(w):o[f]=w}return o.author&&(o.author=oi(o.author)),o.committer&&(o.committer=oi(o.committer)),o}static renderHeaders(t){let i="";if(t.tree?i+=`tree ${t.tree}
`:i+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,t.parent){if(t.parent.length===void 0)throw new x("commit 'parent' property should be an array");for(const f of t.parent)i+=`parent ${f}
`}const o=t.author;i+=`author ${Ki(o)}
`;const l=t.committer||t.author;return i+=`committer ${Ki(l)}
`,t.gpgsig&&(i+="gpgsig"+Xi(t.gpgsig)),i}static render(t){return gt.renderHeaders(t)+`
`+gr(t.message)}render(){return this._commit}withoutSignature(){const t=gr(this._commit);if(t.indexOf(`
gpgsig`)===-1)return t;const i=t.slice(0,t.indexOf(`
gpgsig`)),o=t.slice(t.indexOf(`-----END PGP SIGNATURE-----
`)+28);return gr(i+`
`+o)}isolateSignature(){const t=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return Th(t)}static async sign(t,i,o){const l=t.withoutSignature(),f=gt.justMessage(t._commit);let{signature:w}=await i({payload:l,secretKey:o});w=gr(w);const I=gt.justHeaders(t._commit)+`
gpgsig`+Xi(w)+`
`+f;return gt.from(I)}}async function Yr({fs:a,cache:t,gitdir:i,oid:o}){if(o==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:Pe.from([]),oid:o};const{type:l,object:f}=await dt({fs:a,cache:t,gitdir:i,oid:o});if(l==="tag")return o=Gt.from(f).parse().object,Yr({fs:a,cache:t,gitdir:i,oid:o});if(l==="commit")return o=gt.from(f).parse().tree,Yr({fs:a,cache:t,gitdir:i,oid:o});if(l!=="tree")throw new Fe(o,l,"tree");return{tree:Pe.from(f),oid:o}}class Rh{constructor({fs:t,gitdir:i,ref:o,cache:l}){this.fs=t,this.cache=l,this.gitdir=i,this.mapPromise=(async()=>{const w=new Map;let v;try{v=await H.resolve({fs:t,gitdir:i,ref:o})}catch(T){T instanceof je&&(v="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const I=await Yr({fs:t,cache:this.cache,gitdir:i,oid:v});return I.type="tree",I.mode="40000",w.set(".",I),w})();const f=this;this.ConstructEntry=class{constructor(v){this._fullpath=v,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return f.type(this)}async mode(){return f.mode(this)}async stat(){return f.stat(this)}async content(){return f.content(this)}async oid(){return f.oid(this)}}}async readdir(t){const i=t._fullpath,{fs:o,cache:l,gitdir:f}=this,w=await this.mapPromise,v=w.get(i);if(!v)throw new Error(`No obj for ${i}`);const I=v.oid;if(!I)throw new Error(`No oid for obj ${JSON.stringify(v)}`);if(v.type!=="tree")return null;const{type:T,object:k}=await dt({fs:o,cache:l,gitdir:f,oid:I});if(T!==v.type)throw new Fe(I,T,v.type);const M=Pe.from(k);for(const D of M)w.set(p(i,D.path),D);return M.entries().map(D=>p(i,D.path))}async type(t){if(t._type===!1){const i=await this.mapPromise,{type:o}=i.get(t._fullpath);t._type=o}return t._type}async mode(t){if(t._mode===!1){const i=await this.mapPromise,{mode:o}=i.get(t._fullpath);t._mode=L(parseInt(o,8))}return t._mode}async stat(t){}async content(t){if(t._content===!1){const i=await this.mapPromise,{fs:o,cache:l,gitdir:f}=this,v=i.get(t._fullpath).oid,{type:I,object:T}=await dt({fs:o,cache:l,gitdir:f,oid:v});I!=="blob"?t._content=void 0:t._content=new Uint8Array(T)}return t._content}async oid(t){if(t._oid===!1){const o=(await this.mapPromise).get(t._fullpath);t._oid=o.oid}return t._oid}}function Vt({ref:a="HEAD"}={}){const t=Object.create(null);return Object.defineProperty(t,Ae,{value:function({fs:i,gitdir:o,cache:l}){return new Rh({fs:i,gitdir:o,ref:a,cache:l})}}),Object.freeze(t),t}class Oh{constructor({fs:t,dir:i,gitdir:o,cache:l}){this.fs=t,this.cache=l,this.dir=i,this.gitdir=o,this.config=null;const f=this;this.ConstructEntry=class{constructor(v){this._fullpath=v,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return f.type(this)}async mode(){return f.mode(this)}async stat(){return f.stat(this)}async content(){return f.content(this)}async oid(){return f.oid(this)}}}async readdir(t){const i=t._fullpath,{fs:o,dir:l}=this,f=await o.readdir(p(l,i));return f===null?null:f.map(w=>p(i,w))}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const{fs:i,dir:o}=this;let l=await i.lstat(`${o}/${t._fullpath}`);if(!l)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);let f=l.isDirectory()?"tree":"blob";f==="blob"&&!l.isFile()&&!l.isSymbolicLink()&&(f="special"),t._type=f,l=G(l),t._mode=l.mode,l.size===-1&&t._actualSize&&(l.size=t._actualSize),t._stat=l}return t._stat}async content(t){if(t._content===!1){const{fs:i,dir:o,gitdir:l}=this;if(await t.type()==="tree")t._content=void 0;else{let f;if(await t.mode()>>12===10)f=await i.readlink(`${o}/${t._fullpath}`);else{const v=await(await this._getGitConfig(i,l)).get("core.autocrlf");f=await i.read(`${o}/${t._fullpath}`,{autocrlf:v})}t._actualSize=f.length,t._stat&&t._stat.size===-1&&(t._stat.size=t._actualSize),t._content=new Uint8Array(f)}}return t._content}async oid(t){if(t._oid===!1){const i=this,{fs:o,gitdir:l,cache:f}=this;let w;await he.acquire({fs:o,gitdir:l,cache:f},async function(v){const I=v.entriesMap.get(t._fullpath),T=await t.stat(),M=await(await i._getGitConfig(o,l)).get("core.filemode"),D=typeof process<"u"?process.platform!=="win32":!0;if(!I||de(T,I,M,D)){const V=await t.content();V===void 0?w=void 0:(w=await Z(rt.wrap({type:"blob",object:V})),I&&w===I.oid&&(!M||T.mode===I.mode)&&de(T,I,M,D)&&v.insert({filepath:t._fullpath,stats:T,oid:w}))}else w=I.oid}),t._oid=w}return t._oid}async _getGitConfig(t,i){return this.config?this.config:(this.config=await ue.get({fs:t,gitdir:i}),this.config)}}function Jr(){const a=Object.create(null);return Object.defineProperty(a,Ae,{value:function({fs:t,dir:i,gitdir:o,cache:l}){return new Oh({fs:t,dir:i,gitdir:o,cache:l})}}),Object.freeze(a),a}function Ph(a,t){const i=t-a;return Array.from({length:i},(o,l)=>a+l)}const Bs=typeof Array.prototype.flat>"u"?a=>a.reduce((t,i)=>t.concat(i),[]):a=>a.flat();class Mh{constructor(){this.value=null}consider(t){t!=null&&(this.value===null?this.value=t:t<this.value&&(this.value=t))}reset(){this.value=null}}function*jh(a){const t=new Mh;let i;const o=[],l=a.length;for(let f=0;f<l;f++)o[f]=a[f].next().value,o[f]!==void 0&&t.consider(o[f]);if(t.value!==null)for(;;){const f=[];i=t.value,t.reset();for(let w=0;w<l;w++)o[w]!==void 0&&o[w]===i?(f[w]=o[w],o[w]=a[w].next().value):f[w]=null,o[w]!==void 0&&t.consider(o[w]);if(yield f,t.value===null)return}}async function vr({fs:a,cache:t,dir:i,gitdir:o,trees:l,map:f=async(I,T)=>T,reduce:w=async(I,T)=>{const k=Bs(T);return I!==void 0&&k.unshift(I),k},iterate:v=(I,T)=>Promise.all([...T].map(I))}){const I=l.map(V=>V[Ae]({fs:a,dir:i,gitdir:o,cache:t})),T=new Array(I.length).fill("."),k=Ph(0,I.length),M=async V=>{k.forEach(fe=>{const we=V[fe];V[fe]=we&&new I[fe].ConstructEntry(we)});const ge=(await Promise.all(k.map(fe=>{const we=V[fe];return we?I[fe].readdir(we):[]}))).map(fe=>(fe===null?[]:fe)[Symbol.iterator]());return{entries:V,children:jh(ge)}},D=async V=>{const{entries:ee,children:ge}=await M(V),fe=ee.find(ve=>ve&&ve._fullpath)._fullpath,we=await f(fe,ee);if(we!==null){let ve=await v(D,ge);return ve=ve.filter(Re=>Re!==void 0),w(we,ve)}};return D(T)}async function Yi(a,t){const i=await a.readdir(t);i==null?await a.rm(t):i.length?await Promise.all(i.map(o=>{const l=p(t,o);return a.lstat(l).then(f=>{if(f)return f.isDirectory()?Yi(a,l):a.rm(l)})})).then(()=>a.rmdir(t)):await a.rmdir(t)}function Bh(a){return Fh(a)&&Fs(a.then)&&Fs(a.catch)}function Fh(a){return a&&typeof a=="object"}function Fs(a){return typeof a=="function"}function Ds(a){return Bh((i=>{try{return i.readFile().catch(o=>o)}catch(o){return o}})(a))}const Ls=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function $s(a,t){if(Ds(t))for(const i of Ls)a[`_${i}`]=t[i].bind(t);else for(const i of Ls)a[`_${i}`]=u(t[i].bind(t));Ds(t)?(t.cp&&(a._cp=t.cp.bind(t)),t.rm?a._rm=t.rm.bind(t):t.rmdir.length>1?a._rm=t.rmdir.bind(t):a._rm=Yi.bind(null,a)):(t.cp&&(a._cp=u(t.cp.bind(t))),t.rm?a._rm=u(t.rm.bind(t)):t.rmdir.length>2?a._rm=u(t.rmdir.bind(t)):a._rm=Yi.bind(null,a))}class qe{constructor(t){if(typeof t._original_unwrapped_fs<"u")return t;const i=Object.getOwnPropertyDescriptor(t,"promises");i&&i.enumerable?$s(this,t.promises):$s(this,t),this._original_unwrapped_fs=t}async exists(t,i={}){try{return await this._stat(t),!0}catch(o){if(o.code==="ENOENT"||o.code==="ENOTDIR"||(o.code||"").includes("ENS"))return!1;throw o}}async read(t,i={}){try{let o=await this._readFile(t,i);if(i.autocrlf==="true")try{o=new TextDecoder("utf8",{fatal:!0}).decode(o),o=o.replace(/\r\n/g,`
`),o=new TextEncoder().encode(o)}catch{}return typeof o!="string"&&(o=Buffer.from(o)),o}catch{return null}}async write(t,i,o={}){try{await this._writeFile(t,i,o)}catch{await this.mkdir(_e(t)),await this._writeFile(t,i,o)}}async mkdir(t,i=!1){try{await this._mkdir(t)}catch(o){if(o===null||o.code==="EEXIST")return;if(i)throw o;if(o.code==="ENOENT"){const l=_e(t);if(l==="."||l==="/"||l===t)throw o;await this.mkdir(l),await this.mkdir(t,!0)}}}async rm(t){try{await this._unlink(t)}catch(i){if(i.code!=="ENOENT")throw i}}async rmdir(t,i){try{i&&i.recursive?await this._rm(t,i):await this._rmdir(t)}catch(o){if(o.code!=="ENOENT")throw o}}async readdir(t){try{const i=await this._readdir(t);return i.sort(j),i}catch(i){return i.code==="ENOTDIR"?null:[]}}async readdirDeep(t){const i=await this._readdir(t);return(await Promise.all(i.map(async l=>{const f=t+"/"+l;return(await this._stat(f)).isDirectory()?this.readdirDeep(f):f}))).reduce((l,f)=>l.concat(f),[])}async lstat(t){try{return await this._lstat(t)}catch(i){if(i.code==="ENOENT"||(i.code||"").includes("ENS"))return null;throw i}}async readlink(t,i={encoding:"buffer"}){try{const o=await this._readlink(t,i);return Buffer.isBuffer(o)?o:Buffer.from(o)}catch(o){if(o.code==="ENOENT"||(o.code||"").includes("ENS"))return null;throw o}}async writelink(t,i){return this._symlink(i.toString("utf8"),t)}}function Y(a,t){if(t===void 0)throw new qt(a)}async function We({fsp:a,dotgit:t}){Y("fsp",a),Y("dotgit",t);const i=await a._stat(t).catch(()=>({isFile:()=>!1,isDirectory:()=>!1}));return i.isDirectory()?t:i.isFile()?a._readFile(t,"utf8").then(o=>o.trimRight().substr(8)).then(o=>p(_e(t),o)):t}async function si(a,t){return!a&&!t?!1:a&&!t||!a&&t?!0:!(await a.type()==="tree"&&await t.type()==="tree"||await a.type()===await t.type()&&await a.mode()===await t.mode()&&await a.oid()===await t.oid())}async function Ns({fs:a,dir:t,gitdir:i=p(t,".git"),commit:o="HEAD",cache:l={}}){try{Y("fs",a),Y("dir",t),Y("gitdir",i);const f=new qe(a),w=[Vt({ref:o}),Jr(),Oe()];let v=[];const I=await We({fsp:f,dotgit:i});await he.acquire({fs:f,gitdir:I,cache:l},async function(k){v=k.unmergedPaths});const T=await vr({fs:f,cache:l,dir:t,gitdir:I,trees:w,map:async function(k,[M,D,V]){const ee=!await si(D,V),ge=v.includes(k),fe=!await si(V,M);if(ee||ge)return M?{path:k,mode:await M.mode(),oid:await M.oid(),type:await M.type(),content:await M.content()}:void 0;if(fe)return!1;throw new An(k)}});await he.acquire({fs:f,gitdir:I,cache:l},async function(k){for(const M of T)if(M!==!1){if(!M){await f.rmdir(`${t}/${M.path}`,{recursive:!0}),k.delete({filepath:M.path});continue}if(M.type==="blob"){const D=new TextDecoder().decode(M.content);await f.write(`${t}/${M.path}`,D,{mode:M.mode}),k.insert({filepath:M.path,oid:M.oid,stage:0})}}})}catch(f){throw f.caller="git.abortMerge",f}}class Qr{static async isIgnored({fs:t,dir:i,gitdir:o=p(i,".git"),filepath:l}){if(ze(l)===".git")return!0;if(l===".")return!1;let f="";const w=p(o,"info","exclude");await t.exists(w)&&(f=await t.read(w,"utf8"));const v=[{gitignore:p(i,".gitignore"),filepath:l}],I=l.split("/").filter(Boolean);for(let k=1;k<I.length;k++){const M=I.slice(0,k).join("/"),D=I.slice(k).join("/");v.push({gitignore:p(i,M,".gitignore"),filepath:D})}let T=!1;for(const k of v){let M;try{M=await t.read(k.gitignore,"utf8")}catch(ee){if(ee.code==="NOENT")continue}const D=g().add(f);D.add(M);const V=_e(k.filepath);if(V!=="."&&D.ignores(V))return!0;T?T=!D.test(k.filepath).unignored:T=D.test(k.filepath).ignored}return T}}async function Dh({fs:a,gitdir:t,object:i,format:o,oid:l}){const f=`objects/${l.slice(0,2)}/${l.slice(2)}`,w=`${t}/${f}`;await a.exists(w)||await a.write(w,i)}let Ji=null;async function Us(a){return Ji===null&&(Ji=$h()),Ji?Lh(a):c.deflate(a)}async function Lh(a){const t=new CompressionStream("deflate"),i=new Blob([a]).stream().pipeThrough(t);return new Uint8Array(await new Response(i).arrayBuffer())}function $h(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function Wt({fs:a,gitdir:t,type:i,object:o,format:l="content",oid:f=void 0,dryRun:w=!1}){return l!=="deflated"&&(l!=="wrapped"&&(o=rt.wrap({type:i,object:o})),f=await Z(o),o=Buffer.from(await Us(o))),w||await Dh({fs:a,gitdir:t,object:o,format:"deflated",oid:f}),f}function zs(a){let t;for(;~(t=a.indexOf(92));)a[t]=47;return a}async function Gs({fs:a,dir:t,gitdir:i=p(t,".git"),filepath:o,cache:l={},force:f=!1,parallel:w=!0}){try{Y("fs",a),Y("dir",t),Y("gitdir",i),Y("filepath",o);const v=new qe(a),I=await We({fsp:v,dotgit:i});await he.acquire({fs:v,gitdir:I,cache:l},async T=>{const M=await(await ue.get({fs:v,gitdir:I})).get("core.autocrlf");return Qi({dir:t,gitdir:I,fs:v,filepath:o,index:T,force:f,parallel:w,autocrlf:M})})}catch(v){throw v.caller="git.add",v}}async function Qi({dir:a,gitdir:t,fs:i,filepath:o,index:l,force:f,parallel:w,autocrlf:v}){o=Array.isArray(o)?o:[o];const I=o.map(async D=>{if(!f&&await Qr.isIgnored({fs:i,dir:a,gitdir:t,filepath:D}))return;const V=await i.lstat(p(a,D));if(!V)throw new je(D);if(V.isDirectory()){const ee=await i.readdir(p(a,D));if(w){const ge=ee.map(fe=>Qi({dir:a,gitdir:t,fs:i,filepath:[p(D,fe)],index:l,force:f,parallel:w,autocrlf:v}));await Promise.all(ge)}else for(const ge of ee)await Qi({dir:a,gitdir:t,fs:i,filepath:[p(D,ge)],index:l,force:f,parallel:w,autocrlf:v})}else{const ee=V.isSymbolicLink()?await i.readlink(p(a,D)).then(zs):await i.read(p(a,D),{autocrlf:v});if(ee===null)throw new je(D);const ge=await Wt({fs:i,gitdir:t,type:"blob",object:ee});l.insert({filepath:D,stats:V,oid:ge})}}),T=await Promise.allSettled(I),k=T.filter(D=>D.status==="rejected").map(D=>D.reason);if(k.length>1)throw new _n(k);if(k.length===1)throw k[0];return T.filter(D=>D.status==="fulfilled"&&D.value).map(D=>D.value)}async function Cn({fs:a,gitdir:t,path:i}){return(await ue.get({fs:a,gitdir:t})).get(i)}function Hs(a,...t){for(const i of t)if(i)for(const o of Object.keys(i)){const l=i[o];l!==void 0&&(a[o]=l)}return a}async function xr({fs:a,gitdir:t,author:i,commit:o}){const l=Math.floor(Date.now()/1e3),f={name:await Cn({fs:a,gitdir:t,path:"user.name"}),email:await Cn({fs:a,gitdir:t,path:"user.email"})||"",timestamp:l,timezoneOffset:new Date(l*1e3).getTimezoneOffset()},w=Hs({},f,o?o.author:void 0,i);if(w.name!==void 0)return w}async function Pr({fs:a,gitdir:t,author:i,committer:o,commit:l}){const f=Math.floor(Date.now()/1e3),w={name:await Cn({fs:a,gitdir:t,path:"user.name"}),email:await Cn({fs:a,gitdir:t,path:"user.email"})||"",timestamp:f,timezoneOffset:new Date(f*1e3).getTimezoneOffset()},v=Hs({},w,l?l.committer:void 0,i,o);if(v.name!==void 0)return v}async function qs({fs:a,cache:t,gitdir:i,oid:o}){const{type:l,object:f}=await dt({fs:a,cache:t,gitdir:i,oid:o});if(l==="tag")return o=Gt.from(f).parse().object,qs({fs:a,cache:t,gitdir:i,oid:o});if(l!=="commit")throw new Fe(o,l,"commit");return{commit:gt.from(f),oid:o}}async function ur({fs:a,cache:t,gitdir:i,oid:o}){const{commit:l,oid:f}=await qs({fs:a,cache:t,gitdir:i,oid:o});return{oid:f,commit:l.parse(),payload:l.withoutSignature()}}async function Tn({fs:a,cache:t,onSign:i,gitdir:o,message:l,author:f,committer:w,signingKey:v,amend:I=!1,dryRun:T=!1,noUpdateBranch:k=!1,ref:M,parent:D,tree:V}){let ee=!1,ge=!1;M||(ge=!(await a.read(`${o}/HEAD`,{encoding:"utf8"})).startsWith("ref:"),M=await H.resolve({fs:a,gitdir:o,ref:"HEAD",depth:2}));let fe,we;try{fe=await H.resolve({fs:a,gitdir:o,ref:M}),we=await ur({fs:a,gitdir:o,oid:fe,cache:{}})}catch{ee=!0}if(I&&ee)throw new In(M);const ve=I?await xr({fs:a,gitdir:o,author:f,commit:we.commit}):await xr({fs:a,gitdir:o,author:f});if(!ve)throw new Pt("author");const Re=I?await Pr({fs:a,gitdir:o,author:ve,committer:w,commit:we.commit}):await Pr({fs:a,gitdir:o,author:ve,committer:w});if(!Re)throw new Pt("committer");return he.acquire({fs:a,gitdir:o,cache:t,allowUnmerged:!1},async function(Ne){const He=Me(Ne.entries).get(".");if(V||(V=await Ws({fs:a,gitdir:o,inode:He,dryRun:T})),D?D=await Promise.all(D.map(Be=>H.resolve({fs:a,gitdir:o,ref:Be}))):I?D=we.commit.parent:D=fe?[fe]:[],!l)if(I)l=we.commit.message;else throw new qt("message");let Ce=gt.from({tree:V,parent:D,author:ve,committer:Re,message:l});v&&(Ce=await gt.sign(Ce,i,v));const Te=await Wt({fs:a,gitdir:o,type:"commit",object:Ce.toObject(),dryRun:T});return!k&&!T&&await H.writeRef({fs:a,gitdir:o,ref:ge?"HEAD":M,value:Te}),Te})}async function Ws({fs:a,gitdir:t,inode:i,dryRun:o}){const l=i.children;for(const I of l)I.type==="tree"&&(I.metadata.mode="040000",I.metadata.oid=await Ws({fs:a,gitdir:t,inode:I,dryRun:o}));const f=l.map(I=>({mode:I.metadata.mode,path:I.basename,oid:I.metadata.oid,type:I.type})),w=Pe.from(f);return await Wt({fs:a,gitdir:t,type:"tree",object:w.toObject(),dryRun:o})}async function Rn({fs:a,cache:t,gitdir:i,oid:o,filepath:l}){if(l.startsWith("/"))throw new yr("leading-slash");if(l.endsWith("/"))throw new yr("trailing-slash");const f=o,w=await Yr({fs:a,cache:t,gitdir:i,oid:o}),v=w.tree;if(l==="")o=w.oid;else{const I=l.split("/");o=await Vs({fs:a,cache:t,gitdir:i,tree:v,pathArray:I,oid:f,filepath:l})}return o}async function Vs({fs:a,cache:t,gitdir:i,tree:o,pathArray:l,oid:f,filepath:w}){const v=l.shift();for(const I of o)if(I.path===v){if(l.length===0)return I.oid;{const{type:T,object:k}=await dt({fs:a,cache:t,gitdir:i,oid:I.oid});if(T!=="tree")throw new Fe(f,T,"tree",w);return o=Pe.from(k),Vs({fs:a,cache:t,gitdir:i,tree:o,pathArray:l,oid:f,filepath:w})}}throw new je(`file or directory found at "${f}:${w}"`)}async function en({fs:a,cache:t,gitdir:i,oid:o,filepath:l=void 0}){l!==void 0&&(o=await Rn({fs:a,cache:t,gitdir:i,oid:o,filepath:l}));const{tree:f,oid:w}=await Yr({fs:a,cache:t,gitdir:i,oid:o});return{oid:w,tree:f.entries()}}async function On({fs:a,gitdir:t,tree:i}){const o=Pe.from(i).toObject();return await Wt({fs:a,gitdir:t,type:"tree",object:o,format:"content"})}async function Nh({fs:a,cache:t,onSign:i,gitdir:o,ref:l,oid:f,note:w,force:v,author:I,committer:T,signingKey:k}){let M;try{M=await H.resolve({gitdir:o,fs:a,ref:l})}catch(we){if(!(we instanceof je))throw we}let V=(await en({fs:a,cache:t,gitdir:o,oid:M||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(v)V=V.filter(we=>we.path!==f);else for(const we of V)if(we.path===f)throw new ir("note",f);typeof w=="string"&&(w=Buffer.from(w,"utf8"));const ee=await Wt({fs:a,gitdir:o,type:"blob",object:w,format:"content"});V.push({mode:"100644",path:f,oid:ee,type:"blob"});const ge=await On({fs:a,gitdir:o,tree:V});return await Tn({fs:a,cache:t,onSign:i,gitdir:o,ref:l,tree:ge,parent:M&&[M],message:`Note added by 'isomorphic-git addNote'
`,author:I,committer:T,signingKey:k})}async function Zs({fs:a,onSign:t,dir:i,gitdir:o=p(i,".git"),ref:l="refs/notes/commits",oid:f,note:w,force:v,author:I,committer:T,signingKey:k,cache:M={}}){try{Y("fs",a),Y("gitdir",o),Y("oid",f),Y("note",w),k&&Y("onSign",t);const D=new qe(a),V=await xr({fs:D,gitdir:o,author:I});if(!V)throw new Pt("author");const ee=await Pr({fs:D,gitdir:o,author:V,committer:T});if(!ee)throw new Pt("committer");const ge=await We({fsp:D,dotgit:o});return await Nh({fs:D,cache:M,onSign:t,gitdir:ge,ref:l,oid:f,note:w,force:v,author:V,committer:ee,signingKey:k})}catch(D){throw D.caller="git.addNote",D}}const Uh=/(^|[/.])([/.]|$)|^@$|@{|[\x00-\x20\x7f~^:?*[\\]|\.lock(\/|$)/;function Pn(a,t){if(typeof a!="string")throw new TypeError("Reference name must be a string");return!Uh.test(a)&&!0}async function Ks({fs:a,gitdir:t,remote:i,url:o,force:l}){if(!Pn(i))throw new ar(i,d.clean(i));const f=await ue.get({fs:a,gitdir:t});if(!l&&(await f.getSubsections("remote")).includes(i)&&o!==await f.get(`remote.${i}.url`))throw new ir("remote",i);await f.set(`remote.${i}.url`,o),await f.set(`remote.${i}.fetch`,`+refs/heads/*:refs/remotes/${i}/*`),await ue.save({fs:a,gitdir:t,config:f})}async function Xs({fs:a,dir:t,gitdir:i=p(t,".git"),remote:o,url:l,force:f=!1}){try{Y("fs",a),Y("gitdir",i),Y("remote",o),Y("url",l);const w=new qe(a),v=await We({fsp:w,dotgit:i});return await Ks({fs:w,gitdir:v,remote:o,url:l,force:f})}catch(w){throw w.caller="git.addRemote",w}}async function zh({fs:a,cache:t,onSign:i,gitdir:o,ref:l,tagger:f,message:w=l,gpgsig:v,object:I,signingKey:T,force:k=!1}){if(l=l.startsWith("refs/tags/")?l:`refs/tags/${l}`,!k&&await H.exists({fs:a,gitdir:o,ref:l}))throw new ir("tag",l);const M=await H.resolve({fs:a,gitdir:o,ref:I||"HEAD"}),{type:D}=await dt({fs:a,cache:t,gitdir:o,oid:M});let V=Gt.from({object:M,type:D,tag:l.replace("refs/tags/",""),tagger:f,message:w,gpgsig:v});T&&(V=await Gt.sign(V,i,T));const ee=await Wt({fs:a,gitdir:o,type:"tag",object:V.toObject()});await H.writeRef({fs:a,gitdir:o,ref:l,value:ee})}async function Ys({fs:a,onSign:t,dir:i,gitdir:o=p(i,".git"),ref:l,tagger:f,message:w=l,gpgsig:v,object:I,signingKey:T,force:k=!1,cache:M={}}){try{Y("fs",a),Y("gitdir",o),Y("ref",l),T&&Y("onSign",t);const D=new qe(a),V=await We({fsp:D,dotgit:o}),ee=await xr({fs:D,gitdir:V,author:f});if(!ee)throw new Pt("tagger");return await zh({fs:D,cache:M,onSign:t,gitdir:V,ref:l,tagger:ee,message:w,gpgsig:v,object:I,signingKey:T,force:k})}catch(D){throw D.caller="git.annotatedTag",D}}async function Gh({fs:a,gitdir:t,ref:i,object:o,checkout:l=!1,force:f=!1}){if(!Pn(i))throw new ar(i,d.clean(i));const w=`refs/heads/${i}`;if(!f&&await H.exists({fs:a,gitdir:t,ref:w}))throw new ir("branch",i,!1);let v;try{v=await H.resolve({fs:a,gitdir:t,ref:o||"HEAD"})}catch{}v&&await H.writeRef({fs:a,gitdir:t,ref:w,value:v}),l&&await H.writeSymbolicRef({fs:a,gitdir:t,ref:"HEAD",value:w})}async function Js({fs:a,dir:t,gitdir:i=p(t,".git"),ref:o,object:l,checkout:f=!1,force:w=!1}){try{Y("fs",a),Y("gitdir",i),Y("ref",o);const v=new qe(a),I=await We({fsp:v,dotgit:i});return await Gh({fs:v,gitdir:I,ref:o,object:l,checkout:f,force:w})}catch(v){throw v.caller="git.branch",v}}const Qs=(a,t)=>a==="."||t==null||t.length===0||t==="."?!0:t.length>=a.length?t.startsWith(a):a.startsWith(t);async function ea({fs:a,cache:t,onProgress:i,onPostCheckout:o,dir:l,gitdir:f,remote:w,ref:v,filepaths:I,noCheckout:T,noUpdateHead:k,dryRun:M,force:D,track:V=!0,nonBlocking:ee=!1,batchSize:ge=100}){let fe;if(o)try{fe=await H.resolve({fs:a,gitdir:f,ref:"HEAD"})}catch{fe="0000000000000000000000000000000000000000"}let we;try{we=await H.resolve({fs:a,gitdir:f,ref:v})}catch(ve){if(v==="HEAD")throw ve;const Re=`${w}/${v}`;if(we=await H.resolve({fs:a,gitdir:f,ref:Re}),V){const Ne=await ue.get({fs:a,gitdir:f});await Ne.set(`branch.${v}.remote`,w),await Ne.set(`branch.${v}.merge`,`refs/heads/${v}`),await ue.save({fs:a,gitdir:f,config:Ne})}await H.writeRef({fs:a,gitdir:f,ref:`refs/heads/${v}`,value:we})}if(!T){let ve;try{ve=await Hh({fs:a,cache:t,onProgress:i,dir:l,gitdir:f,ref:v,force:D,filepaths:I})}catch(Ce){throw Ce instanceof je&&Ce.data.what===we?new wn(v,we):Ce}const Re=ve.filter(([Ce])=>Ce==="conflict").map(([Ce,Te])=>Te);if(Re.length>0)throw new pn(Re);const Ne=ve.filter(([Ce])=>Ce==="error").map(([Ce,Te])=>Te);if(Ne.length>0)throw new x(Ne.join(", "));if(M){o&&await o({previousHead:fe,newHead:we,type:I!=null&&I.length>0?"file":"branch"});return}let Ge=0;const He=ve.length;if(await he.acquire({fs:a,gitdir:f,cache:t},async function(Ce){await Promise.all(ve.filter(([Te])=>Te==="delete"||Te==="delete-index").map(async function([Te,Be]){const et=`${l}/${Be}`;Te==="delete"&&await a.rm(et),Ce.delete({filepath:Be}),i&&await i({phase:"Updating workdir",loaded:++Ge,total:He})}))}),await he.acquire({fs:a,gitdir:f,cache:t},async function(Ce){for(const[Te,Be]of ve)if(Te==="rmdir"||Te==="rmdir-index"){const et=`${l}/${Be}`;try{Te==="rmdir"&&await a.rmdir(et),Ce.delete({filepath:Be}),i&&await i({phase:"Updating workdir",loaded:++Ge,total:He})}catch(ct){if(ct.code!=="ENOTEMPTY")throw ct}}}),await Promise.all(ve.filter(([Ce])=>Ce==="mkdir"||Ce==="mkdir-index").map(async function([Ce,Te]){const Be=`${l}/${Te}`;await a.mkdir(Be),i&&await i({phase:"Updating workdir",loaded:++Ge,total:He})})),ee){const Ce=ve.filter(([Be])=>Be==="create"||Be==="create-index"||Be==="update"||Be==="mkdir-index"),Te=await ec("Update Working Dir",Ce.map(([Be,et,ct,It,lt])=>()=>Wh({fs:a,cache:t,gitdir:f,dir:l},[Be,et,ct,It,lt])),i,ge);await he.acquire({fs:a,gitdir:f,cache:t,allowUnmerged:!0},async function(Be){await ec("Update Index",Te.map(([et,ct,It])=>()=>qh({index:Be,fullpath:et,oid:ct,stats:It})),i,ge)})}else await he.acquire({fs:a,gitdir:f,cache:t,allowUnmerged:!0},async function(Ce){await Promise.all(ve.filter(([Te])=>Te==="create"||Te==="create-index"||Te==="update"||Te==="mkdir-index").map(async function([Te,Be,et,ct,It]){const lt=`${l}/${Be}`;try{if(Te!=="create-index"&&Te!=="mkdir-index"){const{object:Mt}=await dt({fs:a,cache:t,gitdir:f,oid:et});if(It&&await a.rm(lt),ct===33188)await a.write(lt,Mt);else if(ct===33261)await a.write(lt,Mt,{mode:511});else if(ct===40960)await a.writelink(lt,Mt);else throw new x(`Invalid mode 0o${ct.toString(8)} detected in blob ${et}`)}const Tt=await a.lstat(lt);ct===33261&&(Tt.mode=493),Te==="mkdir-index"&&(Tt.mode=57344),Ce.insert({filepath:Be,stats:Tt,oid:et}),i&&await i({phase:"Updating workdir",loaded:++Ge,total:He})}catch{}}))});o&&await o({previousHead:fe,newHead:we,type:I!=null&&I.length>0?"file":"branch"})}if(!k){const ve=await H.expand({fs:a,gitdir:f,ref:v});ve.startsWith("refs/heads")?await H.writeSymbolicRef({fs:a,gitdir:f,ref:"HEAD",value:ve}):await H.writeRef({fs:a,gitdir:f,ref:"HEAD",value:we})}}async function Hh({fs:a,cache:t,onProgress:i,dir:o,gitdir:l,ref:f,force:w,filepaths:v}){let I=0;return vr({fs:a,cache:t,dir:o,gitdir:l,trees:[Vt({ref:f}),Jr(),Oe()],map:async function(T,[k,M,D]){if(T===".")return;if(v&&!v.some(ee=>Qs(T,ee)))return null;switch(i&&await i({phase:"Analyzing workdir",loaded:++I}),[!!D,!!k,!!M].map(Number).join("")){case"000":return;case"001":return w&&v&&v.includes(T)?["delete",T]:void 0;case"010":switch(await k.type()){case"tree":return["mkdir",T];case"blob":return["create",T,await k.oid(),await k.mode()];case"commit":return["mkdir-index",T,await k.oid(),await k.mode()];default:return["error",`new entry Unhandled type ${await k.type()}`]}case"011":switch(`${await k.type()}-${await M.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",T];case"blob-blob":return await k.oid()!==await M.oid()?w?["update",T,await k.oid(),await k.mode(),await k.mode()!==await M.mode()]:["conflict",T]:await k.mode()!==await M.mode()?w?["update",T,await k.oid(),await k.mode(),!0]:["conflict",T]:["create-index",T,await k.oid(),await k.mode()];case"commit-tree":return;case"commit-blob":return["conflict",T];default:return["error",`new entry Unhandled type ${k.type}`]}case"100":return["delete-index",T];case"101":switch(await D.type()){case"tree":return["rmdir-index",T];case"blob":return await D.oid()!==await M.oid()?w?["delete",T]:["conflict",T]:["delete",T];case"commit":return["rmdir-index",T];default:return["error",`delete entry Unhandled type ${await D.type()}`]}case"110":case"111":switch(`${await D.type()}-${await k.type()}`){case"tree-tree":return;case"blob-blob":{if(await D.oid()===await k.oid()&&await D.mode()===await k.mode()&&!w)return;if(M){if(await M.oid()!==await D.oid()&&await M.oid()!==await k.oid())return w?["update",T,await k.oid(),await k.mode(),await k.mode()!==await M.mode()]:["conflict",T]}else if(w)return["update",T,await k.oid(),await k.mode(),await k.mode()!==await D.mode()];return await k.mode()!==await D.mode()?["update",T,await k.oid(),await k.mode(),!0]:await k.oid()!==await D.oid()?["update",T,await k.oid(),await k.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",T,await k.oid()];case"blob-tree":return["update-blob-to-tree",T];case"commit-commit":return["mkdir-index",T,await k.oid(),await k.mode()];default:return["error",`update entry Unhandled type ${await D.type()}-${await k.type()}`]}}},reduce:async function(T,k){return k=Bs(k),T?T&&T[0]==="rmdir"?(k.push(T),k):(k.unshift(T),k):k}})}async function qh({index:a,fullpath:t,stats:i,oid:o}){try{a.insert({filepath:t,stats:i,oid:o})}catch{}}async function Wh({fs:a,cache:t,gitdir:i,dir:o},[l,f,w,v,I]){const T=`${o}/${f}`;if(l!=="create-index"&&l!=="mkdir-index"){const{object:M}=await dt({fs:a,cache:t,gitdir:i,oid:w});if(I&&await a.rm(T),v===33188)await a.write(T,M);else if(v===33261)await a.write(T,M,{mode:511});else if(v===40960)await a.writelink(T,M);else throw new x(`Invalid mode 0o${v.toString(8)} detected in blob ${w}`)}const k=await a.lstat(T);return v===33261&&(k.mode=493),l==="mkdir-index"&&(k.mode=57344),[f,w,k]}async function ec(a,t,i,o){const l=[];try{for(let f=0;f<t.length;f+=o){const w=t.slice(f,f+o).map(I=>I());(await Promise.allSettled(w)).forEach(I=>{I.status==="fulfilled"&&l.push(I.value)}),i&&await i({phase:"Updating workdir",loaded:f+w.length,total:t.length})}return l}catch{}return l}async function ta({fs:a,onProgress:t,onPostCheckout:i,dir:o,gitdir:l=p(o,".git"),remote:f="origin",ref:w,filepaths:v,noCheckout:I=!1,noUpdateHead:T=w===void 0,dryRun:k=!1,force:M=!1,track:D=!0,cache:V={},nonBlocking:ee=!1,batchSize:ge=100}){try{Y("fs",a),Y("dir",o),Y("gitdir",l);const fe=w||"HEAD",we=new qe(a),ve=await We({fsp:we,dotgit:l});return await ea({fs:we,cache:V,onProgress:t,onPostCheckout:i,dir:o,gitdir:ve,remote:f,ref:fe,filepaths:v,noCheckout:I,noUpdateHead:T,dryRun:k,force:M,track:D,nonBlocking:ee,batchSize:ge})}catch(fe){throw fe.caller="git.checkout",fe}}const ra=/^.*(\r?\n|$)/gm;function Vh({branches:a,contents:t}){const i=a[1],o=a[2],l=t[0],f=t[1],w=t[2],v=f.match(ra),I=l.match(ra),T=w.match(ra),k=h(v,I,T),M=7;let D="",V=!0;for(const ee of k)ee.ok&&(D+=ee.ok.join("")),ee.conflict&&(V=!1,D+=`${"<".repeat(M)} ${i}
`,D+=ee.conflict.a.join(""),D+=`${"=".repeat(M)}
`,D+=ee.conflict.b.join(""),D+=`${">".repeat(M)} ${o}
`);return{cleanMerge:V,mergedText:D}}async function tc({fs:a,cache:t,dir:i,gitdir:o=p(i,".git"),index:l,ourOid:f,baseOid:w,theirOid:v,ourName:I="ours",baseName:T="base",theirName:k="theirs",dryRun:M=!1,abortOnConflict:D=!0,mergeDriver:V}){const ee=Vt({ref:f}),ge=Vt({ref:w}),fe=Vt({ref:v}),we=[],ve=[],Re=[],Ne=[],Ge=await vr({fs:a,cache:t,dir:i,gitdir:o,trees:[ee,ge,fe],map:async function(He,[Ce,Te,Be]){const et=ze(He),ct=await si(Ce,Te),It=await si(Be,Te);switch(`${ct}-${It}`){case"false-false":return{mode:await Te.mode(),path:et,oid:await Te.oid(),type:await Te.type()};case"false-true":return!Be&&await Ce.type()==="tree"?{mode:await Ce.mode(),path:et,oid:await Ce.oid(),type:await Ce.type()}:Be?{mode:await Be.mode(),path:et,oid:await Be.oid(),type:await Be.type()}:void 0;case"true-false":return!Ce&&await Be.type()==="tree"?{mode:await Be.mode(),path:et,oid:await Be.oid(),type:await Be.type()}:Ce?{mode:await Ce.mode(),path:et,oid:await Ce.oid(),type:await Ce.type()}:void 0;case"true-true":{if(Ce&&Be&&await Ce.type()==="tree"&&await Be.type()==="tree")return{mode:await Ce.mode(),path:et,oid:await Ce.oid(),type:"tree"};if(Ce&&Be&&await Ce.type()==="blob"&&await Be.type()==="blob")return Zh({fs:a,gitdir:o,path:et,ours:Ce,base:Te,theirs:Be,ourName:I,baseName:T,theirName:k,mergeDriver:V}).then(async lt=>{if(lt.cleanMerge)D||l.insert({filepath:He,oid:lt.mergeResult.oid,stage:0});else if(we.push(He),ve.push(He),!D){let Tt="";Te&&await Te.type()==="blob"&&(Tt=await Te.oid());const Mt=await Ce.oid(),Br=await Be.oid();l.delete({filepath:He}),Tt&&l.insert({filepath:He,oid:Tt,stage:1}),l.insert({filepath:He,oid:Mt,stage:2}),l.insert({filepath:He,oid:Br,stage:3})}return lt.mergeResult});if(Te&&!Ce&&Be&&await Te.type()==="blob"&&await Be.type()==="blob"){if(we.push(He),Re.push(He),!D){const lt=await Te.oid(),Tt=await Be.oid();l.delete({filepath:He}),l.insert({filepath:He,oid:lt,stage:1}),l.insert({filepath:He,oid:Tt,stage:3})}return{mode:await Be.mode(),oid:await Be.oid(),type:"blob",path:et}}if(Te&&Ce&&!Be&&await Te.type()==="blob"&&await Ce.type()==="blob"){if(we.push(He),Ne.push(He),!D){const lt=await Te.oid(),Tt=await Ce.oid();l.delete({filepath:He}),l.insert({filepath:He,oid:lt,stage:1}),l.insert({filepath:He,oid:Tt,stage:2})}return{mode:await Ce.mode(),oid:await Ce.oid(),type:"blob",path:et}}if(Te&&!Ce&&!Be&&(await Te.type()==="blob"||await Te.type()==="tree"))return;throw new Zr}}},reduce:we.length!==0&&(!i||D)?void 0:async(He,Ce)=>{const Te=Ce.filter(Boolean);if(He&&!(He&&He.type==="tree"&&Te.length===0&&He.path!==".")){if(Te.length>0||He.path==="."&&Te.length===0){const et=new Pe(Te).toObject(),ct=await Wt({fs:a,gitdir:o,type:"tree",object:et,dryRun:M});He.oid=ct}return He}}});return we.length!==0?(i&&!D&&await vr({fs:a,cache:t,dir:i,gitdir:o,trees:[Vt({ref:Ge.oid})],map:async function(He,[Ce]){const Te=`${i}/${He}`;if(await Ce.type()==="blob"){const Be=await Ce.mode(),et=new TextDecoder().decode(await Ce.content());await a.write(Te,et,{mode:Be})}return!0}}),new Rr(we,ve,Re,Ne)):Ge.oid}async function Zh({fs:a,gitdir:t,path:i,ours:o,base:l,theirs:f,ourName:w,theirName:v,baseName:I,dryRun:T,mergeDriver:k=Vh}){const M="blob";let D="100755",V="",ee="";l&&await l.type()==="blob"&&(D=await l.mode(),V=await l.oid(),ee=Buffer.from(await l.content()).toString("utf8"));const ge=D===await o.mode()?await f.mode():await o.mode();if(await o.oid()===await f.oid())return{cleanMerge:!0,mergeResult:{mode:ge,path:i,oid:await o.oid(),type:M}};if(await o.oid()===V)return{cleanMerge:!0,mergeResult:{mode:ge,path:i,oid:await f.oid(),type:M}};if(await f.oid()===V)return{cleanMerge:!0,mergeResult:{mode:ge,path:i,oid:await o.oid(),type:M}};const fe=Buffer.from(await o.content()).toString("utf8"),we=Buffer.from(await f.content()).toString("utf8"),{mergedText:ve,cleanMerge:Re}=await k({branches:[I,w,v],contents:[ee,fe,we],path:i}),Ne=await Wt({fs:a,gitdir:t,type:"blob",object:Buffer.from(ve,"utf8"),dryRun:T});return{cleanMerge:Re,mergeResult:{mode:ge,path:i,oid:Ne,type:M}}}const Kh={stage:Oe,workdir:Jr};let na;async function tn(a,t){return na===void 0&&(na=new r),na.acquire(a,t)}async function Xh(a,t,i,o,l=null){const f=p(i,o),w=await a.lstat(f);if(!w)throw new je(f);if(w.isDirectory())throw new x(`${f}: file expected, but found directory`);const v=l?await Jt({fs:a,gitdir:t,oid:l}):void 0;let I=v?l:void 0;return v||await tn({fs:a,gitdir:t,currentFilepath:f},async()=>{const T=w.isSymbolicLink()?await a.readlink(f).then(zs):await a.read(f);if(T===null)throw new je(f);I=await Wt({fs:a,gitdir:t,type:"blob",object:T})}),I}async function Yh({fs:a,dir:t,gitdir:i,entries:o}){async function l(f){if(f.type==="tree"){if(!f.oid){const w=await Promise.all(f.children.map(l));f.oid=await On({fs:a,gitdir:i,tree:w}),f.mode=16384}}else f.type==="blob"&&(f.oid=await Xh(a,i,t,f.path,f.oid),f.mode=33188);return f.path=f.path.split("/").pop(),f}return Promise.all(o.map(l))}async function rc({fs:a,dir:t,gitdir:i,treePair:o}){const l=o[1]==="stage",f=o.map(V=>typeof V=="string"?Kh[V]():V),w=[],k=await vr({fs:a,cache:{},dir:t,gitdir:i,trees:f,map:async(V,[ee,ge])=>{if(!(V==="."||await Qr.isIgnored({fs:a,dir:t,gitdir:i,filepath:V}))&&ge)return(!ee||await ee.oid()!==await ge.oid()&&await ge.oid()!==void 0)&&w.push([ee,ge]),{mode:await ge.mode(),path:V,oid:await ge.oid(),type:await ge.type()}},reduce:async(V,ee)=>(ee=ee.filter(Boolean),V?(V.children=ee,V):ee.length>0?ee:void 0),iterate:async(V,ee)=>{const ge=[];for(const fe of ee){const[we,ve]=fe;l?ve&&(await a.exists(`${t}/${ve.toString()}`)?ge.push(fe):w.push([null,ve])):we&&(ve?ge.push(fe):w.push([we,null]))}return ge.length?Promise.all(ge.map(V)):[]}});if(w.length===0||k.length===0)return null;const D=(await Yh({fs:a,dir:t,gitdir:i,entries:k})).filter(Boolean).map(V=>({mode:V.mode,path:V.path,oid:V.oid,type:V.type}));return On({fs:a,gitdir:i,tree:D})}async function nc({fs:a,dir:t,gitdir:i,stashCommit:o,parentCommit:l,wasStaged:f}){const w=[],v=[],I=await vr({fs:a,cache:{},dir:t,gitdir:i,trees:[Vt({ref:l}),Vt({ref:o})],map:async(T,[k,M])=>{if(T==="."||await Qr.isIgnored({fs:a,dir:t,gitdir:i,filepath:T}))return;const D=M?await M.type():await k.type();if(D!=="tree"&&D!=="blob")return;if(!M&&k){const ee=D==="tree"?"rmdir":"rm";return D==="tree"&&w.push(T),D==="blob"&&f&&v.push({filepath:T,oid:await k.oid()}),{method:ee,filepath:T}}const V=await M.oid();if(!k||await k.oid()!==V)return D==="tree"?{method:"mkdir",filepath:T}:(f&&v.push({filepath:T,oid:V,stats:await a.lstat(p(t,T))}),{method:"write",filepath:T,oid:V})}});await tn({fs:a,gitdir:i,dirRemoved:w,ops:I},async()=>{for(const T of I){const k=p(t,T.filepath);switch(T.method){case"rmdir":await a.rmdir(k);break;case"mkdir":await a.mkdir(k);break;case"rm":await a.rm(k);break;case"write":if(!w.some(M=>k.startsWith(M))){const{object:M}=await dt({fs:a,cache:{},gitdir:i,oid:T.oid});await a.exists(k)&&await a.rm(k),await a.write(k,M)}break}}}),await he.acquire({fs:a,gitdir:i,cache:{}},async T=>{v.forEach(({filepath:k,stats:M,oid:D})=>{T.insert({filepath:k,stats:M,oid:D})})})}async function ic({fs:a,cache:t,dir:i,gitdir:o,oid:l,dryRun:f=!1,noUpdateBranch:w=!1,abortOnConflict:v=!0,committer:I,mergeDriver:T}){const{commit:k,oid:M}=await ur({fs:a,cache:t,gitdir:o,oid:l});if(k.parent.length>1)throw new gn(M,k.parent.length);if(k.parent.length===0)throw new mn(M);const D=await H.resolve({fs:a,gitdir:o,ref:"HEAD"}),{commit:V}=await ur({fs:a,cache:t,gitdir:o,oid:D}),ee=k.parent[0],{commit:ge}=await ur({fs:a,cache:t,gitdir:o,oid:ee}),fe=await he.acquire({fs:a,gitdir:o,cache:t,allowUnmerged:!1},async ve=>tc({fs:a,cache:t,dir:i,gitdir:o,index:ve,ourOid:V.tree,baseOid:ge.tree,theirOid:k.tree,ourName:"HEAD",baseName:`parent of ${M.slice(0,7)}`,theirName:M.slice(0,7),dryRun:f,abortOnConflict:v,mergeDriver:T}));if(fe instanceof Rr)throw fe;const we=await Tn({fs:a,cache:t,gitdir:o,message:k.message,tree:fe,parent:[D],author:k.author,committer:I,dryRun:f,noUpdateBranch:w});return i&&!f&&!w&&await nc({fs:a,dir:i,gitdir:o,stashCommit:we,parentCommit:D,wasStaged:!0}),we}async function ac({fs:a,dir:t,gitdir:i=p(t,".git"),oid:o,cache:l={},committer:f,dryRun:w=!1,noUpdateBranch:v=!1,abortOnConflict:I=!0,mergeDriver:T}){try{Y("fs",a),Y("gitdir",i),Y("oid",o);const k=new qe(a),M=await We({fsp:k,dotgit:i}),{commit:D}=await ur({fs:k,cache:l,gitdir:M,oid:o});if(D.parent&&D.parent.length>1)return await ic({fs:k,cache:l,dir:t,gitdir:M,oid:o,dryRun:w,noUpdateBranch:v,abortOnConflict:I,committer:void 0,mergeDriver:T});const V=await Pr({fs:k,gitdir:M,committer:f});if(!V)throw new Pt("committer");return await ic({fs:k,cache:l,dir:t,gitdir:M,oid:o,dryRun:w,noUpdateBranch:v,abortOnConflict:I,committer:V,mergeDriver:T})}catch(k){throw k.caller="git.cherryPick",k}}const Jh=/^refs\/(heads\/|tags\/|remotes\/)?(.*)/;function Mr(a){const t=Jh.exec(a);return t?t[1]==="remotes/"&&a.endsWith("/HEAD")?t[2].slice(0,-5):t[2]:a}async function _r({fs:a,gitdir:t,fullname:i=!1,test:o=!1}){const l=await H.resolve({fs:a,gitdir:t,ref:"HEAD",depth:2});if(o)try{await H.resolve({fs:a,gitdir:t,ref:l})}catch{return}if(l.startsWith("refs/"))return i?l:Mr(l)}function Qh(a){return a=a.replace(/^git@([^:]+):/,"https://$1/"),a=a.replace(/^ssh:\/\//,"https://"),a}function oc({username:a="",password:t=""}){return`Basic ${Buffer.from(`${a}:${t}`).toString("base64")}`}async function Mn(a,t){const i=Cr(a);for(;;){const{value:o,done:l}=await i.next();if(o&&await t(o),l)break}i.return&&i.return()}async function ci(a){let t=0;const i=[];await Mn(a,f=>{i.push(f),t+=f.byteLength});const o=new Uint8Array(t);let l=0;for(const f of i)o.set(f,l),l+=f.byteLength;return o}function sc(a){let t=a.match(/^https?:\/\/([^/]+)@/);if(t==null)return{url:a,auth:{}};t=t[1];const[i,o]=t.split(":");return a=a.replace(`${t}@`,""),{url:a,auth:{username:i,password:o}}}function ia(a,t){const i=t.toString(16);return"0".repeat(a-i.length)+i}class _t{static flush(){return Buffer.from("0000","utf8")}static delim(){return Buffer.from("0001","utf8")}static encode(t){typeof t=="string"&&(t=Buffer.from(t));const i=t.length+4,o=ia(4,i);return Buffer.concat([Buffer.from(o,"utf8"),t])}static streamReader(t){const i=new Tr(t);return async function(){try{let l=await i.read(4);if(l==null)return!0;if(l=parseInt(l.toString("utf8"),16),l===0||l===1)return null;const f=await i.read(l-4);return f??!0}catch(l){return t.error=l,!0}}}}async function cc(a){const t={};let i;for(;i=await a(),i!==!0;){if(i===null)continue;i=i.toString("utf8").replace(/\n$/,"");const o=i.indexOf("=");if(o>-1){const l=i.slice(0,o),f=i.slice(o+1);t[l]=f}else t[i]=!0}return{protocolVersion:2,capabilities2:t}}async function lc(a,{service:t}){const i=new Set,o=new Map,l=new Map,f=_t.streamReader(a);let w=await f();for(;w===null;)w=await f();if(w===!0)throw new yn;if(w.includes("version 2"))return cc(f);if(w.toString("utf8").replace(/\n$/,"")!==`# service=${t}`)throw new Or(`# service=${t}\\n`,w.toString("utf8"));let v=await f();for(;v===null;)v=await f();if(v===!0)return{capabilities:i,refs:o,symrefs:l};if(v=v.toString("utf8"),v.includes("version 2"))return cc(f);const[I,T]=aa(v,"\0","\\x00");if(T.split(" ").map(k=>i.add(k)),I!=="0000000000000000000000000000000000000000 capabilities^{}"){const[k,M]=aa(I," "," ");for(o.set(M,k);;){const D=await f();if(D===!0)break;if(D!==null){const[V,ee]=aa(D.toString("utf8")," "," ");o.set(ee,V)}}}for(const k of i)if(k.startsWith("symref=")){const M=k.match(/symref=([^:]+):(.*)/);M.length===3&&l.set(M[1],M[2])}return{protocolVersion:1,capabilities:i,refs:o,symrefs:l}}function aa(a,t,i){const o=a.trim().split(t);if(o.length!==2)throw new Or(`Two strings separated by '${i}'`,a.toString("utf8"));return o}const uc=(a,t)=>a.endsWith("?")?`${a}${t}`:`${a}/${t.replace(/^https?:\/\//,"")}`,fc=(a,t)=>{(t.username||t.password)&&(a.Authorization=oc(t)),t.headers&&Object.assign(a,t.headers)},oa=async a=>{try{const t=Buffer.from(await ci(a.body)),i=t.toString("utf8");return{preview:i.length<256?i:i.slice(0,256)+"...",response:i,data:t}}catch{return{}}};class li{static async capabilities(){return["discover","connect"]}static async discover({http:t,onProgress:i,onAuth:o,onAuthSuccess:l,onAuthFailure:f,corsProxy:w,service:v,url:I,headers:T,protocolVersion:k}){let{url:M,auth:D}=sc(I);const V=w?uc(w,M):M;(D.username||D.password)&&(T.Authorization=oc(D)),k===2&&(T["Git-Protocol"]="version=2");let ee,ge,fe=!1;do if(ee=await t.request({onProgress:i,method:"GET",url:`${V}/info/refs?service=${v}`,headers:T}),ge=!1,ee.statusCode===401||ee.statusCode===203){const we=fe?f:o;if(we){if(D=await we(M,{...D,headers:{...T}}),D&&D.cancel)throw new Xr;D&&(fc(T,D),fe=!0,ge=!0)}}else ee.statusCode===200&&fe&&l&&await l(M,D);while(ge);if(ee.statusCode!==200){const{response:we}=await oa(ee);throw new Vr(ee.statusCode,ee.statusMessage,we)}if(ee.headers["content-type"]===`application/x-${v}-advertisement`){const we=await lc(ee.body,{service:v});return we.auth=D,we}else{const{preview:we,response:ve,data:Re}=await oa(ee);try{const Ne=await lc([Re],{service:v});return Ne.auth=D,Ne}catch{throw new Sn(we,ve)}}}static async connect({http:t,onProgress:i,corsProxy:o,service:l,url:f,auth:w,body:v,headers:I}){const T=sc(f);T&&(f=T.url),o&&(f=uc(o,f)),I["content-type"]=`application/x-${l}-request`,I.accept=`application/x-${l}-result`,fc(I,w);const k=await t.request({onProgress:i,method:"POST",url:`${f}/${l}`,body:v,headers:I});if(k.statusCode!==200){const{response:M}=oa(k);throw new Vr(k.statusCode,k.statusMessage,M)}return k}}class ui{static getRemoteHelperFor({url:t}){const i=new Map;i.set("http",li),i.set("https",li);const o=ep({url:t});if(!o)throw new En(t);if(i.has(o.transport))return i.get(o.transport);throw new kn(t,o.transport,o.transport==="ssh"?Qh(t):void 0)}}function ep({url:a}){if(a.startsWith("git@"))return{transport:"ssh",address:a};const t=a.match(/(\w+)(:\/\/|::)(.*)/);if(t!==null){if(t[2]==="://")return{transport:t[1],address:t[0]};if(t[2]==="::")return{transport:t[1],address:t[3]}}}let jr=null;class jn{static async read({fs:t,gitdir:i}){jr===null&&(jr=new r);const o=p(i,"shallow"),l=new Set;return await jr.acquire(o,async function(){const f=await t.read(o,{encoding:"utf8"});if(f===null||f.trim()==="")return l;f.trim().split(`
`).map(w=>l.add(w))}),l}static async write({fs:t,gitdir:i,oids:o}){jr===null&&(jr=new r);const l=p(i,"shallow");if(o.size>0){const f=[...o].join(`
`)+`
`;await jr.acquire(l,async function(){await t.write(l,f,{encoding:"utf8"})})}else await jr.acquire(l,async function(){await t.rm(l)})}}async function tp({fs:a,gitdir:t,oid:i}){const o=`objects/${i.slice(0,2)}/${i.slice(2)}`;return a.exists(`${t}/${o}`)}async function rp({fs:a,cache:t,gitdir:i,oid:o,getExternalRefDelta:l}){let f=await a.readdir(p(i,"objects/pack"));f=f.filter(w=>w.endsWith(".idx"));for(const w of f){const v=`${i}/objects/pack/${w}`,I=await Zi({fs:a,cache:t,filename:v,getExternalRefDelta:l});if(I.error)throw new x(I.error);if(I.offsets.has(o))return!0}return!1}async function dc({fs:a,cache:t,gitdir:i,oid:o,format:l="content"}){const f=v=>dt({fs:a,cache:t,gitdir:i,oid:v});let w=await tp({fs:a,gitdir:i,oid:o});return w||(w=await rp({fs:a,cache:t,gitdir:i,oid:o,getExternalRefDelta:f})),w}function np(a){const l="5041434b"+"00000002"+"00000000";return a.slice(0,12).toString("hex")===l}function hc(a,t){const i=a.map(o=>o.split("=",1)[0]);return t.filter(o=>{const l=o.split("=",1)[0];return i.includes(l)})}const fi={name:"isomorphic-git",version:"1.37.1",agent:"git/isomorphic-git@1.37.1"};class di{constructor(){this._queue=[]}write(t){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const i=this._waiting;this._waiting=null,i({value:t})}else this._queue.push(t)}end(){if(this._ended=!0,this._waiting){const t=this._waiting;this._waiting=null,t({done:!0})}}destroy(t){this.error=t,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(t=>{this._waiting=t})}}function ip(a){const t=a.indexOf("\r"),i=a.indexOf(`
`);return t===-1&&i===-1?-1:t===-1?i+1:i===-1?t+1:i===t+1?i+1:Math.min(t,i)+1}function pc(a){const t=new di;let i="";return(async()=>(await Mn(a,o=>{for(o=o.toString("utf8"),i+=o;;){const l=ip(i);if(l===-1)break;t.write(i.slice(0,l)),i=i.slice(l)}}),i.length>0&&t.write(i),t.end()))(),t}class gc{static demux(t){const i=_t.streamReader(t),o=new di,l=new di,f=new di,w=async function(){const v=await i();if(v===null)return w();if(v===!0){o.end(),f.end(),t.error?l.destroy(t.error):l.end();return}switch(v[0]){case 1:{l.write(v.slice(1));break}case 2:{f.write(v.slice(1));break}case 3:{const I=v.slice(1);f.write(I),o.end(),f.end(),l.destroy(new Error(I.toString("utf8")));return}default:o.write(v)}w()};return w(),{packetlines:o,packfile:l,progress:f}}}async function ap(a){const{packetlines:t,packfile:i,progress:o}=gc.demux(a),l=[],f=[],w=[];let v=!1,I=!1;return new Promise((T,k)=>{Mn(t,M=>{const D=M.toString("utf8").trim();if(D.startsWith("shallow")){const V=D.slice(-41).trim();V.length!==40&&k(new Ke(V)),l.push(V)}else if(D.startsWith("unshallow")){const V=D.slice(-41).trim();V.length!==40&&k(new Ke(V)),f.push(V)}else if(D.startsWith("ACK")){const[,V,ee]=D.split(" ");w.push({oid:V,status:ee}),ee||(I=!0)}else D.startsWith("NAK")?(v=!0,I=!0):(I=!0,v=!0);I&&(a.error?k(a.error):T({shallows:l,unshallows:f,acks:w,nak:v,packfile:i,progress:o}))}).finally(()=>{I||(a.error?k(a.error):T({shallows:l,unshallows:f,acks:w,nak:v,packfile:i,progress:o}))})})}function op({capabilities:a=[],wants:t=[],haves:i=[],shallows:o=[],depth:l=null,since:f=null,exclude:w=[]}){const v=[];t=[...new Set(t)];let I=` ${a.join(" ")}`;for(const T of t)v.push(_t.encode(`want ${T}${I}
`)),I="";for(const T of o)v.push(_t.encode(`shallow ${T}
`));l!==null&&v.push(_t.encode(`deepen ${l}
`)),f!==null&&v.push(_t.encode(`deepen-since ${Math.floor(f.valueOf()/1e3)}
`));for(const T of w)v.push(_t.encode(`deepen-not ${T}
`));v.push(_t.flush());for(const T of i)v.push(_t.encode(`have ${T}
`));return v.push(_t.encode(`done
`)),v}async function sa({fs:a,cache:t,http:i,onProgress:o,onMessage:l,onAuth:f,onAuthSuccess:w,onAuthFailure:v,gitdir:I,ref:T,remoteRef:k,remote:M,url:D,corsProxy:V,depth:ee=null,since:ge=null,exclude:fe=[],relative:we=!1,tags:ve=!1,singleBranch:Re=!1,headers:Ne={},prune:Ge=!1,pruneTags:He=!1}){const Ce=T||await _r({fs:a,gitdir:I,test:!0}),Te=await ue.get({fs:a,gitdir:I}),Be=M||Ce&&await Te.get(`branch.${Ce}.remote`)||"origin",et=D||await Te.get(`remote.${Be}.url`);if(typeof et>"u")throw new qt("remote OR url");const ct=k||Ce&&await Te.get(`branch.${Ce}.merge`)||T||"HEAD";V===void 0&&(V=await Te.get("http.corsProxy"));const It=ui.getRemoteHelperFor({url:et}),lt=await It.discover({http:i,onAuth:f,onAuthSuccess:w,onAuthFailure:v,corsProxy:V,service:"git-upload-pack",url:et,headers:Ne,protocolVersion:1}),Tt=lt.auth,Mt=lt.refs;if(Mt.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(ee!==null&&!lt.capabilities.has("shallow"))throw new br("shallow","depth");if(ge!==null&&!lt.capabilities.has("deepen-since"))throw new br("deepen-since","since");if(fe.length>0&&!lt.capabilities.has("deepen-not"))throw new br("deepen-not","exclude");if(we===!0&&!lt.capabilities.has("deepen-relative"))throw new br("deepen-relative","relative");const{oid:Br,fullref:Fr}=H.resolveAgainstMap({ref:ct,map:Mt});for(const ut of Mt.keys())ut===Fr||ut==="HEAD"||ut.startsWith("refs/heads/")||ve&&ut.startsWith("refs/tags/")||Mt.delete(ut);const rn=hc([...lt.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${fi.agent}`]);we&&rn.push("deepen-relative");const fa=Re?[Br]:Mt.values(),da=Re?[Ce]:await H.listRefs({fs:a,gitdir:I,filepath:"refs"});let Zt=[];for(let ut of da)try{ut=await H.expand({fs:a,gitdir:I,ref:ut});const jt=await H.resolve({fs:a,gitdir:I,ref:ut});await dc({fs:a,cache:t,gitdir:I,oid:jt})&&Zt.push(jt)}catch{}Zt=[...new Set(Zt)];const yt=await jn.read({fs:a,gitdir:I}),fr=lt.capabilities.has("shallow")?[...yt]:[],Nt=op({capabilities:rn,wants:fa,haves:Zt,shallows:fr,depth:ee,since:ge,exclude:fe}),Bn=Buffer.from(await ci(Nt)),Dr=await It.connect({http:i,onProgress:o,corsProxy:V,service:"git-upload-pack",url:et,auth:Tt,body:[Bn],headers:Ne}),Ct=await ap(Dr.body);Dr.headers&&(Ct.headers=Dr.headers);for(const ut of Ct.shallows)if(!yt.has(ut))try{const{object:jt}=await dt({fs:a,cache:t,gitdir:I,oid:ut}),tr=new gt(jt),dr=await Promise.all(tr.headers().parent.map(Dn=>dc({fs:a,cache:t,gitdir:I,oid:Dn})));dr.length===0||dr.every(Dn=>Dn)||yt.add(ut)}catch{yt.add(ut)}for(const ut of Ct.unshallows)yt.delete(ut);if(await jn.write({fs:a,gitdir:I,oids:yt}),Re){const ut=new Map([[Fr,Br]]),jt=new Map;let tr=10,dr=Fr;for(;tr--;){const pa=lt.symrefs.get(dr);if(pa===void 0)break;jt.set(dr,pa),dr=pa}const ha=Mt.get(dr);ha&&ut.set(dr,ha);const{pruned:Dn}=await H.updateRemoteRefs({fs:a,gitdir:I,remote:Be,refs:ut,symrefs:jt,tags:ve,prune:Ge});Ge&&(Ct.pruned=Dn)}else{const{pruned:ut}=await H.updateRemoteRefs({fs:a,gitdir:I,remote:Be,refs:Mt,symrefs:lt.symrefs,tags:ve,prune:Ge,pruneTags:He});Ge&&(Ct.pruned=ut)}if(Ct.HEAD=lt.symrefs.get("HEAD"),Ct.HEAD===void 0){const{oid:ut}=H.resolveAgainstMap({ref:"HEAD",map:Mt});for(const[jt,tr]of Mt.entries())if(jt!=="HEAD"&&tr===ut){Ct.HEAD=jt;break}}const Gp=Fr.startsWith("refs/tags")?"tag":"branch";if(Ct.FETCH_HEAD={oid:Br,description:`${Gp} '${Mr(Fr)}' of ${et}`},o||l){const ut=pc(Ct.progress);Mn(ut,async jt=>{if(l&&await l(jt),o){const tr=jt.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);tr&&await o({phase:tr[1].trim(),loaded:parseInt(tr[2],10),total:parseInt(tr[3],10)})}})}const pi=Buffer.from(await ci(Ct.packfile));if(Dr.body.error)throw Dr.body.error;const Ll=pi.slice(-20).toString("hex"),Fn={defaultBranch:Ct.HEAD,fetchHead:Ct.FETCH_HEAD.oid,fetchHeadDescription:Ct.FETCH_HEAD.description};if(Ct.headers&&(Fn.headers=Ct.headers),Ge&&(Fn.pruned=Ct.pruned),Ll!==""&&!np(pi)){Fn.packfile=`objects/pack/pack-${Ll}.pack`;const ut=p(I,Fn.packfile);await a.write(ut,pi);const jt=dr=>dt({fs:a,cache:t,gitdir:I,oid:dr}),tr=await Wr.fromPack({pack:pi,getExternalRefDelta:jt,onProgress:o});await a.write(ut.replace(/\.pack$/,".idx"),await tr.toBuffer())}return Fn}async function mc({fs:a,bare:t=!1,dir:i,gitdir:o=t?i:p(i,".git"),defaultBranch:l="master"}){if(await a.exists(o+"/config"))return;let f=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];f=f.map(w=>o+"/"+w);for(const w of f)await a.mkdir(w);await a.write(o+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${t}
`+(t?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await a.write(o+"/HEAD",`ref: refs/heads/${l}
`)}async function sp({fs:a,cache:t,http:i,onProgress:o,onMessage:l,onAuth:f,onAuthSuccess:w,onAuthFailure:v,onPostCheckout:I,dir:T,gitdir:k,url:M,corsProxy:D,ref:V,remote:ee,depth:ge,since:fe,exclude:we,relative:ve,singleBranch:Re,noCheckout:Ne,noTags:Ge,headers:He,nonBlocking:Ce,batchSize:Te=100}){try{if(await mc({fs:a,gitdir:k}),await Ks({fs:a,gitdir:k,remote:ee,url:M,force:!1}),D){const ct=await ue.get({fs:a,gitdir:k});await ct.set("http.corsProxy",D),await ue.save({fs:a,gitdir:k,config:ct})}const{defaultBranch:Be,fetchHead:et}=await sa({fs:a,cache:t,http:i,onProgress:o,onMessage:l,onAuth:f,onAuthSuccess:w,onAuthFailure:v,gitdir:k,ref:V,remote:ee,corsProxy:D,depth:ge,since:fe,exclude:we,relative:ve,singleBranch:Re,headers:He,tags:!Ge});if(et===null)return;V=V||Be,V=V.replace("refs/heads/",""),await ea({fs:a,cache:t,onProgress:o,onPostCheckout:I,dir:T,gitdir:k,ref:V,remote:ee,noCheckout:Ne,nonBlocking:Ce,batchSize:Te})}catch(Be){throw await a.rmdir(k,{recursive:!0,maxRetries:10}).catch(()=>{}),Be}}async function wc({fs:a,http:t,onProgress:i,onMessage:o,onAuth:l,onAuthSuccess:f,onAuthFailure:w,onPostCheckout:v,dir:I,gitdir:T=p(I,".git"),url:k,corsProxy:M=void 0,ref:D=void 0,remote:V="origin",depth:ee=void 0,since:ge=void 0,exclude:fe=[],relative:we=!1,singleBranch:ve=!1,noCheckout:Re=!1,noTags:Ne=!1,headers:Ge={},cache:He={},nonBlocking:Ce=!1,batchSize:Te=100}){try{Y("fs",a),Y("http",t),Y("gitdir",T),Re||Y("dir",I),Y("url",k);const Be=new qe(a),et=await We({fsp:Be,dotgit:T});return await sp({fs:Be,cache:He,http:t,onProgress:i,onMessage:o,onAuth:l,onAuthSuccess:f,onAuthFailure:w,onPostCheckout:v,dir:I,gitdir:et,url:k,corsProxy:M,ref:D,remote:V,depth:ee,since:ge,exclude:fe,relative:we,singleBranch:ve,noCheckout:Re,noTags:Ne,headers:Ge,nonBlocking:Ce,batchSize:Te})}catch(Be){throw Be.caller="git.clone",Be}}async function yc({fs:a,onSign:t,dir:i,gitdir:o=p(i,".git"),message:l,author:f,committer:w,signingKey:v,amend:I=!1,dryRun:T=!1,noUpdateBranch:k=!1,ref:M,parent:D,tree:V,cache:ee={}}){try{Y("fs",a),I||Y("message",l),v&&Y("onSign",t);const ge=new qe(a),fe=await We({fsp:ge,dotgit:o});return await Tn({fs:ge,cache:ee,onSign:t,gitdir:fe,message:l,author:f,committer:w,signingKey:v,amend:I,dryRun:T,noUpdateBranch:k,ref:M,parent:D,tree:V})}catch(ge){throw ge.caller="git.commit",ge}}async function bc({fs:a,dir:t,gitdir:i=p(t,".git"),fullname:o=!1,test:l=!1}){try{Y("fs",a),Y("gitdir",i);const f=new qe(a),w=await We({fsp:f,dotgit:i});return await _r({fs:f,gitdir:w,fullname:o,test:l})}catch(f){throw f.caller="git.currentBranch",f}}async function cp({fs:a,gitdir:t,ref:i}){if(i=i.startsWith("refs/heads/")?i:`refs/heads/${i}`,!await H.exists({fs:a,gitdir:t,ref:i}))throw new je(i);const l=await H.expand({fs:a,gitdir:t,ref:i}),f=await _r({fs:a,gitdir:t,fullname:!0});if(l===f){const I=await H.resolve({fs:a,gitdir:t,ref:l});await H.writeRef({fs:a,gitdir:t,ref:"HEAD",value:I})}await H.deleteRef({fs:a,gitdir:t,ref:l});const w=Mr(i),v=await ue.get({fs:a,gitdir:t});await v.deleteSection("branch",w),await ue.save({fs:a,gitdir:t,config:v})}async function vc({fs:a,dir:t,gitdir:i=p(t,".git"),ref:o}){try{Y("fs",a),Y("ref",o);const l=new qe(a),f=await We({fsp:l,dotgit:i});return await cp({fs:l,gitdir:f,ref:o})}catch(l){throw l.caller="git.deleteBranch",l}}async function xc({fs:a,dir:t,gitdir:i=p(t,".git"),ref:o}){try{Y("fs",a),Y("ref",o);const l=new qe(a),f=await We({fsp:l,dotgit:i});await H.deleteRef({fs:l,gitdir:f,ref:o})}catch(l){throw l.caller="git.deleteRef",l}}async function lp({fs:a,gitdir:t,remote:i}){const o=await ue.get({fs:a,gitdir:t});await o.deleteSection("remote",i),await ue.save({fs:a,gitdir:t,config:o})}async function _c({fs:a,dir:t,gitdir:i=p(t,".git"),remote:o}){try{Y("fs",a),Y("remote",o);const l=new qe(a),f=await We({fsp:l,dotgit:i});return await lp({fs:l,gitdir:f,remote:o})}catch(l){throw l.caller="git.deleteRemote",l}}async function up({fs:a,gitdir:t,ref:i}){i=i.startsWith("refs/tags/")?i:`refs/tags/${i}`,await H.deleteRef({fs:a,gitdir:t,ref:i})}async function Sc({fs:a,dir:t,gitdir:i=p(t,".git"),ref:o}){try{Y("fs",a),Y("ref",o);const l=new qe(a),f=await We({fsp:l,dotgit:i});return await up({fs:l,gitdir:f,ref:o})}catch(l){throw l.caller="git.deleteTag",l}}async function fp({fs:a,gitdir:t,oid:i}){const o=i.slice(0,2);return(await a.readdir(`${t}/objects/${o}`)).map(f=>`${o}${f}`).filter(f=>f.startsWith(i))}async function dp({fs:a,cache:t,gitdir:i,oid:o,getExternalRefDelta:l}){const f=[];let w=await a.readdir(p(i,"objects/pack"));w=w.filter(v=>v.endsWith(".idx"));for(const v of w){const I=`${i}/objects/pack/${v}`,T=await Zi({fs:a,cache:t,filename:I,getExternalRefDelta:l});if(T.error)throw new x(T.error);for(const k of T.offsets.keys())k.startsWith(o)&&f.push(k)}return f}async function hp({fs:a,cache:t,gitdir:i,oid:o}){const l=v=>dt({fs:a,cache:t,gitdir:i,oid:v}),f=await fp({fs:a,gitdir:i,oid:o}),w=await dp({fs:a,cache:t,gitdir:i,oid:o,getExternalRefDelta:l});for(const v of w)f.indexOf(v)===-1&&f.push(v);if(f.length===1)return f[0];throw f.length>1?new hn("oids",o,f):new je(`an object matching "${o}"`)}async function kc({fs:a,dir:t,gitdir:i=p(t,".git"),oid:o,cache:l={}}){try{Y("fs",a),Y("gitdir",i),Y("oid",o);const f=new qe(a),w=await We({fsp:f,dotgit:i});return await hp({fs:f,cache:l,gitdir:w,oid:o})}catch(f){throw f.caller="git.expandOid",f}}async function Ec({fs:a,dir:t,gitdir:i=p(t,".git"),ref:o}){try{Y("fs",a),Y("gitdir",i),Y("ref",o);const l=new qe(a),f=await We({fsp:l,dotgit:i});return await H.expand({fs:l,gitdir:f,ref:o})}catch(l){throw l.caller="git.expandRef",l}}async function ca({fs:a,cache:t,gitdir:i,oids:o}){const l={},f=o.length;let w=o.map((v,I)=>({index:I,oid:v}));for(;w.length;){const v=new Set;for(const{oid:T,index:k}of w)l[T]||(l[T]=new Set),l[T].add(k),l[T].size===f&&v.add(T);if(v.size>0)return[...v];const I=new Map;for(const{oid:T,index:k}of w)try{const{object:M}=await dt({fs:a,cache:t,gitdir:i,oid:T}),D=gt.from(M),{parent:V}=D.parseHeaders();for(const ee of V)(!l[ee]||!l[ee].has(k))&&I.set(ee+":"+k,{oid:ee,index:k})}catch{}w=Array.from(I.values())}return[]}async function Ac({fs:a,cache:t,dir:i,gitdir:o,ours:l,theirs:f,fastForward:w=!0,fastForwardOnly:v=!1,dryRun:I=!1,noUpdateBranch:T=!1,abortOnConflict:k=!0,message:M,author:D,committer:V,signingKey:ee,onSign:ge,mergeDriver:fe,allowUnrelatedHistories:we=!1}){l===void 0&&(l=await _r({fs:a,gitdir:o,fullname:!0})),l=await H.expand({fs:a,gitdir:o,ref:l}),f=await H.expand({fs:a,gitdir:o,ref:f});const ve=await H.resolve({fs:a,gitdir:o,ref:l}),Re=await H.resolve({fs:a,gitdir:o,ref:f}),Ne=await ca({fs:a,cache:t,gitdir:o,oids:[ve,Re]});if(Ne.length!==1)if(Ne.length===0&&we)Ne.push("4b825dc642cb6eb9a060e54bf8d69288fbee4904");else throw new Zr;const Ge=Ne[0];if(Ge===Re)return{oid:ve,alreadyMerged:!0};if(w&&Ge===ve)return!I&&!T&&await H.writeRef({fs:a,gitdir:o,ref:l,value:Re}),{oid:Re,fastForward:!0};{if(v)throw new bn;const He=await he.acquire({fs:a,gitdir:o,cache:t,allowUnmerged:!1},async Te=>tc({fs:a,cache:t,dir:i,gitdir:o,index:Te,ourOid:ve,theirOid:Re,baseOid:Ge,ourName:Mr(l),baseName:"base",theirName:Mr(f),dryRun:I,abortOnConflict:k,mergeDriver:fe}));if(He instanceof Rr)throw He;return M||(M=`Merge branch '${Mr(f)}' into ${Mr(l)}`),{oid:await Tn({fs:a,cache:t,gitdir:o,message:M,ref:l,tree:He,parent:[ve,Re],author:D,committer:V,signingKey:ee,onSign:ge,dryRun:I,noUpdateBranch:T}),tree:He,mergeCommit:!0}}}async function Ic({fs:a,cache:t,http:i,onProgress:o,onMessage:l,onAuth:f,onAuthSuccess:w,onAuthFailure:v,dir:I,gitdir:T,ref:k,url:M,remote:D,remoteRef:V,prune:ee,pruneTags:ge,fastForward:fe,fastForwardOnly:we,corsProxy:ve,singleBranch:Re,headers:Ne,author:Ge,committer:He,signingKey:Ce}){try{if(!k){const et=await _r({fs:a,gitdir:T});if(!et)throw new qt("ref");k=et}const{fetchHead:Te,fetchHeadDescription:Be}=await sa({fs:a,cache:t,http:i,onProgress:o,onMessage:l,onAuth:f,onAuthSuccess:w,onAuthFailure:v,gitdir:T,corsProxy:ve,ref:k,url:M,remote:D,remoteRef:V,singleBranch:Re,headers:Ne,prune:ee,pruneTags:ge});await Ac({fs:a,cache:t,gitdir:T,ours:k,theirs:Te,fastForward:fe,fastForwardOnly:we,message:`Merge ${Be}`,author:Ge,committer:He,signingKey:Ce,dryRun:!1,noUpdateBranch:!1}),await ea({fs:a,cache:t,onProgress:o,dir:I,gitdir:T,ref:k,remote:D,noCheckout:!1})}catch(Te){throw Te.caller="git.pull",Te}}async function Cc({fs:a,http:t,onProgress:i,onMessage:o,onAuth:l,onAuthSuccess:f,onAuthFailure:w,dir:v,gitdir:I=p(v,".git"),ref:T,url:k,remote:M,remoteRef:D,corsProxy:V,singleBranch:ee,headers:ge={},cache:fe={}}){try{Y("fs",a),Y("http",t),Y("gitdir",I);const we={name:"",email:"",timestamp:Date.now(),timezoneOffset:0},ve=new qe(a),Re=await We({fsp:ve,dotgit:I});return await Ic({fs:ve,cache:fe,http:t,onProgress:i,onMessage:o,onAuth:l,onAuthSuccess:f,onAuthFailure:w,dir:v,gitdir:Re,ref:T,url:k,remote:M,remoteRef:D,fastForwardOnly:!0,corsProxy:V,singleBranch:ee,headers:ge,author:we,committer:we})}catch(we){throw we.caller="git.fastForward",we}}async function Tc({fs:a,http:t,onProgress:i,onMessage:o,onAuth:l,onAuthSuccess:f,onAuthFailure:w,dir:v,gitdir:I=p(v,".git"),ref:T,remote:k,remoteRef:M,url:D,corsProxy:V,depth:ee=null,since:ge=null,exclude:fe=[],relative:we=!1,tags:ve=!1,singleBranch:Re=!1,headers:Ne={},prune:Ge=!1,pruneTags:He=!1,cache:Ce={}}){try{Y("fs",a),Y("http",t),Y("gitdir",I);const Te=new qe(a),Be=await We({fsp:Te,dotgit:I});return await sa({fs:Te,cache:Ce,http:t,onProgress:i,onMessage:o,onAuth:l,onAuthSuccess:f,onAuthFailure:w,gitdir:Be,ref:T,remote:k,remoteRef:M,url:D,corsProxy:V,depth:ee,since:ge,exclude:fe,relative:we,tags:ve,singleBranch:Re,headers:Ne,prune:Ge,pruneTags:He})}catch(Te){throw Te.caller="git.fetch",Te}}async function Rc({fs:a,dir:t,gitdir:i=p(t,".git"),oids:o,cache:l={}}){try{Y("fs",a),Y("gitdir",i),Y("oids",o);const f=new qe(a),w=await We({fsp:f,dotgit:i});return await ca({fs:f,cache:l,gitdir:w,oids:o})}catch(f){throw f.caller="git.findMergeBase",f}}async function Oc({fs:a,filepath:t}){if(await a.exists(p(t,".git")))return t;{const i=_e(t);if(i===t)throw new je(`git root for ${t}`);return Oc({fs:a,filepath:i})}}async function Pc({fs:a,filepath:t}){try{return Y("fs",a),Y("filepath",t),await Oc({fs:new qe(a),filepath:t})}catch(i){throw i.caller="git.findRoot",i}}async function Mc({fs:a,dir:t,gitdir:i=p(t,".git"),path:o}){try{Y("fs",a),Y("gitdir",i),Y("path",o);const l=new qe(a),f=await We({fsp:l,dotgit:i});return await Cn({fs:l,gitdir:f,path:o})}catch(l){throw l.caller="git.getConfig",l}}async function pp({fs:a,gitdir:t,path:i}){return(await ue.get({fs:a,gitdir:t})).getall(i)}async function jc({fs:a,dir:t,gitdir:i=p(t,".git"),path:o}){try{Y("fs",a),Y("gitdir",i),Y("path",o);const l=new qe(a),f=await We({fsp:l,dotgit:i});return await pp({fs:l,gitdir:f,path:o})}catch(l){throw l.caller="git.getConfigAll",l}}async function Bc({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:o,corsProxy:l,url:f,headers:w={},forPush:v=!1}){try{Y("http",a),Y("url",f);const T=await ui.getRemoteHelperFor({url:f}).discover({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:o,corsProxy:l,service:v?"git-receive-pack":"git-upload-pack",url:f,headers:w,protocolVersion:1}),k={capabilities:[...T.capabilities]};for(const[M,D]of T.refs){const V=M.split("/"),ee=V.pop();let ge=k;for(const fe of V)ge[fe]=ge[fe]||{},ge=ge[fe];ge[ee]=D}for(const[M,D]of T.symrefs){const V=M.split("/"),ee=V.pop();let ge=k;for(const fe of V)ge[fe]=ge[fe]||{},ge=ge[fe];ge[ee]=D}return k}catch(I){throw I.caller="git.getRemoteInfo",I}}function Fc(a,t,i,o){const l=[];for(const[f,w]of a.refs){if(t&&!f.startsWith(t))continue;if(f.endsWith("^{}")){if(o){const I=f.replace("^{}",""),T=l[l.length-1],k=T.ref===I?T:l.find(M=>M.ref===I);if(k===void 0)throw new Error("I did not expect this to happen");k.peeled=w}continue}const v={ref:f,oid:w};i&&a.symrefs.has(f)&&(v.target=a.symrefs.get(f)),l.push(v)}return l}async function Dc({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:o,corsProxy:l,url:f,headers:w={},forPush:v=!1,protocolVersion:I=2}){try{Y("http",a),Y("url",f);const k=await ui.getRemoteHelperFor({url:f}).discover({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:o,corsProxy:l,service:v?"git-receive-pack":"git-upload-pack",url:f,headers:w,protocolVersion:I});if(k.protocolVersion===2)return{protocolVersion:k.protocolVersion,capabilities:k.capabilities2};const M={};for(const D of k.capabilities){const[V,ee]=D.split("=");ee?M[V]=ee:M[V]=!0}return{protocolVersion:1,capabilities:M,refs:Fc(k,void 0,!0,!0)}}catch(T){throw T.caller="git.getRemoteInfo2",T}}async function gp({type:a,object:t,format:i="content",oid:o=void 0}){return i!=="deflated"&&(i!=="wrapped"&&(t=rt.wrap({type:a,object:t})),o=await Z(t)),{oid:o,object:t}}async function Lc({object:a}){try{Y("object",a),typeof a=="string"?a=Buffer.from(a,"utf8"):a instanceof Uint8Array||(a=new Uint8Array(a));const t="blob",{oid:i,object:o}=await gp({type:t,format:"content",object:a});return{oid:i,type:t,object:o,format:"wrapped"}}catch(t){throw t.caller="git.hashBlob",t}}async function mp({fs:a,cache:t,onProgress:i,dir:o,gitdir:l,filepath:f}){try{f=p(o,f);const w=await a.read(f),v=T=>dt({fs:a,cache:t,gitdir:l,oid:T}),I=await Wr.fromPack({pack:w,getExternalRefDelta:v,onProgress:i});return await a.write(f.replace(/\.pack$/,".idx"),await I.toBuffer()),{oids:[...I.hashes]}}catch(w){throw w.caller="git.indexPack",w}}async function $c({fs:a,onProgress:t,dir:i,gitdir:o=p(i,".git"),filepath:l,cache:f={}}){try{Y("fs",a),Y("dir",i),Y("gitdir",i),Y("filepath",l);const w=new qe(a),v=await We({fsp:w,dotgit:o});return await mp({fs:w,cache:f,onProgress:t,dir:i,gitdir:v,filepath:l})}catch(w){throw w.caller="git.indexPack",w}}async function Nc({fs:a,bare:t=!1,dir:i,gitdir:o=t?i:p(i,".git"),defaultBranch:l="master"}){try{Y("fs",a),Y("gitdir",o),t||Y("dir",i);const f=new qe(a),w=await We({fsp:f,dotgit:o});return await mc({fs:f,bare:t,dir:i,gitdir:w,defaultBranch:l})}catch(f){throw f.caller="git.init",f}}async function Uc({fs:a,cache:t,gitdir:i,oid:o,ancestor:l,depth:f}){const w=await jn.read({fs:a,gitdir:i});if(!o)throw new qt("oid");if(!l)throw new qt("ancestor");if(o===l)return!1;const v=[o],I=new Set;let T=0;for(;v.length;){if(T++===f)throw new xn(f);const k=v.shift(),{type:M,object:D}=await dt({fs:a,cache:t,gitdir:i,oid:k});if(M!=="commit")throw new Fe(k,M,"commit");const V=gt.from(D).parse();for(const ee of V.parent)if(ee===l)return!0;if(!w.has(k))for(const ee of V.parent)I.has(ee)||(v.push(ee),I.add(ee))}return!1}async function zc({fs:a,dir:t,gitdir:i=p(t,".git"),oid:o,ancestor:l,depth:f=-1,cache:w={}}){try{Y("fs",a),Y("gitdir",i),Y("oid",o),Y("ancestor",l);const v=new qe(a),I=await We({fsp:v,dotgit:i});return await Uc({fs:v,cache:w,gitdir:I,oid:o,ancestor:l,depth:f})}catch(v){throw v.caller="git.isDescendent",v}}async function Gc({fs:a,dir:t,gitdir:i=p(t,".git"),filepath:o}){try{Y("fs",a),Y("dir",t),Y("gitdir",i),Y("filepath",o);const l=new qe(a),f=await We({fsp:l,dotgit:i});return Qr.isIgnored({fs:l,dir:t,gitdir:f,filepath:o})}catch(l){throw l.caller="git.isIgnored",l}}async function Hc({fs:a,dir:t,gitdir:i=p(t,".git"),remote:o}){try{Y("fs",a),Y("gitdir",i);const l=new qe(a),f=await We({fsp:l,dotgit:i});return H.listBranches({fs:l,gitdir:f,remote:o})}catch(l){throw l.caller="git.listBranches",l}}async function wp({fs:a,gitdir:t,ref:i,cache:o}){if(i){const l=await H.resolve({gitdir:t,fs:a,ref:i}),f=[];return await qc({fs:a,cache:o,gitdir:t,oid:l,filenames:f,prefix:""}),f}else return he.acquire({fs:a,gitdir:t,cache:o},async function(l){return l.entries.map(f=>f.path)})}async function qc({fs:a,cache:t,gitdir:i,oid:o,filenames:l,prefix:f}){const{tree:w}=await en({fs:a,cache:t,gitdir:i,oid:o});for(const v of w)v.type==="tree"?await qc({fs:a,cache:t,gitdir:i,oid:v.oid,filenames:l,prefix:p(f,v.path)}):l.push(p(f,v.path))}async function Wc({fs:a,dir:t,gitdir:i=p(t,".git"),ref:o,cache:l={}}){try{Y("fs",a),Y("gitdir",i);const f=new qe(a),w=await We({fsp:f,dotgit:i});return await wp({fs:f,cache:l,gitdir:w,ref:o})}catch(f){throw f.caller="git.listFiles",f}}async function yp({fs:a,cache:t,gitdir:i,ref:o}){let l;try{l=await H.resolve({gitdir:i,fs:a,ref:o})}catch(v){if(v instanceof je)return[]}return(await en({fs:a,cache:t,gitdir:i,oid:l})).tree.map(v=>({target:v.path,note:v.oid}))}async function Vc({fs:a,dir:t,gitdir:i=p(t,".git"),ref:o="refs/notes/commits",cache:l={}}){try{Y("fs",a),Y("gitdir",i),Y("ref",o);const f=new qe(a),w=await We({fsp:f,dotgit:i});return await yp({fs:f,cache:l,gitdir:w,ref:o})}catch(f){throw f.caller="git.listNotes",f}}async function Zc({fs:a,dir:t,gitdir:i=p(t,".git"),filepath:o}){try{Y("fs",a),Y("gitdir",i);const l=new qe(a),f=await We({fsp:l,dotgit:i});return H.listRefs({fs:l,gitdir:f,filepath:o})}catch(l){throw l.caller="git.listRefs",l}}async function bp({fs:a,gitdir:t}){const i=await ue.get({fs:a,gitdir:t}),o=await i.getSubsections("remote");return Promise.all(o.map(async f=>{const w=await i.get(`remote.${f}.url`);return{remote:f,url:w}}))}async function Kc({fs:a,dir:t,gitdir:i=p(t,".git")}){try{Y("fs",a),Y("gitdir",i);const o=new qe(a),l=await We({fsp:o,dotgit:i});return await bp({fs:o,gitdir:l})}catch(o){throw o.caller="git.listRemotes",o}}async function vp(a){const t=_t.streamReader(a),i=[];let o;for(;o=await t(),o!==!0;){if(o===null)continue;o=o.toString("utf8").replace(/\n$/,"");const[l,f,...w]=o.split(" "),v={ref:f,oid:l};for(const I of w){const[T,k]=I.split(":");T==="symref-target"?v.target=k:T==="peeled"&&(v.peeled=k)}i.push(v)}return i}async function xp({prefix:a,symrefs:t,peelTags:i}){const o=[];return o.push(_t.encode(`command=ls-refs
`)),o.push(_t.encode(`agent=${fi.agent}
`)),(i||t||a)&&o.push(_t.delim()),i&&o.push(_t.encode("peel")),t&&o.push(_t.encode("symrefs")),a&&o.push(_t.encode(`ref-prefix ${a}`)),o.push(_t.flush()),o}async function Xc({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:o,corsProxy:l,url:f,headers:w={},forPush:v=!1,protocolVersion:I=2,prefix:T,symrefs:k,peelTags:M}){try{Y("http",a),Y("url",f);const D=await li.discover({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:o,corsProxy:l,service:v?"git-receive-pack":"git-upload-pack",url:f,headers:w,protocolVersion:I});if(D.protocolVersion===1)return Fc(D,T,k,M);const V=await xp({prefix:T,symrefs:k,peelTags:M}),ee=await li.connect({http:a,auth:D.auth,headers:w,corsProxy:l,service:v?"git-receive-pack":"git-upload-pack",url:f,body:V});return vp(ee.body)}catch(D){throw D.caller="git.listServerRefs",D}}async function Yc({fs:a,dir:t,gitdir:i=p(t,".git")}){try{Y("fs",a),Y("gitdir",i);const o=new qe(a),l=await We({fsp:o,dotgit:i});return H.listTags({fs:o,gitdir:l})}catch(o){throw o.caller="git.listTags",o}}function _p(a,t){return a.committer.timestamp-t.committer.timestamp}const Sp="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function Jc({fs:a,cache:t,gitdir:i,oid:o,fileId:l}){if(l===Sp)return;const f=o;let w;const v=await Yr({fs:a,cache:t,gitdir:i,oid:o}),I=v.tree;return l===v.oid?w=v.path:(w=await Qc({fs:a,cache:t,gitdir:i,tree:I,fileId:l,oid:f}),Array.isArray(w)&&(w.length===0?w=void 0:w.length===1&&(w=w[0]))),w}async function Qc({fs:a,cache:t,gitdir:i,tree:o,fileId:l,oid:f,filepaths:w=[],parentPath:v=""}){const I=o.entries().map(function(T){let k;return T.oid===l?(k=p(v,T.path),w.push(k)):T.type==="tree"&&(k=dt({fs:a,cache:t,gitdir:i,oid:T.oid}).then(function({object:M}){return Qc({fs:a,cache:t,gitdir:i,tree:Pe.from(M),fileId:l,oid:f,filepaths:w,parentPath:p(v,T.path)})})),k});return await Promise.all(I),w}async function kp({fs:a,cache:t,gitdir:i,filepath:o,ref:l,depth:f,since:w,force:v,follow:I}){const T=typeof w>"u"?void 0:Math.floor(w.valueOf()/1e3),k=[],M=await jn.read({fs:a,gitdir:i}),D=await H.resolve({fs:a,gitdir:i,ref:l}),V=[await ur({fs:a,cache:t,gitdir:i,oid:D})];let ee,ge,fe;function we(ve){fe&&o&&k.push(ve)}for(;V.length>0;){const ve=V.pop();if(T!==void 0&&ve.commit.committer.timestamp<=T)break;if(o){let Re;try{Re=await Rn({fs:a,cache:t,gitdir:i,oid:ve.commit.tree,filepath:o}),ge&&ee!==Re&&k.push(ge),ee=Re,ge=ve,fe=!0}catch(Ne){if(Ne instanceof je){let Ge=I&&ee;if(Ge&&(Ge=await Jc({fs:a,cache:t,gitdir:i,oid:ve.commit.tree,fileId:ee}),Ge))if(Array.isArray(Ge)){if(ge){const He=await Jc({fs:a,cache:t,gitdir:i,oid:ge.commit.tree,fileId:ee});if(Array.isArray(He))if(Ge=Ge.filter(Ce=>He.indexOf(Ce)===-1),Ge.length===1)Ge=Ge[0],o=Ge,ge&&k.push(ge);else{Ge=!1,ge&&k.push(ge);break}}}else o=Ge,ge&&k.push(ge);if(!Ge){if(fe&&ee&&(k.push(ge),!v))break;if(!v&&!I)throw Ne}ge=ve,fe=!1}else throw Ne}}else k.push(ve);if(f!==void 0&&k.length===f){we(ve);break}if(!M.has(ve.oid))for(const Re of ve.commit.parent){const Ne=await ur({fs:a,cache:t,gitdir:i,oid:Re});V.map(Ge=>Ge.oid).includes(Ne.oid)||V.push(Ne)}V.length===0&&we(ve),V.sort((Re,Ne)=>_p(Re.commit,Ne.commit))}return k}async function el({fs:a,dir:t,gitdir:i=p(t,".git"),filepath:o,ref:l="HEAD",depth:f,since:w,force:v,follow:I,cache:T={}}){try{Y("fs",a),Y("gitdir",i),Y("ref",l);const k=new qe(a),M=await We({fsp:k,dotgit:i});return await kp({fs:k,cache:T,gitdir:M,filepath:o,ref:l,depth:f,since:w,force:v,follow:I})}catch(k){throw k.caller="git.log",k}}async function tl({fs:a,onSign:t,dir:i,gitdir:o=p(i,".git"),ours:l,theirs:f,fastForward:w=!0,fastForwardOnly:v=!1,dryRun:I=!1,noUpdateBranch:T=!1,abortOnConflict:k=!0,message:M,author:D,committer:V,signingKey:ee,cache:ge={},mergeDriver:fe,allowUnrelatedHistories:we=!1}){try{Y("fs",a),ee&&Y("onSign",t);const ve=new qe(a),Re=await We({fsp:ve,dotgit:o}),Ne=await xr({fs:ve,gitdir:Re,author:D});if(!Ne&&(!v||!w))throw new Pt("author");const Ge=await Pr({fs:ve,gitdir:Re,author:Ne,committer:V});if(!Ge&&(!v||!w))throw new Pt("committer");return await Ac({fs:ve,cache:ge,dir:i,gitdir:Re,ours:l,theirs:f,fastForward:w,fastForwardOnly:v,dryRun:I,noUpdateBranch:T,abortOnConflict:k,message:M,author:Ne,committer:Ge,signingKey:ee,onSign:t,mergeDriver:fe,allowUnrelatedHistories:we})}catch(ve){throw ve.caller="git.merge",ve}}const Ep={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function rl({fs:a,cache:t,dir:i,gitdir:o=p(i,".git"),oids:l}){const f=new n,w=[];function v(k,M){const D=Buffer.from(k,M);w.push(D),f.update(D)}async function I({stype:k,object:M}){const D=Ep[k];let V=M.length,ee=V>15?128:0;const ge=V&15;V=V>>>4;let fe=(ee|D|ge).toString(16);for(v(fe,"hex");ee;)ee=V>127?128:0,fe=ee|V&127,v(ia(2,fe),"hex"),V=V>>>7;v(Buffer.from(await Us(M)))}v("PACK"),v("00000002","hex"),v(ia(8,l.length),"hex");for(const k of l){const{type:M,object:D}=await dt({fs:a,cache:t,gitdir:o,oid:k});await I({object:D,stype:M})}const T=f.digest();return w.push(T),w}async function Ap({fs:a,cache:t,gitdir:i,oids:o,write:l}){const f=await rl({fs:a,cache:t,gitdir:i,oids:o}),w=Buffer.from(await ci(f)),I=`pack-${w.slice(-20).toString("hex")}.pack`;return l?(await a.write(p(i,`objects/pack/${I}`),w),{filename:I}):{filename:I,packfile:new Uint8Array(w)}}async function nl({fs:a,dir:t,gitdir:i=p(t,".git"),oids:o,write:l=!1,cache:f={}}){try{Y("fs",a),Y("gitdir",i),Y("oids",o);const w=new qe(a),v=await We({fsp:w,dotgit:i});return await Ap({fs:w,cache:f,gitdir:v,oids:o,write:l})}catch(w){throw w.caller="git.packObjects",w}}async function il({fs:a,http:t,onProgress:i,onMessage:o,onAuth:l,onAuthSuccess:f,onAuthFailure:w,dir:v,gitdir:I=p(v,".git"),ref:T,url:k,remote:M,remoteRef:D,prune:V=!1,pruneTags:ee=!1,fastForward:ge=!0,fastForwardOnly:fe=!1,corsProxy:we,singleBranch:ve,headers:Re={},author:Ne,committer:Ge,signingKey:He,cache:Ce={}}){try{Y("fs",a),Y("gitdir",I);const Te=new qe(a),Be=await We({fsp:Te,dotgit:I}),et=await xr({fs:Te,gitdir:Be,author:Ne});if(!et)throw new Pt("author");const ct=await Pr({fs:Te,gitdir:Be,author:et,committer:Ge});if(!ct)throw new Pt("committer");return await Ic({fs:Te,cache:Ce,http:t,onProgress:i,onMessage:o,onAuth:l,onAuthSuccess:f,onAuthFailure:w,dir:v,gitdir:Be,ref:T,url:k,remote:M,remoteRef:D,fastForward:ge,fastForwardOnly:fe,corsProxy:we,singleBranch:ve,headers:Re,author:et,committer:ct,signingKey:He,prune:V,pruneTags:ee})}catch(Te){throw Te.caller="git.pull",Te}}async function Ip({fs:a,cache:t,dir:i,gitdir:o=p(i,".git"),start:l,finish:f}){const w=await jn.read({fs:a,gitdir:o}),v=new Set,I=new Set;for(const M of l)v.add(await H.resolve({fs:a,gitdir:o,ref:M}));for(const M of f)try{const D=await H.resolve({fs:a,gitdir:o,ref:M});I.add(D)}catch{}const T=new Set;async function k(M){T.add(M);const{type:D,object:V}=await dt({fs:a,cache:t,gitdir:o,oid:M});if(D==="tag"){const ge=Gt.from(V).headers().object;return k(ge)}if(D!=="commit")throw new Fe(M,D,"commit");if(!w.has(M)){const ge=gt.from(V).headers().parent;for(M of ge)!I.has(M)&&!T.has(M)&&await k(M)}}for(const M of v)await k(M);return T}async function la({fs:a,cache:t,dir:i,gitdir:o=p(i,".git"),oids:l}){const f=new Set;async function w(v){if(f.has(v))return;f.add(v);const{type:I,object:T}=await dt({fs:a,cache:t,gitdir:o,oid:v});if(I==="tag"){const M=Gt.from(T).headers().object;await w(M)}else if(I==="commit"){const M=gt.from(T).headers().tree;await w(M)}else if(I==="tree"){const k=Pe.from(T);for(const M of k)M.type==="blob"&&f.add(M.oid),M.type==="tree"&&await w(M.oid)}}for(const v of l)await w(v);return f}async function Cp(a){const t={};let i="";const o=_t.streamReader(a);let l=await o();for(;l!==!0;)l!==null&&(i+=l.toString("utf8")+`
`),l=await o();const f=i.toString("utf8").split(`
`);if(l=f.shift(),!l.startsWith("unpack "))throw new Or('unpack ok" or "unpack [error message]',l);t.ok=l==="unpack ok",t.ok||(t.error=l.slice(7)),t.refs={};for(const w of f){if(w.trim()==="")continue;const v=w.slice(0,2),I=w.slice(3);let T=I.indexOf(" ");T===-1&&(T=I.length);const k=I.slice(0,T),M=I.slice(T+1);t.refs[k]={ok:v==="ok",error:M}}return t}async function Tp({capabilities:a=[],triplets:t=[]}){const i=[];let o=`\0 ${a.join(" ")}`;for(const l of t)i.push(_t.encode(`${l.oldoid} ${l.oid} ${l.fullRef}${o}
`)),o="";return i.push(_t.flush()),i}async function Rp({fs:a,cache:t,http:i,onProgress:o,onMessage:l,onAuth:f,onAuthSuccess:w,onAuthFailure:v,onPrePush:I,gitdir:T,ref:k,remoteRef:M,remote:D,url:V,force:ee=!1,delete:ge=!1,corsProxy:fe,headers:we={}}){const ve=k||await _r({fs:a,gitdir:T});if(typeof ve>"u")throw new qt("ref");const Re=await ue.get({fs:a,gitdir:T});D=D||await Re.get(`branch.${ve}.pushRemote`)||await Re.get("remote.pushDefault")||await Re.get(`branch.${ve}.remote`)||"origin";const Ne=V||await Re.get(`remote.${D}.pushurl`)||await Re.get(`remote.${D}.url`);if(typeof Ne>"u")throw new qt("remote OR url");const Ge=M||await Re.get(`branch.${ve}.merge`);if(typeof Ne>"u")throw new qt("remoteRef");fe===void 0&&(fe=await Re.get("http.corsProxy"));const He=await H.expand({fs:a,gitdir:T,ref:ve}),Ce=ge?"0000000000000000000000000000000000000000":await H.resolve({fs:a,gitdir:T,ref:He}),Te=ui.getRemoteHelperFor({url:Ne}),Be=await Te.discover({http:i,onAuth:f,onAuthSuccess:w,onAuthFailure:v,corsProxy:fe,service:"git-receive-pack",url:Ne,headers:we,protocolVersion:1}),et=Be.auth;let ct;if(!Ge)ct=He;else try{ct=await H.expandAgainstMap({ref:Ge,map:Be.refs})}catch(yt){if(yt instanceof je)ct=Ge.startsWith("refs/")?Ge:`refs/heads/${Ge}`;else throw yt}const It=Be.refs.get(ct)||"0000000000000000000000000000000000000000";if(I&&!await I({remote:D,url:Ne,localRef:{ref:ge?"(delete)":He,oid:Ce},remoteRef:{ref:ct,oid:It}}))throw new Xr;const lt=!Be.capabilities.has("no-thin");let Tt=new Set;if(!ge){const yt=[...Be.refs.values()];let fr=new Set;if(It!=="0000000000000000000000000000000000000000"){const Nt=await ca({fs:a,cache:t,gitdir:T,oids:[Ce,It]});for(const Bn of Nt)yt.push(Bn);lt&&(fr=await la({fs:a,cache:t,gitdir:T,oids:Nt}))}if(!yt.includes(Ce)){const Nt=await Ip({fs:a,cache:t,gitdir:T,start:[Ce],finish:yt});Tt=await la({fs:a,cache:t,gitdir:T,oids:Nt})}if(lt){try{const Nt=await H.resolve({fs:a,gitdir:T,ref:`refs/remotes/${D}/HEAD`,depth:2}),{oid:Bn}=await H.resolveAgainstMap({ref:Nt.replace(`refs/remotes/${D}/`,""),fullref:Nt,map:Be.refs}),Dr=[Bn];for(const Ct of await la({fs:a,cache:t,gitdir:T,oids:Dr}))fr.add(Ct)}catch{}for(const Nt of fr)Tt.delete(Nt)}if(Ce===It&&(ee=!0),!ee){if(He.startsWith("refs/tags")&&It!=="0000000000000000000000000000000000000000")throw new Kr("tag-exists");if(Ce!=="0000000000000000000000000000000000000000"&&It!=="0000000000000000000000000000000000000000"&&!await Uc({fs:a,cache:t,gitdir:T,oid:Ce,ancestor:It,depth:-1}))throw new Kr("not-fast-forward")}}const Mt=hc([...Be.capabilities],["report-status","side-band-64k",`agent=${fi.agent}`]),Br=await Tp({capabilities:Mt,triplets:[{oldoid:It,oid:Ce,fullRef:ct}]}),Fr=ge?[]:await rl({fs:a,cache:t,gitdir:T,oids:[...Tt]}),rn=await Te.connect({http:i,onProgress:o,corsProxy:fe,service:"git-receive-pack",url:Ne,auth:et,headers:we,body:[...Br,...Fr]}),{packfile:fa,progress:da}=await gc.demux(rn.body);if(l){const yt=pc(da);Mn(yt,async fr=>{await l(fr)})}const Zt=await Cp(fa);if(rn.headers&&(Zt.headers=rn.headers),D&&Zt.ok&&Zt.refs[ct].ok&&!He.startsWith("refs/tags")){const yt=`refs/remotes/${D}/${ct.replace("refs/heads","")}`;ge?await H.deleteRef({fs:a,gitdir:T,ref:yt}):await H.writeRef({fs:a,gitdir:T,ref:yt,value:Ce})}if(Zt.ok&&Object.values(Zt.refs).every(yt=>yt.ok))return Zt;{const yt=Object.entries(Zt.refs).filter(([fr,Nt])=>!Nt.ok).map(([fr,Nt])=>`
  - ${fr}: ${Nt.error}`).join("");throw new vn(yt,Zt)}}async function al({fs:a,http:t,onProgress:i,onMessage:o,onAuth:l,onAuthSuccess:f,onAuthFailure:w,onPrePush:v,dir:I,gitdir:T=p(I,".git"),ref:k,remoteRef:M,remote:D="origin",url:V,force:ee=!1,delete:ge=!1,corsProxy:fe,headers:we={},cache:ve={}}){try{Y("fs",a),Y("http",t),Y("gitdir",T);const Re=new qe(a),Ne=await We({fsp:Re,dotgit:T});return await Rp({fs:Re,cache:ve,http:t,onProgress:i,onMessage:o,onAuth:l,onAuthSuccess:f,onAuthFailure:w,onPrePush:v,gitdir:Ne,ref:k,remoteRef:M,remote:D,url:V,force:ee,delete:ge,corsProxy:fe,headers:we})}catch(Re){throw Re.caller="git.push",Re}}async function ol({fs:a,cache:t,gitdir:i,oid:o}){const{type:l,object:f}=await dt({fs:a,cache:t,gitdir:i,oid:o});if(l==="tag")return o=Gt.from(f).parse().object,ol({fs:a,cache:t,gitdir:i,oid:o});if(l!=="blob")throw new Fe(o,l,"blob");return{oid:o,blob:new Uint8Array(f)}}async function sl({fs:a,cache:t,gitdir:i,oid:o,filepath:l=void 0}){return l!==void 0&&(o=await Rn({fs:a,cache:t,gitdir:i,oid:o,filepath:l})),await ol({fs:a,cache:t,gitdir:i,oid:o})}async function cl({fs:a,dir:t,gitdir:i=p(t,".git"),oid:o,filepath:l,cache:f={}}){try{Y("fs",a),Y("gitdir",i),Y("oid",o);const w=new qe(a),v=await We({fsp:w,dotgit:i});return await sl({fs:w,cache:f,gitdir:v,oid:o,filepath:l})}catch(w){throw w.caller="git.readBlob",w}}async function ua({fs:a,dir:t,gitdir:i=p(t,".git"),oid:o,cache:l={}}){try{Y("fs",a),Y("gitdir",i),Y("oid",o);const f=new qe(a),w=await We({fsp:f,dotgit:i});return await ur({fs:f,cache:l,gitdir:w,oid:o})}catch(f){throw f.caller="git.readCommit",f}}async function Op({fs:a,cache:t,gitdir:i,ref:o="refs/notes/commits",oid:l}){const f=await H.resolve({gitdir:i,fs:a,ref:o}),{blob:w}=await sl({fs:a,cache:t,gitdir:i,oid:f,filepath:l});return w}async function ll({fs:a,dir:t,gitdir:i=p(t,".git"),ref:o="refs/notes/commits",oid:l,cache:f={}}){try{Y("fs",a),Y("gitdir",i),Y("ref",o),Y("oid",l);const w=new qe(a),v=await We({fsp:w,dotgit:i});return await Op({fs:w,cache:f,gitdir:v,ref:o,oid:l})}catch(w){throw w.caller="git.readNote",w}}async function ul({fs:a,dir:t,gitdir:i=p(t,".git"),oid:o,format:l="parsed",filepath:f=void 0,encoding:w=void 0,cache:v={}}){try{Y("fs",a),Y("gitdir",i),Y("oid",o);const I=new qe(a),T=await We({fsp:I,dotgit:i});f!==void 0&&(o=await Rn({fs:I,cache:v,gitdir:T,oid:o,filepath:f}));const M=await dt({fs:I,cache:v,gitdir:T,oid:o,format:l==="parsed"?"content":l});if(M.oid=o,l==="parsed")switch(M.format="parsed",M.type){case"commit":M.object=gt.from(M.object).parse();break;case"tree":M.object=Pe.from(M.object).entries();break;case"blob":w?M.object=M.object.toString(w):(M.object=new Uint8Array(M.object),M.format="content");break;case"tag":M.object=Gt.from(M.object).parse();break;default:throw new Fe(M.oid,M.type,"blob|commit|tag|tree")}else(M.format==="deflated"||M.format==="wrapped")&&(M.type=M.format);return M}catch(I){throw I.caller="git.readObject",I}}async function Pp({fs:a,cache:t,gitdir:i,oid:o}){const{type:l,object:f}=await dt({fs:a,cache:t,gitdir:i,oid:o,format:"content"});if(l!=="tag")throw new Fe(o,l,"tag");const w=Gt.from(f);return{oid:o,tag:w.parse(),payload:w.payload()}}async function fl({fs:a,dir:t,gitdir:i=p(t,".git"),oid:o,cache:l={}}){try{Y("fs",a),Y("gitdir",i),Y("oid",o);const f=new qe(a),w=await We({fsp:f,dotgit:i});return await Pp({fs:f,cache:l,gitdir:w,oid:o})}catch(f){throw f.caller="git.readTag",f}}async function dl({fs:a,dir:t,gitdir:i=p(t,".git"),oid:o,filepath:l=void 0,cache:f={}}){try{Y("fs",a),Y("gitdir",i),Y("oid",o);const w=new qe(a),v=await We({fsp:w,dotgit:i});return await en({fs:w,cache:f,gitdir:v,oid:o,filepath:l})}catch(w){throw w.caller="git.readTree",w}}async function hl({fs:a,dir:t,gitdir:i=p(t,".git"),filepath:o,cache:l={}}){try{Y("fs",a),Y("gitdir",i),Y("filepath",o);const f=new qe(a),w=await We({fsp:f,dotgit:i});await he.acquire({fs:f,gitdir:w,cache:l},async function(v){v.delete({filepath:o})})}catch(f){throw f.caller="git.remove",f}}async function Mp({fs:a,cache:t,onSign:i,gitdir:o,ref:l="refs/notes/commits",oid:f,author:w,committer:v,signingKey:I}){let T;try{T=await H.resolve({gitdir:o,fs:a,ref:l})}catch(ee){if(!(ee instanceof je))throw ee}let M=(await en({fs:a,cache:t,gitdir:o,oid:T||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;M=M.filter(ee=>ee.path!==f);const D=await On({fs:a,gitdir:o,tree:M});return await Tn({fs:a,cache:t,onSign:i,gitdir:o,ref:l,tree:D,parent:T&&[T],message:`Note removed by 'isomorphic-git removeNote'
`,author:w,committer:v,signingKey:I})}async function pl({fs:a,onSign:t,dir:i,gitdir:o=p(i,".git"),ref:l="refs/notes/commits",oid:f,author:w,committer:v,signingKey:I,cache:T={}}){try{Y("fs",a),Y("gitdir",o),Y("oid",f);const k=new qe(a),M=await We({fsp:k,dotgit:o}),D=await xr({fs:k,gitdir:M,author:w});if(!D)throw new Pt("author");const V=await Pr({fs:k,gitdir:M,author:D,committer:v});if(!V)throw new Pt("committer");return await Mp({fs:k,cache:T,onSign:t,gitdir:M,ref:l,oid:f,author:D,committer:V,signingKey:I})}catch(k){throw k.caller="git.removeNote",k}}async function jp({fs:a,gitdir:t,oldref:i,ref:o,checkout:l=!1}){if(!Pn(o))throw new ar(o,d.clean(o));if(!Pn(i))throw new ar(i,d.clean(i));const f=`refs/heads/${i}`,w=`refs/heads/${o}`;if(await H.exists({fs:a,gitdir:t,ref:w}))throw new ir("branch",o,!1);const I=await H.resolve({fs:a,gitdir:t,ref:f,depth:1});await H.writeRef({fs:a,gitdir:t,ref:w,value:I}),await H.deleteRef({fs:a,gitdir:t,ref:f});const k=await _r({fs:a,gitdir:t,fullname:!0})===f;(l||k)&&await H.writeSymbolicRef({fs:a,gitdir:t,ref:"HEAD",value:w})}async function gl({fs:a,dir:t,gitdir:i=p(t,".git"),ref:o,oldref:l,checkout:f=!1}){try{Y("fs",a),Y("gitdir",i),Y("ref",o),Y("oldref",l);const w=new qe(a),v=await We({fsp:w,dotgit:i});return await jp({fs:w,gitdir:v,ref:o,oldref:l,checkout:f})}catch(w){throw w.caller="git.renameBranch",w}}async function ml({gitdir:a,type:t,object:i}){return Z(rt.wrap({type:t,object:i}))}async function wl({fs:a,dir:t,gitdir:i=p(t,".git"),filepath:o,ref:l,cache:f={}}){try{Y("fs",a),Y("gitdir",i),Y("filepath",o);const w=new qe(a),v=await We({fsp:w,dotgit:i});let I,T;try{I=await H.resolve({fs:w,gitdir:v,ref:l||"HEAD"})}catch(D){if(l)throw D}if(I)try{I=await Rn({fs:w,cache:f,gitdir:v,oid:I,filepath:o})}catch{I=null}let k={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const M=t&&await w.read(p(t,o));M&&(T=await ml({gitdir:v,type:"blob",object:M}),I===T&&(k=await w.lstat(p(t,o)))),await he.acquire({fs:w,gitdir:v,cache:f},async function(D){D.delete({filepath:o}),I&&D.insert({filepath:o,stats:k,oid:I})})}catch(w){throw w.caller="git.reset",w}}async function yl({fs:a,dir:t,gitdir:i=p(t,".git"),ref:o,depth:l}){try{Y("fs",a),Y("gitdir",i),Y("ref",o);const f=new qe(a),w=await We({fsp:f,dotgit:i});return await H.resolve({fs:f,gitdir:w,ref:o,depth:l})}catch(f){throw f.caller="git.resolveRef",f}}async function bl({fs:a,dir:t,gitdir:i=p(t,".git"),path:o,value:l,append:f=!1}){try{Y("fs",a),Y("gitdir",i),Y("path",o);const w=new qe(a),v=await We({fsp:w,dotgit:i}),I=await ue.get({fs:w,gitdir:v});f?await I.append(o,l):await I.set(o,l),await ue.save({fs:w,gitdir:v,config:I})}catch(w){throw w.caller="git.setConfig",w}}async function vl({fs:a,gitdir:t,commit:i}){const o=gt.from(i).toObject();return await Wt({fs:a,gitdir:t,type:"commit",object:o,format:"content"})}class hi{static get timezoneOffsetForRefLogEntry(){const t=new Date().getTimezoneOffset(),i=Math.abs(Math.floor(t/60)),o=Math.abs(t%60).toString().padStart(2,"0");return`${t>0?"-":"+"}${i.toString().padStart(2,"0")}${o}`}static createStashReflogEntry(t,i,o){const l=t.name.replace(/\s/g,""),f="0000000000000000000000000000000000000000",w=Math.floor(Date.now()/1e3),v=hi.timezoneOffsetForRefLogEntry;return`${f} ${i} ${l} ${t.email} ${w} ${v}	${o}
`}static getStashReflogEntry(t,i=!1){return t.split(`
`).filter(f=>f).reverse().map((f,w)=>i?`stash@{${w}}: ${f.split("	")[1]}`:f)}}class mr{constructor({fs:t,dir:i,gitdir:o=p(i,".git")}){Object.assign(this,{fs:t,dir:i,gitdir:o,_author:null})}static get refStash(){return"refs/stash"}static get refLogsStash(){return"logs/refs/stash"}get refStashPath(){return p(this.gitdir,mr.refStash)}get refLogsStashPath(){return p(this.gitdir,mr.refLogsStash)}async getAuthor(){if(!this._author&&(this._author=await xr({fs:this.fs,gitdir:this.gitdir,author:{}}),!this._author))throw new Pt("author");return this._author}async getStashSHA(t,i){return await this.fs.exists(this.refStashPath)?(i||await this.readStashReflogs({parsed:!1}))[t].split(" ")[1]:null}async writeStashCommit({message:t,tree:i,parent:o}){return vl({fs:this.fs,gitdir:this.gitdir,commit:{message:t,tree:i,parent:o,author:await this.getAuthor(),committer:await this.getAuthor()}})}async readStashCommit(t){const i=await this.readStashReflogs({parsed:!1});if(t!==0&&(t<0||t>i.length-1))throw new ar(`stash@${t}`,"number that is in range of [0, num of stash pushed]");const o=await this.getStashSHA(t,i);return o?ur({fs:this.fs,cache:{},gitdir:this.gitdir,oid:o}):{}}async writeStashRef(t){return H.writeRef({fs:this.fs,gitdir:this.gitdir,ref:mr.refStash,value:t})}async writeStashReflogEntry({stashCommit:t,message:i}){const o=await this.getAuthor(),l=hi.createStashReflogEntry(o,t,i),f=this.refLogsStashPath;await tn({filepath:f,entry:l},async()=>{const w=await this.fs.exists(f)?await this.fs.read(f,"utf8"):"";await this.fs.write(f,w+l,"utf8")})}async readStashReflogs({parsed:t=!1}){if(!await this.fs.exists(this.refLogsStashPath))return[];const i=await this.fs.read(this.refLogsStashPath,"utf8");return hi.getStashReflogEntry(i,t)}}async function xl({fs:a,dir:t,gitdir:i,message:o=""}){const l=new mr({fs:a,dir:t,gitdir:i});await l.getAuthor();const f=await _r({fs:a,gitdir:i,fullname:!1}),w=await H.resolve({fs:a,gitdir:i,ref:"HEAD"}),I=(await ua({fs:a,dir:t,gitdir:i,oid:w})).commit.message,T=[w];let k=null,M=Vt({ref:"HEAD"});const D=await rc({fs:a,dir:t,gitdir:i,treePair:[Vt({ref:"HEAD"}),"stage"]});if(D){const fe=await l.writeStashCommit({message:`stash-Index: WIP on ${f} - ${new Date().toISOString()}`,tree:D,parent:T});T.push(fe),k=D,M=Oe()}const V=await rc({fs:a,dir:t,gitdir:i,treePair:[M,"workdir"]});if(V){const fe=await l.writeStashCommit({message:`stash-WorkDir: WIP on ${f} - ${new Date().toISOString()}`,tree:V,parent:[T[T.length-1]]});T.push(fe),k=V}if(!k||!D&&!V)throw new je("changes, nothing to stash");const ee=(o.trim()||`WIP on ${f}`)+`: ${w.substring(0,7)} ${I}`;return{stashCommit:await l.writeStashCommit({message:ee,tree:k,parent:T}),stashMsg:ee,branch:f,stashMgr:l}}async function Bp({fs:a,dir:t,gitdir:i,message:o=""}){const{stashCommit:l,stashMsg:f,branch:w,stashMgr:v}=await xl({fs:a,dir:t,gitdir:i,message:o});return await v.writeStashRef(l),await v.writeStashReflogEntry({stashCommit:l,message:f}),await ta({fs:a,dir:t,gitdir:i,ref:w,track:!1,force:!0}),l}async function Fp({fs:a,dir:t,gitdir:i,message:o=""}){const{stashCommit:l}=await xl({fs:a,dir:t,gitdir:i,message:o});return l}async function _l({fs:a,dir:t,gitdir:i,refIdx:o=0}){const f=await new mr({fs:a,dir:t,gitdir:i}).readStashCommit(o),{parent:w=null}=f.commit?f.commit:{};if(!(!w||!Array.isArray(w)))for(let v=0;v<w.length-1;v++){const T=(await ur({fs:a,cache:{},gitdir:i,oid:w[v+1]})).commit.message.startsWith("stash-Index");await nc({fs:a,dir:t,gitdir:i,stashCommit:w[v+1],parentCommit:w[v],wasStaged:T})}}async function Sl({fs:a,dir:t,gitdir:i,refIdx:o=0}){const l=new mr({fs:a,dir:t,gitdir:i});if(!(await l.readStashCommit(o)).commit)return;const w=l.refStashPath;await tn(w,async()=>{await a.exists(w)&&await a.rm(w)});const v=await l.readStashReflogs({parsed:!1});if(!v.length)return;v.splice(o,1);const I=l.refLogsStashPath;await tn({reflogEntries:v,stashReflogPath:I,stashMgr:l},async()=>{if(v.length){await a.write(I,v.reverse().join(`
`)+`
`,"utf8");const T=v[v.length-1].split(" ")[1];await l.writeStashRef(T)}else await a.rm(I)})}async function Dp({fs:a,dir:t,gitdir:i}){return new mr({fs:a,dir:t,gitdir:i}).readStashReflogs({parsed:!0})}async function Lp({fs:a,dir:t,gitdir:i}){const o=new mr({fs:a,dir:t,gitdir:i}),l=[o.refStashPath,o.refLogsStashPath];await tn(l,async()=>{await Promise.all(l.map(async f=>{if(await a.exists(f))return a.rm(f)}))})}async function $p({fs:a,dir:t,gitdir:i,refIdx:o=0}){await _l({fs:a,dir:t,gitdir:i,refIdx:o}),await Sl({fs:a,dir:t,gitdir:i,refIdx:o})}async function kl({fs:a,dir:t,gitdir:i=p(t,".git"),op:o="push",message:l="",refIdx:f=0}){Y("fs",a),Y("dir",t),Y("gitdir",i),Y("op",o);const w={push:Bp,apply:_l,drop:Sl,list:Dp,clear:Lp,pop:$p,create:Fp},v=["apply","drop","pop"];try{const I=new qe(a),T=await We({fsp:I,dotgit:i});["refs","logs","logs/refs"].map(D=>p(T,D)).forEach(async D=>{await I.exists(D)||await I.mkdir(D)});const M=w[o];if(M){if(v.includes(o)&&f<0)throw new ar(`stash@${f}`,"number that is in range of [0, num of stash pushed]");return await M({fs:I,dir:t,gitdir:T,message:l,refIdx:f})}throw new Error(`To be implemented: ${o}`)}catch(I){throw I.caller="git.stash",I}}async function El({fs:a,dir:t,gitdir:i=p(t,".git"),filepath:o,cache:l={}}){try{Y("fs",a),Y("gitdir",i),Y("filepath",o);const f=new qe(a),w=await We({fsp:f,dotgit:i});if(await Qr.isIgnored({fs:f,gitdir:w,dir:t,filepath:o}))return"ignored";const I=await Np({fs:f,cache:l,gitdir:w}),T=await Al({fs:f,cache:l,gitdir:w,tree:I,path:o}),k=await he.acquire({fs:f,gitdir:w,cache:l},async function(fe){for(const we of fe)if(we.path===o)return we;return null}),M=await f.lstat(p(t,o)),D=T!==null,V=k!==null,ee=M!==null,ge=async()=>{if(V&&!de(k,M))return k.oid;{const fe=await f.read(p(t,o)),we=await ml({gitdir:w,type:"blob",object:fe});return V&&k.oid===we&&M.size!==-1&&he.acquire({fs:f,gitdir:w,cache:l},async function(ve){ve.insert({filepath:o,stats:M,oid:we})}),we}};if(!D&&!ee&&!V)return"absent";if(!D&&!ee&&V)return"*absent";if(!D&&ee&&!V)return"*added";if(!D&&ee&&V)return await ge()===k.oid?"added":"*added";if(D&&!ee&&!V)return"deleted";if(D&&!ee&&V)return T===k.oid,"*deleted";if(D&&ee&&!V)return await ge()===T?"*undeleted":"*undeletemodified";if(D&&ee&&V){const fe=await ge();return fe===T?fe===k.oid?"unmodified":"*unmodified":fe===k.oid?"modified":"*modified"}}catch(f){throw f.caller="git.status",f}}async function Al({fs:a,cache:t,gitdir:i,tree:o,path:l}){typeof l=="string"&&(l=l.split("/"));const f=l.shift();for(const w of o)if(w.path===f){if(l.length===0)return w.oid;const{type:v,object:I}=await dt({fs:a,cache:t,gitdir:i,oid:w.oid});if(v==="tree"){const T=Pe.from(I);return Al({fs:a,cache:t,gitdir:i,tree:T,path:l})}if(v==="blob")throw new Fe(w.oid,v,"blob",l.join("/"))}return null}async function Np({fs:a,cache:t,gitdir:i}){let o;try{o=await H.resolve({fs:a,gitdir:i,ref:"HEAD"})}catch(f){if(f instanceof je)return[]}const{tree:l}=await en({fs:a,cache:t,gitdir:i,oid:o});return l}async function Il({fs:a,dir:t,gitdir:i=p(t,".git"),ref:o="HEAD",filepaths:l=["."],filter:f,cache:w={},ignored:v=!1}){try{Y("fs",a),Y("gitdir",i),Y("ref",o);const I=new qe(a),T=await We({fsp:I,dotgit:i});return await vr({fs:I,cache:w,dir:t,gitdir:T,trees:[Vt({ref:o}),Jr(),Oe()],map:async function(k,[M,D,V]){if(!M&&!V&&D&&!v&&await Qr.isIgnored({fs:I,dir:t,filepath:k})||!l.some(Ce=>Qs(k,Ce)))return null;if(f&&!f(k))return;const[ee,ge,fe]=await Promise.all([M&&M.type(),D&&D.type(),V&&V.type()]),we=[ee,ge,fe].includes("blob");if((ee==="tree"||ee==="special")&&!we)return;if(ee==="commit")return null;if((ge==="tree"||ge==="special")&&!we)return;if(fe==="commit")return null;if((fe==="tree"||fe==="special")&&!we)return;const ve=ee==="blob"?await M.oid():void 0,Re=fe==="blob"?await V.oid():void 0;let Ne;ee!=="blob"&&ge==="blob"&&fe!=="blob"?Ne="42":ge==="blob"&&(Ne=await D.oid());const Ge=[void 0,ve,Ne,Re],He=Ge.map(Ce=>Ge.indexOf(Ce));return He.shift(),[k,...He]}})}catch(I){throw I.caller="git.statusMatrix",I}}async function Cl({fs:a,dir:t,gitdir:i=p(t,".git"),ref:o,object:l,force:f=!1}){try{Y("fs",a),Y("gitdir",i),Y("ref",o);const w=new qe(a);if(o===void 0)throw new qt("ref");o=o.startsWith("refs/tags/")?o:`refs/tags/${o}`;const v=await We({fsp:w,dotgit:i}),I=await H.resolve({fs:w,gitdir:v,ref:l||"HEAD"});if(!f&&await H.exists({fs:w,gitdir:v,ref:o}))throw new ir("tag",o);await H.writeRef({fs:w,gitdir:v,ref:o,value:I})}catch(w){throw w.caller="git.tag",w}}async function Tl({fs:a,dir:t,gitdir:i=p(t,".git"),cache:o={},filepath:l,oid:f,mode:w,add:v,remove:I,force:T}){try{Y("fs",a),Y("gitdir",i),Y("filepath",l);const k=new qe(a),M=await We({fsp:k,dotgit:i});if(I)return await he.acquire({fs:k,gitdir:M,cache:o},async function(V){if(!T){const ee=await k.lstat(p(t,l));if(ee){if(ee.isDirectory())throw new yr("directory");return}}V.has({filepath:l})&&V.delete({filepath:l})});let D;if(!f){if(D=await k.lstat(p(t,l)),!D)throw new je(`file at "${l}" on disk and "remove" not set`);if(D.isDirectory())throw new yr("directory")}return await he.acquire({fs:k,gitdir:M,cache:o},async function(V){if(!v&&!V.has({filepath:l}))throw new je(`file at "${l}" in index and "add" not set`);let ee;if(f)ee={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:w,uid:0,gid:0,size:0};else{ee=D;const ge=ee.isSymbolicLink()?await k.readlink(p(t,l)):await k.read(p(t,l));f=await Wt({fs:k,gitdir:M,type:"blob",format:"content",object:ge})}return V.insert({filepath:l,oid:f,stats:ee}),f})}catch(k){throw k.caller="git.updateIndex",k}}function Rl(){try{return fi.version}catch(a){throw a.caller="git.version",a}}async function Ol({fs:a,dir:t,gitdir:i=p(t,".git"),trees:o,map:l,reduce:f,iterate:w,cache:v={}}){try{Y("fs",a),Y("gitdir",i),Y("trees",o);const I=new qe(a),T=await We({fsp:I,dotgit:i});return await vr({fs:I,cache:v,dir:t,gitdir:T,trees:o,map:l,reduce:f,iterate:w})}catch(I){throw I.caller="git.walk",I}}async function Pl({fs:a,dir:t,gitdir:i=p(t,".git"),blob:o}){try{Y("fs",a),Y("gitdir",i),Y("blob",o);const l=new qe(a),f=await We({fsp:l,dotgit:i});return await Wt({fs:l,gitdir:f,type:"blob",object:o,format:"content"})}catch(l){throw l.caller="git.writeBlob",l}}async function Ml({fs:a,dir:t,gitdir:i=p(t,".git"),commit:o}){try{Y("fs",a),Y("gitdir",i),Y("commit",o);const l=new qe(a),f=await We({fsp:l,dotgit:i});return await vl({fs:l,gitdir:f,commit:o})}catch(l){throw l.caller="git.writeCommit",l}}async function jl({fs:a,dir:t,gitdir:i=p(t,".git"),type:o,object:l,format:f="parsed",oid:w,encoding:v=void 0}){try{const I=new qe(a),T=await We({fsp:I,dotgit:i});if(f==="parsed"){switch(o){case"commit":l=gt.from(l).toObject();break;case"tree":l=Pe.from(l).toObject();break;case"blob":l=Buffer.from(l,v);break;case"tag":l=Gt.from(l).toObject();break;default:throw new Fe(w||"",o,"blob|commit|tag|tree")}f="content"}return w=await Wt({fs:I,gitdir:T,type:o,object:l,oid:w,format:f}),w}catch(I){throw I.caller="git.writeObject",I}}async function Bl({fs:a,dir:t,gitdir:i=p(t,".git"),ref:o,value:l,force:f=!1,symbolic:w=!1}){try{Y("fs",a),Y("gitdir",i),Y("ref",o),Y("value",l);const v=new qe(a);if(!Pn(o,!0))throw new ar(o,d.clean(o));const I=await We({fsp:v,dotgit:i});if(!f&&await H.exists({fs:v,gitdir:I,ref:o}))throw new ir("ref",o);w?await H.writeSymbolicRef({fs:v,gitdir:I,ref:o,value:l}):(l=await H.resolve({fs:v,gitdir:I,ref:l}),await H.writeRef({fs:v,gitdir:I,ref:o,value:l}))}catch(v){throw v.caller="git.writeRef",v}}async function Up({fs:a,gitdir:t,tag:i}){const o=Gt.from(i).toObject();return await Wt({fs:a,gitdir:t,type:"tag",object:o,format:"content"})}async function Fl({fs:a,dir:t,gitdir:i=p(t,".git"),tag:o}){try{Y("fs",a),Y("gitdir",i),Y("tag",o);const l=new qe(a),f=await We({fsp:l,dotgit:i});return await Up({fs:l,gitdir:f,tag:o})}catch(l){throw l.caller="git.writeTag",l}}async function Dl({fs:a,dir:t,gitdir:i=p(t,".git"),tree:o}){try{Y("fs",a),Y("gitdir",i),Y("tree",o);const l=new qe(a),f=await We({fsp:l,dotgit:i});return await On({fs:l,gitdir:f,tree:o})}catch(l){throw l.caller="git.writeTree",l}}var zp={Errors:js,STAGE:Oe,TREE:Vt,WORKDIR:Jr,add:Gs,abortMerge:Ns,addNote:Zs,addRemote:Xs,annotatedTag:Ys,branch:Js,cherryPick:ac,checkout:ta,clone:wc,commit:yc,getConfig:Mc,getConfigAll:jc,setConfig:bl,currentBranch:bc,deleteBranch:vc,deleteRef:xc,deleteRemote:_c,deleteTag:Sc,expandOid:kc,expandRef:Ec,fastForward:Cc,fetch:Tc,findMergeBase:Rc,findRoot:Pc,getRemoteInfo:Bc,getRemoteInfo2:Dc,hashBlob:Lc,indexPack:$c,init:Nc,isDescendent:zc,isIgnored:Gc,listBranches:Hc,listFiles:Wc,listNotes:Vc,listRefs:Zc,listRemotes:Kc,listServerRefs:Xc,listTags:Yc,log:el,merge:tl,packObjects:nl,pull:il,push:al,readBlob:cl,readCommit:ua,readNote:ll,readObject:ul,readTag:fl,readTree:dl,remove:hl,removeNote:pl,renameBranch:gl,resetIndex:wl,updateIndex:Tl,resolveRef:yl,status:El,statusMatrix:Il,tag:Cl,version:Rl,walk:Ol,writeBlob:Pl,writeCommit:Ml,writeObject:jl,writeRef:Bl,writeTag:Fl,writeTree:Dl,stash:kl};return De.Errors=js,De.STAGE=Oe,De.TREE=Vt,De.WORKDIR=Jr,De.abortMerge=Ns,De.add=Gs,De.addNote=Zs,De.addRemote=Xs,De.annotatedTag=Ys,De.branch=Js,De.checkout=ta,De.cherryPick=ac,De.clone=wc,De.commit=yc,De.currentBranch=bc,De.default=zp,De.deleteBranch=vc,De.deleteRef=xc,De.deleteRemote=_c,De.deleteTag=Sc,De.expandOid=kc,De.expandRef=Ec,De.fastForward=Cc,De.fetch=Tc,De.findMergeBase=Rc,De.findRoot=Pc,De.getConfig=Mc,De.getConfigAll=jc,De.getRemoteInfo=Bc,De.getRemoteInfo2=Dc,De.hashBlob=Lc,De.indexPack=$c,De.init=Nc,De.isDescendent=zc,De.isIgnored=Gc,De.listBranches=Hc,De.listFiles=Wc,De.listNotes=Vc,De.listRefs=Zc,De.listRemotes=Kc,De.listServerRefs=Xc,De.listTags=Yc,De.log=el,De.merge=tl,De.packObjects=nl,De.pull=il,De.push=al,De.readBlob=cl,De.readCommit=ua,De.readNote=ll,De.readObject=ul,De.readTag=fl,De.readTree=dl,De.remove=hl,De.removeNote=pl,De.renameBranch=gl,De.resetIndex=wl,De.resolveRef=yl,De.setConfig=bl,De.stash=kl,De.status=El,De.statusMatrix=Il,De.tag=Cl,De.updateIndex=Tl,De.version=Rl,De.walk=Ol,De.writeBlob=Pl,De.writeCommit=Ml,De.writeObject=jl,De.writeRef=Bl,De.writeTag=Fl,De.writeTree=Dl,De}var Qw=Jw();const St=Xn(Qw);function ey(e){let r=[e];return{next(){return Promise.resolve({done:r.length===0,value:r.pop()})},return(){return r=[],{}},[Symbol.asyncIterator](){return this}}}function ty(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:ey(e)}async function ry(e,r){const n=ty(e);for(;;){const{value:s,done:c}=await n.next();if(s&&await r(s),c)break}n.return&&n.return()}async function ny(e){let r=0;const n=[];await ry(e,u=>{n.push(u),r+=u.byteLength});const s=new Uint8Array(r);let c=0;for(const u of n)s.set(u,c),c+=u.byteLength;return s}function iy(e){if(e[Symbol.asyncIterator])return e;const r=e.getReader();return{next(){return r.read()},return(){return r.releaseLock(),{}},[Symbol.asyncIterator](){return this}}}async function ay({onProgress:e,url:r,method:n="GET",headers:s={},body:c}){c&&(c=await ny(c));const u=await fetch(r,{method:n,headers:s,body:c}),g=u.body&&u.body.getReader?iy(u.body):[new Uint8Array(await u.arrayBuffer())];s={};for(const[d,h]of u.headers.entries())s[d]=h;return{url:u.url,method:u.method,statusCode:u.status,statusMessage:u.statusText,body:g,headers:s}}var zi={request:ay};const ln=new Map;function oy(e,r){ln.has(e)||ln.set(e,new Set),ln.get(e).add(r)}function sy(e,r){const n=ln.get(e);n&&(n.delete(r),n.size===0&&ln.delete(e))}function lr(e,r){const n=ln.get(e);n&&n.forEach(s=>s(r))}const Xt={FIND:"notemac-find",REPLACE:"notemac-replace",MARK:"notemac-mark",GOTO_LINE:"notemac-goto-line",COLUMN_EDIT:"notemac-column-edit",CLEAR_MARKS:"notemac-clear-marks",EDITOR_ACTION:"notemac-editor-action",INSERT_SNIPPET:"notemac-insert-snippet",EXECUTE_COMMAND:"notemac-execute-command",GIT_STATUS_CHANGED:"notemac-git-status-changed",GIT_BRANCH_CHANGED:"notemac-git-branch-changed",GIT_OPERATION_COMPLETE:"notemac-git-operation-complete",AI_RESPONSE_COMPLETE:"notemac-ai-response-complete",AI_STREAM_CHUNK:"notemac-ai-stream-chunk",AI_INLINE_SUGGESTION:"notemac-ai-inline-suggestion",AI_ERROR:"notemac-ai-error",AI_ACTION:"notemac-ai-action"};var Wo,Nf;function cy(){if(Nf)return Wo;Nf=1,Wo=e;function e(r){var n,s;if(typeof r!="function")throw new Error("expected a function but got "+r);return function(){return n||(n=!0,s=r.apply(this,arguments)),s}}return Wo}var Vo={},Uf;function ly(){return Uf||(Uf=1,(function(e){function r(F,U){var G;return F instanceof Buffer?G=F:G=Buffer.from(F.buffer,F.byteOffset,F.byteLength),G.toString(U)}var n=function(F){return Buffer.from(F)};function s(F){for(var U=0,G=Math.min(256*256,F.length+1),W=new Uint16Array(G),te=[],Z=0;;){var z=U<F.length;if(!z||Z>=G-1){var B=W.subarray(0,Z),J=B;if(te.push(String.fromCharCode.apply(null,J)),!z)return te.join("");F=F.subarray(U),U=0,Z=0}var N=F[U++];if((N&128)===0)W[Z++]=N;else if((N&224)===192){var ce=F[U++]&63;W[Z++]=(N&31)<<6|ce}else if((N&240)===224){var ce=F[U++]&63,oe=F[U++]&63;W[Z++]=(N&31)<<12|ce<<6|oe}else if((N&248)===240){var ce=F[U++]&63,oe=F[U++]&63,de=F[U++]&63,ne=(N&7)<<18|ce<<12|oe<<6|de;ne>65535&&(ne-=65536,W[Z++]=ne>>>10&1023|55296,ne=56320|ne&1023),W[Z++]=ne}}}function c(F){for(var U=0,G=F.length,W=0,te=Math.max(32,G+(G>>>1)+7),Z=new Uint8Array(te>>>3<<3);U<G;){var z=F.charCodeAt(U++);if(z>=55296&&z<=56319){if(U<G){var B=F.charCodeAt(U);(B&64512)===56320&&(++U,z=((z&1023)<<10)+(B&1023)+65536)}if(z>=55296&&z<=56319)continue}if(W+4>Z.length){te+=8,te*=1+U/F.length*2,te=te>>>3<<3;var J=new Uint8Array(te);J.set(Z),Z=J}if((z&4294967168)===0){Z[W++]=z;continue}else if((z&4294965248)===0)Z[W++]=z>>>6&31|192;else if((z&4294901760)===0)Z[W++]=z>>>12&15|224,Z[W++]=z>>>6&63|128;else if((z&4292870144)===0)Z[W++]=z>>>18&7|240,Z[W++]=z>>>12&63|128,Z[W++]=z>>>6&63|128;else continue;Z[W++]=z&63|128}return Z.slice?Z.slice(0,W):Z.subarray(0,W)}var u="Failed to ",g=function(F,U,G){if(F)throw new Error("".concat(u).concat(U,": the '").concat(G,"' option is unsupported."))},d=typeof Buffer=="function"&&Buffer.from,h=d?n:c;function S(){this.encoding="utf-8"}S.prototype.encode=function(F,U){return g(U&&U.stream,"encode","stream"),h(F)};function _(F){var U;try{var G=new Blob([F],{type:"text/plain;charset=UTF-8"});U=URL.createObjectURL(G);var W=new XMLHttpRequest;return W.open("GET",U,!1),W.send(),W.responseText}finally{U&&URL.revokeObjectURL(U)}}var x=!d&&typeof Blob=="function"&&typeof URL=="function"&&typeof URL.createObjectURL=="function",R=["utf-8","utf8","unicode-1-1-utf-8"],y=s;d?y=r:x&&(y=function(F){try{return _(F)}catch{return s(F)}});var j="construct 'TextDecoder'",X="".concat(u," ").concat(j,": the ");function L(F,U){g(U&&U.fatal,j,"fatal"),F=F||"utf-8";var G;if(d?G=Buffer.isEncoding(F):G=R.indexOf(F.toLowerCase())!==-1,!G)throw new RangeError("".concat(X," encoding label provided ('").concat(F,"') is invalid."));this.encoding=F,this.fatal=!1,this.ignoreBOM=!1}L.prototype.decode=function(F,U){g(U&&U.stream,"decode","stream");var G;return F instanceof Uint8Array?G=F:F.buffer instanceof ArrayBuffer?G=new Uint8Array(F.buffer):G=new Uint8Array(F),y(G,this.encoding)},e.TextEncoder=e.TextEncoder||S,e.TextDecoder=e.TextDecoder||L})(typeof window<"u"?window:typeof Ci<"u"?Ci:Vo)),Vo}var Zo,zf;function uy(){return zf||(zf=1,ly(),Zo={encode:e=>new TextEncoder().encode(e),decode:e=>new TextDecoder().decode(e)}),Zo}var Ko,Gf;function fy(){if(Gf)return Ko;Gf=1,Ko=e;function e(r,n,s){var c;return function(){if(!n)return r.apply(this,arguments);var u=this,g=arguments,d=s&&!c;if(clearTimeout(c),c=setTimeout(function(){if(c=null,!d)return r.apply(u,g)},n),d)return r.apply(this,arguments)}}return Ko}var Xo,Hf;function Os(){if(Hf)return Xo;Hf=1;function e(d){if(d.length===0)return".";let h=s(d);return h=h.reduce(g,[]),n(...h)}function r(...d){let h="";for(let S of d)S.startsWith("/")?h=S:h=e(n(h,S));return h}function n(...d){if(d.length===0)return"";let h=d.join("/");return h=h.replace(/\/{2,}/g,"/"),h}function s(d){if(d.length===0)return[];if(d==="/")return["/"];let h=d.split("/");return h[h.length-1]===""&&h.pop(),d[0]==="/"?h[0]="/":h[0]!=="."&&h.unshift("."),h}function c(d){const h=d.lastIndexOf("/");if(h===-1)throw new Error(`Cannot get dirname of "${d}"`);return h===0?"/":d.slice(0,h)}function u(d){if(d==="/")throw new Error(`Cannot get basename of "${d}"`);const h=d.lastIndexOf("/");return h===-1?d:d.slice(h+1)}function g(d,h){if(d.length===0)return d.push(h),d;if(h===".")return d;if(h===".."){if(d.length===1){if(d[0]==="/")throw new Error("Unable to normalize path - traverses above root directory");if(d[0]===".")return d.push(h),d}return d[d.length-1]===".."?(d.push(".."),d):(d.pop(),d)}return d.push(h),d}return Xo={join:n,normalize:e,split:s,basename:u,dirname:c,resolve:r},Xo}var Yo,qf;function Yd(){if(qf)return Yo;qf=1;function e(d){return class extends Error{constructor(...h){super(...h),this.code=d,this.message?this.message=d+": "+this.message:this.message=d}}}const r=e("EEXIST"),n=e("ENOENT"),s=e("ENOTDIR"),c=e("ENOTEMPTY"),u=e("ETIMEDOUT"),g=e("EISDIR");return Yo={EEXIST:r,ENOENT:n,ENOTDIR:s,ENOTEMPTY:c,ETIMEDOUT:u,EISDIR:g},Yo}var Jo,Wf;function dy(){if(Wf)return Jo;Wf=1;const e=Os(),{EEXIST:r,ENOENT:n,ENOTDIR:s,ENOTEMPTY:c,EISDIR:u}=Yd(),g=0;return Jo=class{constructor(){}_makeRoot(h=new Map){return h.set(g,{mode:511,type:"dir",size:0,ino:0,mtimeMs:Date.now()}),h}activate(h=null){h===null?this._root=new Map([["/",this._makeRoot()]]):typeof h=="string"?this._root=new Map([["/",this._makeRoot(this.parse(h))]]):this._root=h}get activated(){return!!this._root}deactivate(){this._root=void 0}size(){return this._countInodes(this._root.get("/"))-1}_countInodes(h){let S=1;for(let[_,x]of h)_!==g&&(S+=this._countInodes(x));return S}autoinc(){return this._maxInode(this._root.get("/"))+1}_maxInode(h){let S=h.get(g).ino;for(let[_,x]of h)_!==g&&(S=Math.max(S,this._maxInode(x)));return S}print(h=this._root.get("/")){let S="";const _=(x,R)=>{for(let[y,j]of x){if(y===0)continue;let X=j.get(g),L=X.mode.toString(8);S+=`${"	".repeat(R)}${y}	${L}`,X.type==="file"?S+=`	${X.size}	${X.mtimeMs}
`:(S+=`
`,_(j,R+1))}};return _(h,0),S}parse(h){let S=0;function _(j){const X=++S,L=j.length===1?"dir":"file";let[F,U,G]=j;return F=parseInt(F,8),U=U?parseInt(U):0,G=G?parseInt(G):Date.now(),new Map([[g,{mode:F,type:L,size:U,mtimeMs:G,ino:X}]])}let x=h.trim().split(`
`),R=this._makeRoot(),y=[{indent:-1,node:R},{indent:0,node:null}];for(let j of x){let L=j.match(/^\t*/)[0].length;j=j.slice(L);let[F,...U]=j.split("	"),G=_(U);if(L<=y[y.length-1].indent)for(;L<=y[y.length-1].indent;)y.pop();y.push({indent:L,node:G}),y[y.length-2].node.set(F,G)}return R}_lookup(h,S=!0){let _=this._root,x="/",R=e.split(h);for(let y=0;y<R.length;++y){let j=R[y];if(_=_.get(j),!_)throw new n(h);if(S||y<R.length-1){const X=_.get(g);if(X.type==="symlink"){let L=e.resolve(x,X.target);_=this._lookup(L)}x?x=e.join(x,j):x=j}}return _}mkdir(h,{mode:S}){if(h==="/")throw new r;let _=this._lookup(e.dirname(h)),x=e.basename(h);if(_.has(x))throw new r;let R=new Map,y={mode:S,type:"dir",size:0,mtimeMs:Date.now(),ino:this.autoinc()};R.set(g,y),_.set(x,R)}rmdir(h){let S=this._lookup(h);if(S.get(g).type!=="dir")throw new s;if(S.size>1)throw new c;let _=this._lookup(e.dirname(h)),x=e.basename(h);_.delete(x)}readdir(h){let S=this._lookup(h);if(S.get(g).type!=="dir")throw new s;return[...S.keys()].filter(_=>typeof _=="string")}writeStat(h,S,{mode:_}){let x,R;try{R=this.stat(h)}catch{}if(R!==void 0){if(R.type==="dir")throw new u;_==null&&(_=R.mode),x=R.ino}_==null&&(_=438),x==null&&(x=this.autoinc());let y=this._lookup(e.dirname(h)),j=e.basename(h),X={mode:_,type:"file",size:S,mtimeMs:Date.now(),ino:x},L=new Map;return L.set(g,X),y.set(j,L),X}unlink(h){let S=this._lookup(e.dirname(h)),_=e.basename(h);S.delete(_)}rename(h,S){let _=e.basename(S),x=this._lookup(h);this._lookup(e.dirname(S)).set(_,x),this.unlink(h)}stat(h){return this._lookup(h).get(g)}lstat(h){return this._lookup(h,!1).get(g)}readlink(h){return this._lookup(h,!1).get(g).target}symlink(h,S){let _,x;try{let L=this.stat(S);x===null&&(x=L.mode),_=L.ino}catch{}x==null&&(x=40960),_==null&&(_=this.autoinc());let R=this._lookup(e.dirname(S)),y=e.basename(S),j={mode:x,type:"symlink",target:h,size:0,mtimeMs:Date.now(),ino:_},X=new Map;return X.set(g,j),R.set(y,X),j}_du(h){let S=0;for(const[_,x]of h.entries())_===g?S+=x.size:S+=this._du(x);return S}du(h){let S=this._lookup(h);return this._du(S)}},Jo}class Jd{constructor(r="keyval-store",n="keyval"){this.storeName=n,this._dbName=r,this._storeName=n,this._init()}_init(){this._dbp||(this._dbp=new Promise((r,n)=>{const s=indexedDB.open(this._dbName);s.onerror=()=>n(s.error),s.onsuccess=()=>r(s.result),s.onupgradeneeded=()=>{s.result.createObjectStore(this._storeName)}}))}_withIDBStore(r,n){return this._init(),this._dbp.then(s=>new Promise((c,u)=>{const g=s.transaction(this.storeName,r);g.oncomplete=()=>c(),g.onabort=g.onerror=()=>u(g.error),n(g.objectStore(this.storeName))}))}_close(){return this._init(),this._dbp.then(r=>{r.close(),this._dbp=void 0})}}let Qo;function Hr(){return Qo||(Qo=new Jd),Qo}function hy(e,r=Hr()){let n;return r._withIDBStore("readwrite",s=>{n=s.get(e)}).then(()=>n.result)}function py(e,r,n=Hr()){return n._withIDBStore("readwrite",s=>{s.put(r,e)})}function gy(e,r,n=Hr()){return n._withIDBStore("readwrite",s=>{const c=s.get(e);c.onsuccess=()=>{s.put(r(c.result),e)}})}function my(e,r=Hr()){return r._withIDBStore("readwrite",n=>{n.delete(e)})}function wy(e=Hr()){return e._withIDBStore("readwrite",r=>{r.clear()})}function yy(e=Hr()){const r=[];return e._withIDBStore("readwrite",n=>{(n.openKeyCursor||n.openCursor).call(n).onsuccess=function(){this.result&&(r.push(this.result.key),this.result.continue())}}).then(()=>r)}function by(e=Hr()){return e._close()}const vy=Object.freeze(Object.defineProperty({__proto__:null,Store:Jd,clear:wy,close:by,del:my,get:hy,keys:yy,set:py,update:gy},Symbol.toStringTag,{value:"Module"})),Qd=Vp(vy);var es,Vf;function xy(){if(Vf)return es;Vf=1;const e=Qd;return es=class{constructor(n,s){this._database=n,this._storename=s,this._store=new e.Store(this._database,this._storename)}saveSuperblock(n){return e.set("!root",n,this._store)}loadSuperblock(){return e.get("!root",this._store)}readFile(n){return e.get(n,this._store)}writeFile(n,s){return e.set(n,s,this._store)}unlink(n){return e.del(n,this._store)}wipe(){return e.clear(this._store)}close(){return e.close(this._store)}},es}var ts,Zf;function _y(){return Zf||(Zf=1,ts=class{constructor(r){this._url=r}loadSuperblock(){return fetch(this._url+"/.superblock.txt").then(r=>r.ok?r.text():null)}async readFile(r){const n=await fetch(this._url+r);if(n.status===200)return n.arrayBuffer();throw new Error("ENOENT")}async sizeFile(r){const n=await fetch(this._url+r,{method:"HEAD"});if(n.status===200)return n.headers.get("content-length");throw new Error("ENOENT")}}),ts}var rs,Kf;function Sy(){if(Kf)return rs;Kf=1;const e=Qd,r=n=>new Promise(s=>setTimeout(s,n));return rs=class{constructor(s,c){this._id=Math.random(),this._database=s,this._storename=c,this._store=new e.Store(this._database,this._storename),this._lock=null}async has({margin:s=2e3}={}){if(this._lock&&this._lock.holder===this._id){const c=Date.now();return this._lock.expires>c+s?!0:await this.renew()}else return!1}async renew({ttl:s=5e3}={}){let c;return await e.update("lock",u=>{const d=Date.now()+s;return c=u&&u.holder===this._id,this._lock=c?{holder:this._id,expires:d}:u,this._lock},this._store),c}async acquire({ttl:s=5e3}={}){let c,u,g;if(await e.update("lock",d=>{const h=Date.now(),S=h+s;return u=d&&d.expires<h,c=d===void 0||u,g=d&&d.holder===this._id,this._lock=c?{holder:this._id,expires:S}:d,this._lock},this._store),g)throw new Error("Mutex double-locked");return c}async wait({interval:s=100,limit:c=6e3,ttl:u}={}){for(;c--;){if(await this.acquire({ttl:u}))return!0;await r(s)}throw new Error("Mutex timeout")}async release({force:s=!1}={}){let c,u,g;if(await e.update("lock",d=>(c=s||d&&d.holder===this._id,u=d===void 0,g=d&&d.holder!==this._id,this._lock=c?void 0:d,this._lock),this._store),await e.close(this._store),!c&&!s){if(u)throw new Error("Mutex double-freed");if(g)throw new Error("Mutex lost ownership")}return c}},rs}var ns,Xf;function ky(){return Xf||(Xf=1,ns=class{constructor(r){this._id=Math.random(),this._database=r,this._has=!1,this._release=null}async has(){return this._has}async acquire(){return new Promise(r=>{navigator.locks.request(this._database+"_lock",{ifAvailable:!0},n=>(this._has=!!n,r(!!n),new Promise(s=>{this._release=s})))})}async wait({timeout:r=6e5}={}){return new Promise((n,s)=>{const c=new AbortController;setTimeout(()=>{c.abort(),s(new Error("Mutex timeout"))},r),navigator.locks.request(this._database+"_lock",{signal:c.signal},u=>(this._has=!!u,n(!!u),new Promise(g=>{this._release=g})))})}async release({force:r=!1}={}){this._has=!1,this._release?this._release():r&&navigator.locks.request(this._database+"_lock",{steal:!0},n=>!0)}}),ns}var is,Yf;function Ey(){if(Yf)return is;Yf=1;const{encode:e,decode:r}=uy(),n=fy(),s=dy(),{ENOENT:c,ENOTEMPTY:u,ETIMEDOUT:g}=Yd(),d=xy(),h=_y(),S=Sy(),_=ky(),x=Os();return is=class{constructor(){this.saveSuperblock=n(()=>{this.flush()},500)}async init(y,{wipe:j,url:X,urlauto:L,fileDbName:F=y,db:U=null,fileStoreName:G=y+"_files",lockDbName:W=y+"_lock",lockStoreName:te=y+"_lock"}={}){this._name=y,this._idb=U||new d(F,G),this._mutex=navigator.locks?new _(y):new S(W,te),this._cache=new s(y),this._opts={wipe:j,url:X},this._needsWipe=!!j,X&&(this._http=new h(X),this._urlauto=!!L)}async activate(){if(this._cache.activated)return;this._needsWipe&&(this._needsWipe=!1,await this._idb.wipe(),await this._mutex.release({force:!0})),await this._mutex.has()||await this._mutex.wait();const y=await this._idb.loadSuperblock();if(y)this._cache.activate(y);else if(this._http){const j=await this._http.loadSuperblock();this._cache.activate(j),await this._saveSuperblock()}else this._cache.activate();if(!await this._mutex.has())throw new g}async deactivate(){await this._mutex.has()&&await this._saveSuperblock(),this._cache.deactivate();try{await this._mutex.release()}catch{}await this._idb.close()}async _saveSuperblock(){this._cache.activated&&(this._lastSavedAt=Date.now(),await this._idb.saveSuperblock(this._cache._root))}_writeStat(y,j,X){let L=x.split(x.dirname(y)),F=L.shift();for(let U of L){F=x.join(F,U);try{this._cache.mkdir(F,{mode:511})}catch{}}return this._cache.writeStat(y,j,X)}async readFile(y,j){const X=typeof j=="string"?j:j&&j.encoding;if(X&&X!=="utf8")throw new Error('Only "utf8" encoding is supported in readFile');let L=null,F=null;try{F=this._cache.stat(y),L=await this._idb.readFile(F.ino)}catch(U){if(!this._urlauto)throw U}if(!L&&this._http){let U=this._cache.lstat(y);for(;U.type==="symlink";)y=x.resolve(x.dirname(y),U.target),U=this._cache.lstat(y);L=await this._http.readFile(y)}if(L&&((!F||F.size!=L.byteLength)&&(F=await this._writeStat(y,L.byteLength,{mode:F?F.mode:438}),this.saveSuperblock()),X==="utf8"?L=r(L):L.toString=()=>r(L)),!F)throw new c(y);return L}async writeFile(y,j,X){const{mode:L,encoding:F="utf8"}=X;if(typeof j=="string"){if(F!=="utf8")throw new Error('Only "utf8" encoding is supported in writeFile');j=e(j)}const U=await this._cache.writeStat(y,j.byteLength,{mode:L});await this._idb.writeFile(U.ino,j)}async unlink(y,j){const X=this._cache.lstat(y);this._cache.unlink(y),X.type!=="symlink"&&await this._idb.unlink(X.ino)}readdir(y,j){return this._cache.readdir(y)}mkdir(y,j){const{mode:X=511}=j;this._cache.mkdir(y,{mode:X})}rmdir(y,j){if(y==="/")throw new u;this._cache.rmdir(y)}rename(y,j){this._cache.rename(y,j)}stat(y,j){return this._cache.stat(y)}lstat(y,j){return this._cache.lstat(y)}readlink(y,j){return this._cache.readlink(y)}symlink(y,j){this._cache.symlink(y,j)}async backFile(y,j){let X=await this._http.sizeFile(y);await this._writeStat(y,X,j)}du(y){return this._cache.du(y)}flush(){return this._saveSuperblock()}},is}var as,Jf;function Ay(){return Jf||(Jf=1,as=class{constructor(r){this.type=r.type,this.mode=r.mode,this.size=r.size,this.ino=r.ino,this.mtimeMs=r.mtimeMs,this.ctimeMs=r.ctimeMs||r.mtimeMs,this.uid=1,this.gid=1,this.dev=1}isFile(){return this.type==="file"}isDirectory(){return this.type==="dir"}isSymbolicLink(){return this.type==="symlink"}}),as}var os,Qf;function Iy(){if(Qf)return os;Qf=1;const e=Ey(),r=Ay(),n=Os();function s(g,d,...h){return g=n.normalize(g),(typeof d>"u"||typeof d=="function")&&(d={}),typeof d=="string"&&(d={encoding:d}),[g,d,...h]}function c(g,d,h,...S){return g=n.normalize(g),(typeof h>"u"||typeof h=="function")&&(h={}),typeof h=="string"&&(h={encoding:h}),[g,d,h,...S]}function u(g,d,...h){return[n.normalize(g),n.normalize(d),...h]}return os=class{constructor(d,h={}){this.init=this.init.bind(this),this.readFile=this._wrap(this.readFile,s,!1),this.writeFile=this._wrap(this.writeFile,c,!0),this.unlink=this._wrap(this.unlink,s,!0),this.readdir=this._wrap(this.readdir,s,!1),this.mkdir=this._wrap(this.mkdir,s,!0),this.rmdir=this._wrap(this.rmdir,s,!0),this.rename=this._wrap(this.rename,u,!0),this.stat=this._wrap(this.stat,s,!1),this.lstat=this._wrap(this.lstat,s,!1),this.readlink=this._wrap(this.readlink,s,!1),this.symlink=this._wrap(this.symlink,u,!0),this.backFile=this._wrap(this.backFile,s,!0),this.du=this._wrap(this.du,s,!1),this._deactivationPromise=null,this._deactivationTimeout=null,this._activationPromise=null,this._operations=new Set,d&&this.init(d,h)}async init(...d){return this._initPromiseResolve&&await this._initPromise,this._initPromise=this._init(...d),this._initPromise}async _init(d,h={}){await this._gracefulShutdown(),this._activationPromise&&await this._deactivate(),this._backend&&this._backend.destroy&&await this._backend.destroy(),this._backend=h.backend||new e,this._backend.init&&await this._backend.init(d,h),this._initPromiseResolve&&(this._initPromiseResolve(),this._initPromiseResolve=null),h.defer||this.stat("/")}async _gracefulShutdown(){this._operations.size>0&&(this._isShuttingDown=!0,await new Promise(d=>this._gracefulShutdownResolve=d),this._isShuttingDown=!1,this._gracefulShutdownResolve=null)}_wrap(d,h,S){return async(..._)=>{_=h(..._);let x={name:d.name,args:_};this._operations.add(x);try{return await this._activate(),await d.apply(this,_)}finally{this._operations.delete(x),S&&this._backend.saveSuperblock(),this._operations.size===0&&(this._deactivationTimeout||clearTimeout(this._deactivationTimeout),this._deactivationTimeout=setTimeout(this._deactivate.bind(this),500))}}}async _activate(){this._initPromise,await this._initPromise,this._deactivationTimeout&&(clearTimeout(this._deactivationTimeout),this._deactivationTimeout=null),this._deactivationPromise&&await this._deactivationPromise,this._deactivationPromise=null,this._activationPromise||(this._activationPromise=this._backend.activate?this._backend.activate():Promise.resolve()),await this._activationPromise}async _deactivate(){return this._activationPromise&&await this._activationPromise,this._deactivationPromise||(this._deactivationPromise=this._backend.deactivate?this._backend.deactivate():Promise.resolve()),this._activationPromise=null,this._gracefulShutdownResolve&&this._gracefulShutdownResolve(),this._deactivationPromise}async readFile(d,h){return this._backend.readFile(d,h)}async writeFile(d,h,S){return await this._backend.writeFile(d,h,S),null}async unlink(d,h){return await this._backend.unlink(d,h),null}async readdir(d,h){return this._backend.readdir(d,h)}async mkdir(d,h){return await this._backend.mkdir(d,h),null}async rmdir(d,h){return await this._backend.rmdir(d,h),null}async rename(d,h){return await this._backend.rename(d,h),null}async stat(d,h){const S=await this._backend.stat(d,h);return new r(S)}async lstat(d,h){const S=await this._backend.lstat(d,h);return new r(S)}async readlink(d,h){return this._backend.readlink(d,h)}async symlink(d,h){return await this._backend.symlink(d,h),null}async backFile(d,h){return await this._backend.backFile(d,h),null}async du(d){return this._backend.du(d)}async flush(){return this._backend.flush()}},os}var ss,ed;function Cy(){if(ed)return ss;ed=1;const e=cy(),r=Iy();function n(s,c){return typeof s=="function"&&(c=s),c=e(c),[(...g)=>c(null,...g),c]}return ss=class{constructor(...c){this.promises=new r(...c),this.init=this.init.bind(this),this.readFile=this.readFile.bind(this),this.writeFile=this.writeFile.bind(this),this.unlink=this.unlink.bind(this),this.readdir=this.readdir.bind(this),this.mkdir=this.mkdir.bind(this),this.rmdir=this.rmdir.bind(this),this.rename=this.rename.bind(this),this.stat=this.stat.bind(this),this.lstat=this.lstat.bind(this),this.readlink=this.readlink.bind(this),this.symlink=this.symlink.bind(this),this.backFile=this.backFile.bind(this),this.du=this.du.bind(this),this.flush=this.flush.bind(this)}init(c,u){return this.promises.init(c,u)}readFile(c,u,g){const[d,h]=n(u,g);this.promises.readFile(c,u).then(d).catch(h)}writeFile(c,u,g,d){const[h,S]=n(g,d);this.promises.writeFile(c,u,g).then(h).catch(S)}unlink(c,u,g){const[d,h]=n(u,g);this.promises.unlink(c,u).then(d).catch(h)}readdir(c,u,g){const[d,h]=n(u,g);this.promises.readdir(c,u).then(d).catch(h)}mkdir(c,u,g){const[d,h]=n(u,g);this.promises.mkdir(c,u).then(d).catch(h)}rmdir(c,u,g){const[d,h]=n(u,g);this.promises.rmdir(c,u).then(d).catch(h)}rename(c,u,g){const[d,h]=n(g);this.promises.rename(c,u).then(d).catch(h)}stat(c,u,g){const[d,h]=n(u,g);this.promises.stat(c).then(d).catch(h)}lstat(c,u,g){const[d,h]=n(u,g);this.promises.lstat(c).then(d).catch(h)}readlink(c,u,g){const[d,h]=n(u,g);this.promises.readlink(c).then(d).catch(h)}symlink(c,u,g){const[d,h]=n(g);this.promises.symlink(c,u).then(d).catch(h)}backFile(c,u,g){const[d,h]=n(u,g);this.promises.backFile(c,u).then(d).catch(h)}du(c,u){const[g,d]=n(u);this.promises.du(c).then(g).catch(d)}flush(c){const[u,g]=n(c);this.promises.flush().then(u).catch(g)}},ss}var Ty=Cy();const Ry=Xn(Ty);function qr(){return typeof window<"u"&&window.electronAPI?"electron":"showDirectoryPicker"in window?"webfs":"lightningfs"}function Oy(){return qr()==="electron"}function Py(){return qr()==="webfs"}function My(){return qr()==="lightningfs"}const Ii=new Map;function eh(e){return Ii.has(e)||Ii.set(e,new Ry(e)),Ii.get(e)}function jy(e){Ii.delete(e),"indexedDB"in window&&window.indexedDB.deleteDatabase(e)}function Ps(e){return eh(e).promises}const th=new Map;function rh(e,r){th.set(e,r)}function nh(e){return th.get(e)}function ih(e){async function r(c){const u=c.split("/").filter(h=>0<h.length);if(u.length===0)return{dir:e,name:""};const g=u.pop();let d=e;for(const h of u)d=await d.getDirectoryHandle(h,{create:!1});return{dir:d,name:g}}async function n(c){const u=c.split("/").filter(d=>0<d.length);let g=e;for(const d of u)g=await g.getDirectoryHandle(d,{create:!1});return g}const s={readFile:async(c,u)=>{const{dir:g,name:d}=await r(c),S=await(await g.getFileHandle(d)).getFile();return(typeof u=="string"?u:u==null?void 0:u.encoding)==="utf8"?await S.text():new Uint8Array(await S.arrayBuffer())},writeFile:async(c,u,g)=>{const d=c.split("/").filter(R=>0<R.length),h=d.pop();let S=e;for(const R of d)S=await S.getDirectoryHandle(R,{create:!0});const x=await(await S.getFileHandle(h,{create:!0})).createWritable();await x.write(u),await x.close()},unlink:async c=>{const{dir:u,name:g}=await r(c);await u.removeEntry(g)},readdir:async c=>{const u=c.length===0||c==="/"||c==="."?e:await n(c),g=[];for await(const d of u.values())g.push(d.name);return g},mkdir:async c=>{const u=c.split("/").filter(d=>0<d.length);let g=e;for(const d of u)g=await g.getDirectoryHandle(d,{create:!0})},rmdir:async c=>{const{dir:u,name:g}=await r(c);await u.removeEntry(g,{recursive:!0})},stat:async c=>{if(c.length===0||c==="/"||c===".")return{isFile:()=>!1,isDirectory:()=>!0,isSymbolicLink:()=>!1,size:0,mode:16877,mtimeMs:Date.now()};try{const u=await n(c);return{isFile:()=>!1,isDirectory:()=>!0,isSymbolicLink:()=>!1,size:0,mode:16877,mtimeMs:Date.now()}}catch{const{dir:u,name:g}=await r(c),h=await(await u.getFileHandle(g)).getFile();return{isFile:()=>!0,isDirectory:()=>!1,isSymbolicLink:()=>!1,size:h.size,mode:33188,mtimeMs:h.lastModified}}},lstat:async c=>s.stat(c)};return s}function ah(e,r){const n=qr();return n==="electron"?null:n==="webfs"&&r?ih(r):Ps(e)}const Cv=Object.freeze(Object.defineProperty({__proto__:null,CreateLightningFsAdapter:Ps,CreateWebFsAdapter:ih,DeleteLightningFs:jy,DetectFsBackend:qr,GetDirHandle:nh,GetFsForGit:ah,GetLightningFs:eh,IsBrowserWorkspaceEnvironment:My,IsElectronEnvironment:Oy,IsWebFsEnvironment:Py,RegisterDirHandle:rh},Symbol.toStringTag,{value:"Module"}));function xt(){return $e.getState()}let Ur=null,zn=!1,sn=null,ji=null;function By(){Ur=null,zn=!1,sn=null,ji=null}function Dt(){const r=xt().workspacePath||"";if(zn&&r===ji)return Ur;ji=r;const n=qr();if(n==="electron")return Ur=null,zn=!0,null;if(n==="webfs"){const s=nh(r);if(s)return Ur=ah(r,s),zn=!0,Ur}return Ur=Ps(r||"notemac-default"),zn=!0,Ur}function Gi(){return xt().gitSettings.corsProxy||Td}function Hi(e){const r=e||xt().gitCredentials;if(r!=null)return()=>({username:r.username||r.token||"",password:r.token||""})}function zt(){const e=xt().workspacePath||"";return sn!==null&&e===ji?sn:qr()==="webfs"?(sn="/","/"):(sn=e||"/",sn)}function Fy(e){const r=[],n=[],s=[],c=e.length;for(let u=0;u<c;u++){const[g,d,h,S]=e[u];if(d===0&&h===2&&S===0){s.push({path:g,status:"untracked",isStaged:!1});continue}if(d===0&&h===2&&S===2){r.push({path:g,status:"added",isStaged:!0});continue}if(d===0&&h===0&&S===2){r.push({path:g,status:"added",isStaged:!0});continue}if(d===1&&h===2&&S===2){r.push({path:g,status:"modified",isStaged:!0});continue}if(d===1&&h===2&&S===3){r.push({path:g,status:"modified",isStaged:!0}),n.push({path:g,status:"modified",isStaged:!1});continue}if(d===1&&h===2&&S===1){n.push({path:g,status:"modified",isStaged:!1});continue}if(d===1&&h===0&&S===0){r.push({path:g,status:"deleted",isStaged:!0});continue}if(d===1&&h===0&&S===1){n.push({path:g,status:"deleted",isStaged:!1});continue}}return{branch:xt().currentBranch,isRepoDirty:0<r.length+n.length+s.length,stagedFiles:r,unstagedFiles:n,untrackedFiles:s,aheadBy:0,behindBy:0,mergeInProgress:!1}}async function Dy(){const e=Dt();if(e===null)return!1;try{const r=zt();return await St.findRoot({fs:e,filepath:r}),!0}catch{return!1}}async function oh(e){const r=xt();if(e){const s=r.workspacePath||e.name;rh(s,e)}if(By(),Dt()!==null)try{const s=await Dy();r.SetRepoInitialized(s),s&&(await pr(),await Ms(),await qi())}catch{r.SetRepoInitialized(!1)}}async function Tv(){const e=xt(),r=Dt();if(r!==null)try{e.SetGitOperationInProgress(!0),e.SetGitOperationError(null),await St.init({fs:r,dir:zt(),defaultBranch:"main"}),e.SetRepoInitialized(!0),e.SetCurrentBranch("main"),await pr(),lr(Xt.GIT_STATUS_CHANGED)}catch(n){e.SetGitOperationError(n instanceof Error?n.message:String(n))}finally{e.SetGitOperationInProgress(!1)}}async function Rv(e,r,n,s){const c=xt();try{c.SetGitOperationInProgress(!0),c.SetCurrentGitOperation("clone"),c.SetGitOperationProgress(0),c.SetGitOperationError(null),await St.clone({fs:r,http:zi,dir:n,url:e,corsProxy:Gi(),singleBranch:!0,depth:1,onAuth:Hi(s),onProgress:u=>{u.total&&c.SetGitOperationProgress(Math.round(u.loaded/u.total*100))}}),c.SetRepoInitialized(!0),lr(Xt.GIT_OPERATION_COMPLETE,{operation:"clone"})}catch(u){throw c.SetGitOperationError(u instanceof Error?u.message:String(u)),u}finally{c.SetGitOperationInProgress(!1),c.SetCurrentGitOperation(null),c.SetGitOperationProgress(0)}}async function pr(){const e=xt(),r=Dt();if(!(r===null||!e.isRepoInitialized))try{const n=zt();try{const u=await St.currentBranch({fs:r,dir:n,fullname:!1})||"HEAD";e.SetCurrentBranch(u)}catch{}const s=await St.statusMatrix({fs:r,dir:n}),c=Fy(s);c.branch=e.currentBranch,e.SetGitStatus(c),lr(Xt.GIT_STATUS_CHANGED)}catch{e.SetGitStatus(null)}}async function Ov(e){const r=Dt();if(r!==null)try{await St.add({fs:r,dir:zt(),filepath:e}),await pr()}catch(n){xt().SetGitOperationError(n instanceof Error?n.message:String(n))}}async function Pv(){const r=xt().gitStatus;if(r===null)return;const n=Dt();if(n===null)return;const s=zt(),c=[...r.unstagedFiles.map(u=>u.path),...r.untrackedFiles.map(u=>u.path)];await Promise.allSettled(c.map(u=>St.add({fs:n,dir:s,filepath:u}))),await pr()}async function Mv(e){const r=Dt();if(r!==null)try{await St.resetIndex({fs:r,dir:zt(),filepath:e}),await pr()}catch(n){xt().SetGitOperationError(n instanceof Error?n.message:String(n))}}async function jv(e){const r=Dt();if(r!==null)try{await St.checkout({fs:r,dir:zt(),filepaths:[e],force:!0}),await pr()}catch(n){xt().SetGitOperationError(n instanceof Error?n.message:String(n))}}async function Bv(e){const r=xt(),n=Dt();if(n===null)throw new Error("No filesystem available");try{r.SetGitOperationInProgress(!0),r.SetCurrentGitOperation("commit"),r.SetGitOperationError(null);const s=r.gitAuthor,c=await St.commit({fs:n,dir:zt(),message:e,author:{name:s.name,email:s.email}});return await pr(),await qi(),lr(Xt.GIT_OPERATION_COMPLETE,{operation:"commit",oid:c}),c}catch(s){throw r.SetGitOperationError(s instanceof Error?s.message:String(s)),s}finally{r.SetGitOperationInProgress(!1),r.SetCurrentGitOperation(null)}}async function Fv(e="origin"){const r=xt(),n=Dt();if(n!==null)try{r.SetGitOperationInProgress(!0),r.SetCurrentGitOperation("push"),r.SetGitOperationError(null),await St.push({fs:n,http:zi,dir:zt(),remote:e,ref:r.currentBranch,corsProxy:Gi(),onAuth:Hi(),onProgress:s=>{s.total&&r.SetGitOperationProgress(Math.round(s.loaded/s.total*100))}}),await pr(),lr(Xt.GIT_OPERATION_COMPLETE,{operation:"push"})}catch(s){throw r.SetGitOperationError(s instanceof Error?s.message:String(s)),s}finally{r.SetGitOperationInProgress(!1),r.SetCurrentGitOperation(null),r.SetGitOperationProgress(0)}}async function Dv(e="origin"){const r=xt(),n=Dt();if(n!==null)try{r.SetGitOperationInProgress(!0),r.SetCurrentGitOperation("pull"),r.SetGitOperationError(null),await St.pull({fs:n,http:zi,dir:zt(),ref:r.currentBranch,singleBranch:!0,corsProxy:Gi(),onAuth:Hi(),author:{name:r.gitAuthor.name,email:r.gitAuthor.email}}),await pr(),await qi(),lr(Xt.GIT_OPERATION_COMPLETE,{operation:"pull"})}catch(s){throw r.SetGitOperationError(s instanceof Error?s.message:String(s)),s}finally{r.SetGitOperationInProgress(!1),r.SetCurrentGitOperation(null),r.SetGitOperationProgress(0)}}async function Lv(e="origin"){const r=xt(),n=Dt();if(n!==null)try{r.SetGitOperationInProgress(!0),r.SetCurrentGitOperation("fetch"),r.SetGitOperationError(null),await St.fetch({fs:n,http:zi,dir:zt(),remote:e,corsProxy:Gi(),onAuth:Hi()}),await Ms(),lr(Xt.GIT_OPERATION_COMPLETE,{operation:"fetch"})}catch(s){r.SetGitOperationError(s instanceof Error?s.message:String(s))}finally{r.SetGitOperationInProgress(!1),r.SetCurrentGitOperation(null)}}async function Ly(e){const r=xt(),n=Dt();if(n!==null)try{r.SetGitOperationError(null),await St.checkout({fs:n,dir:zt(),ref:e}),r.SetCurrentBranch(e),await pr(),await qi(),lr(Xt.GIT_BRANCH_CHANGED,{branch:e})}catch(s){r.SetGitOperationError(s instanceof Error?s.message:String(s))}}async function $v(e,r=!0){const n=xt(),s=Dt();if(s!==null)try{n.SetGitOperationError(null),await St.branch({fs:s,dir:zt(),ref:e}),r?await Ly(e):await Ms()}catch(c){n.SetGitOperationError(c instanceof Error?c.message:String(c))}}async function Ms(){const e=xt(),r=Dt();if(r!==null)try{const n=zt(),s=await St.listBranches({fs:r,dir:n}),c=e.currentBranch,u=s.map(g=>({name:g,isRemote:!1,isCurrentBranch:g===c,lastCommitOid:""}));try{const g=await St.listBranches({fs:r,dir:n,remote:"origin"});for(const d of g)u.push({name:`origin/${d}`,isRemote:!0,isCurrentBranch:!1,lastCommitOid:""})}catch{}e.SetBranches(u);try{const d=(await St.listRemotes({fs:r,dir:n})).map(h=>({name:h.remote,url:h.url}));e.SetRemotes(d)}catch{e.SetRemotes([])}}catch{}}async function qi(e=Ng){const r=xt(),n=Dt();if(n!==null)try{const s=zt(),u=(await St.log({fs:n,dir:s,depth:e})).map(g=>({oid:g.oid,message:g.commit.message,author:{name:g.commit.author.name,email:g.commit.author.email},timestamp:g.commit.author.timestamp}));r.SetCommitLog(u)}catch{r.SetCommitLog([])}}async function $y(e){const r=Dt();if(r===null)return null;try{const n=zt(),s=await St.resolveRef({fs:r,dir:n,ref:"HEAD"}),{blob:c}=await St.readBlob({fs:r,dir:n,oid:s,filepath:e});return new TextDecoder().decode(c)}catch{return null}}async function Nv(){var c;const e=xt(),r=e.gitStatus;if(r===null||r.stagedFiles.length===0)return"";const n=[],s=r.stagedFiles.length;for(let u=0;u<s;u++){const g=r.stagedFiles[u];if(n.push(`${g.status}: ${g.path}`),g.status==="modified"){const d=await $y(g.path);if(d!==null){const h=d.split(`
`),_=(((c=e.tabs.find(x=>{var R;return(R=x.path)==null?void 0:R.endsWith(g.path)}))==null?void 0:c.content)||"").split(`
`).length-h.length;_!==0&&n.push(`  (${0<_?"+":""}${_} lines)`)}}}return n.join(`
`)}function td(e){e.preventDefault(),e.stopPropagation()}async function rd(e){var r;if(e.preventDefault(),e.stopPropagation(),(r=e.dataTransfer)!=null&&r.files){const n=Array.from(e.dataTransfer.files),s=$e.getState();for(const c of n){const u=await c.text();s.addTab({name:c.name,content:u,language:hr(c.name),lineEnding:Er(u)})}}}function Ny(){var e,r;window.electronAPI&&(window.electronAPI.onFileOpened(n=>{const s=$e.getState(),c=s.tabs.find(u=>u.path===n.path);c?s.setActiveTab(c.id):(s.addTab({name:n.name,path:n.path,content:n.content,language:hr(n.name),lineEnding:Er(n.content)}),s.addRecentFile(n.path,n.name))}),window.electronAPI.onFolderOpened(n=>{const s=$e.getState();s.setFileTree(n.tree),s.setWorkspacePath(n.path),s.setSidebarPanel("explorer"),oh()}),window.electronAPI.onMenuAction((n,s)=>{const c=$e.getState();Fd(n,c.activeTabId,c.tabs,c.zoomLevel,s)}),(r=(e=window.electronAPI).onFileSaved)==null||r.call(e,n=>{const s=$e.getState();s.activeTabId!==null&&s.updateTab(s.activeTabId,{name:n.name,path:n.path,isModified:!1,language:hr(n.name)})}))}const Uy=[{group:"Unicode",items:[{value:"utf-8",label:"UTF-8"},{value:"utf-8-bom",label:"UTF-8 BOM"},{value:"utf-16le",label:"UTF-16 LE"},{value:"utf-16be",label:"UTF-16 BE"}]},{group:"Western European",items:[{value:"windows-1252",label:"Windows-1252 (ANSI)"},{value:"iso-8859-1",label:"ISO 8859-1 (Latin I)"},{value:"iso-8859-15",label:"ISO 8859-15 (Latin 9)"},{value:"cp850",label:"OEM 850 (DOS Latin)"}]},{group:"Central European",items:[{value:"windows-1250",label:"Windows-1250"},{value:"iso-8859-2",label:"ISO 8859-2 (Latin II)"}]},{group:"Cyrillic",items:[{value:"windows-1251",label:"Windows-1251"},{value:"iso-8859-5",label:"ISO 8859-5"},{value:"koi8-r",label:"KOI8-R"},{value:"koi8-u",label:"KOI8-U"},{value:"cp866",label:"OEM 866 (DOS Cyrillic)"}]},{group:"Greek",items:[{value:"windows-1253",label:"Windows-1253"},{value:"iso-8859-7",label:"ISO 8859-7"}]},{group:"Turkish",items:[{value:"windows-1254",label:"Windows-1254"},{value:"iso-8859-9",label:"ISO 8859-9"}]},{group:"Hebrew",items:[{value:"windows-1255",label:"Windows-1255"},{value:"iso-8859-8",label:"ISO 8859-8"}]},{group:"Arabic",items:[{value:"windows-1256",label:"Windows-1256"},{value:"iso-8859-6",label:"ISO 8859-6"}]},{group:"Baltic",items:[{value:"windows-1257",label:"Windows-1257"},{value:"iso-8859-13",label:"ISO 8859-13"}]},{group:"Vietnamese",items:[{value:"windows-1258",label:"Windows-1258"}]},{group:"East Asian",items:[{value:"big5",label:"Big5 (Traditional Chinese)"},{value:"gb2312",label:"GB2312 (Simplified Chinese)"},{value:"shift_jis",label:"Shift JIS (Japanese)"},{value:"euc-kr",label:"EUC-KR (Korean)"},{value:"iso-2022-jp",label:"ISO-2022-JP"}]},{group:"Thai",items:[{value:"tis-620",label:"TIS-620 (Thai)"}]},{group:"DOS",items:[{value:"cp437",label:"OEM 437 (US)"},{value:"cp737",label:"OEM 737 (Greek)"},{value:"cp775",label:"OEM 775 (Baltic)"},{value:"cp852",label:"OEM 852 (Latin II)"},{value:"cp855",label:"OEM 855 (Cyrillic)"},{value:"cp857",label:"OEM 857 (Turkish)"},{value:"cp858",label:"OEM 858 (Latin I + Euro)"},{value:"cp860",label:"OEM 860 (Portuguese)"},{value:"cp861",label:"OEM 861 (Icelandic)"},{value:"cp862",label:"OEM 862 (Hebrew)"},{value:"cp863",label:"OEM 863 (French Canadian)"},{value:"cp865",label:"OEM 865 (Nordic)"},{value:"cp869",label:"OEM 869 (Greek)"}]}];function nd(){return Uy}const zy=[{value:"plaintext",label:"Normal Text"},{value:"actionscript",label:"ActionScript"},{value:"ada",label:"Ada"},{value:"asp",label:"ASP"},{value:"asm",label:"Assembly"},{value:"autoit",label:"AutoIt"},{value:"bat",label:"Batch"},{value:"c",label:"C"},{value:"cpp",label:"C++"},{value:"csharp",label:"C#"},{value:"caml",label:"OCaml"},{value:"cmake",label:"CMake"},{value:"cobol",label:"COBOL"},{value:"coffeescript",label:"CoffeeScript"},{value:"css",label:"CSS"},{value:"d",label:"D"},{value:"dart",label:"Dart"},{value:"diff",label:"Diff"},{value:"dockerfile",label:"Dockerfile"},{value:"elixir",label:"Elixir"},{value:"erlang",label:"Erlang"},{value:"fortran",label:"Fortran"},{value:"fsharp",label:"F#"},{value:"gdscript",label:"GDScript"},{value:"go",label:"Go"},{value:"graphql",label:"GraphQL"},{value:"haskell",label:"Haskell"},{value:"html",label:"HTML"},{value:"ini",label:"INI"},{value:"java",label:"Java"},{value:"javascript",label:"JavaScript"},{value:"json",label:"JSON"},{value:"json5",label:"JSON5"},{value:"julia",label:"Julia"},{value:"kotlin",label:"Kotlin"},{value:"latex",label:"LaTeX"},{value:"less",label:"LESS"},{value:"lisp",label:"Lisp"},{value:"lua",label:"Lua"},{value:"makefile",label:"Makefile"},{value:"markdown",label:"Markdown"},{value:"matlab",label:"MATLAB"},{value:"nim",label:"Nim"},{value:"nsis",label:"NSIS"},{value:"objective-c",label:"Objective-C"},{value:"pascal",label:"Pascal"},{value:"perl",label:"Perl"},{value:"php",label:"PHP"},{value:"powershell",label:"PowerShell"},{value:"properties",label:"Properties"},{value:"python",label:"Python"},{value:"r",label:"R"},{value:"raku",label:"Raku"},{value:"restructuredtext",label:"reStructuredText"},{value:"ruby",label:"Ruby"},{value:"rust",label:"Rust"},{value:"sas",label:"SAS"},{value:"scala",label:"Scala"},{value:"scheme",label:"Scheme"},{value:"scss",label:"SCSS"},{value:"shell",label:"Shell/Bash"},{value:"smalltalk",label:"Smalltalk"},{value:"sql",label:"SQL"},{value:"swift",label:"Swift"},{value:"tcl",label:"Tcl"},{value:"toml",label:"TOML"},{value:"typescript",label:"TypeScript"},{value:"vb",label:"Visual Basic"},{value:"verilog",label:"Verilog"},{value:"vhdl",label:"VHDL"},{value:"xml",label:"XML"},{value:"yaml",label:"YAML"}];function Gy(){return zy}function Hy({theme:e,onAction:r,isElectron:n}){const[s,c]=ye.useState(null),[u,g]=ye.useState(null),[d,h]=ye.useState(null),S=ye.useRef(null),{settings:_,isRecordingMacro:x}=$e(),R=navigator.platform.includes("Mac"),y=R?"":"Ctrl+",j=R?"":"Shift+",X=R?"":"Alt+";ye.useEffect(()=>{const W=te=>{S.current&&!S.current.contains(te.target)&&(c(null),h(null))};return document.addEventListener("mousedown",W),()=>document.removeEventListener("mousedown",W)},[]);const L=[];nd().forEach(W=>{L.push({type:"separator",label:`--- ${W.group} ---`}),W.items.forEach(te=>{L.push({label:te.label,action:"encoding",value:te.value})})});const F=Gy().map(W=>({label:W.label,action:"language",value:W.value})),U={File:[{label:"New",shortcut:`${y}N`,action:"new"},{type:"separator",label:""},{label:"Open...",shortcut:`${y}O`,action:"open"},{label:"Open Folder as Workspace",action:"open-folder"},{label:"Reload from Disk",action:"reload-from-disk"},{type:"separator",label:""},{label:"Save",shortcut:`${y}S`,action:"save"},{label:"Save As...",shortcut:`${j}${y}S`,action:"save-as"},{label:"Save Copy As...",action:"save-copy-as"},{label:"Save All",action:"save-all"},{type:"separator",label:""},{label:"Rename...",action:"rename-file"},{label:"Delete from Disk",action:"delete-file"},{type:"separator",label:""},{label:"Restore Last Closed Tab",shortcut:`${j}${y}T`,action:"restore-last-closed"},{type:"separator",label:""},{label:"Close Tab",shortcut:`${y}W`,action:"close-tab"},{label:"Close All",action:"close-all"},{label:"Close Others",action:"close-others"},{label:"Close Tabs to Left",action:"close-tabs-to-left"},{label:"Close Tabs to Right",action:"close-tabs-to-right"},{label:"Close Unchanged",action:"close-unchanged"},{label:"Close All but Pinned",action:"close-all-but-pinned"},{type:"separator",label:""},{label:"Pin Tab",action:"pin-tab"},{type:"separator",label:""},{label:"Load Session...",action:"load-session"},{label:"Save Session...",action:"save-session"},{type:"separator",label:""},{label:"Print...",shortcut:`${y}P`,action:"print"}],Edit:[{label:"Undo",shortcut:`${y}Z`,action:"undo"},{label:"Redo",shortcut:`${j}${y}Z`,action:"redo"},{type:"separator",label:""},{label:"Cut",shortcut:`${y}X`,action:"cut"},{label:"Copy",shortcut:`${y}C`,action:"copy"},{label:"Paste",shortcut:`${y}V`,action:"paste"},{label:"Select All",shortcut:`${y}A`,action:"select-all"},{type:"separator",label:""},{label:"Duplicate Line",shortcut:`${y}D`,action:"duplicate-line"},{label:"Delete Line",shortcut:`${j}${y}K`,action:"delete-line"},{label:"Transpose Line",shortcut:`${X}T`,action:"transpose-line"},{label:"Move Line Up",shortcut:`${X}`,action:"move-line-up"},{label:"Move Line Down",shortcut:`${X}`,action:"move-line-down"},{label:"Split Lines",action:"split-lines"},{label:"Join Lines",action:"join-lines"},{type:"separator",label:""},{label:"Toggle Comment",shortcut:`${y}/`,action:"toggle-comment"},{label:"Block Comment",shortcut:`${j}${X}A`,action:"block-comment"},{type:"separator",label:""},{label:"UPPERCASE",shortcut:`${j}${y}U`,action:"uppercase"},{label:"lowercase",shortcut:`${y}U`,action:"lowercase"},{label:"Proper Case",action:"proper-case"},{label:"Sentence Case",action:"sentence-case"},{label:"Invert Case",action:"invert-case"},{label:"Random Case",action:"random-case"},{type:"separator",label:""},{label:"Insert Date/Time",action:"insert-datetime"},{type:"separator",label:""},{label:"Column Editor...",shortcut:`${X}C`,action:"column-editor"},{label:"Clipboard History",shortcut:`${y}${j}V`,action:"clipboard-history"},{label:"Character Panel",action:"char-panel"},{type:"separator",label:""},{label:"Copy File Path",action:"copy-file-path"},{label:"Copy File Name",action:"copy-file-name"},{label:"Copy File Dir",action:"copy-file-dir"},{type:"separator",label:""},{label:"Compare Files...",action:"compare-files"},{label:"Snippet Manager...",action:"snippet-manager"},{type:"separator",label:""},{label:"Set Read-Only",action:"toggle-readonly"}],Search:[{label:"Find...",shortcut:`${y}F`,action:"find"},{label:"Replace...",shortcut:`${y}H`,action:"replace"},{label:"Find in Files...",shortcut:`${j}${y}F`,action:"find-in-files"},{label:"Incremental Search",shortcut:`${y}${X}I`,action:"incremental-search"},{type:"separator",label:""},{label:"Mark...",action:"mark"},{label:"Mark Style 1",action:"mark-style",value:1},{label:"Mark Style 2",action:"mark-style",value:2},{label:"Mark Style 3",action:"mark-style",value:3},{label:"Mark Style 4",action:"mark-style",value:4},{label:"Mark Style 5",action:"mark-style",value:5},{label:"Clear All Marks",action:"clear-marks"},{type:"separator",label:""},{label:"Cut Marked Lines",action:"cut-marked-lines"},{label:"Copy Marked Lines",action:"copy-marked-lines"},{label:"Paste to (Replace) Marked Lines",action:"paste-marked-lines"},{label:"Delete Marked Lines",action:"delete-marked-lines"},{label:"Delete Unmarked Lines",action:"delete-unmarked-lines"},{label:"Inverse Marks",action:"inverse-marks"},{type:"separator",label:""},{label:"Go to Line...",shortcut:`${y}G`,action:"goto-line"},{label:"Go to Matching Bracket",shortcut:`${j}${y}\\`,action:"goto-bracket"},{label:"Select to Matching Bracket",action:"select-to-bracket"},{type:"separator",label:""},{label:"Toggle Bookmark",shortcut:`${y}F2`,action:"toggle-bookmark"},{label:"Next Bookmark",shortcut:"F2",action:"next-bookmark"},{label:"Previous Bookmark",shortcut:`${j}F2`,action:"prev-bookmark"},{label:"Clear All Bookmarks",action:"clear-bookmarks"},{type:"separator",label:""},{label:"Find Characters in Range...",action:"find-char-in-range"}],View:[{label:"Word Wrap",type:"checkbox",checked:_.wordWrap,action:"word-wrap"},{type:"separator",label:""},{label:"Show Whitespace",type:"checkbox",checked:_.showWhitespace,action:"show-whitespace"},{label:"Show EOL",type:"checkbox",checked:_.showEOL,action:"show-eol"},{label:"Show Non-Printable Characters",type:"checkbox",checked:_.showNonPrintable,action:"show-non-printable"},{label:"Show Wrap Symbol",type:"checkbox",checked:_.showWrapSymbol,action:"show-wrap-symbol"},{label:"Show Indent Guides",type:"checkbox",checked:_.showIndentGuides,action:"indent-guide"},{label:"Show Line Numbers",type:"checkbox",checked:_.showLineNumbers,action:"show-line-numbers"},{label:"Show Minimap",type:"checkbox",checked:_.showMinimap,action:"toggle-minimap"},{type:"separator",label:""},{label:"Fold All",action:"fold-all"},{label:"Unfold All",action:"unfold-all"},{label:"Fold Level 1",action:"fold-level",value:1},{label:"Fold Level 2",action:"fold-level",value:2},{label:"Fold Level 3",action:"fold-level",value:3},{label:"Fold Level 4",action:"fold-level",value:4},{label:"Fold Level 5",action:"fold-level",value:5},{label:"Fold Level 6",action:"fold-level",value:6},{label:"Fold Level 7",action:"fold-level",value:7},{label:"Fold Level 8",action:"fold-level",value:8},{type:"separator",label:""},{label:"Zoom In",shortcut:`${y}+`,action:"zoom-in"},{label:"Zoom Out",shortcut:`${y}-`,action:"zoom-out"},{label:"Reset Zoom",shortcut:`${y}0`,action:"zoom-reset"},{type:"separator",label:""},{label:"Toggle Sidebar",shortcut:`${y}B`,action:"toggle-sidebar"},{label:"Document List",action:"show-doc-list"},{label:"Function List",action:"show-function-list"},{label:"Project Panel",action:"show-project-panel"},{type:"separator",label:""},{label:"Distraction-Free Mode",type:"checkbox",checked:_.distractionFreeMode,action:"distraction-free"},{label:"Always on Top",type:"checkbox",checked:_.alwaysOnTop,action:"always-on-top"},{type:"separator",label:""},{label:"Synchronize Vertical Scrolling",type:"checkbox",checked:_.syncScrollVertical,action:"sync-scroll-v"},{label:"Synchronize Horizontal Scrolling",type:"checkbox",checked:_.syncScrollHorizontal,action:"sync-scroll-h"},{type:"separator",label:""},{label:"Split Right",action:"split-right"},{label:"Split Down",action:"split-down"},{label:"Close Split",action:"close-split"},{type:"separator",label:""},{label:"Summary...",action:"show-summary"},{label:"Monitoring (tail -f)",action:"toggle-monitoring"},{type:"separator",label:""},{label:"Command Palette...",shortcut:`${j}${y}P`,action:"command-palette"},{label:"Quick Open...",shortcut:`${y}P`,action:"quick-open"},{label:"Toggle Terminal",shortcut:"Ctrl+`",action:"toggle-terminal"}],Encoding:[...nd().flatMap(W=>[{type:"separator",label:` ${W.group} `},...W.items.map(te=>({label:te.label,action:"encoding",value:te.value}))]),{type:"separator",label:""},{label:"Line Ending: LF (Unix/Mac)",action:"line-ending",value:"LF"},{label:"Line Ending: CRLF (Windows)",action:"line-ending",value:"CRLF"},{label:"Line Ending: CR (Old Mac)",action:"line-ending",value:"CR"}],Language:F,"Line Ops":[{label:"Sort Lines Ascending",action:"sort-asc"},{label:"Sort Lines Descending",action:"sort-desc"},{label:"Sort Lines Case Insensitive (Asc)",action:"sort-asc-ci"},{label:"Sort Lines Case Insensitive (Desc)",action:"sort-desc-ci"},{label:"Sort Lines by Length (Asc)",action:"sort-len-asc"},{label:"Sort Lines by Length (Desc)",action:"sort-len-desc"},{type:"separator",label:""},{label:"Remove Duplicate Lines",action:"remove-duplicates"},{label:"Remove Consecutive Duplicate Lines",action:"remove-consecutive-duplicates"},{label:"Remove Empty Lines",action:"remove-empty-lines"},{label:"Remove Empty Lines (Containing Blank)",action:"remove-blank-lines"},{type:"separator",label:""},{label:"Trim Trailing Spaces",action:"trim-trailing"},{label:"Trim Leading Spaces",action:"trim-leading"},{label:"Trim Leading and Trailing Spaces",action:"trim-both"},{label:"EOL to Space",action:"eol-to-space"},{type:"separator",label:""},{label:"TAB to Space",action:"tab-to-space"},{label:"Space to TAB (Leading)",action:"space-to-tab-leading"},{label:"Space to TAB (All)",action:"space-to-tab-all"},{type:"separator",label:""},{label:"Insert Blank Line Above",action:"insert-blank-above"},{label:"Insert Blank Line Below",action:"insert-blank-below"},{label:"Reverse Line Order",action:"reverse-lines"}],Macro:[{label:x?"Stop Recording":"Start Recording",shortcut:`${j}${y}R`,action:x?"macro-stop":"macro-start"},{label:"Playback",shortcut:`${j}${y}P`,action:"macro-playback"},{type:"separator",label:""},{label:"Run Macro Multiple Times...",action:"macro-run-multiple"},{label:"Save Recorded Macro...",action:"macro-save"}],Git:[{label:"Source Control Panel",action:"show-git-panel"},{type:"separator",label:""},{label:"Clone Repository...",action:"clone-repository"},{type:"separator",label:""},{label:"Compare with HEAD",action:"compare-files"},{type:"separator",label:""},{label:"Git Settings...",action:"git-settings"}],Run:[{label:"Run Command...",action:"run-command"},{type:"separator",label:""},{label:"Search on Google",action:"search-google"},{label:"Search on Wikipedia",action:"search-wikipedia"},{label:"Open in Browser",action:"open-in-browser"}],Tools:[{label:"MD5 - Generate",action:"hash-md5"},{label:"MD5 - Copy to Clipboard",action:"hash-md5-clipboard"},{label:"SHA-1 - Generate",action:"hash-sha1"},{label:"SHA-1 - Copy to Clipboard",action:"hash-sha1-clipboard"},{label:"SHA-256 - Generate",action:"hash-sha256"},{label:"SHA-256 - Copy to Clipboard",action:"hash-sha256-clipboard"},{label:"SHA-512 - Generate",action:"hash-sha512"},{label:"SHA-512 - Copy to Clipboard",action:"hash-sha512-clipboard"},{type:"separator",label:""},{label:"MD5 - Generate from File",action:"hash-md5-file"},{label:"SHA-256 - Generate from File",action:"hash-sha256-file"},{type:"separator",label:""},{label:"Base64 Encode",action:"base64-encode"},{label:"Base64 Decode",action:"base64-decode"},{type:"separator",label:""},{label:"URL Encode",action:"url-encode"},{label:"URL Decode",action:"url-decode"},{type:"separator",label:""},{label:"JSON Format",action:"json-format"},{label:"JSON Minify",action:"json-minify"}],AI:[{label:"AI Chat Panel",shortcut:"Ctrl+Shift+A",action:"ai-chat"},{type:"separator",label:""},{label:"Explain Code",shortcut:"Ctrl+Shift+E",action:"ai-explain"},{label:"Refactor Code",shortcut:"Ctrl+Shift+R",action:"ai-refactor"},{label:"Generate Tests",action:"ai-generate-tests"},{label:"Generate Documentation",action:"ai-generate-docs"},{label:"Fix Error",action:"ai-fix-error"},{label:"Simplify Code",action:"ai-simplify"},{type:"separator",label:""},{label:"Toggle Inline Completions",action:"ai-toggle-inline"},{type:"separator",label:""},{label:"AI Settings...",action:"ai-settings"}],Settings:[{label:"Preferences...",shortcut:`${y},`,action:"preferences"},{label:"Shortcut Mapper...",action:"shortcut-mapper"},{type:"separator",label:""},{label:"About Notemac++",action:"about"}]},G=W=>{W.type!=="separator"&&(W.label.startsWith("")||(W.type==="checkbox"?r(W.action,!W.checked):W.action&&r(W.action,W.value),c(null),h(null)))};return E.jsxs("div",{ref:S,style:{display:"flex",alignItems:"center",height:30,backgroundColor:e.menuBg,borderBottom:`1px solid ${e.border}`,paddingLeft:8,flexShrink:0},children:[E.jsx("span",{style:{fontWeight:600,fontSize:13,marginRight:16,color:e.accent},children:"N++"}),Object.entries(U).map(([W,te])=>E.jsxs("div",{style:{position:"relative"},children:[E.jsx("div",{style:{padding:"4px 10px",cursor:"pointer",borderRadius:4,fontSize:13,backgroundColor:s===W?e.bgHover:"transparent",color:s===W?e.text:e.menuText},onClick:()=>c(s===W?null:W),onMouseEnter:()=>s&&c(W),children:W}),s===W&&E.jsx("div",{style:{position:"absolute",top:"100%",left:0,minWidth:280,maxHeight:"calc(100vh - 80px)",overflowY:"auto",backgroundColor:e.menuBg,border:`1px solid ${e.border}`,borderRadius:6,padding:"4px 0",zIndex:Od,boxShadow:"0 4px 16px rgba(0,0,0,0.3)"},children:te.map((Z,z)=>{if(Z.type==="separator")return Z.label&&Z.label.startsWith("")?E.jsx("div",{style:{padding:"4px 16px",fontSize:11,fontWeight:700,color:e.textMuted,textTransform:"uppercase",letterSpacing:.5,cursor:"default"},children:Z.label.replace(/\u2500 /g,"").replace(/ \u2500/g,"")},z):E.jsx("div",{style:{height:1,backgroundColor:e.border,margin:"4px 0"}},z);const B=`${W}-${Z.label}-${z}`;return E.jsxs("div",{style:{padding:"5px 16px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:24,fontSize:13,backgroundColor:u===B?e.bgHover:"transparent",color:e.menuText},onClick:()=>G(Z),onMouseEnter:()=>g(B),onMouseLeave:()=>g(null),children:[E.jsxs("span",{style:{display:"flex",alignItems:"center",gap:8},children:[Z.type==="checkbox"&&E.jsx("span",{style:{width:16,textAlign:"center"},children:Z.checked?"":""}),Z.label]}),Z.shortcut&&E.jsx("span",{style:{opacity:.5,fontSize:11},children:Z.shortcut})]},z)})})]},W)),x&&E.jsxs("div",{className:"recording-indicator",style:{display:"flex",alignItems:"center",gap:6,marginLeft:"auto",marginRight:12,color:"#ff4444",fontSize:12,fontWeight:600},children:[E.jsx("span",{style:{width:8,height:8,borderRadius:"50%",backgroundColor:"#ff4444",display:"inline-block"}}),"REC"]})]})}const Bt={newFile:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M9 1H4a1 1 0 00-1 1v12a1 1 0 001 1h8a1 1 0 001-1V5L9 1z"}),E.jsx("path",{d:"M9 1v4h4"}),E.jsx("path",{d:"M8 8v4M6 10h4"})]}),open:e=>E.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:E.jsx("path",{d:"M2 13V4a1 1 0 011-1h3.5l1.5 1.5H13a1 1 0 011 1V13a1 1 0 01-1 1H3a1 1 0 01-1-1z"})}),save:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M13 14H3a1 1 0 01-1-1V3a1 1 0 011-1h7l3 3v8a1 1 0 01-1 1z"}),E.jsx("path",{d:"M11 14V9H5v5"}),E.jsx("path",{d:"M5 2v3h5"})]}),saveAll:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M12 14H4a1 1 0 01-1-1V4a1 1 0 011-1h5.5l2.5 2.5V13a1 1 0 01-1 1z"}),E.jsx("path",{d:"M10 14V10H6v4"}),E.jsx("path",{d:"M6 3v2h3.5"}),E.jsx("path",{d:"M14 5v7.5",opacity:"0.5"}),E.jsx("path",{d:"M5 2H14.5",opacity:"0.5"})]}),undo:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M3 7h6a3.5 3.5 0 010 7H7"}),E.jsx("path",{d:"M6 4L3 7l3 3"})]}),redo:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M13 7H7a3.5 3.5 0 000 7h2"}),E.jsx("path",{d:"M10 4l3 3-3 3"})]}),find:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"7",cy:"7",r:"4"}),E.jsx("path",{d:"M14 14l-3.5-3.5"})]}),replace:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"5.5",cy:"5.5",r:"3"}),E.jsx("path",{d:"M14 14l-2.8-2.8"}),E.jsx("path",{d:"M10 7l2-2 2 2"}),E.jsx("path",{d:"M12 5v5.5a1.5 1.5 0 01-3 0"})]}),zoomIn:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"7",cy:"7",r:"4"}),E.jsx("path",{d:"M14 14l-3.5-3.5"}),E.jsx("path",{d:"M7 5v4M5 7h4"})]}),zoomOut:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"7",cy:"7",r:"4"}),E.jsx("path",{d:"M14 14l-3.5-3.5"}),E.jsx("path",{d:"M5 7h4"})]}),record:e=>E.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:E.jsx("circle",{cx:"8",cy:"8",r:"5",fill:e})}),stop:e=>E.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:E.jsx("rect",{x:"4",y:"4",width:"8",height:"8",rx:"1",fill:e})}),play:e=>E.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:e,children:E.jsx("polygon",{points:"5,3 13,8 5,13"})}),sidebar:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("rect",{x:"2",y:"2",width:"12",height:"12",rx:"1"}),E.jsx("path",{d:"M6 2v12"})]}),wordWrap:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M3 4h10M3 8h8a2 2 0 010 4H8"}),E.jsx("path",{d:"M10 10l-2 2 2 2"})]}),whitespace:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M3 12h10"}),E.jsx("circle",{cx:"5",cy:"7",r:"0.8",fill:e}),E.jsx("circle",{cx:"8",cy:"7",r:"0.8",fill:e}),E.jsx("circle",{cx:"11",cy:"7",r:"0.8",fill:e})]}),settings:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"8",cy:"8",r:"2"}),E.jsx("path",{d:"M8 1.5v2M8 12.5v2M1.5 8h2M12.5 8h2M3.4 3.4l1.4 1.4M11.2 11.2l1.4 1.4M3.4 12.6l1.4-1.4M11.2 4.8l1.4-1.4"})]})};function Ut({icon:e,title:r,onClick:n,theme:s,active:c,danger:u}){const[g,d]=kt.useState(!1);return E.jsx("button",{title:r,"aria-label":r,onClick:n,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),style:{background:g?s.bgHover:c?s.bgActive:"transparent",border:"none",color:u?s.danger:c?s.accent:s.textSecondary,cursor:"pointer",padding:"4px 6px",borderRadius:4,fontSize:16,lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:28,height:28},children:e})}function Un({theme:e}){return E.jsx("div",{style:{width:1,height:20,backgroundColor:e.border,margin:"0 4px"}})}function qy({theme:e,onAction:r}){const{isRecordingMacro:n,settings:s}=$e(),c=e.textSecondary,u=e.danger||"#e53e3e";return E.jsxs("div",{style:{display:"flex",alignItems:"center",height:36,backgroundColor:e.bgSecondary,borderBottom:`1px solid ${e.border}`,padding:"0 8px",gap:2,flexShrink:0},children:[E.jsx(Ut,{icon:Bt.newFile(c),title:"New (Cmd+N)",onClick:()=>r("new"),theme:e}),E.jsx(Ut,{icon:Bt.open(c),title:"Open (Cmd+O)",onClick:()=>r("open"),theme:e}),E.jsx(Ut,{icon:Bt.save(c),title:"Save (Cmd+S)",onClick:()=>r("save"),theme:e}),E.jsx(Ut,{icon:Bt.saveAll(c),title:"Save All",onClick:()=>r("save-all"),theme:e}),E.jsx(Un,{theme:e}),E.jsx(Ut,{icon:Bt.undo(c),title:"Undo (Cmd+Z)",onClick:()=>r("undo"),theme:e}),E.jsx(Ut,{icon:Bt.redo(c),title:"Redo (Cmd+Shift+Z)",onClick:()=>r("redo"),theme:e}),E.jsx(Un,{theme:e}),E.jsx(Ut,{icon:Bt.find(c),title:"Find (Cmd+F)",onClick:()=>r("find"),theme:e}),E.jsx(Ut,{icon:Bt.replace(c),title:"Replace (Cmd+H)",onClick:()=>r("replace"),theme:e}),E.jsx(Un,{theme:e}),E.jsx(Ut,{icon:Bt.zoomIn(c),title:"Zoom In (Cmd++)",onClick:()=>r("zoom-in"),theme:e}),E.jsx(Ut,{icon:Bt.zoomOut(c),title:"Zoom Out (Cmd+-)",onClick:()=>r("zoom-out"),theme:e}),E.jsx(Un,{theme:e}),E.jsx(Ut,{icon:n?Bt.stop(u):Bt.record(c),title:n?"Stop Recording":"Start Recording",onClick:()=>r(n?"macro-stop":"macro-start"),theme:e,danger:n}),E.jsx(Ut,{icon:Bt.play(c),title:"Playback Macro",onClick:()=>r("macro-playback"),theme:e}),E.jsx(Un,{theme:e}),E.jsx(Ut,{icon:Bt.sidebar(c),title:"Toggle Sidebar (Cmd+B)",onClick:()=>r("toggle-sidebar"),theme:e}),E.jsx(Ut,{icon:Bt.wordWrap(c),title:"Word Wrap",onClick:()=>r("word-wrap",!s.wordWrap),theme:e}),E.jsx(Ut,{icon:Bt.whitespace(c),title:"Show Whitespace",onClick:()=>r("show-whitespace",!s.showWhitespace),theme:e}),E.jsx("div",{style:{flex:1}}),E.jsx(Ut,{icon:Bt.settings(c),title:"Settings (Cmd+,)",onClick:()=>r("preferences"),theme:e})]})}function Wy({theme:e}){const{tabs:r,activeTabId:n,setActiveTab:s,closeTab:c,addTab:u,closeOtherTabs:g,closeAllTabs:d,moveTab:h,setSplitView:S,closeTabsToLeft:_,closeTabsToRight:x,closeUnchangedTabs:R,closeAllButPinned:y,togglePinTab:j,setTabColor:X}=$e(),[L,F]=ye.useState(null),[U,G]=ye.useState(null),[W,te]=ye.useState(null),[Z,z]=ye.useState(!1),B=ne=>{F(ne)},J=(ne,me)=>{ne.preventDefault(),G(me)},N=ne=>{L!==null&&L!==ne&&h(L,ne),F(null),G(null)},ce=(ne,me)=>{ne.preventDefault(),te({x:ne.clientX,y:ne.clientY,tabId:me}),z(!1)},oe=(ne,me)=>{ne.button===1&&(ne.preventDefault(),c(me))};kt.useEffect(()=>{const ne=()=>{te(null),z(!1)};if(W)return document.addEventListener("click",ne),()=>document.removeEventListener("click",ne)},[W]);const de=W?r.find(ne=>ne.id===W.tabId):null;return E.jsxs(E.Fragment,{children:[E.jsxs("div",{style:{display:"flex",alignItems:"flex-end",backgroundColor:e.tabBg,borderBottom:`1px solid ${e.border}`,overflowX:"auto",overflowY:"hidden",scrollbarWidth:"thin",flexShrink:0,height:Ea},children:[r.map((ne,me)=>{const ae=ne.id===n,ie=tu[ne.tabColor];return E.jsxs("div",{draggable:!0,onDragStart:()=>B(me),onDragOver:se=>J(se,me),onDrop:()=>N(me),onDragEnd:()=>{F(null),G(null)},onClick:()=>s(ne.id),onMouseDown:se=>oe(se,ne.id),onContextMenu:se=>ce(se,ne.id),style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",cursor:"pointer",backgroundColor:ae?e.tabActiveBg:e.tabBg,color:ae?e.tabActiveText:e.textSecondary,borderRight:`1px solid ${e.tabBorder}`,borderTop:ne.tabColor!=="none"?`3px solid ${ie}`:ae?`2px solid ${e.accent}`:"2px solid transparent",borderBottom:ae?"none":`1px solid ${e.border}`,minWidth:Qg,maxWidth:em,height:Ea,position:"relative",opacity:L===me?.5:1,borderLeft:U===me?`2px solid ${e.accent}`:"none",fontSize:13,whiteSpace:"nowrap",flexShrink:0},children:[E.jsxs("span",{style:{overflow:"hidden",textOverflow:"ellipsis",flex:1,display:"flex",alignItems:"center",gap:4},children:[ne.isPinned&&E.jsx("span",{style:{fontSize:10,opacity:.7},title:"Pinned",children:""}),ne.isModified&&E.jsx("span",{style:{color:e.warning},children:""}),ne.isReadOnly&&E.jsx("span",{style:{fontSize:10,opacity:.7},title:"Read Only",children:""}),ne.name]}),!ne.isPinned&&E.jsx("button",{"aria-label":`Close tab: ${ne.name}`,onClick:se=>{se.stopPropagation(),c(ne.id)},style:{width:au,height:au,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,fontSize:14,opacity:.5,flexShrink:0,backgroundColor:"transparent",border:"none",cursor:"pointer",color:"inherit",padding:0},onMouseEnter:se=>{se.target.style.opacity="1",se.target.style.backgroundColor=e.bgHover},onMouseLeave:se=>{se.target.style.opacity="0.5",se.target.style.backgroundColor="transparent"},children:""})]},ne.id)}),E.jsx("button",{"aria-label":"New tab",onClick:()=>u(),style:{display:"flex",alignItems:"center",justifyContent:"center",width:tm,height:Ea,cursor:"pointer",color:e.textMuted,fontSize:18,flexShrink:0,backgroundColor:"transparent",border:"none",padding:0},onMouseEnter:ne=>{ne.target.style.color=e.text},onMouseLeave:ne=>{ne.target.style.color=e.textMuted},children:"+"})]}),W&&E.jsxs("div",{className:"context-menu",style:{left:W.x,top:W.y,backgroundColor:e.menuBg,border:`1px solid ${e.border}`,position:"fixed",zIndex:2e4,borderRadius:6,padding:"4px 0",minWidth:200,boxShadow:"0 4px 16px rgba(0,0,0,0.3)"},children:[[{label:"Close",action:()=>c(W.tabId)},{label:"Close Others",action:()=>g(W.tabId)},{label:"Close Tabs to the Left",action:()=>_(W.tabId)},{label:"Close Tabs to the Right",action:()=>x(W.tabId)},{label:"Close All",action:()=>d()},{label:"Close Unchanged",action:()=>R()},{label:"Close All but Pinned",action:()=>y()},{label:"separator"},{label:de!=null&&de.isPinned?"Unpin Tab":"Pin Tab",action:()=>j(W.tabId)},{label:"separator"},{label:"Tab Color",action:()=>z(!Z)},{label:"separator"},{label:"Clone to Split View",action:()=>S("vertical",W.tabId)}].map((ne,me)=>ne.label==="separator"?E.jsx("div",{style:{height:1,backgroundColor:e.border,margin:"4px 0"}},me):E.jsx("div",{style:{padding:"5px 16px",cursor:"pointer",fontSize:13,color:e.menuText},onClick:ae=>{ae.stopPropagation(),ne.action(),ne.label!=="Tab Color"&&te(null)},onMouseEnter:ae=>{ae.target.style.backgroundColor=e.bgHover},onMouseLeave:ae=>{ae.target.style.backgroundColor="transparent"},children:ne.label},me)),Z&&E.jsx("div",{style:{display:"flex",gap:4,padding:"4px 16px 8px"},children:["none","color1","color2","color3","color4","color5"].map(ne=>E.jsx("div",{onClick:me=>{me.stopPropagation(),X(W.tabId,ne),te(null)},style:{width:20,height:20,borderRadius:4,backgroundColor:ne==="none"?e.bgTertiary:tu[ne],border:(de==null?void 0:de.tabColor)===ne?"2px solid white":`1px solid ${e.border}`,cursor:"pointer"},title:ne==="none"?"No color":ne},ne))})]})]})}function id(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,s=Array(r);n<r;n++)s[n]=e[n];return s}function Vy(e){if(Array.isArray(e))return e}function Zy(e,r,n){return(r=t0(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function Ky(e,r){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,c,u,g,d=[],h=!0,S=!1;try{if(u=(n=n.call(e)).next,r!==0)for(;!(h=(s=u.call(n)).done)&&(d.push(s.value),d.length!==r);h=!0);}catch(_){S=!0,c=_}finally{try{if(!h&&n.return!=null&&(g=n.return(),Object(g)!==g))return}finally{if(S)throw c}}return d}}function Xy(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ad(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,s)}return n}function od(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?ad(Object(n),!0).forEach(function(s){Zy(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ad(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Yy(e,r){if(e==null)return{};var n,s,c=Jy(e,r);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(s=0;s<u.length;s++)n=u[s],r.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}function Jy(e,r){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(r.indexOf(s)!==-1)continue;n[s]=e[s]}return n}function Qy(e,r){return Vy(e)||Ky(e,r)||r0(e,r)||Xy()}function e0(e,r){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,r);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function t0(e){var r=e0(e,"string");return typeof r=="symbol"?r:r+""}function r0(e,r){if(e){if(typeof e=="string")return id(e,r);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?id(e,r):void 0}}function n0(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function sd(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);r&&(s=s.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,s)}return n}function cd(e){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?sd(Object(n),!0).forEach(function(s){n0(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sd(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function i0(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return function(s){return r.reduceRight(function(c,u){return u(c)},s)}}function Gn(e){return function r(){for(var n=this,s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];return c.length>=e.length?e.apply(this,c):function(){for(var g=arguments.length,d=new Array(g),h=0;h<g;h++)d[h]=arguments[h];return r.apply(n,[].concat(c,d))}}}function Bi(e){return{}.toString.call(e).includes("Object")}function a0(e){return!Object.keys(e).length}function Kn(e){return typeof e=="function"}function o0(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function s0(e,r){return Bi(r)||kr("changeType"),Object.keys(r).some(function(n){return!o0(e,n)})&&kr("changeField"),r}function c0(e){Kn(e)||kr("selectorType")}function l0(e){Kn(e)||Bi(e)||kr("handlerType"),Bi(e)&&Object.values(e).some(function(r){return!Kn(r)})&&kr("handlersType")}function u0(e){e||kr("initialIsRequired"),Bi(e)||kr("initialType"),a0(e)&&kr("initialContent")}function f0(e,r){throw new Error(e[r]||e.default)}var d0={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},kr=Gn(f0)(d0),Ei={changes:s0,selector:c0,handler:l0,initial:u0};function h0(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ei.initial(e),Ei.handler(r);var n={current:e},s=Gn(m0)(n,r),c=Gn(g0)(n),u=Gn(Ei.changes)(e),g=Gn(p0)(n);function d(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(_){return _};return Ei.selector(S),S(n.current)}function h(S){i0(s,c,u,g)(S)}return[d,h]}function p0(e,r){return Kn(r)?r(e.current):r}function g0(e,r){return e.current=cd(cd({},e.current),r),r}function m0(e,r,n){return Kn(r)?r(e.current):Object.keys(n).forEach(function(s){var c;return(c=r[s])===null||c===void 0?void 0:c.call(r,e.current[s])}),n}var w0={create:h0},y0={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function b0(e){return function r(){for(var n=this,s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];return c.length>=e.length?e.apply(this,c):function(){for(var g=arguments.length,d=new Array(g),h=0;h<g;h++)d[h]=arguments[h];return r.apply(n,[].concat(c,d))}}}function v0(e){return{}.toString.call(e).includes("Object")}function x0(e){return e||ld("configIsRequired"),v0(e)||ld("configType"),e.urls?{paths:{vs:e.urls.monacoBase}}:e}function _0(e,r){throw new Error(e[r]||e.default)}var S0={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},ld=b0(_0)(S0),k0={config:x0},E0=function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return function(c){return n.reduceRight(function(u,g){return g(u)},c)}};function sh(e,r){return Object.keys(r).forEach(function(n){r[n]instanceof Object&&e[n]&&Object.assign(r[n],sh(e[n],r[n]))}),od(od({},e),r)}var A0={type:"cancelation",msg:"operation is manually canceled"};function cs(e){var r=!1,n=new Promise(function(s,c){e.then(function(u){return r?c(A0):s(u)}),e.catch(c)});return n.cancel=function(){return r=!0},n}var I0=["monaco"],C0=w0.create({config:y0,isInitialized:!1,resolve:null,reject:null,monaco:null}),ch=Qy(C0,2),ti=ch[0],Wi=ch[1];function T0(e){var r=k0.config(e),n=r.monaco,s=Yy(r,I0);Wi(function(c){return{config:sh(c.config,s),monaco:n}})}function R0(){var e=ti(function(r){var n=r.monaco,s=r.isInitialized,c=r.resolve;return{monaco:n,isInitialized:s,resolve:c}});if(!e.isInitialized){if(Wi({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),cs(ls);if(window.monaco&&window.monaco.editor)return lh(window.monaco),e.resolve(window.monaco),cs(ls);E0(O0,M0)(j0)}return cs(ls)}function O0(e){return document.body.appendChild(e)}function P0(e){var r=document.createElement("script");return e&&(r.src=e),r}function M0(e){var r=ti(function(s){var c=s.config,u=s.reject;return{config:c,reject:u}}),n=P0("".concat(r.config.paths.vs,"/loader.js"));return n.onload=function(){return e()},n.onerror=r.reject,n}function j0(){var e=ti(function(n){var s=n.config,c=n.resolve,u=n.reject;return{config:s,resolve:c,reject:u}}),r=window.require;r.config(e.config),r(["vs/editor/editor.main"],function(n){var s=n.m||n;lh(s),e.resolve(s)},function(n){e.reject(n)})}function lh(e){ti().monaco||Wi({monaco:e})}function B0(){return ti(function(e){var r=e.monaco;return r})}var ls=new Promise(function(e,r){return Wi({resolve:e,reject:r})}),uh={config:T0,init:R0,__getMonacoInstance:B0},F0={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},us=F0,D0={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},L0=D0;function $0({children:e}){return kt.createElement("div",{style:L0.container},e)}var N0=$0,U0=N0;function z0({width:e,height:r,isEditorReady:n,loading:s,_ref:c,className:u,wrapperProps:g}){return kt.createElement("section",{style:{...us.wrapper,width:e,height:r},...g},!n&&kt.createElement(U0,null,s),kt.createElement("div",{ref:c,style:{...us.fullWidth,...!n&&us.hide},className:u}))}var G0=z0,fh=ye.memo(G0);function H0(e){ye.useEffect(e,[])}var dh=H0;function q0(e,r,n=!0){let s=ye.useRef(!0);ye.useEffect(s.current||!n?()=>{s.current=!1}:e,r)}var Kt=q0;function qn(){}function cn(e,r,n,s){return W0(e,s)||V0(e,r,n,s)}function W0(e,r){return e.editor.getModel(hh(e,r))}function V0(e,r,n,s){return e.editor.createModel(r,n,s?hh(e,s):void 0)}function hh(e,r){return e.Uri.parse(r)}function Z0({original:e,modified:r,language:n,originalLanguage:s,modifiedLanguage:c,originalModelPath:u,modifiedModelPath:g,keepCurrentOriginalModel:d=!1,keepCurrentModifiedModel:h=!1,theme:S="light",loading:_="Loading...",options:x={},height:R="100%",width:y="100%",className:j,wrapperProps:X={},beforeMount:L=qn,onMount:F=qn}){let[U,G]=ye.useState(!1),[W,te]=ye.useState(!0),Z=ye.useRef(null),z=ye.useRef(null),B=ye.useRef(null),J=ye.useRef(F),N=ye.useRef(L),ce=ye.useRef(!1);dh(()=>{let me=uh.init();return me.then(ae=>(z.current=ae)&&te(!1)).catch(ae=>(ae==null?void 0:ae.type)!=="cancelation"&&void 0),()=>Z.current?ne():me.cancel()}),Kt(()=>{if(Z.current&&z.current){let me=Z.current.getOriginalEditor(),ae=cn(z.current,e||"",s||n||"text",u||"");ae!==me.getModel()&&me.setModel(ae)}},[u],U),Kt(()=>{if(Z.current&&z.current){let me=Z.current.getModifiedEditor(),ae=cn(z.current,r||"",c||n||"text",g||"");ae!==me.getModel()&&me.setModel(ae)}},[g],U),Kt(()=>{let me=Z.current.getModifiedEditor();me.getOption(z.current.editor.EditorOption.readOnly)?me.setValue(r||""):r!==me.getValue()&&(me.executeEdits("",[{range:me.getModel().getFullModelRange(),text:r||"",forceMoveMarkers:!0}]),me.pushUndoStop())},[r],U),Kt(()=>{var me,ae;(ae=(me=Z.current)==null?void 0:me.getModel())==null||ae.original.setValue(e||"")},[e],U),Kt(()=>{let{original:me,modified:ae}=Z.current.getModel();z.current.editor.setModelLanguage(me,s||n||"text"),z.current.editor.setModelLanguage(ae,c||n||"text")},[n,s,c],U),Kt(()=>{var me;(me=z.current)==null||me.editor.setTheme(S)},[S],U),Kt(()=>{var me;(me=Z.current)==null||me.updateOptions(x)},[x],U);let oe=ye.useCallback(()=>{var ie;if(!z.current)return;N.current(z.current);let me=cn(z.current,e||"",s||n||"text",u||""),ae=cn(z.current,r||"",c||n||"text",g||"");(ie=Z.current)==null||ie.setModel({original:me,modified:ae})},[n,r,c,e,s,u,g]),de=ye.useCallback(()=>{var me;!ce.current&&B.current&&(Z.current=z.current.editor.createDiffEditor(B.current,{automaticLayout:!0,...x}),oe(),(me=z.current)==null||me.editor.setTheme(S),G(!0),ce.current=!0)},[x,S,oe]);ye.useEffect(()=>{U&&J.current(Z.current,z.current)},[U]),ye.useEffect(()=>{!W&&!U&&de()},[W,U,de]);function ne(){var ae,ie,se,he;let me=(ae=Z.current)==null?void 0:ae.getModel();d||((ie=me==null?void 0:me.original)==null||ie.dispose()),h||((se=me==null?void 0:me.modified)==null||se.dispose()),(he=Z.current)==null||he.dispose()}return kt.createElement(fh,{width:y,height:R,isEditorReady:U,loading:_,_ref:B,className:j,wrapperProps:X})}var K0=Z0,Uv=ye.memo(K0);function X0(e){let r=ye.useRef();return ye.useEffect(()=>{r.current=e},[e]),r.current}var Y0=X0,Ai=new Map;function J0({defaultValue:e,defaultLanguage:r,defaultPath:n,value:s,language:c,path:u,theme:g="light",line:d,loading:h="Loading...",options:S={},overrideServices:_={},saveViewState:x=!0,keepCurrentModel:R=!1,width:y="100%",height:j="100%",className:X,wrapperProps:L={},beforeMount:F=qn,onMount:U=qn,onChange:G,onValidate:W=qn}){let[te,Z]=ye.useState(!1),[z,B]=ye.useState(!0),J=ye.useRef(null),N=ye.useRef(null),ce=ye.useRef(null),oe=ye.useRef(U),de=ye.useRef(F),ne=ye.useRef(),me=ye.useRef(s),ae=Y0(u),ie=ye.useRef(!1),se=ye.useRef(!1);dh(()=>{let _e=uh.init();return _e.then(Me=>(J.current=Me)&&B(!1)).catch(Me=>(Me==null?void 0:Me.type)!=="cancelation"&&void 0),()=>N.current?ze():_e.cancel()}),Kt(()=>{var Me,q,ke,Ae;let _e=cn(J.current,e||s||"",r||c||"",u||n||"");_e!==((Me=N.current)==null?void 0:Me.getModel())&&(x&&Ai.set(ae,(q=N.current)==null?void 0:q.saveViewState()),(ke=N.current)==null||ke.setModel(_e),x&&((Ae=N.current)==null||Ae.restoreViewState(Ai.get(u))))},[u],te),Kt(()=>{var _e;(_e=N.current)==null||_e.updateOptions(S)},[S],te),Kt(()=>{!N.current||s===void 0||(N.current.getOption(J.current.editor.EditorOption.readOnly)?N.current.setValue(s):s!==N.current.getValue()&&(se.current=!0,N.current.executeEdits("",[{range:N.current.getModel().getFullModelRange(),text:s,forceMoveMarkers:!0}]),N.current.pushUndoStop(),se.current=!1))},[s],te),Kt(()=>{var Me,q;let _e=(Me=N.current)==null?void 0:Me.getModel();_e&&c&&((q=J.current)==null||q.editor.setModelLanguage(_e,c))},[c],te),Kt(()=>{var _e;d!==void 0&&((_e=N.current)==null||_e.revealLine(d))},[d],te),Kt(()=>{var _e;(_e=J.current)==null||_e.editor.setTheme(g)},[g],te);let he=ye.useCallback(()=>{var _e;if(!(!ce.current||!J.current)&&!ie.current){de.current(J.current);let Me=u||n,q=cn(J.current,s||e||"",r||c||"",Me||"");N.current=(_e=J.current)==null?void 0:_e.editor.create(ce.current,{model:q,automaticLayout:!0,...S},_),x&&N.current.restoreViewState(Ai.get(Me)),J.current.editor.setTheme(g),d!==void 0&&N.current.revealLine(d),Z(!0),ie.current=!0}},[e,r,n,s,c,u,S,_,x,g,d]);ye.useEffect(()=>{te&&oe.current(N.current,J.current)},[te]),ye.useEffect(()=>{!z&&!te&&he()},[z,te,he]),me.current=s,ye.useEffect(()=>{var _e,Me;te&&G&&((_e=ne.current)==null||_e.dispose(),ne.current=(Me=N.current)==null?void 0:Me.onDidChangeModelContent(q=>{se.current||G(N.current.getValue(),q)}))},[te,G]),ye.useEffect(()=>{if(te){let _e=J.current.editor.onDidChangeMarkers(Me=>{var ke;let q=(ke=N.current.getModel())==null?void 0:ke.uri;if(q&&Me.find(Ae=>Ae.path===q.path)){let Ae=J.current.editor.getModelMarkers({resource:q});W==null||W(Ae)}});return()=>{_e==null||_e.dispose()}}return()=>{}},[te,W]);function ze(){var _e,Me;(_e=ne.current)==null||_e.dispose(),R?x&&Ai.set(u,N.current.saveViewState()):(Me=N.current.getModel())==null||Me.dispose(),N.current.dispose()}return kt.createElement(fh,{width:y,height:j,isEditorReady:te,loading:h,_ref:ce,className:X,wrapperProps:L})}var Q0=J0,eb=ye.memo(Q0),tb=eb;function rb(e){const{savedSnippets:r}=$e.getState();return r.filter(n=>n.language==="*"||n.language===e)}function nb(e,r){if(!e)return;const n=e.getContribution("snippetController2");if(n)n.insert(r);else{const s=r.replace(/\$\{?\d+(?::([^}]*))?\}?/g,"$1").replace(/\$0/g,""),c=e.getSelection();c&&e.executeEdits("snippet",[{range:c,text:s,forceMoveMarkers:!0}])}}function ib(e){return e.languages.registerCompletionItemProvider("*",{provideCompletionItems:(r,n)=>{const s=r.getLanguageId(),c=rb(s);if(c.length===0)return{suggestions:[]};const u=r.getWordUntilPosition(n),g={startLineNumber:n.lineNumber,endLineNumber:n.lineNumber,startColumn:u.startColumn,endColumn:u.endColumn};return{suggestions:c.map(h=>({label:h.prefix,kind:e.languages.CompletionItemKind.Snippet,documentation:h.description||h.name,insertText:h.body,insertTextRules:e.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:`Snippet: ${h.name}`,range:g}))}}})}function ph(){return $e.getState()}let un=null;function gh(e,r,n){return{model:r,messages:e,temperature:n.temperature??.7,max_tokens:n.maxTokens??4096,stream:n.stream??!0}}function mh(e,r,n){const s=[],c=[];for(let u=0,g=e.length;u<g;u++)e[u].role==="system"?s.push(e[u].content):c.push(e[u]);return{model:r,system:0<s.length?s.join(`
`):void 0,messages:c.map(u=>({role:u.role,content:u.content})),max_tokens:n.maxTokens??4096,temperature:n.temperature??.7,stream:n.stream??!0}}function wh(e,r){const n=e.filter(c=>c.role!=="system").map(c=>({role:c.role==="assistant"?"model":"user",parts:[{text:c.content}]})),s=e.find(c=>c.role==="system");return{contents:n,systemInstruction:s?{parts:[{text:s.content}]}:void 0,generationConfig:{temperature:r.temperature??.7,maxOutputTokens:r.maxTokens??4096}}}function yh(e,r,n){if(e.type==="anthropic")return`${e.baseUrl}/v1/messages`;if(e.type==="google"){const s=n?"?alt=sse":"";return`${e.baseUrl}/v1beta/models/${r}:${n?"streamGenerateContent":"generateContent"}${s}`}return`${e.baseUrl}/v1/chat/completions`}function bh(e,r){const n={"Content-Type":"application/json"};return e.type==="anthropic"?(n["x-api-key"]=r.apiKey,n["anthropic-version"]=Xg,n["anthropic-dangerous-direct-browser-access"]="true"):e.type==="google"?n["x-goog-api-key"]=r.apiKey:n.Authorization=`Bearer ${r.apiKey}`,n}function ab(e){var n,s,c;if(!e.startsWith("data: "))return null;const r=e.slice(6).trim();if(r==="[DONE]")return null;try{return((c=(s=(n=JSON.parse(r).choices)==null?void 0:n[0])==null?void 0:s.delta)==null?void 0:c.content)||null}catch{return null}}function ob(e){var n;if(!e.startsWith("data: "))return null;const r=e.slice(6).trim();try{const s=JSON.parse(r);return s.type==="content_block_delta"&&((n=s.delta)==null?void 0:n.text)||null}catch{return null}}function sb(e){var n,s,c,u,g;if(!e.startsWith("data: "))return null;const r=e.slice(6).trim();try{return((g=(u=(c=(s=(n=JSON.parse(r).candidates)==null?void 0:n[0])==null?void 0:s.content)==null?void 0:c.parts)==null?void 0:u[0])==null?void 0:g.text)||null}catch{return null}}function ud(e,r){return e==="anthropic"?ob(r):e==="google"?sb(r):ab(r)}async function Vi(e,r={},n,s,c){var X,L,F,U,G,W,te,Z,z,B,J;const u=ph(),g=u.GetActiveProvider();if(g===null){const N="No active AI provider configured";throw c==null||c(N),new Error(N)}const d=u.GetCredentialForProvider(g.id);if(d===null){const N=`No API key configured for ${g.name}`;throw c==null||c(N),new Error(N)}const h=u.activeModelId,S=r.stream!==!1,_=[...e];r.systemPrompt&&!_.some(N=>N.role==="system")&&_.unshift({role:"system",content:r.systemPrompt});const x=u.aiSettings.systemPrompt;x&&!_.some(N=>N.role==="system")&&_.unshift({role:"system",content:x});let R;g.type==="anthropic"?R=mh(_,h,{...r,stream:S}):g.type==="google"?R=wh(_,{...r}):R=gh(_,h,{...r,stream:S});const y=yh(g,h,S),j=bh(g,d);ub(),un=new AbortController;try{const N=await fetch(y,{method:"POST",headers:j,body:JSON.stringify(R),signal:un.signal});if(!N.ok){const ce=await N.text();let oe=`API error ${N.status}`;try{const de=JSON.parse(ce);oe=((X=de.error)==null?void 0:X.message)||de.message||oe}catch{}throw c==null||c(oe),new Error(oe)}if(S&&N.body)return await cb(N.body,g.type,n,s);{const ce=await N.json();let oe="";return g.type==="anthropic"?oe=((F=(L=ce.content)==null?void 0:L[0])==null?void 0:F.text)||"":g.type==="google"?oe=((Z=(te=(W=(G=(U=ce.candidates)==null?void 0:U[0])==null?void 0:G.content)==null?void 0:W.parts)==null?void 0:te[0])==null?void 0:Z.text)||"":oe=((J=(B=(z=ce.choices)==null?void 0:z[0])==null?void 0:B.message)==null?void 0:J.content)||"",s==null||s(oe),oe}}catch(N){if(N instanceof Error&&N.name==="AbortError")return s==null||s(""),"";const ce=N instanceof Error?N.message:String(N);throw c==null||c(ce),N}finally{un=null}}async function cb(e,r,n,s){const c=e.getReader(),u=new TextDecoder;let g="",d="";try{for(;;){const{done:h,value:S}=await c.read();if(h)break;d+=u.decode(S,{stream:!0});const _=d.split(`
`);d=_.pop()||"";const x=_.length;for(let R=0;R<x;R++){const y=_[R].trim();if(y.length===0)continue;const j=ud(r,y);j!==null&&0<j.length&&(g+=j,n==null||n(j))}}if(0<d.trim().length){const h=ud(r,d.trim());h!==null&&0<h.length&&(g+=h,n==null||n(h))}}finally{c.releaseLock()}return s==null||s(g),g}async function lb(e,r,n,s,c){const g=ph().aiSettings,d=`You are an intelligent code completion assistant. Complete the code at the cursor position. Only output the completion text, no explanations, no markdown, no code fences. The code is in ${n}.`,h=`Complete the code at [CURSOR]:

${e}[CURSOR]${r}

Output ONLY the completion text that goes at [CURSOR]. No explanations.`;return Vi([{role:"system",content:d},{role:"user",content:h}],{temperature:g.codeTemperature,maxTokens:g.inlineMaxTokens,stream:!1},void 0,s,c)}function ub(){un!==null&&(un.abort(),un=null)}async function zv(e,r){var n;try{const s=0<e.models.length?e.models[0].id:"",c=yh(e,s,!1),u=bh(e,r);let g;const d=[{role:"user",content:'Say "ok".'}];e.type==="anthropic"?g=mh(d,s,{maxTokens:10,stream:!1}):e.type==="google"?g=wh(d,{maxTokens:10}):g=gh(d,s,{maxTokens:10,stream:!1});const h=await fetch(c,{method:"POST",headers:u,body:JSON.stringify(g)});if(h.ok)return{success:!0};const S=await h.text();let _=`HTTP ${h.status}`;try{const x=JSON.parse(S);_=((n=x.error)==null?void 0:n.message)||x.message||_}catch{}return{success:!1,error:_}}catch(s){return{success:!1,error:s instanceof Error?s.message:String(s)}}}function fb(e){if(e.length===0)return"";const r=[],n=e.length;for(let s=0;s<n;s++){const c=e[s];c.type==="file"?r.push(`--- File: ${c.label} (${c.language||"unknown"}) ---
${c.content}`):c.type==="selection"?r.push(`--- Selected code (${c.language||"unknown"}) ---
${c.content}`):c.type==="error"?r.push(`--- Error ---
${c.content}`):c.type==="diff"&&r.push(`--- Diff ---
${c.content}`)}return r.join(`

`)}function vh(e){const r=[],n=/```(\w*)\n([\s\S]*?)```/g;let s;for(;(s=n.exec(e))!==null;)r.push({language:s[1]||"text",code:s[2].trim()});return r}let Sr=null,fs=0;function db(e,r){const n=[];return n.push(e.languages.registerCompletionItemProvider("*",{provideCompletionItems:(s,c)=>{const{tabs:u}=$e.getState(),g=s.getValue(),d=s.getWordUntilPosition(c),h={startLineNumber:c.lineNumber,endLineNumber:c.lineNumber,startColumn:d.startColumn,endColumn:d.endColumn},S=new Set,_=/\b[a-zA-Z_$][a-zA-Z0-9_$]{2,}\b/g,x=u.length;for(let y=0;y<x;y++){const j=u[y].content;if(j===g)continue;let X;for(_.lastIndex=0;(X=_.exec(j))!==null;)S.add(X[0])}return d.word&&S.delete(d.word),{suggestions:Array.from(S).map(y=>({label:y,kind:e.languages.CompletionItemKind.Text,detail:"from other tabs",insertText:y,range:h,sortText:"~"+y}))}}})),n.push(ib(e)),n.push(e.languages.registerCompletionItemProvider("*",{triggerCharacters:["/"],provideCompletionItems:(s,c)=>{if(!s.getLineContent(c.lineNumber).substring(0,c.column-1).match(/['".]\/[^'"]*$/))return{suggestions:[]};const{tabs:d,fileTree:h}=$e.getState(),S=s.getWordUntilPosition(c),_={startLineNumber:c.lineNumber,endLineNumber:c.lineNumber,startColumn:S.startColumn,endColumn:S.endColumn},x=d.map(R=>({label:R.name,kind:e.languages.CompletionItemKind.File,detail:R.path||"open tab",insertText:R.name,range:_}));if(h){const R=(y,j)=>{for(const X of y)x.push({label:j+X.name,kind:X.isDirectory?e.languages.CompletionItemKind.Folder:e.languages.CompletionItemKind.File,detail:X.path,insertText:X.name,range:_}),X.children&&R(X.children,j+X.name+"/")};R(h,"")}return{suggestions:x}}})),n.push(hb(e)),n}function hb(e,r){return e.languages.registerInlineCompletionsProvider("*",{provideInlineCompletions:async(s,c,u,g)=>{const d=$e.getState();if(!d.aiEnabled||!d.inlineSuggestionEnabled)return{items:[]};if(!d.aiSettings.inlineCompletionEnabled)return{items:[]};const h=d.GetActiveProvider();if(h===null)return{items:[]};const S=d.GetCredentialForProvider(h.id);if(S===null||S.apiKey.length===0)return{items:[]};Sr!==null&&(clearTimeout(Sr),Sr=null);const _=++fs,x=d.aiSettings.inlineDebounceMs||Rd;if(!await new Promise(te=>{Sr=setTimeout(()=>{Sr=null,te(_===fs)},x),g.onCancellationRequested(()=>{Sr!==null&&(clearTimeout(Sr),Sr=null),te(!1)})}))return{items:[]};const y=s.getOffsetAt(c),j=s.getValue(),X=j.substring(0,y),L=j.substring(y),F=X.length>vi?X.substring(X.length-vi):X,U=L.length>vi?L.substring(0,vi):L;if(F.trimEnd().length<5)return{items:[]};const W=s.getLanguageId()||"plaintext";try{const te=await lb(F,U,W);if(_!==fs)return{items:[]};if(te.length===0)return{items:[]};let Z=te.trim();if(Z.startsWith("```")){const z=Z.split(`
`);z.shift(),0<z.length&&z[z.length-1].startsWith("```")&&z.pop(),Z=z.join(`
`)}return Z.length===0?{items:[]}:{items:[{insertText:Z,range:new e.Range(c.lineNumber,c.column,c.lineNumber,c.column)}]}}catch{return{items:[]}}},freeInlineCompletions:()=>{}})}function ri(){return $e.getState()}function pb(e){return{id:Ar(),role:"user",content:e,timestamp:Date.now(),codeBlocks:[]}}function fd(e=""){const r=vh(e);return{id:Ar(),role:"assistant",content:e,timestamp:Date.now(),codeBlocks:r.map(n=>({language:n.language,code:n.code,action:"replace"}))}}function gb(e){const r=ri();return{id:Ar(),title:e,messages:[],modelId:r.activeModelId,providerId:r.activeProviderId,createdAt:Date.now()}}async function mb(e){const r=ri();let n=r.activeConversationId;if(n===null){const _=e.length>50?e.substring(0,50)+"...":e,x=gb(_);r.AddConversation(x),n=x.id}const s=pb(e);r.AddMessageToConversation(n,s);const c=r.conversations.find(_=>_.id===n);if(!c)return;const u=fb(r.aiContextItems),g=[];0<u.length&&g.push({role:"system",content:`Here is relevant context:

${u}`});const d=c.messages.length;for(let _=0;_<d;_++)g.push({role:c.messages[_].role,content:c.messages[_].content});const h=fd();r.AddMessageToConversation(n,h),r.SetIsAiStreaming(!0),r.SetAiStreamContent(""),r.SetAiOperationError(null);let S="";try{await Vi(g,{temperature:r.aiSettings.chatTemperature},_=>{S+=_,r.SetAiStreamContent(S),r.UpdateLastMessage(n,S),lr(Xt.AI_STREAM_CHUNK,{text:_})},_=>{const x=fd(_);r.UpdateLastMessage(n,_),lr(Xt.AI_RESPONSE_COMPLETE,{conversationId:n,text:_})},_=>{r.SetAiOperationError(_),lr(Xt.AI_ERROR,{error:_})})}catch(_){r.SetAiOperationError(_ instanceof Error?_.message:String(_))}finally{r.SetIsAiStreaming(!1),r.SetAiStreamContent(""),r.SaveAIState()}}async function ni(e,r,n){const s=ri();s.SetIsAiStreaming(!0),s.SetAiOperationError(null);try{const c=await Vi([{role:"system",content:e},{role:"user",content:r}],{temperature:s.aiSettings.codeTemperature,stream:!1}),u=vh(c);n(0<u.length?u[0].code:c)}catch(c){s.SetAiOperationError(c instanceof Error?c.message:String(c))}finally{s.SetIsAiStreaming(!1)}}async function dd(e,r){ri().setSidebarPanel("ai");const s=`Explain the following ${r} code in detail. What does it do, and why?

\`\`\`${r}
${e}
\`\`\``;await mb(s)}async function hd(e,r,n){await ni("You are a code refactoring assistant. Refactor the given code to improve readability, performance, and maintainability. Return ONLY the refactored code in a single code block. No explanations before or after.",`Refactor this ${r} code:

\`\`\`${r}
${e}
\`\`\``,n)}async function pd(e,r,n){await ni("You are a test generation assistant. Generate comprehensive unit tests for the given code. Return ONLY the test code in a single code block. Use appropriate testing framework for the language. No explanations.",`Generate unit tests for this ${r} code:

\`\`\`${r}
${e}
\`\`\``,n)}async function gd(e,r,n){await ni("You are a documentation assistant. Add comprehensive documentation (JSDoc, docstrings, or appropriate format) to the given code. Return ONLY the fully documented code in a single code block. No explanations.",`Add documentation to this ${r} code:

\`\`\`${r}
${e}
\`\`\``,n)}async function wb(e,r,n,s){await ni("You are a debugging assistant. Fix the error in the given code. Return ONLY the fixed code in a single code block. No explanations before or after.",`Fix this ${r} code.

Error: ${n}

Code:
\`\`\`${r}
${e}
\`\`\``,s)}async function md(e,r,n){await ni("You are a code simplification assistant. Simplify the given code while maintaining the same functionality. Return ONLY the simplified code in a single code block. No explanations.",`Simplify this ${r} code:

\`\`\`${r}
${e}
\`\`\``,n)}async function Gv(e,r,n){const s=ri();s.SetIsAiStreaming(!0),s.SetAiOperationError(null);const c=`You are a git commit message assistant. Write a clear, concise commit message following conventional commits style. First line should be a short summary (under ${Kg} chars). Optionally add a blank line and a longer description if the changes are complex. Output ONLY the commit message text, nothing else.`;let u="";try{return u=await Vi([{role:"system",content:c},{role:"user",content:`Generate a commit message for these changes:

${e}`}],{temperature:Zg,maxTokens:Vg},g=>{u+=g,s.SetCommitMessageDraft(u),r==null||r(g)},g=>{s.SetCommitMessageDraft(g),n==null||n(g)}),u}catch(g){return s.SetAiOperationError(g instanceof Error?g.message:String(g)),""}finally{s.SetIsAiStreaming(!1)}}const wd=new WeakMap;function yd({tab:e,theme:r,settings:n,zoomLevel:s}){const c=ye.useRef(null),u=ye.useRef(null),{updateTabContent:g,updateTab:d,showFindReplace:h}=$e(),[S,_]=ye.useState(!1),x=ye.useCallback((y,j)=>{c.current=y,u.current=j,Lm(j),j.editor.setTheme(r.editorMonacoTheme),_(!0),y.onDidChangeCursorPosition(L=>{d(e.id,{cursorLine:L.position.lineNumber,cursorColumn:L.position.column})}),y.onDidScrollChange(L=>{d(e.id,{scrollTop:L.scrollTop})}),y.addCommand(j.KeyMod.CtrlCmd|j.KeyCode.KeyD,()=>{var L;(L=y.getAction("editor.action.copyLinesDownAction"))==null||L.run()}),y.addCommand(j.KeyMod.CtrlCmd|j.KeyMod.Shift|j.KeyCode.KeyK,()=>{var L;(L=y.getAction("editor.action.deleteLines"))==null||L.run()}),y.addCommand(j.KeyMod.Alt|j.KeyCode.UpArrow,()=>{var L;(L=y.getAction("editor.action.moveLinesUpAction"))==null||L.run()}),y.addCommand(j.KeyMod.Alt|j.KeyCode.DownArrow,()=>{var L;(L=y.getAction("editor.action.moveLinesDownAction"))==null||L.run()}),y.addCommand(j.KeyMod.CtrlCmd|j.KeyCode.Slash,()=>{var L;(L=y.getAction("editor.action.commentLine"))==null||L.run()}),e.scrollTop&&y.setScrollTop(e.scrollTop),y.addAction({id:"ai-explain",label:"AI: Explain Code",contextMenuGroupId:"9_ai",contextMenuOrder:1,run:L=>{const F=L.getSelection(),U=L.getModel();if(F&&!F.isEmpty()&&U){const G=U.getValueInRange(F);dd(G,U.getLanguageId()||"plaintext")}}}),y.addAction({id:"ai-refactor",label:"AI: Refactor Code",contextMenuGroupId:"9_ai",contextMenuOrder:2,run:L=>{const F=L.getSelection(),U=L.getModel();if(F&&!F.isEmpty()&&U){const G=U.getValueInRange(F);hd(G,U.getLanguageId()||"plaintext",W=>{L.executeEdits("ai-refactor",[{range:F,text:W}])})}}}),y.addAction({id:"ai-generate-tests",label:"AI: Generate Tests",contextMenuGroupId:"9_ai",contextMenuOrder:3,run:L=>{const F=L.getSelection(),U=L.getModel();if(F&&!F.isEmpty()&&U){const G=U.getValueInRange(F);pd(G,U.getLanguageId()||"plaintext",W=>{const te=U.getLineCount(),Z=U.getLineMaxColumn(te);L.executeEdits("ai-tests",[{range:new j.Range(te,Z,te,Z),text:`

`+W}])})}}}),y.addAction({id:"ai-generate-docs",label:"AI: Generate Documentation",contextMenuGroupId:"9_ai",contextMenuOrder:4,run:L=>{const F=L.getSelection(),U=L.getModel();if(F&&!F.isEmpty()&&U){const G=U.getValueInRange(F);gd(G,U.getLanguageId()||"plaintext",W=>{L.executeEdits("ai-docs",[{range:F,text:W}])})}}}),y.addAction({id:"ai-fix-error",label:"AI: Fix Error",contextMenuGroupId:"9_ai",contextMenuOrder:5,run:L=>{const F=L.getSelection(),U=L.getModel();if(F&&!F.isEmpty()&&U){const G=U.getValueInRange(F),W=prompt("Describe the error (or paste error message):")||"Fix any issues";wb(G,U.getLanguageId()||"plaintext",W,te=>{L.executeEdits("ai-fix",[{range:F,text:te}])})}}}),y.addAction({id:"ai-simplify",label:"AI: Simplify Code",contextMenuGroupId:"9_ai",contextMenuOrder:6,run:L=>{const F=L.getSelection(),U=L.getModel();if(F&&!F.isEmpty()&&U){const G=U.getValueInRange(F);md(G,U.getLanguageId()||"plaintext",W=>{L.executeEdits("ai-simplify",[{range:F,text:W}])})}}}),Nm(y);const X=db(j);wd.set(y,X),y.focus()},[e.id,r.editorMonacoTheme,e.scrollTop,d]),R=ye.useCallback(y=>{y!==void 0&&g(e.id,y)},[e.id,g]);return ye.useEffect(()=>{u.current&&u.current.editor.setTheme(r.editorMonacoTheme)},[r.editorMonacoTheme]),ye.useEffect(()=>{const y=j=>{c.current&&(j!=null&&j.body)&&(nb(c.current,j.body),c.current.focus())};return oy(Xt.INSERT_SNIPPET,y),()=>sy(Xt.INSERT_SNIPPET,y)},[]),ye.useEffect(()=>()=>{var X;const y=c.current,j=y?wd.get(y):void 0;if(j)for(const L of j)(X=L==null?void 0:L.dispose)==null||X.call(L)},[]),ye.useEffect(()=>{const y=c.current,j=u.current;if(!y||!j)return;zm((Z,z)=>{var J,N,ce,oe,de,ne,me,ae,ie,se,he,ze,_e,Me;const B=y.getModel();if(B)switch(Z){case"cut":y.trigger("keyboard","editor.action.clipboardCutAction",null);break;case"copy":y.trigger("keyboard","editor.action.clipboardCopyAction",null);break;case"paste":{navigator.clipboard.readText().then(q=>{y.trigger("keyboard","paste",{text:q})}).catch(()=>{y.focus(),document.execCommand("paste")});break}case"undo":y.trigger("keyboard","undo",null);break;case"redo":y.trigger("keyboard","redo",null);break;case"select-all":y.setSelection(B.getFullModelRange());break;case"duplicate-line":(J=y.getAction("editor.action.copyLinesDownAction"))==null||J.run();break;case"delete-line":(N=y.getAction("editor.action.deleteLines"))==null||N.run();break;case"move-line-up":(ce=y.getAction("editor.action.moveLinesUpAction"))==null||ce.run();break;case"move-line-down":(oe=y.getAction("editor.action.moveLinesDownAction"))==null||oe.run();break;case"toggle-comment":(de=y.getAction("editor.action.commentLine"))==null||de.run();break;case"block-comment":(ne=y.getAction("editor.action.blockComment"))==null||ne.run();break;case"transpose-line":{const q=y.getPosition();if(!q||q.lineNumber<=1)break;const ke=B.getLineContent(q.lineNumber),Ae=B.getLineContent(q.lineNumber-1);y.executeEdits("transpose",[{range:new j.Range(q.lineNumber-1,1,q.lineNumber,B.getLineMaxColumn(q.lineNumber)),text:ke+`
`+Ae}]);break}case"split-lines":{const q=y.getSelection();if(q&&!q.isEmpty()){const ke=B.getValueInRange(q);y.executeEdits("split",[{range:q,text:ke.split("").join(`
`)}])}break}case"join-lines":{const q=y.getSelection();q&&!q.isEmpty()&&y.executeEdits("join",[{range:q,text:B.getValueInRange(q).replace(/\n/g," ")}]);break}case"uppercase":{const q=y.getSelection();q&&!q.isEmpty()&&y.executeEdits("uppercase",[{range:q,text:B.getValueInRange(q).toUpperCase()}]);break}case"lowercase":{const q=y.getSelection();q&&!q.isEmpty()&&y.executeEdits("lowercase",[{range:q,text:B.getValueInRange(q).toLowerCase()}]);break}case"proper-case":{const q=y.getSelection();q&&!q.isEmpty()&&y.executeEdits("proper",[{range:q,text:B.getValueInRange(q).replace(/\w\S*/g,ke=>ke.charAt(0).toUpperCase()+ke.substr(1).toLowerCase())}]);break}case"sentence-case":{const q=y.getSelection();q&&!q.isEmpty()&&y.executeEdits("sentence",[{range:q,text:B.getValueInRange(q).toLowerCase().replace(/(^\s*\w|[.!?]\s+\w)/g,ke=>ke.toUpperCase())}]);break}case"invert-case":{const q=y.getSelection();q&&!q.isEmpty()&&y.executeEdits("invert",[{range:q,text:B.getValueInRange(q).split("").map(ke=>ke===ke.toUpperCase()?ke.toLowerCase():ke.toUpperCase()).join("")}]);break}case"random-case":{const q=y.getSelection();q&&!q.isEmpty()&&y.executeEdits("random",[{range:q,text:B.getValueInRange(q).split("").map(ke=>Math.random()>.5?ke.toUpperCase():ke.toLowerCase()).join("")}]);break}case"insert-datetime":{const q=y.getPosition();if(q){const Ae=new Date().toISOString().replace("T"," ").replace(/\.\d+Z/,"");y.executeEdits("datetime",[{range:new j.Range(q.lineNumber,q.column,q.lineNumber,q.column),text:Ae}])}break}case"sort-asc":case"sort-desc":case"sort-asc-ci":case"sort-desc-ci":case"sort-len-asc":case"sort-len-desc":{const q=B.getFullModelRange(),ke=B.getValue().split(`
`);Z==="sort-asc"?ke.sort((Ae,Oe)=>Ae.localeCompare(Oe)):Z==="sort-desc"?ke.sort((Ae,Oe)=>Oe.localeCompare(Ae)):Z==="sort-asc-ci"?ke.sort((Ae,Oe)=>Ae.toLowerCase().localeCompare(Oe.toLowerCase())):Z==="sort-desc-ci"?ke.sort((Ae,Oe)=>Oe.toLowerCase().localeCompare(Ae.toLowerCase())):Z==="sort-len-asc"?ke.sort((Ae,Oe)=>Ae.length-Oe.length):Z==="sort-len-desc"&&ke.sort((Ae,Oe)=>Oe.length-Ae.length),y.executeEdits("sort",[{range:q,text:ke.join(`
`)}]);break}case"remove-duplicates":{const q=B.getFullModelRange();y.executeEdits("remove-dup",[{range:q,text:[...new Set(B.getValue().split(`
`))].join(`
`)}]);break}case"remove-consecutive-duplicates":{const q=B.getFullModelRange(),ke=B.getValue().split(`
`);y.executeEdits("remove-consec-dup",[{range:q,text:ke.filter((Ae,Oe)=>Oe===0||Ae!==ke[Oe-1]).join(`
`)}]);break}case"remove-empty-lines":{y.executeEdits("remove-empty",[{range:B.getFullModelRange(),text:B.getValue().split(`
`).filter(q=>q.trim()!=="").join(`
`)}]);break}case"remove-blank-lines":{y.executeEdits("remove-blank",[{range:B.getFullModelRange(),text:B.getValue().split(`
`).filter(q=>q!=="").join(`
`)}]);break}case"trim-trailing":{y.executeEdits("trim",[{range:B.getFullModelRange(),text:B.getValue().split(`
`).map(q=>q.trimEnd()).join(`
`)}]);break}case"trim-leading":{y.executeEdits("trim-lead",[{range:B.getFullModelRange(),text:B.getValue().split(`
`).map(q=>q.trimStart()).join(`
`)}]);break}case"trim-both":{y.executeEdits("trim-both",[{range:B.getFullModelRange(),text:B.getValue().split(`
`).map(q=>q.trim()).join(`
`)}]);break}case"eol-to-space":{y.executeEdits("eol-space",[{range:B.getFullModelRange(),text:B.getValue().replace(/\n/g," ")}]);break}case"tab-to-space":{const q=" ".repeat($e.getState().settings.tabSize);y.executeEdits("tab-space",[{range:B.getFullModelRange(),text:B.getValue().replace(/\t/g,q)}]);break}case"space-to-tab-leading":{const q=$e.getState().settings.tabSize,ke=new RegExp(`^( {${q}})+`,"gm");y.executeEdits("space-tab",[{range:B.getFullModelRange(),text:B.getValue().replace(ke,Ae=>"	".repeat(Ae.length/q))}]);break}case"space-to-tab-all":{const q=$e.getState().settings.tabSize;y.executeEdits("space-tab-all",[{range:B.getFullModelRange(),text:B.getValue().split(" ".repeat(q)).join("	")}]);break}case"insert-blank-above":{const q=y.getPosition();q&&y.executeEdits("blank-above",[{range:new j.Range(q.lineNumber,1,q.lineNumber,1),text:`
`}]);break}case"insert-blank-below":{const q=y.getPosition();q&&y.executeEdits("blank-below",[{range:new j.Range(q.lineNumber,B.getLineMaxColumn(q.lineNumber),q.lineNumber,B.getLineMaxColumn(q.lineNumber)),text:`
`}]);break}case"reverse-lines":{y.executeEdits("reverse",[{range:B.getFullModelRange(),text:B.getValue().split(`
`).reverse().join(`
`)}]);break}case"fold-all":(me=y.getAction("editor.foldAll"))==null||me.run();break;case"unfold-all":(ae=y.getAction("editor.unfoldAll"))==null||ae.run();break;case"fold-level":{const q=z;(ie=y.getAction(`editor.foldLevel${q}`))==null||ie.run();break}case"select-to-bracket":(se=y.getAction("editor.action.selectToBracket"))==null||se.run();break;case"goto-bracket":(he=y.getAction("editor.action.jumpToBracket"))==null||he.run();break;case"toggle-bookmark":{const q=(ze=y.getPosition())==null?void 0:ze.lineNumber;if(q){const ke=[...e.bookmarks],Ae=ke.indexOf(q);Ae>=0?ke.splice(Ae,1):ke.push(q),ke.sort((Oe,je)=>Oe-je),d(e.id,{bookmarks:ke})}break}case"next-bookmark":{const q=((_e=y.getPosition())==null?void 0:_e.lineNumber)||1,Ae=e.bookmarks.find(Oe=>Oe>q)||e.bookmarks[0];Ae&&y.setPosition({lineNumber:Ae,column:1}),y.revealLineInCenter(Ae||q);break}case"prev-bookmark":{const q=((Me=y.getPosition())==null?void 0:Me.lineNumber)||1,Ae=[...e.bookmarks].reverse().find(Oe=>Oe<q)||e.bookmarks[e.bookmarks.length-1];Ae&&y.setPosition({lineNumber:Ae,column:1}),y.revealLineInCenter(Ae||q);break}case"clear-bookmarks":{d(e.id,{bookmarks:[]});break}case"mark-style":{const q=y.getSelection();if(q&&!q.isEmpty()){const ke=[...e.marks||[]];ke.push({line:q.startLineNumber,column:q.startColumn,length:B.getValueInRange(q).length,style:z||1}),d(e.id,{marks:ke})}break}case"clear-marks":{d(e.id,{marks:[]});break}case"cut-marked-lines":case"copy-marked-lines":case"delete-marked-lines":case"delete-unmarked-lines":case"paste-marked-lines":case"inverse-marks":{const q=e.marks||[];if(q.length===0)break;const ke=new Set(q.map(je=>je.line)),Ae=B.getValue().split(`
`),Oe=(je,Fe)=>ke.has(Fe+1);if(Z==="cut-marked-lines"){const je=Ae.filter((Ke,Ye)=>Oe(Ke,Ye));navigator.clipboard.writeText(je.join(`
`));const Fe=Ae.filter((Ke,Ye)=>!Oe(Ke,Ye));y.executeEdits("cut-marked",[{range:B.getFullModelRange(),text:Fe.join(`
`)}])}else if(Z==="copy-marked-lines")navigator.clipboard.writeText(Ae.filter((je,Fe)=>Oe(je,Fe)).join(`
`));else if(Z==="delete-marked-lines")y.executeEdits("del-marked",[{range:B.getFullModelRange(),text:Ae.filter((je,Fe)=>!Oe(je,Fe)).join(`
`)}]);else if(Z==="delete-unmarked-lines")y.executeEdits("del-unmarked",[{range:B.getFullModelRange(),text:Ae.filter((je,Fe)=>Oe(je,Fe)).join(`
`)}]);else if(Z==="paste-marked-lines")navigator.clipboard.readText().then(je=>{const Fe=Ae.map((Ke,Ye)=>Oe(Ke,Ye)?je:Ke);y.executeEdits("paste-marked",[{range:B.getFullModelRange(),text:Fe.join(`
`)}])}).catch(()=>{});else if(Z==="inverse-marks"){const je=Ae.map((Fe,Ke)=>Ke+1).filter(Fe=>!ke.has(Fe)).map(Fe=>({line:Fe,column:1,length:Ae[Fe-1].length,style:1}));d(e.id,{marks:je})}break}case"macro-playback":{const ke=$e.getState().currentMacroActions;if(ke.length===0)break;for(const Ae of ke)Ae.type==="type"?y.trigger("keyboard","type",{text:Ae.data}):Ae.type==="command"&&y.trigger("keyboard",Ae.data,null);break}case"macro-run-multiple":{const q=prompt("Run macro how many times?","10");if(!q)break;const ke=parseInt(q,10);if(isNaN(ke)||ke<1)break;const Oe=$e.getState().currentMacroActions;if(Oe.length===0)break;for(let je=0;je<ke;je++)for(const Fe of Oe)Fe.type==="type"?y.trigger("keyboard","type",{text:Fe.data}):Fe.type==="command"&&y.trigger("keyboard",Fe.data,null);break}case"macro-save":{const q=$e.getState();if(q.currentMacroActions.length===0)break;const ke=prompt("Save macro as:","My Macro");ke&&q.saveMacro(ke);break}case"hash-md5-file":case"hash-sha256-file":{const q=document.createElement("input");q.type="file",q.onchange=async()=>{var ke;try{const Ae=(ke=q.files)==null?void 0:ke[0];if(!Ae)return;const Oe=await Ae.text(),je=Z==="hash-md5-file"?"md5":"sha256",Fe=await ds(je,Oe),Ke=y.getPosition();Ke&&y.executeEdits("hash-file",[{range:new j.Range(Ke.lineNumber,Ke.column,Ke.lineNumber,Ke.column),text:`
// ${je.toUpperCase()} (${Ae.name}): ${Fe}
`}])}catch{}},q.click();break}case"json-format":{try{y.executeEdits("json-fmt",[{range:B.getFullModelRange(),text:JSON.stringify(JSON.parse(B.getValue()),null,2)}])}catch{}break}case"json-minify":{try{y.executeEdits("json-min",[{range:B.getFullModelRange(),text:JSON.stringify(JSON.parse(B.getValue()))}])}catch{}break}case"hash-md5":case"hash-sha1":case"hash-sha256":case"hash-sha512":{const q=y.getSelection();let ke=q&&!q.isEmpty()?B.getValueInRange(q):B.getValue();ds(Z.replace("hash-",""),ke).then(Ae=>{const Oe=y.getPosition();Oe&&y.executeEdits("hash",[{range:new j.Range(Oe.lineNumber,Oe.column,Oe.lineNumber,Oe.column),text:`
// ${Z.replace("hash-","").toUpperCase()}: ${Ae}
`}])}).catch(()=>{});break}case"hash-md5-clipboard":case"hash-sha1-clipboard":case"hash-sha256-clipboard":case"hash-sha512-clipboard":{const q=y.getSelection();let ke=q&&!q.isEmpty()?B.getValueInRange(q):B.getValue();ds(Z.replace("hash-","").replace("-clipboard",""),ke).then(Ae=>navigator.clipboard.writeText(Ae)).catch(()=>{});break}case"base64-encode":{const q=y.getSelection();q&&!q.isEmpty()&&y.executeEdits("b64enc",[{range:q,text:btoa(B.getValueInRange(q))}]);break}case"base64-decode":{const q=y.getSelection();if(q&&!q.isEmpty())try{y.executeEdits("b64dec",[{range:q,text:atob(B.getValueInRange(q))}])}catch{}break}case"url-encode":{const q=y.getSelection();q&&!q.isEmpty()&&y.executeEdits("urlenc",[{range:q,text:encodeURIComponent(B.getValueInRange(q))}]);break}case"url-decode":{const q=y.getSelection();if(q&&!q.isEmpty())try{y.executeEdits("urldec",[{range:q,text:decodeURIComponent(B.getValueInRange(q))}])}catch{}break}case"copy-file-path":{e.path&&navigator.clipboard.writeText(e.path);break}case"copy-file-name":{navigator.clipboard.writeText(e.name);break}case"copy-file-dir":{e.path&&navigator.clipboard.writeText(e.path.substring(0,e.path.lastIndexOf("/")));break}case"toggle-readonly":{d(e.id,{isReadOnly:!e.isReadOnly});break}case"ai-explain":{const q=y.getSelection();q&&!q.isEmpty()&&dd(B.getValueInRange(q),B.getLanguageId()||"plaintext");break}case"ai-refactor":{const q=y.getSelection();q&&!q.isEmpty()&&hd(B.getValueInRange(q),B.getLanguageId()||"plaintext",ke=>{y.executeEdits("ai-refactor",[{range:q,text:ke}])});break}case"ai-generate-tests":{const q=y.getSelection();q&&!q.isEmpty()&&pd(B.getValueInRange(q),B.getLanguageId()||"plaintext",ke=>{const Ae=B.getLineCount(),Oe=B.getLineMaxColumn(Ae);y.executeEdits("ai-tests",[{range:new j.Range(Ae,Oe,Ae,Oe),text:`

`+ke}])});break}case"ai-generate-docs":{const q=y.getSelection();q&&!q.isEmpty()&&gd(B.getValueInRange(q),B.getLanguageId()||"plaintext",ke=>{y.executeEdits("ai-docs",[{range:q,text:ke}])});break}case"ai-simplify":{const q=y.getSelection();q&&!q.isEmpty()&&md(B.getValueInRange(q),B.getLanguageId()||"plaintext",ke=>{y.executeEdits("ai-simplify",[{range:q,text:ke}])});break}}});const L=Z=>{const{query:z,direction:B,isCaseSensitive:J,isWholeWord:N,isRegex:ce}=Z.detail;if(!z)return;const oe=y.getModel();if(!oe)return;const de=oe.getValue(),ne=y.getPosition(),me=ne?oe.getOffsetAt(ne):0;let ae="g";J||(ae+="i");let ie;ce?ie=z:ie=z.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),N&&(ie=`\\b${ie}\\b`);let se;try{se=new RegExp(ie,ae)}catch{return}const he=[];let ze;for(;(ze=se.exec(de))!==null;)he.push({start:ze.index,end:ze.index+ze[0].length}),ze[0].length===0&&se.lastIndex++;if(he.length===0)return;let _e;B==="next"?_e=he.find(ke=>ke.start>=me)||he[0]:_e=[...he].reverse().find(ke=>ke.end<=me)||he[he.length-1];const Me=oe.getPositionAt(_e.start),q=oe.getPositionAt(_e.end);y.setSelection(new j.Range(Me.lineNumber,Me.column,q.lineNumber,q.column)),y.revealLineInCenter(Me.lineNumber)},F=Z=>{const{find:z,replace:B,all:J,isCaseSensitive:N,isWholeWord:ce,isRegex:oe}=Z.detail;if(!z)return;const de=y.getModel();if(!de)return;let ne="g";N||(ne+="i");let me;oe?me=z:me=z.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ce&&(me=`\\b${me}\\b`);let ae;try{ae=new RegExp(me,ne)}catch{return}if(J){const ie=de.getFullModelRange(),se=de.getValue().replace(ae,B);y.executeEdits("replace-all",[{range:ie,text:se}])}else{const ie=y.getSelection();if(ie&&!ie.isEmpty()){const se=de.getValueInRange(ie),he=new RegExp(me,N?"":"i");he.test(se)&&y.executeEdits("replace",[{range:ie,text:se.replace(he,B)}])}L(new CustomEvent("notemac-find",{detail:{query:z,direction:"next",isCaseSensitive:N,isWholeWord:ce,isRegex:oe}}))}},U=Z=>{const{query:z,isCaseSensitive:B,isWholeWord:J,isRegex:N,style:ce}=Z.detail;if(!z)return;const oe=y.getModel();if(!oe)return;let de="g";B||(de+="i");let ne=N?z:z.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");J&&(ne=`\\b${ne}\\b`);let me;try{me=new RegExp(ne,de)}catch{return}const ae=oe.getValue(),ie=[];let se;for(;(se=me.exec(ae))!==null;){const ze=oe.getPositionAt(se.index);ie.push({line:ze.lineNumber,column:ze.column,length:se[0].length,style:ce||1}),se[0].length===0&&me.lastIndex++}const he=e.marks||[];d(e.id,{marks:[...he,...ie]})},G=()=>{d(e.id,{marks:[]})},W=Z=>{const{line:z}=Z.detail;z&&(y.setPosition({lineNumber:z,column:1}),y.revealLineInCenter(z),y.focus())},te=Z=>{const{text:z,startLine:B,endLine:J,column:N}=Z.detail,ce=y.getModel();if(!ce)return;const oe=[],de=Math.min(J||ce.getLineCount(),ce.getLineCount());for(let ne=B||1;ne<=de;ne++){const me=Math.min(N||1,ce.getLineMaxColumn(ne));oe.push({range:new j.Range(ne,me,ne,me),text:z||""})}0<oe.length&&y.executeEdits("column-edit",oe)};return document.addEventListener("notemac-find",L),document.addEventListener("notemac-replace",F),document.addEventListener("notemac-mark",U),document.addEventListener("notemac-clear-marks",G),document.addEventListener("notemac-goto-line",W),document.addEventListener("notemac-column-edit",te),()=>{Gm(),Um(),document.removeEventListener("notemac-find",L),document.removeEventListener("notemac-replace",F),document.removeEventListener("notemac-mark",U),document.removeEventListener("notemac-clear-marks",G),document.removeEventListener("notemac-goto-line",W),document.removeEventListener("notemac-column-edit",te)}},[S,e.id,e.bookmarks,e.marks]),ye.useEffect(()=>{const y=c.current,j=u.current;if(!y||!j||!S)return;const X=e.bookmarks.map(F=>({range:new j.Range(F,1,F,1),options:{isWholeLine:!0,linesDecorationsClassName:"bookmark-decoration",glyphMarginClassName:"bookmark-glyph",overviewRuler:{color:"#007acc",position:1}}})),L=y.deltaDecorations([],X);return()=>{y.deltaDecorations(L,[])}},[e.bookmarks,S]),E.jsx("div",{style:{flex:1,overflow:"hidden"},children:E.jsx(tb,{height:"100%",language:e.language,value:e.content,onChange:R,onMount:x,theme:r.editorMonacoTheme,options:{fontSize:n.fontSize+s,fontFamily:n.fontFamily,tabSize:n.tabSize,insertSpaces:n.insertSpaces,wordWrap:n.wordWrap?"on":"off",lineNumbers:n.showLineNumbers?"on":"off",minimap:{enabled:n.showMinimap,scale:1,showSlider:"mouseover"},renderWhitespace:n.renderWhitespace,guides:{indentation:n.showIndentGuides,bracketPairs:!0},cursorBlinking:n.cursorBlinking,cursorStyle:n.cursorStyle,smoothScrolling:n.smoothScrolling,bracketPairColorization:{enabled:!0},matchBrackets:n.matchBrackets?"always":"never",autoClosingBrackets:n.autoCloseBrackets?"always":"never",autoClosingQuotes:n.autoCloseQuotes?"always":"never",renderLineHighlight:n.highlightCurrentLine?"all":"none",folding:!0,foldingStrategy:"indentation",showFoldingControls:"mouseover",glyphMargin:!0,scrollBeyondLastLine:!1,automaticLayout:!0,contextmenu:!0,dragAndDrop:!0,links:!0,multiCursorModifier:"alt",inlineSuggest:{enabled:!0},snippetSuggestions:"top",suggestOnTriggerCharacters:!0,wordBasedSuggestions:"currentDocument",padding:{top:8},readOnly:e.isReadOnly,overviewRulerBorder:!1,hideCursorInOverviewRuler:!1,colorDecorators:!0,columnSelection:!0,copyWithSyntaxHighlighting:!0,emptySelectionClipboard:!0,find:{addExtraSpaceOnTop:!1,autoFindInSelection:"never",seedSearchStringFromSelection:"always"}},loading:E.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:r.textMuted},children:"Loading editor..."})})})}async function ds(e,r){const s=new TextEncoder().encode(r),c={md5:"MD5",sha1:"SHA-1",sha256:"SHA-256",sha512:"SHA-512"}[e];if(!c||e==="md5"){let u=0;for(let g=0;g<r.length;g++){const d=r.charCodeAt(g);u=(u<<5)-u+d,u=u&u}return Math.abs(u).toString(16).padStart(8,"0")}try{const u=await crypto.subtle.digest(c,s);return Array.from(new Uint8Array(u)).map(d=>d.toString(16).padStart(2,"0")).join("")}catch{return"error computing hash"}}function yb(e){return e.trim().split(/\s+/).filter(Boolean).length}function bb(e){return e?e.split(/\r\n|\r|\n/).length:0}function Hv(e){return 1024>e?`${e} B`:1024*1024>e?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}function bd(e){return{plaintext:"Plain Text",javascript:"JavaScript",typescript:"TypeScript",python:"Python",ruby:"Ruby",go:"Go",rust:"Rust",c:"C",cpp:"C++",csharp:"C#",java:"Java",swift:"Swift",kotlin:"Kotlin",php:"PHP",html:"HTML",css:"CSS",scss:"SCSS",less:"LESS",json:"JSON",xml:"XML",yaml:"YAML",markdown:"Markdown",sql:"SQL",shell:"Shell",powershell:"PowerShell",r:"R",lua:"Lua",perl:"Perl",dart:"Dart",elixir:"Elixir",erlang:"Erlang",haskell:"Haskell",scala:"Scala",clojure:"Clojure",coffeescript:"CoffeeScript",bat:"Batch",ini:"INI",dockerfile:"Dockerfile",graphql:"GraphQL"}[e]||e}function vb({theme:e}){const{tabs:r,activeTabId:n,settings:s,zoomLevel:c,isRecordingMacro:u,updateTab:g,updateSettings:d,isRepoInitialized:h,currentBranch:S,gitStatus:_,setSidebarPanel:x,aiEnabled:R,isAiStreaming:y,activeModelId:j,inlineSuggestionEnabled:X,SetShowAiSettings:L}=$e(),F=r.find(ae=>ae.id===n),[U,G]=ye.useState(!1),[W,te]=ye.useState(!1),[Z,z]=ye.useState(!1);if(F===void 0)return null;const B=bb(F.content),J=F.content.length,N=yb(F.content),ce=["plaintext","javascript","typescript","python","ruby","go","rust","c","cpp","csharp","java","swift","kotlin","php","html","css","scss","json","xml","yaml","markdown","sql","shell","lua","perl","r","dart","scala","haskell"],oe=["utf-8","utf-8-bom","utf-16le","utf-16be","iso-8859-1","windows-1252"],de=[{value:"LF",label:"LF (Unix/Mac)"},{value:"CRLF",label:"CRLF (Windows)"},{value:"CR",label:"CR (Old Mac)"}],ne=kt.memo(({children:ae,onClick:ie,title:se})=>{const[he,ze]=ye.useState(!1);return E.jsx("div",{title:se,onClick:ie,onMouseEnter:()=>ze(!0),onMouseLeave:()=>ze(!1),style:{padding:"0 8px",cursor:ie!==null?"pointer":"default",backgroundColor:he&&ie!==null?"rgba(255,255,255,0.1)":"transparent",height:"100%",display:"flex",alignItems:"center",borderRadius:2,position:"relative"},children:ae})});ne.displayName="StatusItem";const me=kt.memo(({items:ae,onSelect:ie,onClose:se})=>E.jsxs(E.Fragment,{children:[E.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:im},onClick:se}),E.jsx("div",{style:{position:"absolute",bottom:"100%",left:0,minWidth:180,maxHeight:rm,overflowY:"auto",backgroundColor:e.menuBg,border:`1px solid ${e.border}`,borderRadius:6,padding:"4px 0",zIndex:am,boxShadow:"0 -4px 16px rgba(0,0,0,0.3)"},children:ae.map(he=>E.jsx("div",{onClick:()=>{ie(he.value),se()},className:"hover-bg hover-bg-reset",style:{padding:"6px 16px",cursor:"pointer",fontSize:13,color:e.menuText,"--hover-bg":e.bgHover},children:he.label},he.value))})]}));return me.displayName="Picker",E.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",height:24,backgroundColor:e.statusBarBg,color:e.statusBarText,fontSize:12,flexShrink:0,padding:"0 4px"},children:[E.jsxs("div",{style:{display:"flex",alignItems:"center",height:"100%"},children:[h===!0&&E.jsx(ne,{title:`Branch: ${S}${_!==null&&_.aheadBy!==void 0?` ${_.aheadBy}`:""}${_!==null&&_.behindBy!==void 0?` ${_.behindBy}`:""}`,onClick:()=>x("git"),children:E.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[E.jsx("span",{style:{fontSize:11},children:""}),S,_!==null&&0<_.aheadBy&&E.jsxs("span",{style:{fontSize:10},children:["",_.aheadBy]}),_!==null&&0<_.behindBy&&E.jsxs("span",{style:{fontSize:10},children:["",_.behindBy]}),_!==null&&_.isRepoDirty===!0&&E.jsx("span",{style:{fontSize:10,color:"#f9e2af"},children:""})]})}),u===!0&&E.jsx(ne,{children:E.jsxs("span",{className:"recording-indicator",style:{color:"#ff4444"},children:[""," Recording"]})}),E.jsxs(ne,{title:"Cursor Position",children:["Ln ",F.cursorLine,", Col ",F.cursorColumn]}),E.jsxs(ne,{title:"Character Count",children:[J," chars"]}),E.jsxs(ne,{title:"Word Count",children:[N," words"]}),E.jsxs(ne,{title:"Line Count",children:[B," lines"]})]}),E.jsxs("div",{style:{display:"flex",alignItems:"center",height:"100%"},children:[E.jsxs(ne,{title:"Tab Size",onClick:()=>{const ae=s.tabSize===4?2:4;d({tabSize:ae})},children:[s.insertSpaces?"Spaces":"Tabs",": ",s.tabSize]}),E.jsxs(ne,{title:"Line Ending",onClick:()=>z(!Z),children:[F.lineEnding,Z&&E.jsx(me,{items:de.map(ae=>({value:ae.value,label:ae.label})),onSelect:ae=>g(F.id,{lineEnding:ae}),onClose:()=>z(!1)})]}),E.jsxs(ne,{title:"Encoding",onClick:()=>te(!W),children:[F.encoding.toUpperCase(),W&&E.jsx(me,{items:oe.map(ae=>({value:ae,label:ae.toUpperCase()})),onSelect:ae=>g(F.id,{encoding:ae}),onClose:()=>te(!1)})]}),E.jsxs(ne,{title:"Language",onClick:()=>G(!U),children:[bd(F.language),U&&E.jsx(me,{items:ce.map(ae=>({value:ae,label:bd(ae)})),onSelect:ae=>g(F.id,{language:ae}),onClose:()=>G(!1)})]}),R===!0&&E.jsx(ne,{title:`AI: ${j}${X===!0?" (Inline On)":""}`,onClick:()=>L(!0),children:E.jsx("span",{style:{display:"flex",alignItems:"center",gap:4},children:y===!0?E.jsxs("span",{style:{color:"#a6e3a1",animation:"pulse 1s infinite"},children:[""," Generating..."]}):E.jsxs("span",{style:{color:e.statusBarText,opacity:.8},children:[""," ",j||"No Model"]})})}),c!==0&&E.jsxs(ne,{title:"Zoom Level",children:[0<c?"+":"",c]})]})]})}const xb=ye.lazy(()=>Ot(()=>import("./GitPanelViewPresenter-CRyTZJqF.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(e=>({default:e.GitPanelViewPresenter}))),_b=ye.lazy(()=>Ot(()=>import("./AIChatPanelViewPresenter-D6xIYR09.js"),__vite__mapDeps([4,1,2,3]),import.meta.url).then(e=>({default:e.AIChatPanelViewPresenter})));function Sb({theme:e}){const{sidebarPanel:r,sidebarWidth:n,fileTree:s,workspacePath:c,tabs:u,activeTabId:g,setSidebarPanel:d,toggleTreeNode:h,addTab:S,setActiveTab:_,setFileTree:x,setWorkspacePath:R,GetChangedFileCount:y}=$e(),[j,X]=ye.useState(!1),[L,F]=ye.useState(n),U=ye.useRef(null),G=ye.useRef(null),W=ye.useCallback(J=>{J.preventDefault(),X(!0);const N=J.clientX,ce=L,oe=ne=>{const me=Math.max(Yg,Math.min(Jg,ce+ne.clientX-N));F(me)},de=()=>{X(!1),U.current!==null&&document.removeEventListener("mousemove",U.current),G.current!==null&&document.removeEventListener("mouseup",G.current),U.current=null,G.current=null};U.current=oe,G.current=de,document.addEventListener("mousemove",oe),document.addEventListener("mouseup",de)},[L]);ye.useEffect(()=>()=>{U.current!==null&&document.removeEventListener("mousemove",U.current),G.current!==null&&document.removeEventListener("mouseup",G.current)},[]);const te=async()=>{if("showDirectoryPicker"in window)try{const J=await window.showDirectoryPicker(),N=await xh(J);x(N),R(J.name),await oh(J)}catch{}},Z=async J=>{if(J.isDirectory){h(J.path);return}const N=u.find(ce=>ce.path===J.path||ce.name===J.name);if(N){_(N.id);return}if(window.electronAPI){const ce=await window.electronAPI.readFile(J.path);S({name:J.name,path:J.path,content:ce,language:hr(J.name),lineEnding:Er(ce)})}else if(J.handle)try{const oe=await(await J.handle.getFile()).text();S({name:J.name,path:J.path,content:oe,language:hr(J.name),lineEnding:Er(oe)})}catch{}},z=kt.memo(({node:J,depth:N=0})=>{var me,ae;const[ce,oe]=ye.useState(!1),de=J.isExpanded,ne=((me=u.find(ie=>ie.id===g))==null?void 0:me.path)===J.path;return E.jsxs("div",{children:[E.jsxs("div",{onClick:()=>Z(J),onMouseEnter:()=>oe(!0),onMouseLeave:()=>oe(!1),style:{display:"flex",alignItems:"center",gap:4,padding:"3px 8px",paddingLeft:8+N*16,cursor:"pointer",backgroundColor:ne?e.bgActive:ce?e.bgHover:"transparent",color:ne?e.text:e.sidebarText,fontSize:13,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[E.jsx("span",{style:{fontSize:10,width:16,textAlign:"center",flexShrink:0},children:J.isDirectory?de?"":"":""}),E.jsx("span",{style:{marginRight:4,flexShrink:0},children:J.isDirectory?de?"":"":Cb(J.name)}),E.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis"},children:J.name})]}),J.isDirectory&&de&&((ae=J.children)==null?void 0:ae.map((ie,se)=>E.jsx(z,{node:ie,depth:N+1},ie.path||se)))]})});z.displayName="TreeNode";const B=kt.memo(()=>{const J=u.find(ce=>ce.id===g);if(J===void 0)return null;const N=Tb(J.content,J.language);return E.jsxs("div",{style:{padding:8},children:[E.jsx("div",{style:{fontSize:11,color:e.textMuted,marginBottom:8,textTransform:"uppercase",letterSpacing:1},children:"Functions"}),N.length===0?E.jsx("div",{style:{color:e.textMuted,fontSize:12,padding:8},children:"No functions found"}):N.map((ce,oe)=>E.jsxs("div",{onClick:()=>{document.dispatchEvent(new CustomEvent("notemac-goto-line",{detail:{line:ce.line}}))},className:"hover-bg hover-bg-reset",style:{padding:"4px 8px",cursor:"pointer",fontSize:13,color:e.sidebarText,borderRadius:4,"--hover-bg":e.bgHover},children:[E.jsx("span",{style:{color:e.accent,marginRight:4},children:"f"}),ce.name,E.jsxs("span",{style:{color:e.textMuted,fontSize:11,marginLeft:8},children:[":",ce.line]})]},oe))]})});return B.displayName="FunctionListPanel",E.jsxs("div",{style:{display:"flex",flexShrink:0},children:[E.jsx("div",{style:{width:40,backgroundColor:e.bgSecondary,borderRight:`1px solid ${e.border}`,display:"flex",flexDirection:"column",alignItems:"center",paddingTop:8,gap:4},children:[{panel:"explorer",icon:"",title:"Explorer"},{panel:"search",icon:"",title:"Search"},{panel:"functions",icon:"",title:"Function List"},{panel:"docList",icon:"",title:"Document List"},{panel:"project",icon:"",title:"Project"},{panel:"clipboardHistory",icon:"",title:"Clipboard History"},{panel:"charPanel",icon:"",title:"Character Panel"},{panel:"git",icon:"",title:"Source Control"},{panel:"ai",icon:"",title:"AI Assistant"}].map(({panel:J,icon:N,title:ce})=>{const oe=J==="git"?y():0;return E.jsxs("button",{"aria-label":ce,onClick:()=>d(r===J?null:J),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",borderRadius:6,fontSize:16,backgroundColor:r===J?e.bgHover:"transparent",borderLeft:r===J?`2px solid ${e.accent}`:"2px solid transparent",border:"none",padding:0,position:"relative",color:"inherit"},children:[N,oe>0&&E.jsx("span",{style:{position:"absolute",top:2,right:2,minWidth:14,height:14,borderRadius:7,backgroundColor:e.accent,color:e.accentText,fontSize:9,fontWeight:700,display:"flex",alignItems:"center",justifyContent:"center",padding:"0 3px"},children:oe})]},J)})}),r!==null&&E.jsxs(E.Fragment,{children:[E.jsxs("div",{style:{width:L-40,backgroundColor:e.sidebarBg,borderRight:`1px solid ${e.border}`,overflow:"auto",display:"flex",flexDirection:"column"},children:[E.jsxs("div",{style:{padding:"8px 12px",fontSize:11,fontWeight:600,textTransform:"uppercase",letterSpacing:1,color:e.textSecondary,borderBottom:`1px solid ${e.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r==="explorer"?"Explorer":r==="search"?"Search":r==="functions"?"Functions":r==="docList"?"Document List":r==="project"?"Project":r==="clipboardHistory"?"Clipboard History":r==="charPanel"?"Character Panel":r==="git"?"Source Control":r==="ai"?"AI Assistant":"",E.jsx("button",{"aria-label":"Collapse panel",onClick:()=>d(null),className:"hover-bg-color",style:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",borderRadius:4,fontSize:12,color:e.textMuted,backgroundColor:"transparent",border:"none",padding:0,"--hover-bg":e.bgHover,"--hover-color":e.text},children:""})]}),E.jsxs("div",{style:{flex:1,overflow:"auto"},children:[r==="explorer"&&E.jsx(E.Fragment,{children:s.length>0?E.jsxs("div",{style:{paddingTop:4},children:[c&&E.jsxs("div",{style:{padding:"6px 12px",fontSize:12,fontWeight:600,color:e.text,display:"flex",alignItems:"center",gap:6},children:[E.jsx("span",{children:""}),typeof c=="string"&&c.split("/").pop()||c]}),s.map((J,N)=>E.jsx(z,{node:J},J.path||N))]}):E.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:24,gap:12},children:[E.jsx("div",{style:{color:e.textMuted,fontSize:13,textAlign:"center"},children:"No folder opened"}),E.jsx("button",{onClick:te,style:{backgroundColor:e.accent,color:e.accentText,border:"none",borderRadius:6,padding:"8px 16px",cursor:"pointer",fontSize:13},children:"Open Folder"})]})}),r==="search"&&E.jsx("div",{style:{padding:12},children:E.jsx(Ib,{theme:e})}),r==="functions"&&E.jsx(B,{}),r==="docList"&&E.jsx(kb,{theme:e}),r==="project"&&E.jsx("div",{style:{padding:16,color:e.textMuted,fontSize:13,textAlign:"center"},children:c?E.jsxs("div",{children:[E.jsxs("div",{style:{fontWeight:600,color:e.text,marginBottom:8},children:["Project: ",typeof c=="string"?c.split("/").pop():c]}),E.jsxs("div",{children:[s.length," items"]})]}):"No project opened. Open a folder to use the project panel."}),r==="clipboardHistory"&&E.jsx(Eb,{theme:e}),r==="charPanel"&&E.jsx(Ab,{theme:e}),r==="git"&&E.jsx(ye.Suspense,{fallback:E.jsx("div",{style:{padding:16,color:e.textMuted,fontSize:12},children:"Loading..."}),children:E.jsx(xb,{theme:e})}),r==="ai"&&E.jsx(ye.Suspense,{fallback:E.jsx("div",{style:{padding:16,color:e.textMuted,fontSize:12},children:"Loading..."}),children:E.jsx(_b,{theme:e})})]})]}),E.jsx("div",{className:`resizer ${j?"active":""}`,onMouseDown:W,style:{backgroundColor:j?e.accent:e.border}})]})]})}const kb=kt.memo(function({theme:r}){const{tabs:n,activeTabId:s,setActiveTab:c}=$e();return E.jsx("div",{style:{padding:4},children:n.map(u=>E.jsxs("div",{onClick:()=>c(u.id),style:{display:"flex",alignItems:"center",gap:6,padding:"5px 8px",cursor:"pointer",borderRadius:4,fontSize:13,color:u.id===s?r.text:r.sidebarText,backgroundColor:u.id===s?r.bgActive:"transparent"},children:[E.jsx("span",{style:{fontSize:10,color:u.isModified?r.accent:"transparent"},children:""}),E.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:u.name}),u.isPinned&&E.jsx("span",{style:{fontSize:10},children:""}),u.isReadOnly&&E.jsx("span",{style:{fontSize:10},children:""})]},u.id))})}),Eb=kt.memo(function({theme:r}){const{clipboardHistory:n}=$e();return E.jsxs("div",{style:{padding:8},children:[E.jsx("div",{style:{fontSize:11,color:r.textMuted,marginBottom:8,textTransform:"uppercase",letterSpacing:1},children:"Clipboard History"}),n.length===0?E.jsx("div",{style:{color:r.textMuted,fontSize:12,padding:8},children:"No clipboard entries yet"}):n.map((s,c)=>E.jsxs("div",{onClick:()=>navigator.clipboard.writeText(s.text),style:{padding:"6px 8px",cursor:"pointer",fontSize:12,color:r.sidebarText,borderRadius:4,borderBottom:`1px solid ${r.border}`,marginBottom:2},title:"Click to copy",children:[E.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontFamily:"monospace"},children:s.text.slice(0,100)}),E.jsx("div",{style:{fontSize:10,color:r.textMuted,marginTop:2},children:new Date(s.timestamp).toLocaleTimeString()})]},c))]})}),Ab=kt.memo(function({theme:r}){const{tabs:n,activeTabId:s}=$e(),c=n.find(S=>S.id===s),[u,g]=ye.useState(65),d=[{label:"Common Symbols",chars:""},{label:"Currency",chars:"$"},{label:"Greek",chars:""},{label:"Math",chars:""},{label:"Box Drawing",chars:""}],h=S=>{const _=Bd();_!==null&&_("insert-text",S)};return E.jsxs("div",{style:{padding:8},children:[E.jsx("div",{style:{fontSize:11,color:r.textMuted,marginBottom:8,textTransform:"uppercase",letterSpacing:1},children:"Character Panel"}),c!==void 0&&E.jsxs("div",{style:{fontSize:12,color:r.textSecondary,marginBottom:8,padding:"4px 0",borderBottom:`1px solid ${r.border}`},children:["Cursor pos: Ln ",c.cursorLine,", Col ",c.cursorColumn]}),E.jsxs("div",{style:{display:"flex",gap:4,marginBottom:8},children:[E.jsx("input",{type:"number",value:u,onChange:S=>g(parseInt(S.target.value)||0),style:{width:60,height:24,fontSize:12,backgroundColor:r.bg,color:r.text,border:`1px solid ${r.border}`,borderRadius:3,padding:"0 4px"}}),E.jsx("div",{style:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:r.bg,border:`1px solid ${r.border}`,borderRadius:3,fontFamily:"monospace",fontSize:14,color:r.accent},children:String.fromCharCode(u)}),E.jsx("button",{onClick:()=>h(String.fromCharCode(u)),style:{height:24,fontSize:11,backgroundColor:r.accent,color:r.accentText,border:"none",borderRadius:3,padding:"0 8px",cursor:"pointer"},children:"Insert"})]}),d.map((S,_)=>E.jsxs("div",{style:{marginBottom:8},children:[E.jsx("div",{style:{fontSize:11,color:r.textMuted,marginBottom:4},children:S.label}),E.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:2},children:S.chars.split("").map((x,R)=>E.jsx("div",{onClick:()=>h(x),title:`U+${x.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")}`,style:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",fontSize:13,fontFamily:"monospace",backgroundColor:r.bg,border:`1px solid ${r.border}`,borderRadius:2,cursor:"pointer",color:r.text},children:x},R))})]},_))]})}),Ib=kt.memo(function({theme:r}){const[n,s]=ye.useState(""),[c,u]=ye.useState([]),g=()=>{const d=$e.getState().tabs,h=[];for(const S of d)S.content.split(`
`).forEach((x,R)=>{x.toLowerCase().includes(n.toLowerCase())&&h.push({file:S.name,line:R+1,text:x.trim()})});u(h)};return E.jsxs("div",{children:[E.jsx("div",{style:{display:"flex",gap:6},children:E.jsx("input",{type:"text",placeholder:"Search in files...",value:n,onChange:d=>s(d.target.value),onKeyDown:d=>d.key==="Enter"&&g(),style:{flex:1,height:28,backgroundColor:r.bg,color:r.text,border:`1px solid ${r.border}`,borderRadius:4,padding:"0 8px",fontSize:13}})}),0<c.length&&E.jsxs("div",{style:{marginTop:8},children:[E.jsxs("div",{style:{fontSize:12,color:r.textMuted,marginBottom:4},children:[c.length," results"]}),c.map((d,h)=>E.jsxs("div",{className:"hover-bg hover-bg-reset",style:{padding:"4px 8px",fontSize:12,color:r.sidebarText,cursor:"pointer",borderRadius:4,"--hover-bg":r.bgHover},children:[E.jsxs("div",{style:{color:r.accent,fontSize:11},children:[d.file,":",d.line]}),E.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:d.text})]},h))]})]})});function Cb(e){var s;const r=(s=e.split(".").pop())==null?void 0:s.toLowerCase();return{js:"",jsx:"",ts:"",tsx:"",py:"",rb:"",go:"",rs:"",html:"",css:"",json:"",md:"",txt:"",svg:""}[r||""]||""}function Tb(e,r){const n=[],s=e.split(`
`),c={javascript:[/function\s+(\w+)/,/(?:const|let|var)\s+(\w+)\s*=\s*(?:async\s+)?(?:\([^)]*\)|(\w+))\s*=>/,/(\w+)\s*\([^)]*\)\s*\{/],typescript:[/function\s+(\w+)/,/(?:const|let|var)\s+(\w+)\s*=\s*(?:async\s+)?(?:\([^)]*\)|(\w+))\s*=>/,/(\w+)\s*\([^)]*\)\s*(?::\s*\w+)?\s*\{/],python:[/def\s+(\w+)/,/class\s+(\w+)/],ruby:[/def\s+(\w+)/,/class\s+(\w+)/],go:[/func\s+(?:\(\w+\s+\*?\w+\)\s+)?(\w+)/],rust:[/fn\s+(\w+)/,/struct\s+(\w+)/,/impl\s+(\w+)/],java:[/(?:public|private|protected|static|\s)+[\w<>\[\]]+\s+(\w+)\s*\(/],c:[/(?:void|int|char|float|double|long|short|unsigned|\w+)\s+(\w+)\s*\(/],cpp:[/(?:void|int|char|float|double|long|short|unsigned|\w+)\s+(\w+)\s*\(/],csharp:[/(?:public|private|protected|internal|static|\s)+[\w<>\[\]]+\s+(\w+)\s*\(/],swift:[/func\s+(\w+)/,/class\s+(\w+)/,/struct\s+(\w+)/],php:[/function\s+(\w+)/,/class\s+(\w+)/]},u=c[r]||c.javascript||[];return s.forEach((g,d)=>{for(const h of u){const S=g.match(h);if(S&&S[1]){const _=S[1];["if","else","for","while","switch","catch","return","new"].includes(_)||n.push({name:_,line:d+1});break}}}),n}async function xh(e,r=0){if(r>nm)return[];const n=[];for await(const s of e.values()){if(s.name.startsWith(".")||s.name==="node_modules")continue;const c=s.kind==="file"?s:void 0,u=s.kind==="directory"?s:void 0,g={name:s.name,path:s.name,isDirectory:s.kind==="directory",isExpanded:!1,handle:c};u&&(g.children=await xh(u,r+1)),n.push(g)}return n.sort((s,c)=>s.isDirectory&&!c.isDirectory?-1:!s.isDirectory&&c.isDirectory?1:s.name.localeCompare(c.name))}function Rb({theme:e}){const{findReplaceMode:r,searchOptions:n,updateSearchOptions:s,setShowFindReplace:c}=$e(),u=ye.useRef(null),[g,d]=ye.useState(0),[h,S]=ye.useState(0),[_,x]=ye.useState(1);ye.useEffect(()=>{var B,J;(B=u.current)==null||B.focus(),(J=u.current)==null||J.select()},[r]);const R=ye.useCallback(B=>{y(n.query,B,n)},[n]),y=(B,J,N)=>{document.dispatchEvent(new CustomEvent("notemac-find",{detail:{query:B,direction:J,isCaseSensitive:N.isCaseSensitive,isWholeWord:N.isWholeWord,isRegex:N.isRegex}}))},j=()=>R("next"),X=()=>R("prev"),L=()=>{document.dispatchEvent(new CustomEvent("notemac-replace",{detail:{find:n.query,replace:n.replaceText,all:!1,...n}}))},F=()=>{document.dispatchEvent(new CustomEvent("notemac-replace",{detail:{find:n.query,replace:n.replaceText,all:!0,...n}}))},U=()=>{document.dispatchEvent(new CustomEvent("notemac-mark",{detail:{...n,style:_}}))},G=()=>{document.dispatchEvent(new CustomEvent("notemac-clear-marks",{}))},W=B=>{B.key==="Enter"&&(B.preventDefault(),B.shiftKey?X():j()),B.key==="Escape"&&c(!1)},te=({active:B,onClick:J,title:N,children:ce})=>E.jsx("button",{title:N,"aria-label":N,onClick:J,style:{background:B?e.accent:"transparent",color:B?e.accentText:e.textSecondary,border:`1px solid ${B?e.accent:e.border}`,borderRadius:4,padding:"2px 6px",cursor:"pointer",fontSize:12,fontWeight:B?600:400,minWidth:28,height:24,display:"flex",alignItems:"center",justifyContent:"center"},children:ce}),Z=({onClick:B,title:J,children:N,primary:ce})=>E.jsx("button",{title:J,"aria-label":J,onClick:B,style:{background:ce?e.accent:"transparent",color:ce?e.accentText:e.textSecondary,border:`1px solid ${ce?e.accent:e.border}`,borderRadius:4,padding:"2px 8px",cursor:"pointer",fontSize:12,height:24,display:"flex",alignItems:"center",justifyContent:"center"},children:N}),z=[{key:"find",label:"Find"},{key:"replace",label:"Replace"},{key:"findInFiles",label:"Find in Files"},{key:"mark",label:"Mark"}];return E.jsxs("div",{style:{backgroundColor:e.findBg,borderBottom:`1px solid ${e.border}`,padding:"8px 12px",display:"flex",flexDirection:"column",gap:6,flexShrink:0},children:[E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:4},children:[z.map(B=>E.jsx("span",{onClick:()=>$e.getState().setShowFindReplace(!0,B.key),style:{fontSize:12,fontWeight:r===B.key?600:400,color:r===B.key?e.accent:e.textSecondary,cursor:"pointer",borderBottom:r===B.key?`2px solid ${e.accent}`:"none",paddingBottom:2},children:B.label},B.key)),E.jsx("div",{style:{flex:1}}),E.jsx("button",{"aria-label":"Close find and replace",onClick:()=>c(!1),style:{cursor:"pointer",color:e.textMuted,fontSize:16,padding:"0 4px",backgroundColor:"transparent",border:"none",display:"flex",alignItems:"center",justifyContent:"center"},children:""})]}),E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[E.jsx("input",{ref:u,type:"text",placeholder:"Find...",value:n.query,onChange:B=>s({query:B.target.value}),onKeyDown:W,style:{flex:1,height:28,backgroundColor:e.bg,color:e.text,border:`1px solid ${e.border}`,borderRadius:4,padding:"0 8px",fontSize:13}}),E.jsx(te,{active:n.isCaseSensitive,onClick:()=>s({isCaseSensitive:!n.isCaseSensitive}),title:"Match Case",children:"Aa"}),E.jsx(te,{active:n.isWholeWord,onClick:()=>s({isWholeWord:!n.isWholeWord}),title:"Whole Word",children:"W"}),E.jsx(te,{active:n.isRegex,onClick:()=>s({isRegex:!n.isRegex}),title:"Use Regular Expression",children:".*"}),E.jsx(Z,{onClick:X,title:"Previous Match (Shift+Enter)",children:""}),E.jsx(Z,{onClick:j,title:"Next Match (Enter)",children:""})]}),(r==="replace"||r==="findInFiles")&&E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[E.jsx("input",{type:"text",placeholder:"Replace...",value:n.replaceText,onChange:B=>s({replaceText:B.target.value}),onKeyDown:W,style:{flex:1,height:28,backgroundColor:e.bg,color:e.text,border:`1px solid ${e.border}`,borderRadius:4,padding:"0 8px",fontSize:13}}),E.jsx(Z,{onClick:L,title:"Replace",children:"Replace"}),E.jsx(Z,{onClick:F,title:"Replace All",primary:!0,children:"Replace All"})]}),r==="mark"&&E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[E.jsx("span",{style:{fontSize:12,color:e.textSecondary},children:"Style:"}),[1,2,3,4,5].map(B=>E.jsx("div",{onClick:()=>x(B),style:{width:24,height:20,borderRadius:3,backgroundColor:Eg[B],border:_===B?"2px solid white":`1px solid ${e.border}`,cursor:"pointer",opacity:_===B?1:.6,display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,color:"#fff",fontWeight:700},children:B},B)),E.jsx("div",{style:{flex:1}}),E.jsx(Z,{onClick:U,title:"Mark All",primary:!0,children:"Mark All"}),E.jsx(Z,{onClick:G,title:"Clear All Marks",children:"Clear Marks"})]}),E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,fontSize:12,color:e.textSecondary},children:[E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,cursor:"pointer"},children:[E.jsx("input",{type:"checkbox",checked:n.wrapAround,onChange:B=>s({wrapAround:B.target.checked}),style:{accentColor:e.accent}}),"Wrap around"]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,cursor:"pointer"},children:[E.jsx("input",{type:"checkbox",checked:n.searchInSelection,onChange:B=>s({searchInSelection:B.target.checked}),style:{accentColor:e.accent}}),"In selection"]})]})]})}function Ob({theme:e}){const{addTab:r,recentFiles:n,setActiveTab:s}=$e(),u=navigator.platform.includes("Mac")?"":"Ctrl";return E.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:e.editorBg,gap:24},children:[E.jsxs("div",{style:{textAlign:"center"},children:[E.jsx("div",{style:{fontSize:64,fontWeight:200,color:e.textMuted,letterSpacing:-2,marginBottom:8},children:"N++"}),E.jsx("h1",{style:{fontSize:28,fontWeight:300,color:e.textSecondary,marginBottom:4},children:"Notemac++"}),E.jsx("p",{style:{color:e.textMuted,fontSize:14},children:"A powerful text editor for Mac & Web"})]}),E.jsxs("div",{style:{display:"flex",gap:12,marginTop:8},children:[E.jsx(hs,{theme:e,label:"New File",shortcut:`${u}N`,onClick:()=>r()}),E.jsx(hs,{theme:e,label:"Open File",shortcut:`${u}O`,onClick:()=>{window.electronAPI||Pb().then(g=>{g&&r({name:g.name,content:g.content,language:hr(g.name),lineEnding:Er(g.content)})})}}),E.jsx(hs,{theme:e,label:"Open Folder",onClick:async()=>{if("showDirectoryPicker"in window)try{const g=await window.showDirectoryPicker();$e.getState().setSidebarPanel("explorer")}catch{}}})]}),E.jsxs("div",{style:{marginTop:24,padding:24,backgroundColor:e.bgSecondary,borderRadius:12,border:`1px solid ${e.border}`,width:400},children:[E.jsx("div",{style:{fontSize:12,fontWeight:600,color:e.textSecondary,textTransform:"uppercase",letterSpacing:1,marginBottom:12},children:"Keyboard Shortcuts"}),E.jsx("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr",gap:"8px 16px",fontSize:13},children:[[`${u}N`,"New file"],[`${u}O`,"Open file"],[`${u}S`,"Save"],[`${u}F`,"Find"],[`${u}H`,"Find & Replace"],[`${u}G`,"Go to line"],[`${u}D`,"Duplicate line"],[`${u}B`,"Toggle sidebar"],[`${u},`,"Preferences"]].map(([g,d],h)=>E.jsxs(kt.Fragment,{children:[E.jsx("kbd",{style:{backgroundColor:e.bgTertiary,color:e.textSecondary,padding:"2px 8px",borderRadius:4,fontSize:12,fontFamily:"-apple-system, system-ui, sans-serif",border:`1px solid ${e.border}`,textAlign:"center",minWidth:60},children:g}),E.jsx("span",{style:{color:e.textSecondary},children:d})]},h))})]}),n.length>0&&E.jsxs("div",{style:{marginTop:8},children:[E.jsx("div",{style:{fontSize:12,fontWeight:600,color:e.textSecondary,textTransform:"uppercase",letterSpacing:1,marginBottom:8},children:"Recent Files"}),n.slice(0,5).map((g,d)=>E.jsxs("div",{onClick:async()=>{if(window.electronAPI){const h=await window.electronAPI.readFile(g.path);r({name:g.name,path:g.path,content:h,language:hr(g.name),lineEnding:Er(h)})}},className:"hover-bg hover-bg-reset",style:{padding:"6px 12px",cursor:"pointer",color:e.accent,fontSize:13,borderRadius:4,"--hover-bg":e.bgHover},children:[g.name,E.jsx("span",{style:{color:e.textMuted,fontSize:11,marginLeft:8},children:g.path})]},d))]})]})}function hs({theme:e,label:r,shortcut:n,onClick:s}){const[c,u]=kt.useState(!1);return E.jsxs("button",{onClick:s,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6,padding:"12px 20px",backgroundColor:c?e.bgHover:e.bgSecondary,color:e.text,border:`1px solid ${e.border}`,borderRadius:8,cursor:"pointer",fontSize:13,transition:"background-color 0.15s ease",minWidth:110},children:[E.jsx("span",{children:r}),n&&E.jsx("span",{style:{fontSize:11,color:e.textMuted},children:n})]})}async function Pb(){if("showOpenFilePicker"in window)try{const[e]=await window.showOpenFilePicker({multiple:!1}),r=await e.getFile(),n=await r.text();return{name:r.name,content:n}}catch{return null}return new Promise(e=>{const r=document.createElement("input");r.type="file",r.onchange=async n=>{var u;const s=(u=n.target.files)==null?void 0:u[0];if(!s){e(null);return}const c=await s.text();e({name:s.name,content:c})},r.click()})}function Mb(e,r,n){const s=ye.useRef(null);ye.useEffect(()=>{if(!r||!e.current)return;s.current=document.activeElement;const c=e.current,u='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])',g=c.querySelector(u);g==null||g.focus();const d=h=>{if(h.key==="Escape"){h.preventDefault(),n==null||n();return}if(h.key!=="Tab")return;const S=c.querySelectorAll(u);if(S.length===0)return;const _=S[0],x=S[S.length-1];h.shiftKey?document.activeElement===_&&(h.preventDefault(),x.focus()):document.activeElement===x&&(h.preventDefault(),_.focus())};return c.addEventListener("keydown",d),()=>{var h;c.removeEventListener("keydown",d),(h=s.current)==null||h.focus()}},[r,e,n])}const jb=1200*1e3,vd="notemac_feedback_shown_version",xd="2.3.0";function Bb({theme:e}){const[r,n]=ye.useState(!1),[s,c]=ye.useState(null),u=ye.useRef(null);if(ye.useEffect(()=>{if(localStorage.getItem(vd)===xd)return;const R=setTimeout(()=>{n(!0),localStorage.setItem(vd,xd)},jb);return()=>clearTimeout(R)},[]),Mb(u,r,()=>n(!1)),!r)return null;const g="I've been using Notemac++ and it's an awesome text editor for Mac & Web! Check it out:",d="https://sergioadevita.github.io/notemac-plus-plus/",h=encodeURIComponent("Check out Notemac++!"),S=encodeURIComponent(`Hey!

${g}
${d}

Give it a try!`),_=[{id:"github",label:"Open an issue",sublabel:"Report bugs or request features",icon:E.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:e.text,children:E.jsx("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})}),href:"https://github.com/sergioadevita/notemac-plus-plus/issues/new",color:e.bgTertiary,textColor:e.text,borderColor:e.border},{id:"twitter",label:"Share on X",sublabel:"Tell the world about it",icon:E.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"#fff",children:E.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),href:`https://twitter.com/intent/tweet?text=${encodeURIComponent(g)}&url=${encodeURIComponent(d)}`,color:"#000",textColor:"#fff",borderColor:"#333"},{id:"email",label:"Share via email",sublabel:"Send to a friend",icon:E.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:e.accent,children:E.jsx("path",{d:"M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})}),href:`mailto:?subject=${h}&body=${S}`,color:e.bgTertiary,textColor:e.text,borderColor:e.border},{id:"donate",label:"Buy me a coffee",sublabel:"Support development",icon:E.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"#fff",children:E.jsx("path",{d:"M23.881 8.948c-.773-4.085-4.859-4.593-4.859-4.593H.723c-.604 0-.679.798-.679.798s-.082 7.324-.022 11.822c.164 2.424 2.586 2.672 2.586 2.672s8.267-.023 11.966-.049c2.438-.426 2.683-2.566 2.658-3.734 4.352.24 7.422-2.831 6.649-6.916zm-11.062 3.511c-1.246 1.453-4.011 3.976-4.011 3.976s-.121.119-.31.023c-.076-.057-.108-.09-.108-.09-.443-.441-3.368-3.049-4.034-3.954-.709-.965-1.041-2.7-.091-3.71.951-1.01 3.005-1.086 4.363.407 0 0 1.565-1.782 3.468-.963 1.904.82 1.832 3.011.723 4.311zm6.173.478c-.928.116-1.682.028-1.682.028V7.284h1.77s1.971.551 1.971 2.638c0 1.913-.985 2.667-2.059 3.015z"})}),href:"https://ko-fi.com/sergioadevita",color:"#FF5E5B",textColor:"#fff",borderColor:"#FF5E5B"}];return E.jsx("div",{className:"dialog-overlay",onClick:()=>n(!1),style:{zIndex:Od},children:E.jsxs("div",{ref:u,role:"dialog","aria-modal":"true","aria-labelledby":"feedback-title",onClick:x=>x.stopPropagation(),style:{backgroundColor:e.bgSecondary,border:`1px solid ${e.border}`,borderRadius:16,padding:32,width:440,boxShadow:"0 12px 48px rgba(0,0,0,0.5)",textAlign:"center",animation:"feedbackSlideIn 0.4s ease-out"},children:[E.jsx("style",{children:`
                    @keyframes feedbackSlideIn {
                        from { opacity: 0; transform: translateY(30px) scale(0.95); }
                        to { opacity: 1; transform: translateY(0) scale(1); }
                    }
                `}),E.jsx("div",{style:{fontSize:48,marginBottom:8},children:""}),E.jsx("h2",{id:"feedback-title",style:{color:e.text,fontSize:22,fontWeight:700,marginBottom:8},children:"Hey, you're still here!"}),E.jsxs("p",{style:{color:e.textSecondary,fontSize:14,lineHeight:1.6,marginBottom:8,padding:"0 8px"},children:["You've been coding for 20 minutes straight  that's either dedication or a really nasty bug. Either way, we're glad you're using ",E.jsx("span",{style:{color:e.accent,fontWeight:600},children:"Notemac++"}),"!"]}),E.jsx("p",{style:{color:e.textMuted,fontSize:13,marginBottom:24},children:"If this octopus has been helpful, here are some ways to spread the love:"}),E.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10,marginBottom:24},children:_.map(x=>{let R=s===x.id;return E.jsxs("a",{href:x.href,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",alignItems:"center",gap:12,backgroundColor:x.color,color:x.textColor,border:`1px solid ${x.borderColor}`,borderRadius:10,padding:"10px 16px",textDecoration:"none",transition:"all 0.2s ease",transform:R?"translateX(4px)":"none",opacity:R?.9:1},onMouseEnter:()=>c(x.id),onMouseLeave:()=>c(null),children:[E.jsx("div",{style:{flexShrink:0},children:x.icon}),E.jsxs("div",{style:{textAlign:"left"},children:[E.jsx("div",{style:{fontWeight:600,fontSize:14},children:x.label}),E.jsx("div",{style:{fontSize:11,opacity:.7},children:x.sublabel})]})]},x.id)})}),E.jsx("button",{onClick:()=>n(!1),className:"hover-color",style:{backgroundColor:"transparent",color:e.textMuted,border:"none",cursor:"pointer",fontSize:13,padding:"6px 16px",transition:"color 0.2s","--hover-color":e.text},children:"Maybe later  I'm in the zone"})]})})}class Rt extends ye.Component{constructor(n){super(n);$l(this,"handleRetry",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,s){}render(){var n;return this.state.hasError?E.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:32,gap:12,color:"#b0b0b0",fontFamily:"system-ui, sans-serif",fontSize:13,height:"100%"},children:[E.jsx("div",{style:{fontSize:18,fontWeight:600,color:"#e06c75"},children:this.props.fallbackMessage||"Something went wrong"}),E.jsx("div",{style:{maxWidth:400,textAlign:"center",lineHeight:1.5},children:((n=this.state.error)==null?void 0:n.message)||"An unexpected error occurred in this panel."}),E.jsx("button",{onClick:this.handleRetry,style:{marginTop:8,padding:"6px 16px",backgroundColor:"#3d3d3d",color:"#d4d4d4",border:"1px solid #555",borderRadius:4,cursor:"pointer",fontSize:12},children:"Retry"})]}):this.props.children}}const Fb=ye.lazy(()=>Ot(()=>import("./SettingsDialogViewPresenter-Bgi08qAW.js"),__vite__mapDeps([5,1,2,3]),import.meta.url).then(e=>({default:e.SettingsDialog}))),Db=ye.lazy(()=>Ot(()=>import("./GoToLineDialogViewPresenter-DK0S00Ob.js"),__vite__mapDeps([6,1,2,3]),import.meta.url).then(e=>({default:e.GoToLineDialog}))),Lb=ye.lazy(()=>Ot(()=>import("./AboutDialogViewPresenter-DQnO7Cpz.js"),__vite__mapDeps([7,1,2,3]),import.meta.url).then(e=>({default:e.AboutDialog}))),$b=ye.lazy(()=>Ot(()=>import("./RunCommandDialogViewPresenter-TLreVKQf.js"),__vite__mapDeps([8,1,2,3]),import.meta.url).then(e=>({default:e.RunCommandDialog}))),Nb=ye.lazy(()=>Ot(()=>import("./ColumnEditorDialogViewPresenter-pMSLjWlv.js"),__vite__mapDeps([9,1,2,3]),import.meta.url).then(e=>({default:e.ColumnEditorDialog}))),Ub=ye.lazy(()=>Ot(()=>import("./SummaryDialogViewPresenter-DM1qmkCY.js"),__vite__mapDeps([10,1,2,3]),import.meta.url).then(e=>({default:e.SummaryDialog}))),zb=ye.lazy(()=>Ot(()=>import("./CharInRangeDialogViewPresenter-CHc4tc67.js"),__vite__mapDeps([11,1,2,3]),import.meta.url).then(e=>({default:e.CharInRangeDialog}))),Gb=ye.lazy(()=>Ot(()=>import("./ShortcutMapperDialogViewPresenter-Tda-K9uL.js"),__vite__mapDeps([12,13,1,2,3]),import.meta.url).then(e=>({default:e.ShortcutMapperDialog}))),Hb=ye.lazy(()=>Ot(()=>import("./CommandPaletteViewPresenter-BXq7FT3D.js"),__vite__mapDeps([14,13,15,1,2,3]),import.meta.url).then(e=>({default:e.CommandPaletteViewPresenter}))),qb=ye.lazy(()=>Ot(()=>import("./QuickOpenViewPresenter-Avre4FEf.js"),__vite__mapDeps([16,15,1,2,3]),import.meta.url).then(e=>({default:e.QuickOpenViewPresenter}))),Wb=ye.lazy(()=>Ot(()=>import("./DiffViewerViewPresenter-C5dtgy5a.js"),__vite__mapDeps([17,1,2,3]),import.meta.url).then(e=>({default:e.DiffViewerViewPresenter}))),Vb=ye.lazy(()=>Ot(()=>import("./SnippetManagerViewPresenter-CJxcUO3B.js"),__vite__mapDeps([18,1,2,3]),import.meta.url).then(e=>({default:e.SnippetManagerViewPresenter}))),Zb=ye.lazy(()=>Ot(()=>import("./TerminalPanelViewPresenter-VzX45gUQ.js"),__vite__mapDeps([19,1,2,3]),import.meta.url).then(e=>({default:e.TerminalPanelViewPresenter}))),Kb=ye.lazy(()=>Ot(()=>import("./CloneRepositoryViewPresenter-CNz6IQ0m.js"),__vite__mapDeps([20,2,3,1]),import.meta.url).then(e=>({default:e.CloneRepositoryViewPresenter}))),Xb=ye.lazy(()=>Ot(()=>import("./GitSettingsViewPresenter-hXAslM7L.js"),__vite__mapDeps([21,1,2,3]),import.meta.url).then(e=>({default:e.GitSettingsViewPresenter}))),Yb=ye.lazy(()=>Ot(()=>import("./AISettingsViewPresenter-CUp2ClSD.js"),__vite__mapDeps([22,1,2,3]),import.meta.url).then(e=>({default:e.AISettingsViewPresenter})));function Jb(){const e=$e(ae=>ae.tabs),r=$e(ae=>ae.activeTabId);$e(ae=>ae.sidebarPanel);const n=$e(ae=>ae.showStatusBar),s=$e(ae=>ae.showToolbar),c=$e(ae=>ae.settings),u=$e(ae=>ae.showFindReplace),g=$e(ae=>ae.showSettings),d=$e(ae=>ae.showGoToLine),h=$e(ae=>ae.showAbout),S=$e(ae=>ae.showRunCommand),_=$e(ae=>ae.showColumnEditor),x=$e(ae=>ae.showSummary),R=$e(ae=>ae.showCharInRange),y=$e(ae=>ae.showShortcutMapper),j=$e(ae=>ae.showCommandPalette),X=$e(ae=>ae.showQuickOpen),L=$e(ae=>ae.showDiffViewer),F=$e(ae=>ae.showSnippetManager),U=$e(ae=>ae.showTerminalPanel),G=$e(ae=>ae.showCloneDialog),W=$e(ae=>ae.showGitSettings),te=$e(ae=>ae.showAiSettings),Z=$e(ae=>ae.splitView),z=$e(ae=>ae.splitTabId),B=$e(ae=>ae.addTab),J=$e(ae=>ae.zoomLevel),N=ye.useMemo(()=>Dm(c.theme),[c.theme]),ce=ye.useCallback(ae=>{$m(ae,r,J)},[r,J]);ye.useEffect(()=>(window.addEventListener("keydown",ce),()=>window.removeEventListener("keydown",ce)),[ce]),ye.useEffect(()=>(document.addEventListener("dragover",td),document.addEventListener("drop",rd),()=>{document.removeEventListener("dragover",td),document.removeEventListener("drop",rd)}),[]),ye.useEffect(()=>{Ny()},[]);const oe=ye.useCallback((ae,ie)=>{Fd(ae,r,e,J,ie)},[r,J,e]);ye.useEffect(()=>{e.length===0&&B({name:"new 1",content:""})},[]),ye.useEffect(()=>{$e.getState().LoadAIState()},[]);const de=e.find(ae=>ae.id===r),ne=c.distractionFreeMode,me=!!window.electronAPI;return E.jsxs("div",{className:"notemac-app",style:{backgroundColor:N.bg,color:N.text,fontSize:c.fontSize+J},children:[me&&!ne&&E.jsx("div",{style:{height:38,backgroundColor:N.menuBg,borderBottom:`1px solid ${N.border}`,display:"flex",alignItems:"center",paddingLeft:78,flexShrink:0,WebkitAppRegion:"drag"},children:E.jsxs("span",{style:{fontWeight:600,fontSize:13,color:N.text,opacity:.7,WebkitAppRegion:"no-drag",userSelect:"none"},children:[de?de.name+(de.isModified?" ":"")+"  ":"","Notemac++"]})}),!ne&&!me&&E.jsx(Hy,{theme:N,onAction:oe,isElectron:me}),s&&!ne&&E.jsx(qy,{theme:N,onAction:oe}),!ne&&E.jsx(Wy,{theme:N}),E.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[!ne&&E.jsx(Sb,{theme:N}),E.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[u&&E.jsx(Rb,{theme:N}),E.jsx("div",{style:{flex:1,display:"flex",flexDirection:Z==="horizontal"?"column":"row",overflow:"hidden"},children:de?E.jsxs(E.Fragment,{children:[E.jsx(Rt,{fallbackMessage:"Editor panel encountered an error",children:E.jsx(yd,{tab:de,theme:N,settings:c,zoomLevel:J},de.id)}),Z!=="none"&&z&&E.jsxs(E.Fragment,{children:[E.jsx("div",{style:{width:Z==="vertical"?4:void 0,height:Z==="horizontal"?4:void 0,backgroundColor:N.border,cursor:Z==="vertical"?"col-resize":"row-resize"}}),E.jsx(Rt,{fallbackMessage:"Split editor panel encountered an error",children:E.jsx(yd,{tab:e.find(ae=>ae.id===z)||de,theme:N,settings:c,zoomLevel:J},z+"-split")})]})]}):E.jsx(Ob,{theme:N})}),U&&E.jsx(Rt,{fallbackMessage:"Terminal panel failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(Zb,{theme:N})})})]})]}),n&&!ne&&E.jsx(vb,{theme:N}),g&&E.jsx(Rt,{fallbackMessage:"Settings failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(Fb,{theme:N})})}),d&&E.jsx(Rt,{fallbackMessage:"Go to Line dialog failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(Db,{theme:N})})}),h&&E.jsx(Rt,{fallbackMessage:"About dialog failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(Lb,{theme:N})})}),S&&E.jsx(Rt,{fallbackMessage:"Run Command dialog failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx($b,{theme:N})})}),_&&E.jsx(Rt,{fallbackMessage:"Column Editor dialog failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(Nb,{theme:N})})}),x&&E.jsx(Rt,{fallbackMessage:"Summary dialog failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(Ub,{theme:N})})}),R&&E.jsx(Rt,{fallbackMessage:"Char in Range dialog failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(zb,{theme:N})})}),y&&E.jsx(Rt,{fallbackMessage:"Shortcut Mapper dialog failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(Gb,{theme:N})})}),j&&E.jsx(Rt,{fallbackMessage:"Command Palette failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(Hb,{theme:N})})}),X&&E.jsx(Rt,{fallbackMessage:"Quick Open failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(qb,{theme:N})})}),L&&E.jsx(Rt,{fallbackMessage:"Diff Viewer failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(Wb,{theme:N})})}),F&&E.jsx(Rt,{fallbackMessage:"Snippet Manager failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(Vb,{theme:N})})}),G&&E.jsx(Rt,{fallbackMessage:"Clone Repository dialog failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(Kb,{theme:N})})}),W&&E.jsx(Rt,{fallbackMessage:"Git Settings failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(Xb,{theme:N})})}),te&&E.jsx(Rt,{fallbackMessage:"AI Settings failed to load",children:E.jsx(ye.Suspense,{fallback:null,children:E.jsx(Yb,{theme:N})})}),E.jsx(Bb,{theme:N})]})}Jp.createRoot(document.getElementById("root")).render(E.jsx(kt.StrictMode,{children:E.jsx(Jb,{})}));export{mb as $,Bv as A,Nv as B,Ps as C,lr as D,Gv as E,$v as F,$y as G,Fd as H,oh as I,Tv as J,Ly as K,Dv as L,Lv as M,Xt as N,Mv as O,Fv as P,Pv as Q,kt as R,$n as S,zv as T,ov as U,Ov as V,jv as W,lv as X,uv as Y,fv as Z,dv as _,Mb as a,sv as a0,ub as a1,Bd as a2,gv as a3,Cv as a4,Od as b,yb as c,av as d,iv as e,Hv as f,Ar as g,Rv as h,rh as i,E as j,qr as k,rv as l,yi as m,nv as n,Td as o,St as p,zi as q,ye as r,Aa as s,pm as t,$e as u,cv as v,Uv as w,hv as x,xi as y,pv as z};
