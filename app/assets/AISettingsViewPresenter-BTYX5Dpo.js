import{u as Q,r as l,T as Z,g as ee,y as te,j as t,z as se,B as oe}from"./index-BLISzHqN.js";import"./react-vendor-P8ZuH1e3.js";import"./monaco-editor-BYMRfcD5.js";function ie({theme:s}){var F;const{providers:x,credentials:I,activeProviderId:j,activeModelId:K,aiSettings:i,SetActiveProvider:U,SetActiveModel:M,SetCredentialForProvider:L,RemoveCredentialForProvider:W,UpdateAISettings:c,AddProvider:H,RemoveProvider:N,SetShowAiSettings:z,SetAiEnabled:O,isRefreshingModels:R,RefreshProviderModels:_}=Q(),[p,V]=l.useState("providers"),[f,A]=l.useState({}),[v,P]=l.useState(""),[C,S]=l.useState(null),[g,X]=l.useState(()=>{const e={};for(const o of I)e[o.providerId]=o.apiKey;return e}),[y,Y]=l.useState(()=>{const e={};for(const o of I)e[o.providerId]=o.rememberKey;return e}),w=l.useMemo(()=>x.filter(e=>!e.isBuiltIn),[x]),[h,B]=l.useState(""),[b,E]=l.useState(""),q=l.useCallback(e=>{const o=g[e]||"",a=y[e]??!0;0<o.length?(L(e,o,a),O(!0)):W(e)},[g,y]),G=l.useCallback(async e=>{const o=x.find(u=>u.id===e),a=g[e];if(!o||!a)return;A(u=>({...u,[e]:{testing:!0}}));const m=await Z(o,{providerId:e,apiKey:a,rememberKey:y[e]??!0});A(u=>({...u,[e]:{testing:!1,result:m.success?"Connected!":`Error: ${m.error}`}}))},[x,g,y]),J=l.useCallback(()=>{if(h.trim().length===0||b.trim().length===0)return;const e="custom-"+ee(),o=oe("default","Default Model",e),a=te(e,h.trim(),b.trim(),[o]);H(a),B(""),E("")},[h,b]),d={width:"100%",height:28,backgroundColor:s.bg,color:s.text,border:`1px solid ${s.border}`,borderRadius:4,padding:"0 8px",fontSize:12,boxSizing:"border-box"},n={fontSize:11,color:s.textSecondary,marginBottom:4,display:"block"},r={marginBottom:16};return t.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:e=>{e.target===e.currentTarget&&z(!1)},children:t.jsxs("div",{style:{width:520,maxHeight:"80vh",backgroundColor:s.sidebarBg,borderRadius:10,border:`1px solid ${s.border}`,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderBottom:`1px solid ${s.border}`},children:[t.jsx("span",{style:{fontSize:14,fontWeight:600,color:s.text},children:"AI Settings"}),t.jsx("button",{onClick:()=>z(!1),style:{background:"none",border:"none",color:s.textMuted,cursor:"pointer",fontSize:16},children:"✕"})]}),t.jsx("div",{style:{display:"flex",borderBottom:`1px solid ${s.border}`,padding:"0 16px"},children:["providers","completion","chat","custom"].map(e=>t.jsx("button",{onClick:()=>V(e),style:{padding:"8px 12px",fontSize:12,color:p===e?s.accent:s.textMuted,background:"none",border:"none",borderBottom:`2px solid ${p===e?s.accent:"transparent"}`,cursor:"pointer",textTransform:"capitalize"},children:e},e))}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:16},children:[p==="providers"&&t.jsxs("div",{children:[t.jsxs("div",{style:r,children:[t.jsx("label",{style:n,children:"Active Provider"}),t.jsx("select",{value:j,onChange:e=>U(e.target.value),style:d,children:x.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))})]}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:n,children:"Active Model"}),t.jsxs("div",{style:{display:"flex",gap:6},children:[t.jsx("select",{value:K,onChange:e=>M(e.target.value),style:{...d,flex:1},children:(F=x.find(e=>e.id===j))==null?void 0:F.models.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))}),t.jsx("button",{onClick:async()=>{S(null);const e=await _(j);S(e?"Models updated":"Failed — check API key"),e&&setTimeout(()=>S(null),3e3)},disabled:R,title:"Fetch latest models from provider API",style:{height:28,padding:"0 10px",fontSize:11,border:`1px solid ${s.border}`,borderRadius:4,cursor:"pointer",backgroundColor:s.bgHover,color:s.text,whiteSpace:"nowrap"},children:R?"Fetching...":"↻ Refresh"})]}),C&&t.jsx("div",{style:{marginTop:4,fontSize:11,color:C.startsWith("Models")?"#4caf50":"#ff6b6b"},children:C})]}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:n,children:"Custom Model ID (override)"}),t.jsxs("div",{style:{display:"flex",gap:6},children:[t.jsx("input",{type:"text",value:v,onChange:e=>P(e.target.value),placeholder:"e.g., gpt-5.3-codex",style:{...d,flex:1}}),t.jsx("button",{onClick:()=>{0<v.trim().length&&(M(v.trim()),P(""))},disabled:v.trim().length===0,style:{height:28,padding:"0 10px",fontSize:11,border:"none",borderRadius:4,cursor:"pointer",backgroundColor:s.accent,color:s.accentText},children:"Use"})]}),t.jsx("div",{style:{fontSize:10,color:s.textMuted,marginTop:4},children:"Type any model ID to use it directly, even if it's not in the dropdown."})]}),t.jsx("div",{style:{fontSize:12,fontWeight:600,color:s.text,marginBottom:8,marginTop:16},children:"API Keys"}),x.map(e=>{var o,a,m,u,$,D;return t.jsxs("div",{style:{marginBottom:12,padding:10,backgroundColor:s.bg,borderRadius:6,border:`1px solid ${s.border}`},children:[t.jsx("div",{style:{fontSize:12,fontWeight:600,color:s.text,marginBottom:6},children:e.name}),t.jsx("input",{type:"password",placeholder:`Enter ${e.name} API key...`,value:g[e.id]||"",onChange:k=>X(T=>({...T,[e.id]:k.target.value})),style:{...d,marginBottom:6}}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[t.jsxs("div",{children:[t.jsxs("label",{style:{fontSize:11,color:s.textMuted,display:"flex",alignItems:"center",gap:4,cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:y[e.id]??!1,onChange:k=>Y(T=>({...T,[e.id]:k.target.checked}))}),"Remember key (encrypted)"]}),y[e.id]&&t.jsxs("div",{style:{marginTop:2,fontSize:10,color:"#f9e2af",backgroundColor:"#f9e2af15",padding:"2px 6px",borderRadius:3},children:["Key will be encrypted and stored locally. Expires after ",se,"h."]})]}),t.jsx("div",{style:{flex:1}}),t.jsx("button",{onClick:()=>G(e.id),disabled:!((o=g[e.id])!=null&&o.length),style:{height:24,padding:"0 8px",fontSize:11,border:`1px solid ${s.border}`,borderRadius:4,cursor:"pointer",backgroundColor:s.bgHover,color:s.text},children:(a=f[e.id])!=null&&a.testing?"Testing...":"Test"}),t.jsx("button",{onClick:()=>q(e.id),style:{height:24,padding:"0 8px",fontSize:11,border:"none",borderRadius:4,cursor:"pointer",backgroundColor:s.accent,color:s.accentText},children:"Save"})]}),((m=f[e.id])==null?void 0:m.result)&&t.jsx("div",{style:{marginTop:4,fontSize:11,color:($=(u=f[e.id])==null?void 0:u.result)!=null&&$.startsWith("Connected")?"#4caf50":"#ff6b6b"},children:(D=f[e.id])==null?void 0:D.result})]},e.id)})]}),p==="completion"&&t.jsxs("div",{children:[t.jsx("div",{style:r,children:t.jsxs("label",{style:{...n,display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:i.inlineCompletionEnabled,onChange:e=>c({inlineCompletionEnabled:e.target.checked})}),"Enable inline code completions (ghost text)"]})}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:n,children:"Debounce delay (ms)"}),t.jsx("input",{type:"number",value:i.inlineDebounceMs,onChange:e=>c({inlineDebounceMs:parseInt(e.target.value)||500}),min:100,max:3e3,step:100,style:d})]}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:n,children:"Max inline tokens"}),t.jsx("input",{type:"number",value:i.inlineMaxTokens,onChange:e=>c({inlineMaxTokens:parseInt(e.target.value)||256}),min:32,max:1024,step:32,style:d})]}),t.jsxs("div",{style:r,children:[t.jsxs("label",{style:n,children:["Code temperature (",i.codeTemperature,")"]}),t.jsx("input",{type:"range",value:i.codeTemperature,onChange:e=>c({codeTemperature:parseFloat(e.target.value)}),min:0,max:1,step:.05,style:{width:"100%"}})]})]}),p==="chat"&&t.jsxs("div",{children:[t.jsxs("div",{style:r,children:[t.jsxs("label",{style:n,children:["Chat temperature (",i.chatTemperature,")"]}),t.jsx("input",{type:"range",value:i.chatTemperature,onChange:e=>c({chatTemperature:parseFloat(e.target.value)}),min:0,max:1,step:.05,style:{width:"100%"}})]}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:n,children:"Max context tokens"}),t.jsx("input",{type:"number",value:i.maxContextTokens,onChange:e=>c({maxContextTokens:parseInt(e.target.value)||8e3}),min:1e3,max:128e3,step:1e3,style:d})]}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:n,children:"Custom system prompt (optional)"}),t.jsx("textarea",{value:i.systemPrompt,onChange:e=>c({systemPrompt:e.target.value}),placeholder:"Leave empty for default",rows:4,style:{...d,height:"auto",resize:"vertical",fontFamily:"inherit",padding:"6px 8px"}})]}),t.jsx("div",{style:r,children:t.jsxs("label",{style:{...n,display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:i.showAiStatusIndicator,onChange:e=>c({showAiStatusIndicator:e.target.checked})}),"Show AI status indicator in status bar"]})})]}),p==="custom"&&t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:12,color:s.textMuted,marginBottom:12},children:"Add custom OpenAI-compatible providers (e.g., Ollama, LM Studio, vLLM)."}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:n,children:"Provider Name"}),t.jsx("input",{type:"text",value:h,onChange:e=>B(e.target.value),placeholder:"e.g., Ollama Local",style:d})]}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:n,children:"Base URL"}),t.jsx("input",{type:"text",value:b,onChange:e=>E(e.target.value),placeholder:"e.g., http://localhost:11434",style:d})]}),t.jsx("button",{onClick:J,disabled:h.trim().length===0||b.trim().length===0,style:{height:30,padding:"0 16px",fontSize:12,border:"none",borderRadius:4,cursor:"pointer",backgroundColor:s.accent,color:s.accentText,marginBottom:16},children:"Add Provider"}),0<w.length&&t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:12,fontWeight:600,color:s.text,marginBottom:8},children:"Custom Providers"}),w.map(e=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 8px",backgroundColor:s.bg,borderRadius:4,marginBottom:4,border:`1px solid ${s.border}`},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:12,color:s.text},children:e.name}),t.jsx("div",{style:{fontSize:10,color:s.textMuted},children:e.baseUrl})]}),t.jsx("button",{onClick:()=>N(e.id),style:{background:"none",border:"none",color:"#ff6b6b",cursor:"pointer",fontSize:12},children:"✕"})]},e.id))]})]})]})]})})}export{ie as AISettingsViewPresenter};
