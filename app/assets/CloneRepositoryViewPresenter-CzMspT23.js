const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-DZ2o6UUv.js","./react-vendor-P8ZuH1e3.js","./monaco-editor-BYMRfcD5.js","./monaco-editor-C3yYqDe4.css","./index-Bi9SWdzs.css"])))=>i.map(i=>d[i]);
import{_ as $}from"./monaco-editor-BYMRfcD5.js";import{u as l,r as n,g as U,C as O,e as m,h as T,I as _,j as e,i as E}from"./index-DZ2o6UUv.js";import"./react-vendor-P8ZuH1e3.js";function H({theme:o}){var S;const C=l(r=>r.setShowCloneDialog),s=l(r=>r.gitCredentials),k=l(r=>r.isGitOperationInProgress),p=l(r=>r.gitOperationProgress),w=l(r=>r.gitOperationError),[t,R]=n.useState(""),[x,z]=n.useState(!1),[u,P]=n.useState((s==null?void 0:s.username)||""),[h,I]=n.useState((s==null?void 0:s.token)||""),[d,A]=n.useState(!1),[y,F]=n.useState(""),g=E(),a=g==="webfs"||g==="electron",c=n.useCallback(()=>{C(!1)},[C]),W=n.useCallback(async()=>{var v;if(t.trim().length===0)return;const r=l.getState(),j=x?{type:"token",username:u,token:h}:s;try{if(d||!a){const i=U(),b=y||((v=t.split("/").pop())==null?void 0:v.replace(".git",""))||"cloned-repo",f=O(i);await m(t.trim(),f,"/",j),r.AddBrowserWorkspace({id:i,name:b,repoUrl:t.trim(),createdAt:Date.now(),lastOpenedAt:Date.now()}),r.SetIsBrowserWorkspace(!0),r.setWorkspacePath(b),r.setSidebarPanel("explorer")}else if(g==="webfs"){const i=await window.showDirectoryPicker({mode:"readwrite"}),{CreateWebFsAdapter:b}=await $(async()=>{const{CreateWebFsAdapter:B}=await import("./index-DZ2o6UUv.js").then(D=>D.a3);return{CreateWebFsAdapter:B}},__vite__mapDeps([0,1,2,3,4]),import.meta.url),f=b(i);T(i.name,i),await m(t.trim(),f,"/",j),r.setWorkspacePath(i.name),r.setSidebarPanel("explorer")}await _(),c()}catch{}},[t,x,u,h,s,d,a,g,y,c]);return e.jsx("div",{onClick:c,style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{onClick:r=>r.stopPropagation(),style:{width:480,backgroundColor:o.bg,border:`1px solid ${o.border}`,borderRadius:8,boxShadow:"0 8px 32px rgba(0,0,0,0.4)",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"12px 16px",borderBottom:`1px solid ${o.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:14,fontWeight:600,color:o.text},children:"Clone Repository"}),e.jsx("span",{onClick:c,style:{cursor:"pointer",color:o.textMuted,fontSize:18},children:"✕"})]}),e.jsxs("div",{style:{padding:16,display:"flex",flexDirection:"column",gap:12},children:[w!==null&&e.jsx("div",{style:{padding:"8px 12px",backgroundColor:"#f38ba822",borderRadius:4,fontSize:12,color:"#f38ba8"},children:w}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:o.textSecondary,display:"block",marginBottom:4},children:"Repository URL"}),e.jsx("input",{autoFocus:!0,value:t,onChange:r=>R(r.target.value),placeholder:"https://github.com/user/repo.git",style:{width:"100%",height:32,backgroundColor:o.bgSecondary,color:o.text,border:`1px solid ${o.border}`,borderRadius:4,padding:"0 10px",fontSize:13,boxSizing:"border-box"}})]}),a&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("input",{type:"checkbox",checked:d,onChange:r=>A(r.target.checked),id:"clone-to-browser"}),e.jsx("label",{htmlFor:"clone-to-browser",style:{fontSize:12,color:o.textSecondary},children:"Clone to browser workspace (stored in browser only)"})]}),(d||!a)&&e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:o.textSecondary,display:"block",marginBottom:4},children:"Workspace Name"}),e.jsx("input",{value:y,onChange:r=>F(r.target.value),placeholder:((S=t.split("/").pop())==null?void 0:S.replace(".git",""))||"my-repo",style:{width:"100%",height:32,backgroundColor:o.bgSecondary,color:o.text,border:`1px solid ${o.border}`,borderRadius:4,padding:"0 10px",fontSize:13,boxSizing:"border-box"}})]}),!a&&e.jsx("div",{style:{padding:"8px 12px",backgroundColor:"#f9e2af22",borderRadius:4,fontSize:11,color:"#f9e2af"},children:"⚠ Your browser doesn't support the File System Access API. The repository will be cloned to browser storage. Files may be lost if you clear browser data."}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("input",{type:"checkbox",checked:x,onChange:r=>z(r.target.checked),id:"custom-auth"}),e.jsx("label",{htmlFor:"custom-auth",style:{fontSize:12,color:o.textSecondary},children:s!==null?"Use different credentials":"Authenticate"})]}),x&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,paddingLeft:24},children:[e.jsx("input",{value:u,onChange:r=>P(r.target.value),placeholder:"Username",style:{height:28,backgroundColor:o.bgSecondary,color:o.text,border:`1px solid ${o.border}`,borderRadius:4,padding:"0 8px",fontSize:12,boxSizing:"border-box"}}),e.jsx("input",{type:"password",value:h,onChange:r=>I(r.target.value),placeholder:"Personal Access Token",style:{height:28,backgroundColor:o.bgSecondary,color:o.text,border:`1px solid ${o.border}`,borderRadius:4,padding:"0 8px",fontSize:12,boxSizing:"border-box"}})]})]}),k&&e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:11,color:o.textMuted,marginBottom:4},children:["Cloning... ",0<p?`${p}%`:""]}),e.jsx("div",{style:{height:4,backgroundColor:o.border,borderRadius:2,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",backgroundColor:o.accent,borderRadius:2,width:`${0<p?p:30}%`,transition:"width 0.3s"}})})]})]}),e.jsxs("div",{style:{padding:"12px 16px",borderTop:`1px solid ${o.border}`,display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{onClick:c,style:{height:30,padding:"0 16px",backgroundColor:o.bgHover,color:o.text,border:`1px solid ${o.border}`,borderRadius:4,cursor:"pointer",fontSize:12},children:"Cancel"}),e.jsx("button",{onClick:W,disabled:t.trim().length===0||k,style:{height:30,padding:"0 16px",backgroundColor:o.accent,color:o.accentText,border:"none",borderRadius:4,cursor:t.trim().length===0?"not-allowed":"pointer",fontSize:12,fontWeight:600,opacity:t.trim().length===0?.5:1},children:a&&!d?"Choose Folder & Clone":"Clone"})]})]})})}export{H as CloneRepositoryViewPresenter};
