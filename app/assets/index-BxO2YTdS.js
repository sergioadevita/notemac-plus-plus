const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/GitStatusController-782ohgNT.js","assets/react-vendor-P8ZuH1e3.js","assets/monaco-editor-C1KnpKkb.js","assets/monaco-editor-DyN27ZSr.css","assets/GitBranchController-69ZAEWuh.js","assets/GitLogController-C6_nDoQD.js","assets/event-DjZVAIBO.js","assets/core-DhEqZVGG.js","assets/GitPanelViewPresenter-U97URLKD.js","assets/AIChatPanelViewPresenter-QQO-Pyw0.js","assets/SettingsDialogViewPresenter-DQWIDYnf.js","assets/GoToLineDialogViewPresenter-DdsH5dtI.js","assets/AboutDialogViewPresenter-DhmC-Jro.js","assets/RunCommandDialogViewPresenter-BJSo9dcw.js","assets/ColumnEditorDialogViewPresenter-U1TwFX7v.js","assets/SummaryDialogViewPresenter-BnGX-acx.js","assets/CharInRangeDialogViewPresenter-BLSEdTmA.js","assets/ShortcutMapperDialogViewPresenter-T5E-Jq2W.js","assets/ShortcutConfig-CNB-8NLK.js","assets/CommandPaletteViewPresenter-D5P1hFUk.js","assets/FuzzySearchHelpers-xz3AmAn2.js","assets/QuickOpenViewPresenter-C06pwhgD.js","assets/DiffViewerViewPresenter-FYk0Odf8.js","assets/SnippetManagerViewPresenter-DdqlM2Pj.js","assets/TerminalPanelViewPresenter-DGli9hCS.js","assets/CloneRepositoryViewPresenter-BbAa0Mt6.js","assets/GitSettingsViewPresenter-BGGbzp7U.js","assets/AISettingsViewPresenter-riVwtWzT.js"])))=>i.map(i=>d[i]);
var Yp=Object.defineProperty;var Jp=(e,n,r)=>n in e?Yp(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r;var Dl=(e,n,r)=>Jp(e,typeof n!="symbol"?n+"":n,r);import{r as Bi,g as qn,a as Qp,c as Ii,b as eg}from"./react-vendor-P8ZuH1e3.js";import{_ as ht}from"./monaco-editor-C1KnpKkb.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const p of u.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function r(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(c){if(c.ep)return;c.ep=!0;const u=r(c);fetch(c.href,u)}})();var ua={exports:{}},Pn={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ll;function tg(){if(Ll)return Pn;Ll=1;var e=Bi(),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,c=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function p(f,h,x){var _,y={},O=null,R=null;x!==void 0&&(O=""+x),h.key!==void 0&&(O=""+h.key),h.ref!==void 0&&(R=h.ref);for(_ in h)o.call(h,_)&&!u.hasOwnProperty(_)&&(y[_]=h[_]);if(f&&f.defaultProps)for(_ in h=f.defaultProps,h)y[_]===void 0&&(y[_]=h[_]);return{$$typeof:n,type:f,key:O,ref:R,props:y,_owner:c.current}}return Pn.Fragment=r,Pn.jsx=p,Pn.jsxs=p,Pn}var $l;function rg(){return $l||($l=1,ua.exports=tg()),ua.exports}var E=rg(),fe=Bi();const St=qn(fe);var di={},Nl;function ng(){if(Nl)return di;Nl=1;var e=Qp();return di.createRoot=e.createRoot,di.hydrateRoot=e.hydrateRoot,di}var ig=ng();const ag=qn(ig),og={},Ul=e=>{let n;const r=new Set,o=(_,y)=>{const O=typeof _=="function"?_(n):_;if(!Object.is(O,n)){const R=n;n=y??(typeof O!="object"||O===null)?O:Object.assign({},n,O),r.forEach(z=>z(n,R))}},c=()=>n,h={setState:o,getState:c,getInitialState:()=>x,subscribe:_=>(r.add(_),()=>r.delete(_)),destroy:()=>{r.clear()}},x=n=e(o,c,h);return h},sg=e=>e?Ul(e):Ul;var fa={exports:{}},da={},ha={exports:{}},pa={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zl;function cg(){if(zl)return pa;zl=1;var e=Bi();function n(y,O){return y===O&&(y!==0||1/y===1/O)||y!==y&&O!==O}var r=typeof Object.is=="function"?Object.is:n,o=e.useState,c=e.useEffect,u=e.useLayoutEffect,p=e.useDebugValue;function f(y,O){var R=O(),z=o({inst:{value:R,getSnapshot:O}}),N=z[0].inst,L=z[1];return u(function(){N.value=R,N.getSnapshot=O,h(N)&&L({inst:N})},[y,R,O]),c(function(){return h(N)&&L({inst:N}),y(function(){h(N)&&L({inst:N})})},[y]),p(R),R}function h(y){var O=y.getSnapshot;y=y.value;try{var R=O();return!r(y,R)}catch{return!0}}function x(y,O){return O()}var _=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?x:f;return pa.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:_,pa}var Gl;function lg(){return Gl||(Gl=1,ha.exports=cg()),ha.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hl;function ug(){if(Hl)return da;Hl=1;var e=Bi(),n=lg();function r(x,_){return x===_&&(x!==0||1/x===1/_)||x!==x&&_!==_}var o=typeof Object.is=="function"?Object.is:r,c=n.useSyncExternalStore,u=e.useRef,p=e.useEffect,f=e.useMemo,h=e.useDebugValue;return da.useSyncExternalStoreWithSelector=function(x,_,y,O,R){var z=u(null);if(z.current===null){var N={hasValue:!1,value:null};z.current=N}else N=z.current;z=f(function(){function D(Y){if(!U){if(U=!0,G=Y,Y=O(Y),R!==void 0&&N.hasValue){var B=N.value;if(R(B,Y))return X=B}return X=Y}if(B=X,o(G,Y))return B;var K=O(Y);return R!==void 0&&R(B,K)?(G=Y,B):(G=Y,X=K)}var U=!1,G,X,q=y===void 0?null:y;return[function(){return D(_())},q===null?void 0:function(){return D(q())}]},[_,y,O,R]);var L=c(x,z[0],z[1]);return p(function(){N.hasValue=!0,N.value=L},[L]),h(L),L},da}var Wl;function fg(){return Wl||(Wl=1,fa.exports=ug()),fa.exports}var dg=fg();const hg=qn(dg),gd={},{useDebugValue:pg}=St,{useSyncExternalStoreWithSelector:gg}=hg;let ql=!1;const mg=e=>e;function wg(e,n=mg,r){(gd?"production":void 0)!=="production"&&r&&!ql&&(ql=!0);const o=gg(e.subscribe,e.getState,e.getServerState||e.getInitialState,n,r);return pg(o),o}const yg=e=>{const n=typeof e=="function"?sg(e):e,r=(o,c)=>wg(n,o,c);return Object.assign(r,n),r},bg=e=>yg;var md=Symbol.for("immer-nothing"),Vl=Symbol.for("immer-draftable"),qt=Symbol.for("immer-state");function nr(e,...n){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var zn=Object.getPrototypeOf;function on(e){return!!e&&!!e[qt]}function Dr(e){var n;return e?wd(e)||Array.isArray(e)||!!e[Vl]||!!((n=e.constructor)!=null&&n[Vl])||Vn(e)||Di(e):!1}var vg=Object.prototype.constructor.toString(),Kl=new WeakMap;function wd(e){if(!e||typeof e!="object")return!1;const n=Object.getPrototypeOf(e);if(n===null||n===Object.prototype)return!0;const r=Object.hasOwnProperty.call(n,"constructor")&&n.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let o=Kl.get(r);return o===void 0&&(o=Function.toString.call(r),Kl.set(r,o)),o===vg}function Ai(e,n,r=!0){Fi(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(c=>{n(c,e[c],e)}):e.forEach((o,c)=>n(c,o,e))}function Fi(e){const n=e[qt];return n?n.type_:Array.isArray(e)?1:Vn(e)?2:Di(e)?3:0}function us(e,n){return Fi(e)===2?e.has(n):Object.prototype.hasOwnProperty.call(e,n)}function yd(e,n,r){const o=Fi(e);o===2?e.set(n,r):o===3?e.add(r):e[n]=r}function xg(e,n){return e===n?e!==0||1/e===1/n:e!==e&&n!==n}function Vn(e){return e instanceof Map}function Di(e){return e instanceof Set}function jr(e){return e.copy_||e.base_}function fs(e,n){if(Vn(e))return new Map(e);if(Di(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=wd(e);if(n===!0||n==="class_only"&&!r){const o=Object.getOwnPropertyDescriptors(e);delete o[qt];let c=Reflect.ownKeys(o);for(let u=0;u<c.length;u++){const p=c[u],f=o[p];f.writable===!1&&(f.writable=!0,f.configurable=!0),(f.get||f.set)&&(o[p]={configurable:!0,writable:!0,enumerable:f.enumerable,value:e[p]})}return Object.create(zn(e),o)}else{const o=zn(e);if(o!==null&&r)return{...e};const c=Object.create(o);return Object.assign(c,e)}}function ws(e,n=!1){return Li(e)||on(e)||!Dr(e)||(Fi(e)>1&&Object.defineProperties(e,{set:hi,add:hi,clear:hi,delete:hi}),Object.freeze(e),n&&Object.values(e).forEach(r=>ws(r,!0))),e}function _g(){nr(2)}var hi={value:_g};function Li(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var Sg={};function Lr(e){const n=Sg[e];return n||nr(0,e),n}var Gn;function bd(){return Gn}function kg(e,n){return{drafts_:[],parent_:e,immer_:n,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Zl(e,n){n&&(Lr("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=n)}function ds(e){hs(e),e.drafts_.forEach(Eg),e.drafts_=null}function hs(e){e===Gn&&(Gn=e.parent_)}function Xl(e){return Gn=kg(Gn,e)}function Eg(e){const n=e[qt];n.type_===0||n.type_===1?n.revoke_():n.revoked_=!0}function Yl(e,n){n.unfinalizedDrafts_=n.drafts_.length;const r=n.drafts_[0];return e!==void 0&&e!==r?(r[qt].modified_&&(ds(n),nr(4)),Dr(e)&&(e=Ci(n,e),n.parent_||Ti(n,e)),n.patches_&&Lr("Patches").generateReplacementPatches_(r[qt].base_,e,n.patches_,n.inversePatches_)):e=Ci(n,r,[]),ds(n),n.patches_&&n.patchListener_(n.patches_,n.inversePatches_),e!==md?e:void 0}function Ci(e,n,r){if(Li(n))return n;const o=e.immer_.shouldUseStrictIteration(),c=n[qt];if(!c)return Ai(n,(u,p)=>Jl(e,c,n,u,p,r),o),n;if(c.scope_!==e)return n;if(!c.modified_)return Ti(e,c.base_,!0),c.base_;if(!c.finalized_){c.finalized_=!0,c.scope_.unfinalizedDrafts_--;const u=c.copy_;let p=u,f=!1;c.type_===3&&(p=new Set(u),u.clear(),f=!0),Ai(p,(h,x)=>Jl(e,c,u,h,x,r,f),o),Ti(e,u,!1),r&&e.patches_&&Lr("Patches").generatePatches_(c,r,e.patches_,e.inversePatches_)}return c.copy_}function Jl(e,n,r,o,c,u,p){if(c==null||typeof c!="object"&&!p)return;const f=Li(c);if(!(f&&!p)){if(on(c)){const h=u&&n&&n.type_!==3&&!us(n.assigned_,o)?u.concat(o):void 0,x=Ci(e,c,h);if(yd(r,o,x),on(x))e.canAutoFreeze_=!1;else return}else p&&r.add(c);if(Dr(c)&&!f){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||n&&n.base_&&n.base_[o]===c&&f)return;Ci(e,c),(!n||!n.scope_.parent_)&&typeof o!="symbol"&&(Vn(r)?r.has(o):Object.prototype.propertyIsEnumerable.call(r,o))&&Ti(e,c)}}}function Ti(e,n,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&ws(n,r)}function Ig(e,n){const r=Array.isArray(e),o={type_:r?1:0,scope_:n?n.scope_:bd(),modified_:!1,finalized_:!1,assigned_:{},parent_:n,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let c=o,u=ys;r&&(c=[o],u=Hn);const{revoke:p,proxy:f}=Proxy.revocable(c,u);return o.draft_=f,o.revoke_=p,f}var ys={get(e,n){if(n===qt)return e;const r=jr(e);if(!us(r,n))return Ag(e,r,n);const o=r[n];return e.finalized_||!Dr(o)?o:o===ga(e.base_,n)?(ma(e),e.copy_[n]=gs(o,e)):o},has(e,n){return n in jr(e)},ownKeys(e){return Reflect.ownKeys(jr(e))},set(e,n,r){const o=vd(jr(e),n);if(o!=null&&o.set)return o.set.call(e.draft_,r),!0;if(!e.modified_){const c=ga(jr(e),n),u=c==null?void 0:c[qt];if(u&&u.base_===r)return e.copy_[n]=r,e.assigned_[n]=!1,!0;if(xg(r,c)&&(r!==void 0||us(e.base_,n)))return!0;ma(e),ps(e)}return e.copy_[n]===r&&(r!==void 0||n in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[n])||(e.copy_[n]=r,e.assigned_[n]=!0),!0},deleteProperty(e,n){return ga(e.base_,n)!==void 0||n in e.base_?(e.assigned_[n]=!1,ma(e),ps(e)):delete e.assigned_[n],e.copy_&&delete e.copy_[n],!0},getOwnPropertyDescriptor(e,n){const r=jr(e),o=Reflect.getOwnPropertyDescriptor(r,n);return o&&{writable:!0,configurable:e.type_!==1||n!=="length",enumerable:o.enumerable,value:r[n]}},defineProperty(){nr(11)},getPrototypeOf(e){return zn(e.base_)},setPrototypeOf(){nr(12)}},Hn={};Ai(ys,(e,n)=>{Hn[e]=function(){return arguments[0]=arguments[0][0],n.apply(this,arguments)}});Hn.deleteProperty=function(e,n){return Hn.set.call(this,e,n,void 0)};Hn.set=function(e,n,r){return ys.set.call(this,e[0],n,r,e[0])};function ga(e,n){const r=e[qt];return(r?jr(r):e)[n]}function Ag(e,n,r){var c;const o=vd(n,r);return o?"value"in o?o.value:(c=o.get)==null?void 0:c.call(e.draft_):void 0}function vd(e,n){if(!(n in e))return;let r=zn(e);for(;r;){const o=Object.getOwnPropertyDescriptor(r,n);if(o)return o;r=zn(r)}}function ps(e){e.modified_||(e.modified_=!0,e.parent_&&ps(e.parent_))}function ma(e){e.copy_||(e.copy_=fs(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Cg=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(n,r,o)=>{if(typeof n=="function"&&typeof r!="function"){const u=r;r=n;const p=this;return function(h=u,...x){return p.produce(h,_=>r.call(this,_,...x))}}typeof r!="function"&&nr(6),o!==void 0&&typeof o!="function"&&nr(7);let c;if(Dr(n)){const u=Xl(this),p=gs(n,void 0);let f=!0;try{c=r(p),f=!1}finally{f?ds(u):hs(u)}return Zl(u,o),Yl(c,u)}else if(!n||typeof n!="object"){if(c=r(n),c===void 0&&(c=n),c===md&&(c=void 0),this.autoFreeze_&&ws(c,!0),o){const u=[],p=[];Lr("Patches").generateReplacementPatches_(n,c,u,p),o(u,p)}return c}else nr(1,n)},this.produceWithPatches=(n,r)=>{if(typeof n=="function")return(p,...f)=>this.produceWithPatches(p,h=>n(h,...f));let o,c;return[this.produce(n,r,(p,f)=>{o=p,c=f}),o,c]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Dr(e)||nr(8),on(e)&&(e=Tg(e));const n=Xl(this),r=gs(e,void 0);return r[qt].isManual_=!0,hs(n),r}finishDraft(e,n){const r=e&&e[qt];(!r||!r.isManual_)&&nr(9);const{scope_:o}=r;return Zl(o,n),Yl(void 0,o)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,n){let r;for(r=n.length-1;r>=0;r--){const c=n[r];if(c.path.length===0&&c.op==="replace"){e=c.value;break}}r>-1&&(n=n.slice(r+1));const o=Lr("Patches").applyPatches_;return on(e)?o(e,n):this.produce(e,c=>o(c,n))}};function gs(e,n){const r=Vn(e)?Lr("MapSet").proxyMap_(e,n):Di(e)?Lr("MapSet").proxySet_(e,n):Ig(e,n);return(n?n.scope_:bd()).drafts_.push(r),r}function Tg(e){return on(e)||nr(10,e),xd(e)}function xd(e){if(!Dr(e)||Li(e))return e;const n=e[qt];let r,o=!0;if(n){if(!n.modified_)return n.base_;n.finalized_=!0,r=fs(e,n.scope_.immer_.useStrictShallowCopy_),o=n.scope_.immer_.shouldUseStrictIteration()}else r=fs(e,!0);return Ai(r,(c,u)=>{yd(r,c,xd(u))},o),n&&(n.finalized_=!1),r}var Rg=new Cg,et=Rg.produce;const Og={".js":"javascript",".jsx":"javascript",".ts":"typescript",".tsx":"typescript",".py":"python",".rb":"ruby",".go":"go",".rs":"rust",".c":"c",".h":"c",".cpp":"cpp",".cc":"cpp",".cxx":"cpp",".hpp":"cpp",".cs":"csharp",".java":"java",".swift":"swift",".kt":"kotlin",".php":"php",".html":"html",".htm":"html",".css":"css",".scss":"scss",".less":"less",".json":"json",".xml":"xml",".yaml":"yaml",".yml":"yaml",".md":"markdown",".sql":"sql",".sh":"shell",".bash":"shell",".zsh":"shell",".ps1":"powershell",".r":"r",".lua":"lua",".pl":"perl",".pm":"perl",".dart":"dart",".ex":"elixir",".exs":"elixir",".erl":"erlang",".hs":"haskell",".scala":"scala",".clj":"clojure",".coffee":"coffeescript",".bat":"bat",".cmd":"bat",".ini":"ini",".toml":"ini",".dockerfile":"dockerfile",".graphql":"graphql",".gql":"graphql",".vue":"html",".svelte":"html",".log":"plaintext",".txt":"plaintext",".env":"plaintext",".gitignore":"plaintext",".makefile":"plaintext"};function sr(e){if(!e)return"plaintext";const n=e.toLowerCase();if(n==="dockerfile")return"dockerfile";if(n==="makefile")return"makefile";if(n==="cmakelists.txt")return"cmake";const r=n.lastIndexOf(".");if(r===-1)return"plaintext";const o=n.substring(r);return Og[o]||"plaintext"}function br(e){const n=(e.match(/\r\n/g)||[]).length,r=(e.match(new RegExp("(?<!\\r)\\n","g"))||[]).length,o=(e.match(/\r(?!\n)/g)||[]).length;return n>=r&&n>=o?"CRLF":o>r?"CR":"LF"}function vr(){return Math.random().toString(36).substring(2,11)+Date.now().toString(36)}const Ql="3.0.0",pi="SavedSnippets",eu={1:"#ff4444",2:"#44ff44",3:"#4488ff",4:"#ff44ff",5:"#ffaa00"},tu={none:"transparent",color1:"#ff4444",color2:"#44bb44",color3:"#4488ff",color4:"#ff8800",color5:"#cc44cc"},Mg=14,Pg=4,jg="'SF Mono', 'Menlo', 'Monaco', 'Courier New', monospace",Bg=5e3,Fg="https://www.google.com/search?q=",Dg="yyyy-MM-dd HH:mm:ss",Lg=20,$g=20,Ng=50,Ug=-5,zg=10,Gg=200,Hg=100,Wg=600,gi="GitCredentials",wa="GitAuthor",ya="GitSettings",mi="BrowserWorkspaces",Ev=50,_d="https://cors.isomorphic-git.org",qg="Notemac++ User",Vg="user@notemac.app",ru="AIProviders",tr="AICredentials",ba="AISettings",nu="AIConversations",Sd=500,Kg=8e3,Zg=.3,Xg=.7,iu=50,Yg=256,wi=2e3,Jg=256,Qg=.3,em=72,kd="2023-06-01",yi=24,Iv=8,Av="Iv1.CONFIGURE_YOUR_APP",tm=150,rm=500,va=36,nm=100,im=200,au=18,am=32,om=300,Cv=560,Tv=420,Rv=80,sm=4,cm=9998,lm=9999,Ed=1e4,Ov=2e3,Mv=5,Pv=60,jv=3600,Bv=86400,Fv=604800,um=(e,n)=>({tabs:[],activeTabId:null,closedTabs:[],recentFiles:[],addTab:r=>{const o=vr(),c={id:o,name:(r==null?void 0:r.name)||`new ${n().tabs.length+1}`,path:(r==null?void 0:r.path)||null,content:(r==null?void 0:r.content)||"",originalContent:(r==null?void 0:r.content)||"",language:(r==null?void 0:r.language)||sr((r==null?void 0:r.name)||""),encoding:(r==null?void 0:r.encoding)||"utf-8",lineEnding:(r==null?void 0:r.lineEnding)||"LF",isModified:!1,isReadOnly:(r==null?void 0:r.isReadOnly)||!1,isPinned:!1,tabColor:"none",cursorLine:1,cursorColumn:1,scrollTop:0,bookmarks:[],marks:[],hiddenLines:[],isMonitoring:!1};return e(et(u=>{u.tabs.push(c),u.activeTabId=o})),o},closeTab:r=>{e(et(o=>{const c=o.tabs.findIndex(u=>u.id===r);if(c!==-1&&(o.closedTabs.push({...o.tabs[c]}),o.closedTabs.length>Lg&&o.closedTabs.shift(),o.tabs.splice(c,1),o.activeTabId===r))if(0<o.tabs.length){const u=Math.min(c,o.tabs.length-1);o.activeTabId=o.tabs[u].id}else o.activeTabId=null}))},closeAllTabs:()=>{const r=n().tabs;e(et(o=>{o.closedTabs.push(...r),o.tabs=[],o.activeTabId=null}))},closeOtherTabs:r=>{e(et(o=>{const c=o.tabs.filter(u=>u.id!==r);o.closedTabs.push(...c),o.tabs=o.tabs.filter(u=>u.id===r),o.activeTabId=r}))},closeTabsToLeft:r=>{e(et(o=>{const c=o.tabs.findIndex(p=>p.id===r);if(0>=c)return;const u=o.tabs.splice(0,c);o.closedTabs.push(...u)}))},closeTabsToRight:r=>{e(et(o=>{const c=o.tabs.findIndex(p=>p.id===r);if(c===-1||c>=o.tabs.length-1)return;const u=o.tabs.splice(c+1);o.closedTabs.push(...u)}))},closeUnchangedTabs:()=>{e(et(r=>{const o=r.tabs.filter(c=>!c.isModified);r.closedTabs.push(...o),r.tabs=r.tabs.filter(c=>c.isModified),0<r.tabs.length&&!r.tabs.find(c=>c.id===r.activeTabId)?r.activeTabId=r.tabs[0].id:r.tabs.length===0&&(r.activeTabId=null)}))},closeAllButPinned:()=>{e(et(r=>{const o=r.tabs.filter(c=>!c.isPinned);r.closedTabs.push(...o),r.tabs=r.tabs.filter(c=>c.isPinned),0<r.tabs.length&&!r.tabs.find(c=>c.id===r.activeTabId)?r.activeTabId=r.tabs[0].id:r.tabs.length===0&&(r.activeTabId=null)}))},restoreLastClosedTab:()=>{e(et(r=>{if(r.closedTabs.length===0)return;const o=r.closedTabs.pop();o.id=vr(),r.tabs.push(o),r.activeTabId=o.id}))},setActiveTab:r=>e({activeTabId:r}),updateTab:(r,o)=>{e(et(c=>{const u=c.tabs.find(p=>p.id===r);u&&Object.assign(u,o)}))},updateTabContent:(r,o)=>{e(et(c=>{const u=c.tabs.find(p=>p.id===r);u&&(u.content=o,u.isModified=o!==u.originalContent)}))},togglePinTab:r=>{e(et(o=>{const c=o.tabs.find(u=>u.id===r);c&&(c.isPinned=!c.isPinned)}))},setTabColor:(r,o)=>{e(et(c=>{const u=c.tabs.find(p=>p.id===r);u&&(u.tabColor=o)}))},moveTab:(r,o)=>{e(et(c=>{const[u]=c.tabs.splice(r,1);c.tabs.splice(o,0,u)}))},nextTab:()=>{const{tabs:r,activeTabId:o}=n();if(1>=r.length)return;const u=(r.findIndex(p=>p.id===o)+1)%r.length;e({activeTabId:r[u].id})},prevTab:()=>{const{tabs:r,activeTabId:o}=n();if(1>=r.length)return;const u=(r.findIndex(p=>p.id===o)-1+r.length)%r.length;e({activeTabId:r[u].id})},goToTab:r=>{const{tabs:o}=n();0<=r&&r<o.length&&e({activeTabId:o[r].id})},moveTabForward:()=>{const{tabs:r,activeTabId:o}=n(),c=r.findIndex(u=>u.id===o);c<r.length-1&&e(et(u=>{const[p]=u.tabs.splice(c,1);u.tabs.splice(c+1,0,p)}))},moveTabBackward:()=>{const{tabs:r,activeTabId:o}=n(),c=r.findIndex(u=>u.id===o);0<c&&e(et(u=>{const[p]=u.tabs.splice(c,1);u.tabs.splice(c-1,0,p)}))},addRecentFile:(r,o)=>{e(et(c=>{c.recentFiles=c.recentFiles.filter(u=>u.path!==r),c.recentFiles.unshift({path:r,name:o}),c.recentFiles.length>$g&&c.recentFiles.pop()}))}}),fm={query:"",replaceText:"",isRegex:!1,isCaseSensitive:!1,isWholeWord:!1,searchInSelection:!1,wrapAround:!0},dm=(e,n)=>({showFindReplace:!1,findReplaceMode:"find",searchOptions:{...fm},searchResults:[],showIncrementalSearch:!1,setShowFindReplace:(r,o)=>e({showFindReplace:r,findReplaceMode:o||n().findReplaceMode}),updateSearchOptions:r=>{e(o=>({searchOptions:{...o.searchOptions,...r}}))},setShowIncrementalSearch:r=>e({showIncrementalSearch:r})}),hm=(e,n)=>({isRecordingMacro:!1,currentMacroActions:[],savedMacros:[],startRecordingMacro:()=>e({isRecordingMacro:!0,currentMacroActions:[]}),stopRecordingMacro:()=>e({isRecordingMacro:!1}),addMacroAction:r=>{n().isRecordingMacro&&e(et(o=>{o.currentMacroActions.push(r)}))},saveMacro:r=>{const o=n().currentMacroActions;o.length!==0&&e(et(c=>{c.savedMacros.push({id:vr(),name:r,actions:[...o]})}))}}),pm={theme:"dark",fontSize:Mg,fontFamily:jg,tabSize:Pg,insertSpaces:!0,wordWrap:!1,showWhitespace:!1,showLineNumbers:!0,showMinimap:!0,showIndentGuides:!0,showEOL:!1,showNonPrintable:!1,showWrapSymbol:!1,autoSave:!1,autoSaveDelay:Bg,highlightCurrentLine:!0,matchBrackets:!0,autoCloseBrackets:!0,autoCloseQuotes:!0,autoIndent:!0,smoothScrolling:!0,cursorBlinking:"blink",cursorStyle:"line",renderWhitespace:"none",virtualSpace:!1,alwaysOnTop:!1,distractionFreeMode:!1,darkMode:!0,syncScrollVertical:!1,syncScrollHorizontal:!1,rememberLastSession:!0,searchEngine:Fg,dateTimeFormat:Dg};function gm(){return{...pm}}const mm=(e,n)=>({sidebarPanel:null,sidebarWidth:260,showStatusBar:!0,showToolbar:!0,splitView:"none",splitTabId:null,zoomLevel:0,foldAllState:!1,clipboardHistory:[],settings:gm(),showSettings:!1,showGoToLine:!1,showAbout:!1,showRunCommand:!1,showColumnEditor:!1,showSummary:!1,showCharInRange:!1,showShortcutMapper:!1,showCommandPalette:!1,showQuickOpen:!1,showDiffViewer:!1,showSnippetManager:!1,showTerminalPanel:!1,terminalHeight:Gg,showCloneDialog:!1,showGitSettings:!1,setSidebarPanel:r=>e({sidebarPanel:r}),toggleSidebar:()=>{const r=n().sidebarPanel;e({sidebarPanel:r?null:"explorer"})},setZoomLevel:r=>e({zoomLevel:Math.max(Ug,Math.min(zg,r))}),setSplitView:(r,o)=>e({splitView:r,splitTabId:o||null}),addClipboardEntry:r=>{e(et(o=>{o.clipboardHistory.unshift({text:r,timestamp:Date.now()}),o.clipboardHistory.length>Ng&&o.clipboardHistory.pop()}))},updateSettings:r=>{e(et(o=>{Object.assign(o.settings,r)}))},setShowSettings:r=>e({showSettings:r}),setShowGoToLine:r=>e({showGoToLine:r}),setShowAbout:r=>e({showAbout:r}),setShowRunCommand:r=>e({showRunCommand:r}),setShowColumnEditor:r=>e({showColumnEditor:r}),setShowSummary:r=>e({showSummary:r}),setShowCharInRange:r=>e({showCharInRange:r}),setShowShortcutMapper:r=>e({showShortcutMapper:r}),setShowCommandPalette:r=>e({showCommandPalette:r}),setShowQuickOpen:r=>e({showQuickOpen:r}),setShowDiffViewer:r=>e({showDiffViewer:r}),setShowSnippetManager:r=>e({showSnippetManager:r}),setShowTerminalPanel:r=>e({showTerminalPanel:r}),setShowCloneDialog:r=>e({showCloneDialog:r}),setShowGitSettings:r=>e({showGitSettings:r}),setTerminalHeight:r=>e({terminalHeight:Math.max(Hg,Math.min(Wg,r))}),saveSession:()=>{const r=n();return{tabs:r.tabs.map(o=>({path:o.path,name:o.name,language:o.language,cursorLine:o.cursorLine,cursorColumn:o.cursorColumn,scrollTop:o.scrollTop,content:o.path?void 0:o.content})),activeTabIndex:r.tabs.findIndex(o=>o.id===r.activeTabId),sidebarPanel:r.sidebarPanel}},loadSession:r=>{var c,u;const o=r.tabs.map(p=>({id:vr(),name:p.name,path:p.path,content:p.content||"",originalContent:p.content||"",language:p.language,encoding:"utf-8",lineEnding:"LF",isModified:!1,isReadOnly:!1,isPinned:!1,tabColor:"none",cursorLine:p.cursorLine,cursorColumn:p.cursorColumn,scrollTop:p.scrollTop,bookmarks:[],marks:[],hiddenLines:[],isMonitoring:!1}));e({tabs:o,activeTabId:((c=o[r.activeTabIndex])==null?void 0:c.id)||((u=o[0])==null?void 0:u.id)||null,sidebarPanel:r.sidebarPanel})}}),wm=e=>({fileTree:[],workspacePath:null,setFileTree:n=>e({fileTree:n}),setWorkspacePath:n=>e({workspacePath:n}),toggleTreeNode:n=>{e(et(r=>{const o=c=>{for(const u of c){if(u.path===n)return u.isExpanded=!u.isExpanded,!0;if(u.children&&o(u.children))return!0}return!1};o(r.fileTree)}))}});function ur(e,n){try{const r=localStorage.getItem(e);return r===null?n??null:JSON.parse(r)}catch{return null}}function jt(e,n){try{localStorage.setItem(e,JSON.stringify(n))}catch{}}function ym(e){try{localStorage.removeItem(e)}catch{}}const bm=(e,n)=>({savedSnippets:[],addSnippet:r=>{e(et(o=>{const c={...r,id:vr()};o.savedSnippets.push(c)})),jt(pi,n().savedSnippets)},removeSnippet:r=>{e(et(o=>{const c=o.savedSnippets.findIndex(u=>u.id===r);c!==-1&&o.savedSnippets.splice(c,1)})),jt(pi,n().savedSnippets)},updateSnippet:(r,o)=>{e(et(c=>{const u=c.savedSnippets.find(p=>p.id===r);u&&Object.assign(u,o)})),jt(pi,n().savedSnippets)},loadSnippets:()=>{const r=ur(pi);r&&e({savedSnippets:r})}});function ou(){return{autoFetch:!0,autoFetchInterval:3e5,showUntracked:!0,showIgnored:!1,corsProxy:_d}}function su(){return{name:qg,email:Vg}}const vm=(e,n)=>({isRepoInitialized:!1,currentBranch:"main",branches:[],remotes:[],gitStatus:null,commitLog:[],gitCredentials:null,gitAuthor:su(),gitSettings:ou(),isBrowserWorkspace:!1,browserWorkspaces:[],isGitOperationInProgress:!1,currentGitOperation:null,gitOperationProgress:0,gitOperationError:null,SetRepoInitialized:r=>e({isRepoInitialized:r}),SetCurrentBranch:r=>e({currentBranch:r}),SetBranches:r=>e({branches:r}),SetRemotes:r=>e({remotes:r}),SetGitStatus:r=>e({gitStatus:r}),SetCommitLog:r=>e({commitLog:r}),SetGitCredentials:r=>{e({gitCredentials:r}),r!==null?jt(gi,{type:r.type,username:r.username}):jt(gi,null)},SetGitAuthor:r=>{e({gitAuthor:r}),jt(wa,r)},UpdateGitSettings:r=>{e(et(c=>{Object.assign(c.gitSettings,r)}));const o=n().gitSettings;jt(ya,o)},SetIsBrowserWorkspace:r=>e({isBrowserWorkspace:r}),AddBrowserWorkspace:r=>{e(et(o=>{const c=o.browserWorkspaces.findIndex(u=>u.id===r.id);c!==-1?o.browserWorkspaces[c]=r:o.browserWorkspaces.push(r)})),jt(mi,n().browserWorkspaces)},RemoveBrowserWorkspace:r=>{e(et(o=>{const c=o.browserWorkspaces.findIndex(u=>u.id===r);c!==-1&&o.browserWorkspaces.splice(c,1)})),jt(mi,n().browserWorkspaces)},SetGitOperationInProgress:r=>e({isGitOperationInProgress:r}),SetCurrentGitOperation:r=>e({currentGitOperation:r}),SetGitOperationProgress:r=>e({gitOperationProgress:r}),SetGitOperationError:r=>e({gitOperationError:r}),LoadGitState:()=>{const r=ur(gi),o=ur(wa),c=ur(ya),u=ur(mi);e({gitCredentials:r||null,gitAuthor:o||su(),gitSettings:c||ou(),browserWorkspaces:u||[]})},SaveGitState:()=>{const r=n();r.gitCredentials!==null&&jt(gi,{type:r.gitCredentials.type,username:r.gitCredentials.username}),jt(wa,r.gitAuthor),jt(ya,r.gitSettings),jt(mi,r.browserWorkspaces)},GetStagedFileCount:()=>{var r;return((r=n().gitStatus)==null?void 0:r.stagedFiles.length)||0},GetChangedFileCount:()=>{const r=n().gitStatus;return r===null?0:r.stagedFiles.length+r.unstagedFiles.length+r.untrackedFiles.length}});function cu(){return{inlineCompletionEnabled:!0,inlineDebounceMs:Sd,inlineMaxTokens:Yg,chatTemperature:Xg,codeTemperature:Zg,maxContextTokens:Kg,systemPrompt:"",showAiStatusIndicator:!0}}function lu(){return[{id:"openai",name:"OpenAI",type:"openai",baseUrl:"https://api.openai.com",isBuiltIn:!0,models:xm()},{id:"anthropic",name:"Anthropic",type:"anthropic",baseUrl:"https://api.anthropic.com",isBuiltIn:!0,models:_m()},{id:"google",name:"Google AI",type:"google",baseUrl:"https://generativelanguage.googleapis.com",isBuiltIn:!0,models:Sm()}]}function xm(){return[{id:"gpt-5.2",name:"GPT-5.2",providerId:"openai",contextWindow:1047576,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-5.2-pro",name:"GPT-5.2 Pro",providerId:"openai",contextWindow:1047576,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-4.1",name:"GPT-4.1",providerId:"openai",contextWindow:1047576,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-4.1-mini",name:"GPT-4.1 Mini",providerId:"openai",contextWindow:1047576,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-4.1-nano",name:"GPT-4.1 Nano",providerId:"openai",contextWindow:1047576,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-4o",name:"GPT-4o",providerId:"openai",contextWindow:128e3,supportsStreaming:!0,supportsFIM:!1},{id:"gpt-4o-mini",name:"GPT-4o Mini",providerId:"openai",contextWindow:128e3,supportsStreaming:!0,supportsFIM:!1},{id:"o3",name:"o3",providerId:"openai",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1},{id:"o4-mini",name:"o4-mini",providerId:"openai",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1}]}function _m(){return[{id:"claude-opus-4-6",name:"Claude Opus 4.6",providerId:"anthropic",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1},{id:"claude-sonnet-4-6",name:"Claude Sonnet 4.6",providerId:"anthropic",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1},{id:"claude-opus-4-5-20251101",name:"Claude Opus 4.5",providerId:"anthropic",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1},{id:"claude-sonnet-4-5-20250929",name:"Claude Sonnet 4.5",providerId:"anthropic",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1},{id:"claude-haiku-4-5-20251001",name:"Claude Haiku 4.5",providerId:"anthropic",contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1}]}function Sm(){return[{id:"gemini-2.5-pro",name:"Gemini 2.5 Pro",providerId:"google",contextWindow:1048576,supportsStreaming:!0,supportsFIM:!1},{id:"gemini-2.5-flash",name:"Gemini 2.5 Flash",providerId:"google",contextWindow:1048576,supportsStreaming:!0,supportsFIM:!1},{id:"gemini-2.5-flash-lite",name:"Gemini 2.5 Flash Lite",providerId:"google",contextWindow:1048576,supportsStreaming:!0,supportsFIM:!1}]}function Dv(e,n,r,o){return{id:e,name:n,type:"custom",baseUrl:r,isBuiltIn:!1,models:o}}function Lv(e,n,r,o=8192){return{id:e,name:n,providerId:r,contextWindow:o,supportsStreaming:!0,supportsFIM:!1}}function Id(){return typeof window<"u"&&window.__TAURI__?"tauri":typeof window<"u"&&window.electronAPI?"electron":"web"}function km(){return Id()!=="web"}function Kn(){return Id()==="tauri"}function $i(){const e=window.electronAPI;return e==null||typeof e.safeStorageEncrypt!="function"?null:e}let bi=null;async function bs(){if(bi!==null)return bi;try{return bi=(await ht(()=>import("./core-DhEqZVGG.js"),[])).invoke,bi}catch{return null}}function Em(){return $i()!==null||Kn()}async function Im(){if(Kn())try{const n=await bs();return n===null?!1:await n("is_safe_storage_available")}catch{return!1}const e=$i();if(e===null)return!1;try{return await e.isSafeStorageAvailable()}catch{return!1}}async function Am(e){if(Kn()){const r=await bs();if(r===null)throw new Error("Tauri safe storage not available");return await r("safe_storage_encrypt",{plaintext:e})}const n=$i();if(n===null)throw new Error("Safe storage not available");return await n.safeStorageEncrypt(e)}async function Cm(e){if(Kn()){const r=await bs();if(r===null)throw new Error("Tauri safe storage not available");return await r("safe_storage_decrypt",{encrypted:e})}const n=$i();if(n===null)throw new Error("Safe storage not available");return await n.safeStorageDecrypt(e)}const Tm="NotemacKeyStore",sn="keys",Ad="NotemacCryptoKey_v1",vs="AES-GCM",Rm=256,$n=12;let Jr=null;function xs(){return typeof crypto<"u"&&crypto.subtle!==null&&typeof crypto.subtle<"u"}function Cd(){return new Promise((e,n)=>{const r=indexedDB.open(Tm,1);r.onupgradeneeded=()=>{const o=r.result;o.objectStoreNames.contains(sn)||o.createObjectStore(sn,{keyPath:"id"})},r.onsuccess=()=>e(r.result),r.onerror=()=>n(r.error)})}async function Om(){try{const e=await Cd();return new Promise(n=>{const c=e.transaction(sn,"readonly").objectStore(sn).get(Ad);c.onsuccess=()=>{const u=c.result;n(u!=null?u.key:null)},c.onerror=()=>n(null)})}catch{return null}}async function Mm(e){try{const n=await Cd();return new Promise((r,o)=>{const c=n.transaction(sn,"readwrite");c.objectStore(sn).put({id:Ad,key:e}),c.oncomplete=()=>r(),c.onerror=()=>o(c.error)})}catch{}}async function Td(){if(Jr!==null)return Jr;const e=await Om();if(e!==null)return Jr=e,Jr;const n=await crypto.subtle.generateKey({name:vs,length:Rm},!1,["encrypt","decrypt"]);return await Mm(n),Jr=n,Jr}async function Pm(e){if(!xs())return e;try{const n=await Td(),r=crypto.getRandomValues(new Uint8Array($n)),c=new TextEncoder().encode(e),u=await crypto.subtle.encrypt({name:vs,iv:r},n,c),p=new Uint8Array($n+u.byteLength);p.set(r,0),p.set(new Uint8Array(u),$n);let f="";const h=p.byteLength;for(let x=0;x<h;x++)f+=String.fromCharCode(p[x]);return btoa(f)}catch{return e}}async function jm(e){if(!xs())return e;try{const n=await Td(),r=atob(e),o=new Uint8Array(r.length);for(let h=0,x=r.length;h<x;h++)o[h]=r.charCodeAt(h);const c=o.slice(0,$n),u=o.slice($n),p=await crypto.subtle.decrypt({name:vs,iv:c},n,u);return new TextDecoder().decode(p)}catch{return e}}const Bm="SecureCred_",Ri=new Map;function Oi(e){return`${Bm}${e}`}async function Fm(){return Em()&&await Im()?"safeStorage":xs()?"cryptoSubtle":"none"}async function Dm(e,n){return n==="safeStorage"?await Am(e):n==="cryptoSubtle"?await Pm(e):e}async function Lm(e,n){return n==="safeStorage"?await Cm(e):n==="cryptoSubtle"?await jm(e):e}function $m(e){return e.expiresAt===null?!1:Date.now()>e.expiresAt}async function jn(e,n,r){if(r===0){Ri.set(e,n);return}try{const o=await Fm(),u={encrypted:await Dm(n,o),method:o,storedAt:Date.now(),expiresAt:r!=null?Date.now()+r*1e3:null};localStorage.setItem(Oi(e),JSON.stringify(u))}catch{Ri.set(e,n)}}async function Nm(e){const n=Ri.get(e);if(n!==void 0)return n;try{const r=localStorage.getItem(Oi(e));if(r===null)return null;const o=JSON.parse(r);return $m(o)?(localStorage.removeItem(Oi(e)),null):await Lm(o.encrypted,o.method)}catch{return null}}function xa(e){Ri.delete(e);try{localStorage.removeItem(Oi(e))}catch{}}function Rd(){return je.getState()}let nn=null;function Od(e,n,r){return{model:n,messages:e,temperature:r.temperature??.7,max_tokens:r.maxTokens??4096,stream:r.stream??!0}}function Md(e,n,r){const o=[],c=[];for(let u=0,p=e.length;u<p;u++)e[u].role==="system"?o.push(e[u].content):c.push(e[u]);return{model:n,system:0<o.length?o.join(`
`):void 0,messages:c.map(u=>({role:u.role,content:u.content})),max_tokens:r.maxTokens??4096,temperature:r.temperature??.7,stream:r.stream??!0}}function Pd(e,n){const r=e.filter(c=>c.role!=="system").map(c=>({role:c.role==="assistant"?"model":"user",parts:[{text:c.content}]})),o=e.find(c=>c.role==="system");return{contents:r,systemInstruction:o?{parts:[{text:o.content}]}:void 0,generationConfig:{temperature:n.temperature??.7,maxOutputTokens:n.maxTokens??4096}}}function jd(e,n,r){if(e.type==="anthropic")return`${e.baseUrl}/v1/messages`;if(e.type==="google"){const o=r?"?alt=sse":"";return`${e.baseUrl}/v1beta/models/${n}:${r?"streamGenerateContent":"generateContent"}${o}`}return`${e.baseUrl}/v1/chat/completions`}function Bd(e,n){const r={"Content-Type":"application/json"};return e.type==="anthropic"?(r["x-api-key"]=n.apiKey,r["anthropic-version"]=kd,r["anthropic-dangerous-direct-browser-access"]="true"):e.type==="google"?r["x-goog-api-key"]=n.apiKey:r.Authorization=`Bearer ${n.apiKey}`,r}function Um(e){var r,o,c;if(!e.startsWith("data: "))return null;const n=e.slice(6).trim();if(n==="[DONE]")return null;try{return((c=(o=(r=JSON.parse(n).choices)==null?void 0:r[0])==null?void 0:o.delta)==null?void 0:c.content)||null}catch{return null}}function zm(e){var r;if(!e.startsWith("data: "))return null;const n=e.slice(6).trim();try{const o=JSON.parse(n);return o.type==="content_block_delta"&&((r=o.delta)==null?void 0:r.text)||null}catch{return null}}function Gm(e){var r,o,c,u,p;if(!e.startsWith("data: "))return null;const n=e.slice(6).trim();try{return((p=(u=(c=(o=(r=JSON.parse(n).candidates)==null?void 0:r[0])==null?void 0:o.content)==null?void 0:c.parts)==null?void 0:u[0])==null?void 0:p.text)||null}catch{return null}}function uu(e,n){return e==="anthropic"?zm(n):e==="google"?Gm(n):Um(n)}async function Ni(e,n={},r,o,c){var N,L,D,U,G,X,q,Y,B,K,ce;const u=Rd(),p=u.GetActiveProvider();if(p===null){const S="No active AI provider configured";throw c==null||c(S),new Error(S)}const f=u.GetCredentialForProvider(p.id);if(f===null){const S=`No API key configured for ${p.name}`;throw c==null||c(S),new Error(S)}const h=u.activeModelId,x=n.stream!==!1,_=[...e];n.systemPrompt&&!_.some(S=>S.role==="system")&&_.unshift({role:"system",content:n.systemPrompt});const y=u.aiSettings.systemPrompt;y&&!_.some(S=>S.role==="system")&&_.unshift({role:"system",content:y});let O;p.type==="anthropic"?O=Md(_,h,{...n,stream:x}):p.type==="google"?O=Pd(_,{...n}):O=Od(_,h,{...n,stream:x});const R=jd(p,h,x),z=Bd(p,f);qm(),nn=new AbortController;try{const S=await fetch(R,{method:"POST",headers:z,body:JSON.stringify(O),signal:nn.signal});if(!S.ok){const ie=await S.text();let Q=`API error ${S.status}`;try{const se=JSON.parse(ie);Q=((N=se.error)==null?void 0:N.message)||se.message||Q}catch{}throw c==null||c(Q),new Error(Q)}if(x&&S.body)return await Hm(S.body,p.type,r,o);{const ie=await S.json();let Q="";return p.type==="anthropic"?Q=((D=(L=ie.content)==null?void 0:L[0])==null?void 0:D.text)||"":p.type==="google"?Q=((Y=(q=(X=(G=(U=ie.candidates)==null?void 0:U[0])==null?void 0:G.content)==null?void 0:X.parts)==null?void 0:q[0])==null?void 0:Y.text)||"":Q=((ce=(K=(B=ie.choices)==null?void 0:B[0])==null?void 0:K.message)==null?void 0:ce.content)||"",o==null||o(Q),Q}}catch(S){if(S instanceof Error&&S.name==="AbortError")return o==null||o(""),"";const ie=S instanceof Error?S.message:String(S);throw c==null||c(ie),S}finally{nn=null}}async function Hm(e,n,r,o){const c=e.getReader(),u=new TextDecoder;let p="",f="";try{for(;;){const{done:h,value:x}=await c.read();if(h)break;f+=u.decode(x,{stream:!0});const _=f.split(`
`);f=_.pop()||"";const y=_.length;for(let O=0;O<y;O++){const R=_[O].trim();if(R.length===0)continue;const z=uu(n,R);z!==null&&0<z.length&&(p+=z,r==null||r(z))}}if(0<f.trim().length){const h=uu(n,f.trim());h!==null&&0<h.length&&(p+=h,r==null||r(h))}}finally{c.releaseLock()}return o==null||o(p),p}async function Wm(e,n,r,o,c){const p=Rd().aiSettings,f=`You are an intelligent code completion assistant. Complete the code at the cursor position. Only output the completion text, no explanations, no markdown, no code fences. The code is in ${r}.`,h=`Complete the code at [CURSOR]:

${e}[CURSOR]${n}

Output ONLY the completion text that goes at [CURSOR]. No explanations.`;return Ni([{role:"system",content:f},{role:"user",content:h}],{temperature:p.codeTemperature,maxTokens:p.inlineMaxTokens,stream:!1},void 0,o,c)}function qm(){nn!==null&&(nn.abort(),nn=null)}async function $v(e,n){var r;try{const o=0<e.models.length?e.models[0].id:"",c=jd(e,o,!1),u=Bd(e,n);let p;const f=[{role:"user",content:'Say "ok".'}];e.type==="anthropic"?p=Md(f,o,{maxTokens:10,stream:!1}):e.type==="google"?p=Pd(f,{maxTokens:10}):p=Od(f,o,{maxTokens:10,stream:!1});const h=await fetch(c,{method:"POST",headers:u,body:JSON.stringify(p)});if(h.ok)return{success:!0};const x=await h.text();let _=`HTTP ${h.status}`;try{const y=JSON.parse(x);_=((r=y.error)==null?void 0:r.message)||y.message||_}catch{}return{success:!1,error:_}}catch(o){return{success:!1,error:o instanceof Error?o.message:String(o)}}}const fu=["text-embedding","tts-","whisper","dall-e","davinci","babbage","curie","ada","gpt-3.5-turbo-instruct","chatgpt-4o-latest"];function Vm(e){const n=e.toLowerCase();for(let r=0,o=fu.length;r<o;r++)if(n.startsWith(fu[r]))return!1;return!(/^\w+-\d{4}-\d{2}-\d{2}/.test(e)||/\d{4}-\d{2}-\d{2}$/.test(e))}function _a(e){return e.replace(/^gpt-/,"GPT-").replace(/^o(\d)/,"o$1").replace(/-mini$/," Mini").replace(/-nano$/," Nano").replace(/-pro$/," Pro").replace(/-turbo$/," Turbo").replace(/^claude-/,"Claude ").replace(/^gemini-/,"Gemini ")}async function Km(e,n){try{if(e.type==="openai"||e.type==="custom"){const r=await fetch(`${e.baseUrl}/v1/models`,{headers:{Authorization:`Bearer ${n}`}});return r.ok?((await r.json()).data||[]).filter(u=>Vm(u.id)).sort((u,p)=>(p.created||0)-(u.created||0)).map(u=>({id:u.id,name:_a(u.id),providerId:e.id,contextWindow:128e3,supportsStreaming:!0,supportsFIM:!1})):null}if(e.type==="anthropic"){const r=await fetch(`${e.baseUrl}/v1/models`,{headers:{"x-api-key":n,"anthropic-version":kd,"anthropic-dangerous-direct-browser-access":"true"}});return r.ok?((await r.json()).data||[]).map(u=>({id:u.id,name:u.display_name||_a(u.id),providerId:e.id,contextWindow:2e5,supportsStreaming:!0,supportsFIM:!1})):null}if(e.type==="google"){const r=await fetch(`${e.baseUrl}/v1beta/models?key=${n}&pageSize=100`);return r.ok?((await r.json()).models||[]).filter(u=>{var p;return(p=u.supportedGenerationMethods)==null?void 0:p.includes("generateContent")}).map(u=>{const p=u.name.replace("models/","");return{id:p,name:u.displayName||_a(p),providerId:e.id,contextWindow:u.inputTokenLimit||1048576,supportsStreaming:!0,supportsFIM:!1}}):null}return null}catch{return null}}function Zm(e){if(e.length===0)return"";const n=[],r=e.length;for(let o=0;o<r;o++){const c=e[o];c.type==="file"?n.push(`--- File: ${c.label} (${c.language||"unknown"}) ---
${c.content}`):c.type==="selection"?n.push(`--- Selected code (${c.language||"unknown"}) ---
${c.content}`):c.type==="error"?n.push(`--- Error ---
${c.content}`):c.type==="diff"&&n.push(`--- Diff ---
${c.content}`)}return n.join(`

`)}function Fd(e){const n=[],r=/```(\w*)\n([\s\S]*?)```/g;let o;for(;(o=r.exec(e))!==null;)n.push({language:o[1]||"text",code:o[2].trim()});return n}const Xm=(e,n)=>({aiEnabled:!1,activeProviderId:"openai",activeModelId:"gpt-4o-mini",providers:lu(),credentials:[],aiSettings:cu(),conversations:[],activeConversationId:null,isAiStreaming:!1,aiStreamContent:"",inlineSuggestionEnabled:!0,currentInlineSuggestion:null,aiContextItems:[],commitMessageDraft:"",showAiSettings:!1,aiOperationError:null,isRefreshingModels:!1,SetAiEnabled:r=>e({aiEnabled:r}),SetActiveProvider:r=>e({activeProviderId:r}),SetActiveModel:r=>e({activeModelId:r}),SetProviders:r=>e({providers:r}),AddProvider:r=>{e(et(o=>{const c=o.providers.findIndex(u=>u.id===r.id);c!==-1?o.providers[c]=r:o.providers.push(r)})),n().SaveAIState()},RemoveProvider:r=>{e(et(o=>{const c=o.providers.findIndex(u=>u.id===r);c!==-1&&!o.providers[c].isBuiltIn&&o.providers.splice(c,1)})),n().SaveAIState()},SetCredentials:r=>e({credentials:r}),SetCredentialForProvider:(r,o,c)=>{e(et(h=>{const x=h.credentials.findIndex(y=>y.providerId===r),_={providerId:r,apiKey:o,rememberKey:c};x!==-1?h.credentials[x]=_:h.credentials.push(_)}));const u=n().credentials,p=u.filter(h=>h.rememberKey).map(h=>({providerId:h.providerId,apiKey:h.apiKey,rememberKey:!0}));0<p.length?jn(tr,JSON.stringify(p),yi*3600):xa(tr);const f=u.filter(h=>!h.rememberKey);0<f.length&&jn(tr+"_session",JSON.stringify(f),0)},RemoveCredentialForProvider:r=>{e(et(u=>{const p=u.credentials.findIndex(f=>f.providerId===r);p!==-1&&u.credentials.splice(p,1)}));const c=n().credentials.filter(u=>u.rememberKey);0<c.length?jn(tr,JSON.stringify(c),yi*3600):xa(tr)},UpdateAISettings:r=>{e(et(o=>{Object.assign(o.aiSettings,r)})),jt(ba,n().aiSettings)},SetConversations:r=>e({conversations:r}),AddConversation:r=>{e(et(o=>{o.conversations.unshift(r),iu<o.conversations.length&&(o.conversations.length=iu)})),e({activeConversationId:r.id})},RemoveConversation:r=>{e(et(o=>{const c=o.conversations.findIndex(u=>u.id===r);c!==-1&&o.conversations.splice(c,1),r===o.activeConversationId&&(o.activeConversationId=0<o.conversations.length?o.conversations[0].id:null)}))},SetActiveConversation:r=>e({activeConversationId:r}),AddMessageToConversation:(r,o)=>{e(et(c=>{const u=c.conversations.find(p=>p.id===r);u&&u.messages.push(o)}))},UpdateLastMessage:(r,o)=>{e(et(c=>{const u=c.conversations.find(p=>p.id===r);if(u&&0<u.messages.length){const p=u.messages[u.messages.length-1];p.content=o}}))},SetIsAiStreaming:r=>e({isAiStreaming:r}),SetAiStreamContent:r=>e({aiStreamContent:r}),SetInlineSuggestionEnabled:r=>e({inlineSuggestionEnabled:r}),SetCurrentInlineSuggestion:r=>e({currentInlineSuggestion:r}),AddAiContextItem:r=>{e(et(o=>{o.aiContextItems.push(r)}))},RemoveAiContextItem:r=>{e(et(o=>{0<=r&&r<o.aiContextItems.length&&o.aiContextItems.splice(r,1)}))},ClearAiContext:()=>e({aiContextItems:[]}),SetCommitMessageDraft:r=>e({commitMessageDraft:r}),SetShowAiSettings:r=>e({showAiSettings:r}),SetAiOperationError:r=>e({aiOperationError:r}),RefreshProviderModels:async r=>{const o=n(),c=o.providers.find(p=>p.id===r);if(!c)return!1;const u=o.credentials.find(p=>p.providerId===r);if(!u)return!1;e({isRefreshingModels:!0});try{const p=await Km(c,u.apiKey);return p===null||p.length===0?(e({isRefreshingModels:!1}),!1):(e(et(f=>{const h=f.providers.findIndex(x=>x.id===r);h!==-1&&(f.providers[h].models=p),f.isRefreshingModels=!1})),!0)}catch{return e({isRefreshingModels:!1}),!1}},LoadAIState:()=>{const r=ur(ba),o=ur(ru),c=ur(nu),u=lu();let p=u;if(o!=null){const f=o.filter(h=>!h.isBuiltIn);p=[...u,...f]}e({aiSettings:r||cu(),credentials:[],providers:p,conversations:c||[],aiEnabled:!1}),Nm(tr).then(f=>{let h=[];if(f!==null)try{h=JSON.parse(f)}catch{h=[]}else{const x=ur(tr);if(x!==null&&0<x.length){h=x;const _=x.filter(y=>y.rememberKey);0<_.length&&jn(tr,JSON.stringify(_),yi*3600),ym(tr)}}e({credentials:h,aiEnabled:0<h.length})}).catch(()=>{})},SaveAIState:()=>{const r=n();jt(ba,r.aiSettings);const o=r.providers.filter(u=>!u.isBuiltIn);0<o.length&&jt(ru,o);const c=r.credentials.filter(u=>u.rememberKey);0<c.length?jn(tr,JSON.stringify(c),yi*3600):xa(tr),jt(nu,r.conversations)},GetActiveProvider:()=>{const r=n();return r.providers.find(o=>o.id===r.activeProviderId)||null},GetActiveModel:()=>{const r=n(),o=r.providers.find(c=>c.id===r.activeProviderId);return o==null?null:o.models.find(c=>c.id===r.activeModelId)||null},GetCredentialForProvider:r=>n().credentials.find(o=>o.providerId===r)||null,GetActiveConversation:()=>{const r=n();return r.activeConversationId===null?null:r.conversations.find(o=>o.id===r.activeConversationId)||null}}),je=bg()((...e)=>({...um(...e),...dm(...e),...hm(...e),...mm(...e),...wm(...e),...bm(...e),...vm(...e),...Xm(...e)}));typeof window<"u"&&(window.__ZUSTAND_STORE__=je);const du={dark:{bg:"#1e1e1e",bgSecondary:"#252526",bgTertiary:"#2d2d30",bgHover:"#3e3e42",bgActive:"#094771",text:"#cccccc",textSecondary:"#969696",textMuted:"#6e6e6e",border:"#3e3e42",accent:"#007acc",accentHover:"#1a8ad4",accentText:"#ffffff",danger:"#f44747",warning:"#cca700",success:"#89d185",tabBg:"#2d2d30",tabActiveBg:"#1e1e1e",tabActiveText:"#ffffff",tabBorder:"#3e3e42",menuBg:"#2d2d30",menuHover:"#094771",menuText:"#cccccc",statusBarBg:"#007acc",statusBarText:"#ffffff",sidebarBg:"#252526",sidebarText:"#cccccc",scrollbarBg:"transparent",scrollbarThumb:"#424242",editorBg:"#1e1e1e",editorMonacoTheme:"vs-dark",findBg:"#252526"},light:{bg:"#ffffff",bgSecondary:"#f3f3f3",bgTertiary:"#ececec",bgHover:"#e0e0e0",bgActive:"#cce5ff",text:"#333333",textSecondary:"#666666",textMuted:"#999999",border:"#d4d4d4",accent:"#0078d4",accentHover:"#106ebe",accentText:"#ffffff",danger:"#d32f2f",warning:"#f9a825",success:"#2e7d32",tabBg:"#ececec",tabActiveBg:"#ffffff",tabActiveText:"#333333",tabBorder:"#d4d4d4",menuBg:"#f3f3f3",menuHover:"#0078d4",menuText:"#333333",statusBarBg:"#0078d4",statusBarText:"#ffffff",sidebarBg:"#f3f3f3",sidebarText:"#333333",scrollbarBg:"transparent",scrollbarThumb:"#c4c4c4",editorBg:"#ffffff",editorMonacoTheme:"vs",findBg:"#f3f3f3"},monokai:{bg:"#272822",bgSecondary:"#1e1f1c",bgTertiary:"#3e3d32",bgHover:"#49483e",bgActive:"#49483e",text:"#f8f8f2",textSecondary:"#a6a69c",textMuted:"#75715e",border:"#3e3d32",accent:"#a6e22e",accentHover:"#b8f340",accentText:"#272822",danger:"#f92672",warning:"#e6db74",success:"#a6e22e",tabBg:"#1e1f1c",tabActiveBg:"#272822",tabActiveText:"#f8f8f2",tabBorder:"#3e3d32",menuBg:"#1e1f1c",menuHover:"#49483e",menuText:"#f8f8f2",statusBarBg:"#49483e",statusBarText:"#f8f8f2",sidebarBg:"#1e1f1c",sidebarText:"#f8f8f2",scrollbarBg:"transparent",scrollbarThumb:"#49483e",editorBg:"#272822",editorMonacoTheme:"monokai",findBg:"#1e1f1c"},dracula:{bg:"#282a36",bgSecondary:"#21222c",bgTertiary:"#343746",bgHover:"#44475a",bgActive:"#44475a",text:"#f8f8f2",textSecondary:"#bd93f9",textMuted:"#6272a4",border:"#44475a",accent:"#bd93f9",accentHover:"#caa9fa",accentText:"#282a36",danger:"#ff5555",warning:"#f1fa8c",success:"#50fa7b",tabBg:"#21222c",tabActiveBg:"#282a36",tabActiveText:"#f8f8f2",tabBorder:"#44475a",menuBg:"#21222c",menuHover:"#44475a",menuText:"#f8f8f2",statusBarBg:"#44475a",statusBarText:"#f8f8f2",sidebarBg:"#21222c",sidebarText:"#f8f8f2",scrollbarBg:"transparent",scrollbarThumb:"#44475a",editorBg:"#282a36",editorMonacoTheme:"dracula",findBg:"#21222c"},"solarized-dark":{bg:"#002b36",bgSecondary:"#073642",bgTertiary:"#073642",bgHover:"#0a4858",bgActive:"#0a4858",text:"#839496",textSecondary:"#657b83",textMuted:"#586e75",border:"#073642",accent:"#268bd2",accentHover:"#2aa7f5",accentText:"#fdf6e3",danger:"#dc322f",warning:"#b58900",success:"#859900",tabBg:"#073642",tabActiveBg:"#002b36",tabActiveText:"#93a1a1",tabBorder:"#073642",menuBg:"#073642",menuHover:"#0a4858",menuText:"#839496",statusBarBg:"#073642",statusBarText:"#839496",sidebarBg:"#073642",sidebarText:"#839496",scrollbarBg:"transparent",scrollbarThumb:"#0a4858",editorBg:"#002b36",editorMonacoTheme:"solarized-dark",findBg:"#073642"},"solarized-light":{bg:"#fdf6e3",bgSecondary:"#eee8d5",bgTertiary:"#eee8d5",bgHover:"#e4ddc8",bgActive:"#e4ddc8",text:"#657b83",textSecondary:"#839496",textMuted:"#93a1a1",border:"#eee8d5",accent:"#268bd2",accentHover:"#2aa7f5",accentText:"#fdf6e3",danger:"#dc322f",warning:"#b58900",success:"#859900",tabBg:"#eee8d5",tabActiveBg:"#fdf6e3",tabActiveText:"#586e75",tabBorder:"#eee8d5",menuBg:"#eee8d5",menuHover:"#e4ddc8",menuText:"#657b83",statusBarBg:"#eee8d5",statusBarText:"#657b83",sidebarBg:"#eee8d5",sidebarText:"#657b83",scrollbarBg:"transparent",scrollbarThumb:"#d3cbb7",editorBg:"#fdf6e3",editorMonacoTheme:"solarized-light",findBg:"#eee8d5"}};function Ym(e){return du[e]||du.dark}function Jm(e){e.editor.defineTheme("monokai",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"75715e",fontStyle:"italic"},{token:"keyword",foreground:"f92672"},{token:"string",foreground:"e6db74"},{token:"number",foreground:"ae81ff"},{token:"type",foreground:"66d9ef",fontStyle:"italic"},{token:"function",foreground:"a6e22e"},{token:"variable",foreground:"f8f8f2"}],colors:{"editor.background":"#272822","editor.foreground":"#f8f8f2","editor.lineHighlightBackground":"#3e3d32","editor.selectionBackground":"#49483e","editorCursor.foreground":"#f8f8f0"}}),e.editor.defineTheme("dracula",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"6272a4",fontStyle:"italic"},{token:"keyword",foreground:"ff79c6"},{token:"string",foreground:"f1fa8c"},{token:"number",foreground:"bd93f9"},{token:"type",foreground:"8be9fd",fontStyle:"italic"},{token:"function",foreground:"50fa7b"},{token:"variable",foreground:"f8f8f2"}],colors:{"editor.background":"#282a36","editor.foreground":"#f8f8f2","editor.lineHighlightBackground":"#44475a","editor.selectionBackground":"#44475a","editorCursor.foreground":"#f8f8f2"}}),e.editor.defineTheme("solarized-dark",{base:"vs-dark",inherit:!0,rules:[{token:"comment",foreground:"586e75",fontStyle:"italic"},{token:"keyword",foreground:"859900"},{token:"string",foreground:"2aa198"},{token:"number",foreground:"d33682"},{token:"type",foreground:"b58900"},{token:"function",foreground:"268bd2"}],colors:{"editor.background":"#002b36","editor.foreground":"#839496","editor.lineHighlightBackground":"#073642","editor.selectionBackground":"#073642"}}),e.editor.defineTheme("solarized-light",{base:"vs",inherit:!0,rules:[{token:"comment",foreground:"93a1a1",fontStyle:"italic"},{token:"keyword",foreground:"859900"},{token:"string",foreground:"2aa198"},{token:"number",foreground:"d33682"},{token:"type",foreground:"b58900"},{token:"function",foreground:"268bd2"}],colors:{"editor.background":"#fdf6e3","editor.foreground":"#657b83","editor.lineHighlightBackground":"#eee8d5","editor.selectionBackground":"#eee8d5"}})}function Qm(e,n,r){const o=document.activeElement,c=document.querySelector(".notemac-app");if(!((c==null?void 0:c.contains(o))||o===document.body))return;const p=e.metaKey||e.ctrlKey,f=je.getState();p&&e.key==="n"?(e.preventDefault(),f.addTab()):p&&e.key==="w"?(e.preventDefault(),n!==null&&f.closeTab(n)):p&&e.shiftKey&&e.key==="T"?(e.preventDefault(),f.restoreLastClosedTab()):p&&e.key==="f"?(e.preventDefault(),f.setShowFindReplace(!0,"find")):p&&e.key==="h"?(e.preventDefault(),f.setShowFindReplace(!0,"replace")):p&&e.key==="g"?(e.preventDefault(),f.setShowGoToLine(!0)):p&&e.key==="b"?(e.preventDefault(),f.toggleSidebar()):p&&e.key===","?(e.preventDefault(),f.setShowSettings(!0)):p&&e.key==="="?(e.preventDefault(),f.setZoomLevel(r+1)):p&&e.key==="-"?(e.preventDefault(),f.setZoomLevel(r-1)):p&&e.key==="0"?(e.preventDefault(),f.setZoomLevel(0)):p&&e.shiftKey&&e.key==="P"?(e.preventDefault(),f.setShowCommandPalette(!0)):p&&e.shiftKey&&e.key==="F"?(e.preventDefault(),f.setShowFindReplace(!0,"findInFiles")):p&&e.key==="p"?(e.preventDefault(),f.setShowQuickOpen(!0)):e.ctrlKey&&e.key==="`"?(e.preventDefault(),f.setShowTerminalPanel(!f.showTerminalPanel)):e.ctrlKey&&e.shiftKey&&e.key==="G"?(e.preventDefault(),f.setSidebarPanel(f.sidebarPanel==="git"?null:"git")):e.key==="Escape"&&(f.setShowFindReplace(!1),f.setShowSettings(!1),f.setShowGoToLine(!1),f.setShowAbout(!1),f.setShowRunCommand(!1),f.setShowColumnEditor(!1),f.setShowSummary(!1),f.setShowCharInRange(!1),f.setShowShortcutMapper(!1),f.setShowCommandPalette(!1),f.setShowQuickOpen(!1),f.setShowDiffViewer(!1),f.setShowSnippetManager(!1),f.setShowCloneDialog(!1),f.setShowGitSettings(!1))}let Dd=null,_s=null;function ew(e){Dd=e}function Nv(){return Dd}function tw(e){_s=e}function Ld(){return _s}function rw(){_s=null}function $d(e,n,r,o,c){var f,h,x,_;const u=je.getState(),p=Ld();switch(e){case"new":u.addTab();break;case"open":nw();break;case"open-folder":iw();break;case"save":Sa(n,r,!1);break;case"save-as":Sa(n,r,!0);break;case"save-copy-as":Sa(n,r,!0);break;case"save-all":aw(r);break;case"reload-from-disk":ow(n,r);break;case"rename-file":sw(n,r);break;case"delete-file":n!==null&&u.closeTab(n);break;case"close-tab":n!==null&&u.closeTab(n);break;case"close-all":u.closeAllTabs();break;case"close-others":n!==null&&u.closeOtherTabs(n);break;case"close-tabs-to-left":n!==null&&u.closeTabsToLeft(n);break;case"close-tabs-to-right":n!==null&&u.closeTabsToRight(n);break;case"close-unchanged":u.closeUnchangedTabs();break;case"close-all-but-pinned":u.closeAllButPinned();break;case"restore-last-closed":u.restoreLastClosedTab();break;case"pin-tab":n!==null&&u.togglePinTab(n);break;case"print":window.print();break;case"find":u.setShowFindReplace(!0,"find");break;case"replace":u.setShowFindReplace(!0,"replace");break;case"find-in-files":u.setShowFindReplace(!0,"findInFiles");break;case"mark":u.setShowFindReplace(!0,"mark");break;case"incremental-search":u.setShowIncrementalSearch(!0);break;case"goto-line":u.setShowGoToLine(!0);break;case"find-char-in-range":u.setShowCharInRange(!0);break;case"word-wrap":u.updateSettings({wordWrap:c});break;case"show-whitespace":u.updateSettings({showWhitespace:c,renderWhitespace:c?"all":"none"});break;case"show-eol":u.updateSettings({showEOL:c});break;case"show-non-printable":u.updateSettings({showNonPrintable:c});break;case"show-wrap-symbol":u.updateSettings({showWrapSymbol:c});break;case"indent-guide":u.updateSettings({showIndentGuides:c});break;case"show-line-numbers":u.updateSettings({showLineNumbers:c});break;case"toggle-minimap":u.updateSettings({showMinimap:c});break;case"zoom-in":u.setZoomLevel(o+1);break;case"zoom-out":u.setZoomLevel(o-1);break;case"zoom-reset":u.setZoomLevel(0);break;case"toggle-sidebar":u.toggleSidebar();break;case"show-doc-list":u.setSidebarPanel("docList");break;case"show-function-list":u.setSidebarPanel("functions");break;case"show-project-panel":u.setSidebarPanel("project");break;case"distraction-free":u.updateSettings({distractionFreeMode:c});break;case"always-on-top":{u.updateSettings({alwaysOnTop:c}),window.electronAPI&&((h=(f=window.electronAPI).setAlwaysOnTop)==null||h.call(f,c));break}case"sync-scroll-v":u.updateSettings({syncScrollVertical:c});break;case"sync-scroll-h":u.updateSettings({syncScrollHorizontal:c});break;case"split-right":n!==null&&u.setSplitView("vertical",n);break;case"split-down":n!==null&&u.setSplitView("horizontal",n);break;case"close-split":u.setSplitView("none");break;case"show-summary":u.setShowSummary(!0);break;case"toggle-monitoring":{if(n!==null){const y=r.find(O=>O.id===n);y&&u.updateTab(n,{isMonitoring:!y.isMonitoring})}break}case"language":n!==null&&u.updateTab(n,{language:c});break;case"encoding":n!==null&&u.updateTab(n,{encoding:c});break;case"line-ending":n!==null&&u.updateTab(n,{lineEnding:c});break;case"macro-start":u.startRecordingMacro();break;case"macro-stop":u.stopRecordingMacro();break;case"command-palette":u.setShowCommandPalette(!0);break;case"quick-open":u.setShowQuickOpen(!0);break;case"compare-files":u.setShowDiffViewer(!0);break;case"snippet-manager":u.setShowSnippetManager(!0);break;case"toggle-terminal":u.setShowTerminalPanel(!u.showTerminalPanel);break;case"clone-repository":u.setShowCloneDialog(!0);break;case"git-settings":u.setShowGitSettings(!0);break;case"show-git-panel":u.setSidebarPanel("git");break;case"ai-chat":u.setSidebarPanel("ai");break;case"ai-settings":u.SetShowAiSettings(!0);break;case"ai-explain":case"ai-refactor":case"ai-generate-tests":case"ai-generate-docs":case"ai-fix-error":case"ai-simplify":case"ai-convert-language":p&&p(e);break;case"ai-toggle-inline":u.SetInlineSuggestionEnabled(!u.inlineSuggestionEnabled);break;case"preferences":u.setShowSettings(!0);break;case"about":u.setShowAbout(!0);break;case"run-command":u.setShowRunCommand(!0);break;case"column-editor":u.setShowColumnEditor(!0);break;case"shortcut-mapper":u.setShowShortcutMapper(!0);break;case"clipboard-history":u.setSidebarPanel("clipboardHistory");break;case"char-panel":u.setSidebarPanel("charPanel");break;case"search-google":{const y=(x=window.getSelection())==null?void 0:x.toString();y&&window.open(`https://www.google.com/search?q=${encodeURIComponent(y)}`,"_blank");break}case"search-wikipedia":{const y=(_=window.getSelection())==null?void 0:_.toString();y&&window.open(`https://en.wikipedia.org/wiki/${encodeURIComponent(y)}`,"_blank");break}case"open-in-browser":{const y=r.find(O=>O.id===n);y&&y.path&&window.open(`file://${y.path}`,"_blank");break}case"save-session":{const y=u.saveSession(),O=new Blob([JSON.stringify(y,null,2)],{type:"application/json"}),R=URL.createObjectURL(O),z=document.createElement("a");z.href=R,z.download="session.json",z.click(),URL.revokeObjectURL(R);break}case"load-session":{const y=document.createElement("input");y.type="file",y.accept=".json",y.onchange=async O=>{var z;const R=(z=O.target.files)==null?void 0:z[0];if(R)try{const N=await R.text();je.getState().loadSession(JSON.parse(N))}catch{}},y.click();break}default:p&&p(e,c);break}}function nw(){var n,r;if(window.electronAPI){(r=(n=window.electronAPI).openFile)==null||r.call(n);return}const e=document.createElement("input");e.type="file",e.multiple=!0,e.onchange=async()=>{if(e.files)try{const o=je.getState();for(const c of Array.from(e.files)){const u=await c.text();o.addTab({name:c.name,content:u,language:sr(c.name),lineEnding:br(u)})}}catch{}},e.click()}function iw(){var n,r;if(window.electronAPI){(r=(n=window.electronAPI).openFolder)==null||r.call(n);return}const e=document.createElement("input");e.type="file",e.webkitdirectory=!0,e.onchange=async()=>{if(!(!e.files||e.files.length===0))try{const o=je.getState();for(const c of Array.from(e.files)){const u=await c.text();o.addTab({name:c.name,content:u,language:sr(c.name),lineEnding:br(u)})}}catch{}},e.click()}function Sa(e,n,r){var f,h,x,_;if(e===null)return;const o=n.find(y=>y.id===e);if(!o)return;if(window.electronAPI){r||!o.path?(h=(f=window.electronAPI).saveFileAs)==null||h.call(f,o.content,o.name):(_=(x=window.electronAPI).saveFile)==null||_.call(x,o.content,o.path),je.getState().updateTab(e,{isModified:!1});return}const c=new Blob([o.content],{type:"text/plain;charset=utf-8"}),u=URL.createObjectURL(c),p=document.createElement("a");p.href=u,p.download=o.name,p.click(),URL.revokeObjectURL(u),je.getState().updateTab(e,{isModified:!1})}function aw(e){var r,o;const n=je.getState();for(const c of e)if(c.isModified)if(window.electronAPI&&c.path)(o=(r=window.electronAPI).saveFile)==null||o.call(r,c.content,c.path),n.updateTab(c.id,{isModified:!1});else{const u=new Blob([c.content],{type:"text/plain;charset=utf-8"}),p=URL.createObjectURL(u),f=document.createElement("a");f.href=p,f.download=c.name,f.click(),URL.revokeObjectURL(p),n.updateTab(c.id,{isModified:!1})}}function ow(e,n){var c,u;if(e===null)return;const r=n.find(p=>p.id===e);if(!r)return;if(window.electronAPI&&r.path){(u=(c=window.electronAPI).readFile)==null||u.call(c,r.path).then(p=>{je.getState().updateTabContent(e,p),je.getState().updateTab(e,{isModified:!1})}).catch(p=>{const f=p instanceof Error?p.message:String(p);window.alert(`Failed to reload file from disk: ${f}`)});return}const o=document.createElement("input");o.type="file",o.onchange=async()=>{var p;try{const f=(p=o.files)==null?void 0:p[0];if(f){const h=await f.text();je.getState().updateTabContent(e,h),je.getState().updateTab(e,{isModified:!1,name:f.name})}}catch{}},o.click()}function sw(e,n){var c,u;if(e===null)return;const r=n.find(p=>p.id===e);if(!r)return;const o=prompt("Enter new file name:",r.name);o&&o!==r.name&&(je.getState().updateTab(e,{name:o}),window.electronAPI&&r.path&&((u=(c=window.electronAPI).renameFile)==null||u.call(c,r.path,o)))}var Oe={},ka,hu;function cw(){if(hu)return ka;hu=1;var e=function(n){if(n=n||{},this.Promise=n.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=n.domainReentrant||!1,this.domainReentrant){if(typeof process>"u"||typeof process.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=n.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=n.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=n.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,n.maxPending===1/0||Number.isInteger(n.maxPending)&&n.maxPending>=0?this.maxPending=n.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(n,r,o,c){if(Array.isArray(n))return this._acquireBatch(n,r,o,c);if(typeof r!="function")throw new Error("You must pass a function to execute");var u=null,p=null,f=null;typeof o!="function"&&(c=o,o=null,f=new this.Promise(function(G,X){u=G,p=X})),c=c||{};var h=!1,x=null,_=null,y=null,O=this,R=function(G,X,q){_&&(clearTimeout(_),_=null),y&&(clearTimeout(y),y=null),G&&(O.queues[n]&&O.queues[n].length===0&&delete O.queues[n],O.domainReentrant&&delete O.domains[n]),h||(f?X?p(X):u(q):typeof o=="function"&&o(X,q),h=!0),G&&O.queues[n]&&O.queues[n].length>0&&O.queues[n].shift()()},z=function(G){if(h)return R(G);x&&(clearTimeout(x),x=null),O.domainReentrant&&G&&(O.domains[n]=process.domain);var X=c.maxExecutionTime||O.maxExecutionTime;if(X&&(y=setTimeout(function(){O.queues[n]&&R(G,new Error("Maximum execution time is exceeded "+n))},X)),r.length===1){var q=!1;try{r(function(Y,B){q||(q=!0,R(G,Y,B))})}catch(Y){q||(q=!0,R(G,Y))}}else O._promiseTry(function(){return r()}).then(function(Y){R(G,void 0,Y)},function(Y){R(G,Y)})};O.domainReentrant&&process.domain&&(z=process.domain.bind(z));var N=c.maxPending||O.maxPending;if(!O.queues[n])O.queues[n]=[],z(!0);else if(O.domainReentrant&&process.domain&&process.domain===O.domains[n])z(!1);else if(O.queues[n].length>=N)R(!1,new Error("Too many pending tasks in queue "+n));else{var L=function(){z(!0)};c.skipQueue?O.queues[n].unshift(L):O.queues[n].push(L);var D=c.timeout||O.timeout;D&&(x=setTimeout(function(){x=null,R(!1,new Error("async-lock timed out in queue "+n))},D))}var U=c.maxOccupationTime||O.maxOccupationTime;if(U&&(_=setTimeout(function(){O.queues[n]&&R(!1,new Error("Maximum occupation time is exceeded in queue "+n))},U)),f)return f},e.prototype._acquireBatch=function(n,r,o,c){typeof o!="function"&&(c=o,o=null);var u=this,p=function(h,x){return function(_){u.acquire(h,x,_,c)}},f=n.reduceRight(function(h,x){return p(x,h)},r);if(typeof o=="function")f(o);else return new this.Promise(function(h,x){f.length===1?f(function(_,y){_?x(_):h(y)}):h(f())})},e.prototype.isBusy=function(n){return n?!!this.queues[n]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(n){try{return this.Promise.resolve(n())}catch(r){return this.Promise.reject(r)}},ka=e,ka}var Ea,pu;function lw(){return pu||(pu=1,Ea=cw()),Ea}var vi={exports:{}},gu;function uw(){return gu||(gu=1,typeof Object.create=="function"?vi.exports=function(n,r){r&&(n.super_=r,n.prototype=Object.create(r.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}))}:vi.exports=function(n,r){if(r){n.super_=r;var o=function(){};o.prototype=r.prototype,n.prototype=new o,n.prototype.constructor=n}}),vi.exports}var xi={exports:{}},Ia={},Bn={},mu;function fw(){if(mu)return Bn;mu=1,Bn.byteLength=f,Bn.toByteArray=x,Bn.fromByteArray=O;for(var e=[],n=[],r=typeof Uint8Array<"u"?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,u=o.length;c<u;++c)e[c]=o[c],n[o.charCodeAt(c)]=c;n[45]=62,n[95]=63;function p(R){var z=R.length;if(z%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var N=R.indexOf("=");N===-1&&(N=z);var L=N===z?0:4-N%4;return[N,L]}function f(R){var z=p(R),N=z[0],L=z[1];return(N+L)*3/4-L}function h(R,z,N){return(z+N)*3/4-N}function x(R){var z,N=p(R),L=N[0],D=N[1],U=new r(h(R,L,D)),G=0,X=D>0?L-4:L,q;for(q=0;q<X;q+=4)z=n[R.charCodeAt(q)]<<18|n[R.charCodeAt(q+1)]<<12|n[R.charCodeAt(q+2)]<<6|n[R.charCodeAt(q+3)],U[G++]=z>>16&255,U[G++]=z>>8&255,U[G++]=z&255;return D===2&&(z=n[R.charCodeAt(q)]<<2|n[R.charCodeAt(q+1)]>>4,U[G++]=z&255),D===1&&(z=n[R.charCodeAt(q)]<<10|n[R.charCodeAt(q+1)]<<4|n[R.charCodeAt(q+2)]>>2,U[G++]=z>>8&255,U[G++]=z&255),U}function _(R){return e[R>>18&63]+e[R>>12&63]+e[R>>6&63]+e[R&63]}function y(R,z,N){for(var L,D=[],U=z;U<N;U+=3)L=(R[U]<<16&16711680)+(R[U+1]<<8&65280)+(R[U+2]&255),D.push(_(L));return D.join("")}function O(R){for(var z,N=R.length,L=N%3,D=[],U=16383,G=0,X=N-L;G<X;G+=U)D.push(y(R,G,G+U>X?X:G+U));return L===1?(z=R[N-1],D.push(e[z>>2]+e[z<<4&63]+"==")):L===2&&(z=(R[N-2]<<8)+R[N-1],D.push(e[z>>10]+e[z>>4&63]+e[z<<2&63]+"=")),D.join("")}return Bn}var _i={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var wu;function dw(){return wu||(wu=1,_i.read=function(e,n,r,o,c){var u,p,f=c*8-o-1,h=(1<<f)-1,x=h>>1,_=-7,y=r?c-1:0,O=r?-1:1,R=e[n+y];for(y+=O,u=R&(1<<-_)-1,R>>=-_,_+=f;_>0;u=u*256+e[n+y],y+=O,_-=8);for(p=u&(1<<-_)-1,u>>=-_,_+=o;_>0;p=p*256+e[n+y],y+=O,_-=8);if(u===0)u=1-x;else{if(u===h)return p?NaN:(R?-1:1)*(1/0);p=p+Math.pow(2,o),u=u-x}return(R?-1:1)*p*Math.pow(2,u-o)},_i.write=function(e,n,r,o,c,u){var p,f,h,x=u*8-c-1,_=(1<<x)-1,y=_>>1,O=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,R=o?0:u-1,z=o?1:-1,N=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(f=isNaN(n)?1:0,p=_):(p=Math.floor(Math.log(n)/Math.LN2),n*(h=Math.pow(2,-p))<1&&(p--,h*=2),p+y>=1?n+=O/h:n+=O*Math.pow(2,1-y),n*h>=2&&(p++,h/=2),p+y>=_?(f=0,p=_):p+y>=1?(f=(n*h-1)*Math.pow(2,c),p=p+y):(f=n*Math.pow(2,y-1)*Math.pow(2,c),p=0));c>=8;e[r+R]=f&255,R+=z,f/=256,c-=8);for(p=p<<c|f,x+=c;x>0;e[r+R]=p&255,R+=z,p/=256,x-=8);e[r+R-z]|=N*128}),_i}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var yu;function hw(){return yu||(yu=1,(function(e){var n=fw(),r=dw(),o=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=f,e.SlowBuffer=U,e.INSPECT_MAX_BYTES=50;var c=2147483647;e.kMaxLength=c,f.TYPED_ARRAY_SUPPORT=u(),!f.TYPED_ARRAY_SUPPORT&&typeof console<"u";function u(){try{var M=new Uint8Array(1),g={foo:function(){return 42}};return Object.setPrototypeOf(g,Uint8Array.prototype),Object.setPrototypeOf(M,g),M.foo()===42}catch{return!1}}Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}});function p(M){if(M>c)throw new RangeError('The value "'+M+'" is invalid for option "size"');var g=new Uint8Array(M);return Object.setPrototypeOf(g,f.prototype),g}function f(M,g,b){if(typeof M=="number"){if(typeof g=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(M)}return h(M,g,b)}f.poolSize=8192;function h(M,g,b){if(typeof M=="string")return O(M,g);if(ArrayBuffer.isView(M))return z(M);if(M==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof M);if(Ke(M,ArrayBuffer)||M&&Ke(M.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ke(M,SharedArrayBuffer)||M&&Ke(M.buffer,SharedArrayBuffer)))return N(M,g,b);if(typeof M=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var $=M.valueOf&&M.valueOf();if($!=null&&$!==M)return f.from($,g,b);var ae=L(M);if(ae)return ae;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof M[Symbol.toPrimitive]=="function")return f.from(M[Symbol.toPrimitive]("string"),g,b);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof M)}f.from=function(M,g,b){return h(M,g,b)},Object.setPrototypeOf(f.prototype,Uint8Array.prototype),Object.setPrototypeOf(f,Uint8Array);function x(M){if(typeof M!="number")throw new TypeError('"size" argument must be of type number');if(M<0)throw new RangeError('The value "'+M+'" is invalid for option "size"')}function _(M,g,b){return x(M),M<=0?p(M):g!==void 0?typeof b=="string"?p(M).fill(g,b):p(M).fill(g):p(M)}f.alloc=function(M,g,b){return _(M,g,b)};function y(M){return x(M),p(M<0?0:D(M)|0)}f.allocUnsafe=function(M){return y(M)},f.allocUnsafeSlow=function(M){return y(M)};function O(M,g){if((typeof g!="string"||g==="")&&(g="utf8"),!f.isEncoding(g))throw new TypeError("Unknown encoding: "+g);var b=G(M,g)|0,$=p(b),ae=$.write(M,g);return ae!==b&&($=$.slice(0,ae)),$}function R(M){for(var g=M.length<0?0:D(M.length)|0,b=p(g),$=0;$<g;$+=1)b[$]=M[$]&255;return b}function z(M){if(Ke(M,Uint8Array)){var g=new Uint8Array(M);return N(g.buffer,g.byteOffset,g.byteLength)}return R(M)}function N(M,g,b){if(g<0||M.byteLength<g)throw new RangeError('"offset" is outside of buffer bounds');if(M.byteLength<g+(b||0))throw new RangeError('"length" is outside of buffer bounds');var $;return g===void 0&&b===void 0?$=new Uint8Array(M):b===void 0?$=new Uint8Array(M,g):$=new Uint8Array(M,g,b),Object.setPrototypeOf($,f.prototype),$}function L(M){if(f.isBuffer(M)){var g=D(M.length)|0,b=p(g);return b.length===0||M.copy(b,0,0,g),b}if(M.length!==void 0)return typeof M.length!="number"||pt(M.length)?p(0):R(M);if(M.type==="Buffer"&&Array.isArray(M.data))return R(M.data)}function D(M){if(M>=c)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c.toString(16)+" bytes");return M|0}function U(M){return+M!=M&&(M=0),f.alloc(+M)}f.isBuffer=function(g){return g!=null&&g._isBuffer===!0&&g!==f.prototype},f.compare=function(g,b){if(Ke(g,Uint8Array)&&(g=f.from(g,g.offset,g.byteLength)),Ke(b,Uint8Array)&&(b=f.from(b,b.offset,b.byteLength)),!f.isBuffer(g)||!f.isBuffer(b))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(g===b)return 0;for(var $=g.length,ae=b.length,ye=0,xe=Math.min($,ae);ye<xe;++ye)if(g[ye]!==b[ye]){$=g[ye],ae=b[ye];break}return $<ae?-1:ae<$?1:0},f.isEncoding=function(g){switch(String(g).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(g,b){if(!Array.isArray(g))throw new TypeError('"list" argument must be an Array of Buffers');if(g.length===0)return f.alloc(0);var $;if(b===void 0)for(b=0,$=0;$<g.length;++$)b+=g[$].length;var ae=f.allocUnsafe(b),ye=0;for($=0;$<g.length;++$){var xe=g[$];if(Ke(xe,Uint8Array))ye+xe.length>ae.length?f.from(xe).copy(ae,ye):Uint8Array.prototype.set.call(ae,xe,ye);else if(f.isBuffer(xe))xe.copy(ae,ye);else throw new TypeError('"list" argument must be an Array of Buffers');ye+=xe.length}return ae};function G(M,g){if(f.isBuffer(M))return M.length;if(ArrayBuffer.isView(M)||Ke(M,ArrayBuffer))return M.byteLength;if(typeof M!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof M);var b=M.length,$=arguments.length>2&&arguments[2]===!0;if(!$&&b===0)return 0;for(var ae=!1;;)switch(g){case"ascii":case"latin1":case"binary":return b;case"utf8":case"utf-8":return We(M).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b*2;case"hex":return b>>>1;case"base64":return at(M).length;default:if(ae)return $?-1:We(M).length;g=(""+g).toLowerCase(),ae=!0}}f.byteLength=G;function X(M,g,b){var $=!1;if((g===void 0||g<0)&&(g=0),g>this.length||((b===void 0||b>this.length)&&(b=this.length),b<=0)||(b>>>=0,g>>>=0,b<=g))return"";for(M||(M="utf8");;)switch(M){case"hex":return me(this,g,b);case"utf8":case"utf-8":return W(this,g,b);case"ascii":return re(this,g,b);case"latin1":case"binary":return le(this,g,b);case"base64":return se(this,g,b);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Fe(this,g,b);default:if($)throw new TypeError("Unknown encoding: "+M);M=(M+"").toLowerCase(),$=!0}}f.prototype._isBuffer=!0;function q(M,g,b){var $=M[g];M[g]=M[b],M[b]=$}f.prototype.swap16=function(){var g=this.length;if(g%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var b=0;b<g;b+=2)q(this,b,b+1);return this},f.prototype.swap32=function(){var g=this.length;if(g%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var b=0;b<g;b+=4)q(this,b,b+3),q(this,b+1,b+2);return this},f.prototype.swap64=function(){var g=this.length;if(g%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var b=0;b<g;b+=8)q(this,b,b+7),q(this,b+1,b+6),q(this,b+2,b+5),q(this,b+3,b+4);return this},f.prototype.toString=function(){var g=this.length;return g===0?"":arguments.length===0?W(this,0,g):X.apply(this,arguments)},f.prototype.toLocaleString=f.prototype.toString,f.prototype.equals=function(g){if(!f.isBuffer(g))throw new TypeError("Argument must be a Buffer");return this===g?!0:f.compare(this,g)===0},f.prototype.inspect=function(){var g="",b=e.INSPECT_MAX_BYTES;return g=this.toString("hex",0,b).replace(/(.{2})/g,"$1 ").trim(),this.length>b&&(g+=" ... "),"<Buffer "+g+">"},o&&(f.prototype[o]=f.prototype.inspect),f.prototype.compare=function(g,b,$,ae,ye){if(Ke(g,Uint8Array)&&(g=f.from(g,g.offset,g.byteLength)),!f.isBuffer(g))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof g);if(b===void 0&&(b=0),$===void 0&&($=g?g.length:0),ae===void 0&&(ae=0),ye===void 0&&(ye=this.length),b<0||$>g.length||ae<0||ye>this.length)throw new RangeError("out of range index");if(ae>=ye&&b>=$)return 0;if(ae>=ye)return-1;if(b>=$)return 1;if(b>>>=0,$>>>=0,ae>>>=0,ye>>>=0,this===g)return 0;for(var xe=ye-ae,Ve=$-b,Ye=Math.min(xe,Ve),nt=this.slice(ae,ye),ft=g.slice(b,$),st=0;st<Ye;++st)if(nt[st]!==ft[st]){xe=nt[st],Ve=ft[st];break}return xe<Ve?-1:Ve<xe?1:0};function Y(M,g,b,$,ae){if(M.length===0)return-1;if(typeof b=="string"?($=b,b=0):b>2147483647?b=2147483647:b<-2147483648&&(b=-2147483648),b=+b,pt(b)&&(b=ae?0:M.length-1),b<0&&(b=M.length+b),b>=M.length){if(ae)return-1;b=M.length-1}else if(b<0)if(ae)b=0;else return-1;if(typeof g=="string"&&(g=f.from(g,$)),f.isBuffer(g))return g.length===0?-1:B(M,g,b,$,ae);if(typeof g=="number")return g=g&255,typeof Uint8Array.prototype.indexOf=="function"?ae?Uint8Array.prototype.indexOf.call(M,g,b):Uint8Array.prototype.lastIndexOf.call(M,g,b):B(M,[g],b,$,ae);throw new TypeError("val must be string, number or Buffer")}function B(M,g,b,$,ae){var ye=1,xe=M.length,Ve=g.length;if($!==void 0&&($=String($).toLowerCase(),$==="ucs2"||$==="ucs-2"||$==="utf16le"||$==="utf-16le")){if(M.length<2||g.length<2)return-1;ye=2,xe/=2,Ve/=2,b/=2}function Ye(Bt,Jt){return ye===1?Bt[Jt]:Bt.readUInt16BE(Jt*ye)}var nt;if(ae){var ft=-1;for(nt=b;nt<xe;nt++)if(Ye(M,nt)===Ye(g,ft===-1?0:nt-ft)){if(ft===-1&&(ft=nt),nt-ft+1===Ve)return ft*ye}else ft!==-1&&(nt-=nt-ft),ft=-1}else for(b+Ve>xe&&(b=xe-Ve),nt=b;nt>=0;nt--){for(var st=!0,yt=0;yt<Ve;yt++)if(Ye(M,nt+yt)!==Ye(g,yt)){st=!1;break}if(st)return nt}return-1}f.prototype.includes=function(g,b,$){return this.indexOf(g,b,$)!==-1},f.prototype.indexOf=function(g,b,$){return Y(this,g,b,$,!0)},f.prototype.lastIndexOf=function(g,b,$){return Y(this,g,b,$,!1)};function K(M,g,b,$){b=Number(b)||0;var ae=M.length-b;$?($=Number($),$>ae&&($=ae)):$=ae;var ye=g.length;$>ye/2&&($=ye/2);for(var xe=0;xe<$;++xe){var Ve=parseInt(g.substr(xe*2,2),16);if(pt(Ve))return xe;M[b+xe]=Ve}return xe}function ce(M,g,b,$){return ze(We(g,M.length-b),M,b,$)}function S(M,g,b,$){return ze(rt(g),M,b,$)}function ie(M,g,b,$){return ze(at(g),M,b,$)}function Q(M,g,b,$){return ze(Xe(g,M.length-b),M,b,$)}f.prototype.write=function(g,b,$,ae){if(b===void 0)ae="utf8",$=this.length,b=0;else if($===void 0&&typeof b=="string")ae=b,$=this.length,b=0;else if(isFinite(b))b=b>>>0,isFinite($)?($=$>>>0,ae===void 0&&(ae="utf8")):(ae=$,$=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ye=this.length-b;if(($===void 0||$>ye)&&($=ye),g.length>0&&($<0||b<0)||b>this.length)throw new RangeError("Attempt to write outside buffer bounds");ae||(ae="utf8");for(var xe=!1;;)switch(ae){case"hex":return K(this,g,b,$);case"utf8":case"utf-8":return ce(this,g,b,$);case"ascii":case"latin1":case"binary":return S(this,g,b,$);case"base64":return ie(this,g,b,$);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Q(this,g,b,$);default:if(xe)throw new TypeError("Unknown encoding: "+ae);ae=(""+ae).toLowerCase(),xe=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function se(M,g,b){return g===0&&b===M.length?n.fromByteArray(M):n.fromByteArray(M.slice(g,b))}function W(M,g,b){b=Math.min(M.length,b);for(var $=[],ae=g;ae<b;){var ye=M[ae],xe=null,Ve=ye>239?4:ye>223?3:ye>191?2:1;if(ae+Ve<=b){var Ye,nt,ft,st;switch(Ve){case 1:ye<128&&(xe=ye);break;case 2:Ye=M[ae+1],(Ye&192)===128&&(st=(ye&31)<<6|Ye&63,st>127&&(xe=st));break;case 3:Ye=M[ae+1],nt=M[ae+2],(Ye&192)===128&&(nt&192)===128&&(st=(ye&15)<<12|(Ye&63)<<6|nt&63,st>2047&&(st<55296||st>57343)&&(xe=st));break;case 4:Ye=M[ae+1],nt=M[ae+2],ft=M[ae+3],(Ye&192)===128&&(nt&192)===128&&(ft&192)===128&&(st=(ye&15)<<18|(Ye&63)<<12|(nt&63)<<6|ft&63,st>65535&&st<1114112&&(xe=st))}}xe===null?(xe=65533,Ve=1):xe>65535&&(xe-=65536,$.push(xe>>>10&1023|55296),xe=56320|xe&1023),$.push(xe),ae+=Ve}return te($)}var oe=4096;function te(M){var g=M.length;if(g<=oe)return String.fromCharCode.apply(String,M);for(var b="",$=0;$<g;)b+=String.fromCharCode.apply(String,M.slice($,$+=oe));return b}function re(M,g,b){var $="";b=Math.min(M.length,b);for(var ae=g;ae<b;++ae)$+=String.fromCharCode(M[ae]&127);return $}function le(M,g,b){var $="";b=Math.min(M.length,b);for(var ae=g;ae<b;++ae)$+=String.fromCharCode(M[ae]);return $}function me(M,g,b){var $=M.length;(!g||g<0)&&(g=0),(!b||b<0||b>$)&&(b=$);for(var ae="",ye=g;ye<b;++ye)ae+=wt[M[ye]];return ae}function Fe(M,g,b){for(var $=M.slice(g,b),ae="",ye=0;ye<$.length-1;ye+=2)ae+=String.fromCharCode($[ye]+$[ye+1]*256);return ae}f.prototype.slice=function(g,b){var $=this.length;g=~~g,b=b===void 0?$:~~b,g<0?(g+=$,g<0&&(g=0)):g>$&&(g=$),b<0?(b+=$,b<0&&(b=0)):b>$&&(b=$),b<g&&(b=g);var ae=this.subarray(g,b);return Object.setPrototypeOf(ae,f.prototype),ae};function ve(M,g,b){if(M%1!==0||M<0)throw new RangeError("offset is not uint");if(M+g>b)throw new RangeError("Trying to access beyond buffer length")}f.prototype.readUintLE=f.prototype.readUIntLE=function(g,b,$){g=g>>>0,b=b>>>0,$||ve(g,b,this.length);for(var ae=this[g],ye=1,xe=0;++xe<b&&(ye*=256);)ae+=this[g+xe]*ye;return ae},f.prototype.readUintBE=f.prototype.readUIntBE=function(g,b,$){g=g>>>0,b=b>>>0,$||ve(g,b,this.length);for(var ae=this[g+--b],ye=1;b>0&&(ye*=256);)ae+=this[g+--b]*ye;return ae},f.prototype.readUint8=f.prototype.readUInt8=function(g,b){return g=g>>>0,b||ve(g,1,this.length),this[g]},f.prototype.readUint16LE=f.prototype.readUInt16LE=function(g,b){return g=g>>>0,b||ve(g,2,this.length),this[g]|this[g+1]<<8},f.prototype.readUint16BE=f.prototype.readUInt16BE=function(g,b){return g=g>>>0,b||ve(g,2,this.length),this[g]<<8|this[g+1]},f.prototype.readUint32LE=f.prototype.readUInt32LE=function(g,b){return g=g>>>0,b||ve(g,4,this.length),(this[g]|this[g+1]<<8|this[g+2]<<16)+this[g+3]*16777216},f.prototype.readUint32BE=f.prototype.readUInt32BE=function(g,b){return g=g>>>0,b||ve(g,4,this.length),this[g]*16777216+(this[g+1]<<16|this[g+2]<<8|this[g+3])},f.prototype.readIntLE=function(g,b,$){g=g>>>0,b=b>>>0,$||ve(g,b,this.length);for(var ae=this[g],ye=1,xe=0;++xe<b&&(ye*=256);)ae+=this[g+xe]*ye;return ye*=128,ae>=ye&&(ae-=Math.pow(2,8*b)),ae},f.prototype.readIntBE=function(g,b,$){g=g>>>0,b=b>>>0,$||ve(g,b,this.length);for(var ae=b,ye=1,xe=this[g+--ae];ae>0&&(ye*=256);)xe+=this[g+--ae]*ye;return ye*=128,xe>=ye&&(xe-=Math.pow(2,8*b)),xe},f.prototype.readInt8=function(g,b){return g=g>>>0,b||ve(g,1,this.length),this[g]&128?(255-this[g]+1)*-1:this[g]},f.prototype.readInt16LE=function(g,b){g=g>>>0,b||ve(g,2,this.length);var $=this[g]|this[g+1]<<8;return $&32768?$|4294901760:$},f.prototype.readInt16BE=function(g,b){g=g>>>0,b||ve(g,2,this.length);var $=this[g+1]|this[g]<<8;return $&32768?$|4294901760:$},f.prototype.readInt32LE=function(g,b){return g=g>>>0,b||ve(g,4,this.length),this[g]|this[g+1]<<8|this[g+2]<<16|this[g+3]<<24},f.prototype.readInt32BE=function(g,b){return g=g>>>0,b||ve(g,4,this.length),this[g]<<24|this[g+1]<<16|this[g+2]<<8|this[g+3]},f.prototype.readFloatLE=function(g,b){return g=g>>>0,b||ve(g,4,this.length),r.read(this,g,!0,23,4)},f.prototype.readFloatBE=function(g,b){return g=g>>>0,b||ve(g,4,this.length),r.read(this,g,!1,23,4)},f.prototype.readDoubleLE=function(g,b){return g=g>>>0,b||ve(g,8,this.length),r.read(this,g,!0,52,8)},f.prototype.readDoubleBE=function(g,b){return g=g>>>0,b||ve(g,8,this.length),r.read(this,g,!1,52,8)};function Re(M,g,b,$,ae,ye){if(!f.isBuffer(M))throw new TypeError('"buffer" argument must be a Buffer instance');if(g>ae||g<ye)throw new RangeError('"value" argument is out of bounds');if(b+$>M.length)throw new RangeError("Index out of range")}f.prototype.writeUintLE=f.prototype.writeUIntLE=function(g,b,$,ae){if(g=+g,b=b>>>0,$=$>>>0,!ae){var ye=Math.pow(2,8*$)-1;Re(this,g,b,$,ye,0)}var xe=1,Ve=0;for(this[b]=g&255;++Ve<$&&(xe*=256);)this[b+Ve]=g/xe&255;return b+$},f.prototype.writeUintBE=f.prototype.writeUIntBE=function(g,b,$,ae){if(g=+g,b=b>>>0,$=$>>>0,!ae){var ye=Math.pow(2,8*$)-1;Re(this,g,b,$,ye,0)}var xe=$-1,Ve=1;for(this[b+xe]=g&255;--xe>=0&&(Ve*=256);)this[b+xe]=g/Ve&255;return b+$},f.prototype.writeUint8=f.prototype.writeUInt8=function(g,b,$){return g=+g,b=b>>>0,$||Re(this,g,b,1,255,0),this[b]=g&255,b+1},f.prototype.writeUint16LE=f.prototype.writeUInt16LE=function(g,b,$){return g=+g,b=b>>>0,$||Re(this,g,b,2,65535,0),this[b]=g&255,this[b+1]=g>>>8,b+2},f.prototype.writeUint16BE=f.prototype.writeUInt16BE=function(g,b,$){return g=+g,b=b>>>0,$||Re(this,g,b,2,65535,0),this[b]=g>>>8,this[b+1]=g&255,b+2},f.prototype.writeUint32LE=f.prototype.writeUInt32LE=function(g,b,$){return g=+g,b=b>>>0,$||Re(this,g,b,4,4294967295,0),this[b+3]=g>>>24,this[b+2]=g>>>16,this[b+1]=g>>>8,this[b]=g&255,b+4},f.prototype.writeUint32BE=f.prototype.writeUInt32BE=function(g,b,$){return g=+g,b=b>>>0,$||Re(this,g,b,4,4294967295,0),this[b]=g>>>24,this[b+1]=g>>>16,this[b+2]=g>>>8,this[b+3]=g&255,b+4},f.prototype.writeIntLE=function(g,b,$,ae){if(g=+g,b=b>>>0,!ae){var ye=Math.pow(2,8*$-1);Re(this,g,b,$,ye-1,-ye)}var xe=0,Ve=1,Ye=0;for(this[b]=g&255;++xe<$&&(Ve*=256);)g<0&&Ye===0&&this[b+xe-1]!==0&&(Ye=1),this[b+xe]=(g/Ve>>0)-Ye&255;return b+$},f.prototype.writeIntBE=function(g,b,$,ae){if(g=+g,b=b>>>0,!ae){var ye=Math.pow(2,8*$-1);Re(this,g,b,$,ye-1,-ye)}var xe=$-1,Ve=1,Ye=0;for(this[b+xe]=g&255;--xe>=0&&(Ve*=256);)g<0&&Ye===0&&this[b+xe+1]!==0&&(Ye=1),this[b+xe]=(g/Ve>>0)-Ye&255;return b+$},f.prototype.writeInt8=function(g,b,$){return g=+g,b=b>>>0,$||Re(this,g,b,1,127,-128),g<0&&(g=255+g+1),this[b]=g&255,b+1},f.prototype.writeInt16LE=function(g,b,$){return g=+g,b=b>>>0,$||Re(this,g,b,2,32767,-32768),this[b]=g&255,this[b+1]=g>>>8,b+2},f.prototype.writeInt16BE=function(g,b,$){return g=+g,b=b>>>0,$||Re(this,g,b,2,32767,-32768),this[b]=g>>>8,this[b+1]=g&255,b+2},f.prototype.writeInt32LE=function(g,b,$){return g=+g,b=b>>>0,$||Re(this,g,b,4,2147483647,-2147483648),this[b]=g&255,this[b+1]=g>>>8,this[b+2]=g>>>16,this[b+3]=g>>>24,b+4},f.prototype.writeInt32BE=function(g,b,$){return g=+g,b=b>>>0,$||Re(this,g,b,4,2147483647,-2147483648),g<0&&(g=4294967295+g+1),this[b]=g>>>24,this[b+1]=g>>>16,this[b+2]=g>>>8,this[b+3]=g&255,b+4};function He(M,g,b,$,ae,ye){if(b+$>M.length)throw new RangeError("Index out of range");if(b<0)throw new RangeError("Index out of range")}function tt(M,g,b,$,ae){return g=+g,b=b>>>0,ae||He(M,g,b,4),r.write(M,g,b,$,23,4),b+4}f.prototype.writeFloatLE=function(g,b,$){return tt(this,g,b,!0,$)},f.prototype.writeFloatBE=function(g,b,$){return tt(this,g,b,!1,$)};function it(M,g,b,$,ae){return g=+g,b=b>>>0,ae||He(M,g,b,8),r.write(M,g,b,$,52,8),b+8}f.prototype.writeDoubleLE=function(g,b,$){return it(this,g,b,!0,$)},f.prototype.writeDoubleBE=function(g,b,$){return it(this,g,b,!1,$)},f.prototype.copy=function(g,b,$,ae){if(!f.isBuffer(g))throw new TypeError("argument should be a Buffer");if($||($=0),!ae&&ae!==0&&(ae=this.length),b>=g.length&&(b=g.length),b||(b=0),ae>0&&ae<$&&(ae=$),ae===$||g.length===0||this.length===0)return 0;if(b<0)throw new RangeError("targetStart out of bounds");if($<0||$>=this.length)throw new RangeError("Index out of range");if(ae<0)throw new RangeError("sourceEnd out of bounds");ae>this.length&&(ae=this.length),g.length-b<ae-$&&(ae=g.length-b+$);var ye=ae-$;return this===g&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(b,$,ae):Uint8Array.prototype.set.call(g,this.subarray($,ae),b),ye},f.prototype.fill=function(g,b,$,ae){if(typeof g=="string"){if(typeof b=="string"?(ae=b,b=0,$=this.length):typeof $=="string"&&(ae=$,$=this.length),ae!==void 0&&typeof ae!="string")throw new TypeError("encoding must be a string");if(typeof ae=="string"&&!f.isEncoding(ae))throw new TypeError("Unknown encoding: "+ae);if(g.length===1){var ye=g.charCodeAt(0);(ae==="utf8"&&ye<128||ae==="latin1")&&(g=ye)}}else typeof g=="number"?g=g&255:typeof g=="boolean"&&(g=Number(g));if(b<0||this.length<b||this.length<$)throw new RangeError("Out of range index");if($<=b)return this;b=b>>>0,$=$===void 0?this.length:$>>>0,g||(g=0);var xe;if(typeof g=="number")for(xe=b;xe<$;++xe)this[xe]=g;else{var Ve=f.isBuffer(g)?g:f.from(g,ae),Ye=Ve.length;if(Ye===0)throw new TypeError('The value "'+g+'" is invalid for argument "value"');for(xe=0;xe<$-b;++xe)this[xe+b]=Ve[xe%Ye]}return this};var Je=/[^+/0-9A-Za-z-_]/g;function Ge(M){if(M=M.split("=")[0],M=M.trim().replace(Je,""),M.length<2)return"";for(;M.length%4!==0;)M=M+"=";return M}function We(M,g){g=g||1/0;for(var b,$=M.length,ae=null,ye=[],xe=0;xe<$;++xe){if(b=M.charCodeAt(xe),b>55295&&b<57344){if(!ae){if(b>56319){(g-=3)>-1&&ye.push(239,191,189);continue}else if(xe+1===$){(g-=3)>-1&&ye.push(239,191,189);continue}ae=b;continue}if(b<56320){(g-=3)>-1&&ye.push(239,191,189),ae=b;continue}b=(ae-55296<<10|b-56320)+65536}else ae&&(g-=3)>-1&&ye.push(239,191,189);if(ae=null,b<128){if((g-=1)<0)break;ye.push(b)}else if(b<2048){if((g-=2)<0)break;ye.push(b>>6|192,b&63|128)}else if(b<65536){if((g-=3)<0)break;ye.push(b>>12|224,b>>6&63|128,b&63|128)}else if(b<1114112){if((g-=4)<0)break;ye.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw new Error("Invalid code point")}return ye}function rt(M){for(var g=[],b=0;b<M.length;++b)g.push(M.charCodeAt(b)&255);return g}function Xe(M,g){for(var b,$,ae,ye=[],xe=0;xe<M.length&&!((g-=2)<0);++xe)b=M.charCodeAt(xe),$=b>>8,ae=b%256,ye.push(ae),ye.push($);return ye}function at(M){return n.toByteArray(Ge(M))}function ze(M,g,b,$){for(var ae=0;ae<$&&!(ae+b>=g.length||ae>=M.length);++ae)g[ae+b]=M[ae];return ae}function Ke(M,g){return M instanceof g||M!=null&&M.constructor!=null&&M.constructor.name!=null&&M.constructor.name===g.name}function pt(M){return M!==M}var wt=(function(){for(var M="0123456789abcdef",g=new Array(256),b=0;b<16;++b)for(var $=b*16,ae=0;ae<16;++ae)g[$+ae]=M[b]+M[ae];return g})()})(Ia)),Ia}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var bu;function Ss(){return bu||(bu=1,(function(e,n){var r=hw(),o=r.Buffer;function c(p,f){for(var h in p)f[h]=p[h]}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?e.exports=r:(c(r,n),n.Buffer=u);function u(p,f,h){return o(p,f,h)}u.prototype=Object.create(o.prototype),c(o,u),u.from=function(p,f,h){if(typeof p=="number")throw new TypeError("Argument must not be a number");return o(p,f,h)},u.alloc=function(p,f,h){if(typeof p!="number")throw new TypeError("Argument must be a number");var x=o(p);return f!==void 0?typeof h=="string"?x.fill(f,h):x.fill(f):x.fill(0),x},u.allocUnsafe=function(p){if(typeof p!="number")throw new TypeError("Argument must be a number");return o(p)},u.allocUnsafeSlow=function(p){if(typeof p!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(p)}})(xi,xi.exports)),xi.exports}var Aa,vu;function pw(){if(vu)return Aa;vu=1;var e={}.toString;return Aa=Array.isArray||function(n){return e.call(n)=="[object Array]"},Aa}var Ca,xu;function Zn(){return xu||(xu=1,Ca=TypeError),Ca}var Ta,_u;function Nd(){return _u||(_u=1,Ta=Object),Ta}var Ra,Su;function gw(){return Su||(Su=1,Ra=Error),Ra}var Oa,ku;function mw(){return ku||(ku=1,Oa=EvalError),Oa}var Ma,Eu;function ww(){return Eu||(Eu=1,Ma=RangeError),Ma}var Pa,Iu;function yw(){return Iu||(Iu=1,Pa=ReferenceError),Pa}var ja,Au;function Ud(){return Au||(Au=1,ja=SyntaxError),ja}var Ba,Cu;function bw(){return Cu||(Cu=1,Ba=URIError),Ba}var Fa,Tu;function vw(){return Tu||(Tu=1,Fa=Math.abs),Fa}var Da,Ru;function xw(){return Ru||(Ru=1,Da=Math.floor),Da}var La,Ou;function _w(){return Ou||(Ou=1,La=Math.max),La}var $a,Mu;function Sw(){return Mu||(Mu=1,$a=Math.min),$a}var Na,Pu;function kw(){return Pu||(Pu=1,Na=Math.pow),Na}var Ua,ju;function Ew(){return ju||(ju=1,Ua=Math.round),Ua}var za,Bu;function Iw(){return Bu||(Bu=1,za=Number.isNaN||function(n){return n!==n}),za}var Ga,Fu;function Aw(){if(Fu)return Ga;Fu=1;var e=Iw();return Ga=function(r){return e(r)||r===0?r:r<0?-1:1},Ga}var Ha,Du;function Cw(){return Du||(Du=1,Ha=Object.getOwnPropertyDescriptor),Ha}var Wa,Lu;function Xn(){if(Lu)return Wa;Lu=1;var e=Cw();if(e)try{e([],"length")}catch{e=null}return Wa=e,Wa}var qa,$u;function Ui(){if($u)return qa;$u=1;var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return qa=e,qa}var Va,Nu;function zd(){return Nu||(Nu=1,Va=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var n={},r=Symbol("test"),o=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(o)!=="[object Symbol]")return!1;var c=42;n[r]=c;for(var u in n)return!1;if(typeof Object.keys=="function"&&Object.keys(n).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(n).length!==0)return!1;var p=Object.getOwnPropertySymbols(n);if(p.length!==1||p[0]!==r||!Object.prototype.propertyIsEnumerable.call(n,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var f=Object.getOwnPropertyDescriptor(n,r);if(f.value!==c||f.enumerable!==!0)return!1}return!0}),Va}var Ka,Uu;function Tw(){if(Uu)return Ka;Uu=1;var e=typeof Symbol<"u"&&Symbol,n=zd();return Ka=function(){return typeof e!="function"||typeof Symbol!="function"||typeof e("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:n()},Ka}var Za,zu;function Gd(){return zu||(zu=1,Za=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),Za}var Xa,Gu;function Hd(){if(Gu)return Xa;Gu=1;var e=Nd();return Xa=e.getPrototypeOf||null,Xa}var Ya,Hu;function Rw(){if(Hu)return Ya;Hu=1;var e="Function.prototype.bind called on incompatible ",n=Object.prototype.toString,r=Math.max,o="[object Function]",c=function(h,x){for(var _=[],y=0;y<h.length;y+=1)_[y]=h[y];for(var O=0;O<x.length;O+=1)_[O+h.length]=x[O];return _},u=function(h,x){for(var _=[],y=x,O=0;y<h.length;y+=1,O+=1)_[O]=h[y];return _},p=function(f,h){for(var x="",_=0;_<f.length;_+=1)x+=f[_],_+1<f.length&&(x+=h);return x};return Ya=function(h){var x=this;if(typeof x!="function"||n.apply(x)!==o)throw new TypeError(e+x);for(var _=u(arguments,1),y,O=function(){if(this instanceof y){var D=x.apply(this,c(_,arguments));return Object(D)===D?D:this}return x.apply(h,c(_,arguments))},R=r(0,x.length-_.length),z=[],N=0;N<R;N++)z[N]="$"+N;if(y=Function("binder","return function ("+p(z,",")+"){ return binder.apply(this,arguments); }")(O),x.prototype){var L=function(){};L.prototype=x.prototype,y.prototype=new L,L.prototype=null}return y},Ya}var Ja,Wu;function Yn(){if(Wu)return Ja;Wu=1;var e=Rw();return Ja=Function.prototype.bind||e,Ja}var Qa,qu;function ks(){return qu||(qu=1,Qa=Function.prototype.call),Qa}var eo,Vu;function Es(){return Vu||(Vu=1,eo=Function.prototype.apply),eo}var to,Ku;function Ow(){return Ku||(Ku=1,to=typeof Reflect<"u"&&Reflect&&Reflect.apply),to}var ro,Zu;function Wd(){if(Zu)return ro;Zu=1;var e=Yn(),n=Es(),r=ks(),o=Ow();return ro=o||e.call(r,n),ro}var no,Xu;function Is(){if(Xu)return no;Xu=1;var e=Yn(),n=Zn(),r=ks(),o=Wd();return no=function(u){if(u.length<1||typeof u[0]!="function")throw new n("a function is required");return o(e,r,u)},no}var io,Yu;function Mw(){if(Yu)return io;Yu=1;var e=Is(),n=Xn(),r;try{r=[].__proto__===Array.prototype}catch(p){if(!p||typeof p!="object"||!("code"in p)||p.code!=="ERR_PROTO_ACCESS")throw p}var o=!!r&&n&&n(Object.prototype,"__proto__"),c=Object,u=c.getPrototypeOf;return io=o&&typeof o.get=="function"?e([o.get]):typeof u=="function"?function(f){return u(f==null?f:c(f))}:!1,io}var ao,Ju;function qd(){if(Ju)return ao;Ju=1;var e=Gd(),n=Hd(),r=Mw();return ao=e?function(c){return e(c)}:n?function(c){if(!c||typeof c!="object"&&typeof c!="function")throw new TypeError("getProto: not an object");return n(c)}:r?function(c){return r(c)}:null,ao}var oo,Qu;function Pw(){if(Qu)return oo;Qu=1;var e=Function.prototype.call,n=Object.prototype.hasOwnProperty,r=Yn();return oo=r.call(e,n),oo}var so,ef;function Vd(){if(ef)return so;ef=1;var e,n=Nd(),r=gw(),o=mw(),c=ww(),u=yw(),p=Ud(),f=Zn(),h=bw(),x=vw(),_=xw(),y=_w(),O=Sw(),R=kw(),z=Ew(),N=Aw(),L=Function,D=function(rt){try{return L('"use strict"; return ('+rt+").constructor;")()}catch{}},U=Xn(),G=Ui(),X=function(){throw new f},q=U?(function(){try{return arguments.callee,X}catch{try{return U(arguments,"callee").get}catch{return X}}})():X,Y=Tw()(),B=qd(),K=Hd(),ce=Gd(),S=Es(),ie=ks(),Q={},se=typeof Uint8Array>"u"||!B?e:B(Uint8Array),W={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?e:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?e:ArrayBuffer,"%ArrayIteratorPrototype%":Y&&B?B([][Symbol.iterator]()):e,"%AsyncFromSyncIteratorPrototype%":e,"%AsyncFunction%":Q,"%AsyncGenerator%":Q,"%AsyncGeneratorFunction%":Q,"%AsyncIteratorPrototype%":Q,"%Atomics%":typeof Atomics>"u"?e:Atomics,"%BigInt%":typeof BigInt>"u"?e:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?e:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?e:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?e:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":o,"%Float16Array%":typeof Float16Array>"u"?e:Float16Array,"%Float32Array%":typeof Float32Array>"u"?e:Float32Array,"%Float64Array%":typeof Float64Array>"u"?e:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?e:FinalizationRegistry,"%Function%":L,"%GeneratorFunction%":Q,"%Int8Array%":typeof Int8Array>"u"?e:Int8Array,"%Int16Array%":typeof Int16Array>"u"?e:Int16Array,"%Int32Array%":typeof Int32Array>"u"?e:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Y&&B?B(B([][Symbol.iterator]())):e,"%JSON%":typeof JSON=="object"?JSON:e,"%Map%":typeof Map>"u"?e:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Y||!B?e:B(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":n,"%Object.getOwnPropertyDescriptor%":U,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?e:Promise,"%Proxy%":typeof Proxy>"u"?e:Proxy,"%RangeError%":c,"%ReferenceError%":u,"%Reflect%":typeof Reflect>"u"?e:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?e:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Y||!B?e:B(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?e:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Y&&B?B(""[Symbol.iterator]()):e,"%Symbol%":Y?Symbol:e,"%SyntaxError%":p,"%ThrowTypeError%":q,"%TypedArray%":se,"%TypeError%":f,"%Uint8Array%":typeof Uint8Array>"u"?e:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?e:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?e:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?e:Uint32Array,"%URIError%":h,"%WeakMap%":typeof WeakMap>"u"?e:WeakMap,"%WeakRef%":typeof WeakRef>"u"?e:WeakRef,"%WeakSet%":typeof WeakSet>"u"?e:WeakSet,"%Function.prototype.call%":ie,"%Function.prototype.apply%":S,"%Object.defineProperty%":G,"%Object.getPrototypeOf%":K,"%Math.abs%":x,"%Math.floor%":_,"%Math.max%":y,"%Math.min%":O,"%Math.pow%":R,"%Math.round%":z,"%Math.sign%":N,"%Reflect.getPrototypeOf%":ce};if(B)try{null.error}catch(rt){var oe=B(B(rt));W["%Error.prototype%"]=oe}var te=function rt(Xe){var at;if(Xe==="%AsyncFunction%")at=D("async function () {}");else if(Xe==="%GeneratorFunction%")at=D("function* () {}");else if(Xe==="%AsyncGeneratorFunction%")at=D("async function* () {}");else if(Xe==="%AsyncGenerator%"){var ze=rt("%AsyncGeneratorFunction%");ze&&(at=ze.prototype)}else if(Xe==="%AsyncIteratorPrototype%"){var Ke=rt("%AsyncGenerator%");Ke&&B&&(at=B(Ke.prototype))}return W[Xe]=at,at},re={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},le=Yn(),me=Pw(),Fe=le.call(ie,Array.prototype.concat),ve=le.call(S,Array.prototype.splice),Re=le.call(ie,String.prototype.replace),He=le.call(ie,String.prototype.slice),tt=le.call(ie,RegExp.prototype.exec),it=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Je=/\\(\\)?/g,Ge=function(Xe){var at=He(Xe,0,1),ze=He(Xe,-1);if(at==="%"&&ze!=="%")throw new p("invalid intrinsic syntax, expected closing `%`");if(ze==="%"&&at!=="%")throw new p("invalid intrinsic syntax, expected opening `%`");var Ke=[];return Re(Xe,it,function(pt,wt,M,g){Ke[Ke.length]=M?Re(g,Je,"$1"):wt||pt}),Ke},We=function(Xe,at){var ze=Xe,Ke;if(me(re,ze)&&(Ke=re[ze],ze="%"+Ke[0]+"%"),me(W,ze)){var pt=W[ze];if(pt===Q&&(pt=te(ze)),typeof pt>"u"&&!at)throw new f("intrinsic "+Xe+" exists, but is not available. Please file an issue!");return{alias:Ke,name:ze,value:pt}}throw new p("intrinsic "+Xe+" does not exist!")};return so=function(Xe,at){if(typeof Xe!="string"||Xe.length===0)throw new f("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof at!="boolean")throw new f('"allowMissing" argument must be a boolean');if(tt(/^%?[^%]*%?$/,Xe)===null)throw new p("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var ze=Ge(Xe),Ke=ze.length>0?ze[0]:"",pt=We("%"+Ke+"%",at),wt=pt.name,M=pt.value,g=!1,b=pt.alias;b&&(Ke=b[0],ve(ze,Fe([0,1],b)));for(var $=1,ae=!0;$<ze.length;$+=1){var ye=ze[$],xe=He(ye,0,1),Ve=He(ye,-1);if((xe==='"'||xe==="'"||xe==="`"||Ve==='"'||Ve==="'"||Ve==="`")&&xe!==Ve)throw new p("property names with quotes must have matching quotes");if((ye==="constructor"||!ae)&&(g=!0),Ke+="."+ye,wt="%"+Ke+"%",me(W,wt))M=W[wt];else if(M!=null){if(!(ye in M)){if(!at)throw new f("base intrinsic for "+Xe+" exists, but the property is not available.");return}if(U&&$+1>=ze.length){var Ye=U(M,ye);ae=!!Ye,ae&&"get"in Ye&&!("originalValue"in Ye.get)?M=Ye.get:M=M[ye]}else ae=me(M,ye),M=M[ye];ae&&!g&&(W[wt]=M)}}return M},so}var co,tf;function Kd(){if(tf)return co;tf=1;var e=Vd(),n=Is(),r=n([e("%String.prototype.indexOf%")]);return co=function(c,u){var p=e(c,!!u);return typeof p=="function"&&r(c,".prototype.")>-1?n([p]):p},co}var lo,rf;function jw(){if(rf)return lo;rf=1;var e=Function.prototype.toString,n=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,r,o;if(typeof n=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw o}}),o={},n(function(){throw 42},null,r)}catch(U){U!==o&&(n=null)}else n=null;var c=/^\s*class\b/,u=function(G){try{var X=e.call(G);return c.test(X)}catch{return!1}},p=function(G){try{return u(G)?!1:(e.call(G),!0)}catch{return!1}},f=Object.prototype.toString,h="[object Object]",x="[object Function]",_="[object GeneratorFunction]",y="[object HTMLAllCollection]",O="[object HTML document.all class]",R="[object HTMLCollection]",z=typeof Symbol=="function"&&!!Symbol.toStringTag,N=!(0 in[,]),L=function(){return!1};if(typeof document=="object"){var D=document.all;f.call(D)===f.call(document.all)&&(L=function(G){if((N||!G)&&(typeof G>"u"||typeof G=="object"))try{var X=f.call(G);return(X===y||X===O||X===R||X===h)&&G("")==null}catch{}return!1})}return lo=n?function(G){if(L(G))return!0;if(!G||typeof G!="function"&&typeof G!="object")return!1;try{n(G,null,r)}catch(X){if(X!==o)return!1}return!u(G)&&p(G)}:function(G){if(L(G))return!0;if(!G||typeof G!="function"&&typeof G!="object")return!1;if(z)return p(G);if(u(G))return!1;var X=f.call(G);return X!==x&&X!==_&&!/^\[object HTML/.test(X)?!1:p(G)},lo}var uo,nf;function Bw(){if(nf)return uo;nf=1;var e=jw(),n=Object.prototype.toString,r=Object.prototype.hasOwnProperty,o=function(h,x,_){for(var y=0,O=h.length;y<O;y++)r.call(h,y)&&(_==null?x(h[y],y,h):x.call(_,h[y],y,h))},c=function(h,x,_){for(var y=0,O=h.length;y<O;y++)_==null?x(h.charAt(y),y,h):x.call(_,h.charAt(y),y,h)},u=function(h,x,_){for(var y in h)r.call(h,y)&&(_==null?x(h[y],y,h):x.call(_,h[y],y,h))};function p(f){return n.call(f)==="[object Array]"}return uo=function(h,x,_){if(!e(x))throw new TypeError("iterator must be a function");var y;arguments.length>=3&&(y=_),p(h)?o(h,x,y):typeof h=="string"?c(h,x,y):u(h,x,y)},uo}var fo,af;function Fw(){return af||(af=1,fo=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]),fo}var ho,of;function Dw(){if(of)return ho;of=1;var e=Fw(),n=typeof globalThis>"u"?Ii:globalThis;return ho=function(){for(var o=[],c=0;c<e.length;c++)typeof n[e[c]]=="function"&&(o[o.length]=e[c]);return o},ho}var po={exports:{}},go,sf;function Lw(){if(sf)return go;sf=1;var e=Ui(),n=Ud(),r=Zn(),o=Xn();return go=function(u,p,f){if(!u||typeof u!="object"&&typeof u!="function")throw new r("`obj` must be an object or a function`");if(typeof p!="string"&&typeof p!="symbol")throw new r("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new r("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new r("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new r("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new r("`loose`, if provided, must be a boolean");var h=arguments.length>3?arguments[3]:null,x=arguments.length>4?arguments[4]:null,_=arguments.length>5?arguments[5]:null,y=arguments.length>6?arguments[6]:!1,O=!!o&&o(u,p);if(e)e(u,p,{configurable:_===null&&O?O.configurable:!_,enumerable:h===null&&O?O.enumerable:!h,value:f,writable:x===null&&O?O.writable:!x});else if(y||!h&&!x&&!_)u[p]=f;else throw new n("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},go}var mo,cf;function $w(){if(cf)return mo;cf=1;var e=Ui(),n=function(){return!!e};return n.hasArrayLengthDefineBug=function(){if(!e)return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},mo=n,mo}var wo,lf;function Nw(){if(lf)return wo;lf=1;var e=Vd(),n=Lw(),r=$w()(),o=Xn(),c=Zn(),u=e("%Math.floor%");return wo=function(f,h){if(typeof f!="function")throw new c("`fn` is not a function");if(typeof h!="number"||h<0||h>4294967295||u(h)!==h)throw new c("`length` must be a positive 32-bit integer");var x=arguments.length>2&&!!arguments[2],_=!0,y=!0;if("length"in f&&o){var O=o(f,"length");O&&!O.configurable&&(_=!1),O&&!O.writable&&(y=!1)}return(_||y||!x)&&(r?n(f,"length",h,!0,!0):n(f,"length",h)),f},wo}var yo,uf;function Uw(){if(uf)return yo;uf=1;var e=Yn(),n=Es(),r=Wd();return yo=function(){return r(e,n,arguments)},yo}var ff;function zw(){return ff||(ff=1,(function(e){var n=Nw(),r=Ui(),o=Is(),c=Uw();e.exports=function(p){var f=o(arguments),h=p.length-(arguments.length-1);return n(f,1+(h>0?h:0),!0)},r?r(e.exports,"apply",{value:c}):e.exports.apply=c})(po)),po.exports}var bo,df;function Gw(){if(df)return bo;df=1;var e=zd();return bo=function(){return e()&&!!Symbol.toStringTag},bo}var vo,hf;function Hw(){if(hf)return vo;hf=1;var e=Bw(),n=Dw(),r=zw(),o=Kd(),c=Xn(),u=qd(),p=o("Object.prototype.toString"),f=Gw()(),h=typeof globalThis>"u"?Ii:globalThis,x=n(),_=o("String.prototype.slice"),y=o("Array.prototype.indexOf",!0)||function(L,D){for(var U=0;U<L.length;U+=1)if(L[U]===D)return U;return-1},O={__proto__:null};f&&c&&u?e(x,function(N){var L=new h[N];if(Symbol.toStringTag in L&&u){var D=u(L),U=c(D,Symbol.toStringTag);if(!U&&D){var G=u(D);U=c(G,Symbol.toStringTag)}if(U&&U.get){var X=r(U.get);O["$"+N]=X}}}):e(x,function(N){var L=new h[N],D=L.slice||L.set;if(D){var U=r(D);O["$"+N]=U}});var R=function(L){var D=!1;return e(O,function(U,G){if(!D)try{"$"+U(L)===G&&(D=_(G,1))}catch{}}),D},z=function(L){var D=!1;return e(O,function(U,G){if(!D)try{U(L),D=_(G,1)}catch{}}),D};return vo=function(L){if(!L||typeof L!="object")return!1;if(!f){var D=_(p(L),8,-1);return y(x,D)>-1?D:D!=="Object"?!1:z(L)}return c?R(L):null},vo}var xo,pf;function Ww(){if(pf)return xo;pf=1;var e=Hw();return xo=function(r){return!!e(r)},xo}var _o,gf;function qw(){if(gf)return _o;gf=1;var e=Zn(),n=Kd(),r=n("TypedArray.prototype.buffer",!0),o=Ww();return _o=r||function(u){if(!o(u))throw new e("Not a Typed Array");return u.buffer},_o}var So,mf;function Vw(){if(mf)return So;mf=1;var e=Ss().Buffer,n=pw(),r=qw(),o=ArrayBuffer.isView||function(h){try{return r(h),!0}catch{return!1}},c=typeof Uint8Array<"u",u=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",p=u&&(e.prototype instanceof Uint8Array||e.TYPED_ARRAY_SUPPORT);return So=function(h,x){if(e.isBuffer(h))return h.constructor&&!("isBuffer"in h)?e.from(h):h;if(typeof h=="string")return e.from(h,x);if(u&&o(h)){if(h.byteLength===0)return e.alloc(0);if(p){var _=e.from(h.buffer,h.byteOffset,h.byteLength);if(_.byteLength===h.byteLength)return _}var y=h instanceof Uint8Array?h:new Uint8Array(h.buffer,h.byteOffset,h.byteLength),O=e.from(y);if(O.length===h.byteLength)return O}if(c&&h instanceof Uint8Array)return e.from(h);var R=n(h);if(R)for(var z=0;z<h.length;z+=1){var N=h[z];if(typeof N!="number"||N<0||N>255||~~N!==N)throw new RangeError("Array items must be numbers in the range 0-255.")}if(R||e.isBuffer(h)&&h.constructor&&typeof h.constructor.isBuffer=="function"&&h.constructor.isBuffer(h))return e.from(h);throw new TypeError('The "data" argument must be a string, an Array, a Buffer, a Uint8Array, or a DataView.')},So}var ko,wf;function Kw(){if(wf)return ko;wf=1;var e=Ss().Buffer,n=Vw();function r(o,c){this._block=e.alloc(o),this._finalSize=c,this._blockSize=o,this._len=0}return r.prototype.update=function(o,c){o=n(o,c||"utf8");for(var u=this._block,p=this._blockSize,f=o.length,h=this._len,x=0;x<f;){for(var _=h%p,y=Math.min(f-x,p-_),O=0;O<y;O++)u[_+O]=o[x+O];h+=y,x+=y,h%p===0&&this._update(u)}return this._len+=f,this},r.prototype.digest=function(o){var c=this._len%this._blockSize;this._block[c]=128,this._block.fill(0,c+1),c>=this._finalSize&&(this._update(this._block),this._block.fill(0));var u=this._len*8;if(u<=4294967295)this._block.writeUInt32BE(u,this._blockSize-4);else{var p=(u&4294967295)>>>0,f=(u-p)/4294967296;this._block.writeUInt32BE(f,this._blockSize-8),this._block.writeUInt32BE(p,this._blockSize-4)}this._update(this._block);var h=this._hash();return o?h.toString(o):h},r.prototype._update=function(){throw new Error("_update must be implemented by subclass")},ko=r,ko}var Eo,yf;function Zw(){if(yf)return Eo;yf=1;var e=uw(),n=Kw(),r=Ss().Buffer,o=[1518500249,1859775393,-1894007588,-899497514],c=new Array(80);function u(){this.init(),this._w=c,n.call(this,64,56)}e(u,n),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function p(_){return _<<1|_>>>31}function f(_){return _<<5|_>>>27}function h(_){return _<<30|_>>>2}function x(_,y,O,R){return _===0?y&O|~y&R:_===2?y&O|y&R|O&R:y^O^R}return u.prototype._update=function(_){for(var y=this._w,O=this._a|0,R=this._b|0,z=this._c|0,N=this._d|0,L=this._e|0,D=0;D<16;++D)y[D]=_.readInt32BE(D*4);for(;D<80;++D)y[D]=p(y[D-3]^y[D-8]^y[D-14]^y[D-16]);for(var U=0;U<80;++U){var G=~~(U/20),X=f(O)+x(G,R,z,N)+L+y[U]+o[G]|0;L=N,N=z,z=h(R),R=O,O=X}this._a=O+this._a|0,this._b=R+this._b|0,this._c=z+this._c|0,this._d=N+this._d|0,this._e=L+this._e|0},u.prototype._hash=function(){var _=r.allocUnsafe(20);return _.writeInt32BE(this._a|0,0),_.writeInt32BE(this._b|0,4),_.writeInt32BE(this._c|0,8),_.writeInt32BE(this._d|0,12),_.writeInt32BE(this._e|0,16),_},Eo=u,Eo}var Io={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var bf;function Xw(){return bf||(bf=1,(function(e){(function(n){n(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(n){n.version="1.2.2";function r(){for(var K=0,ce=new Array(256),S=0;S!=256;++S)K=S,K=K&1?-306674912^K>>>1:K>>>1,K=K&1?-306674912^K>>>1:K>>>1,K=K&1?-306674912^K>>>1:K>>>1,K=K&1?-306674912^K>>>1:K>>>1,K=K&1?-306674912^K>>>1:K>>>1,K=K&1?-306674912^K>>>1:K>>>1,K=K&1?-306674912^K>>>1:K>>>1,K=K&1?-306674912^K>>>1:K>>>1,ce[S]=K;return typeof Int32Array<"u"?new Int32Array(ce):ce}var o=r();function c(K){var ce=0,S=0,ie=0,Q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ie=0;ie!=256;++ie)Q[ie]=K[ie];for(ie=0;ie!=256;++ie)for(S=K[ie],ce=256+ie;ce<4096;ce+=256)S=Q[ce]=S>>>8^K[S&255];var se=[];for(ie=1;ie!=16;++ie)se[ie-1]=typeof Int32Array<"u"?Q.subarray(ie*256,ie*256+256):Q.slice(ie*256,ie*256+256);return se}var u=c(o),p=u[0],f=u[1],h=u[2],x=u[3],_=u[4],y=u[5],O=u[6],R=u[7],z=u[8],N=u[9],L=u[10],D=u[11],U=u[12],G=u[13],X=u[14];function q(K,ce){for(var S=ce^-1,ie=0,Q=K.length;ie<Q;)S=S>>>8^o[(S^K.charCodeAt(ie++))&255];return~S}function Y(K,ce){for(var S=ce^-1,ie=K.length-15,Q=0;Q<ie;)S=X[K[Q++]^S&255]^G[K[Q++]^S>>8&255]^U[K[Q++]^S>>16&255]^D[K[Q++]^S>>>24]^L[K[Q++]]^N[K[Q++]]^z[K[Q++]]^R[K[Q++]]^O[K[Q++]]^y[K[Q++]]^_[K[Q++]]^x[K[Q++]]^h[K[Q++]]^f[K[Q++]]^p[K[Q++]]^o[K[Q++]];for(ie+=15;Q<ie;)S=S>>>8^o[(S^K[Q++])&255];return~S}function B(K,ce){for(var S=ce^-1,ie=0,Q=K.length,se=0,W=0;ie<Q;)se=K.charCodeAt(ie++),se<128?S=S>>>8^o[(S^se)&255]:se<2048?(S=S>>>8^o[(S^(192|se>>6&31))&255],S=S>>>8^o[(S^(128|se&63))&255]):se>=55296&&se<57344?(se=(se&1023)+64,W=K.charCodeAt(ie++)&1023,S=S>>>8^o[(S^(240|se>>8&7))&255],S=S>>>8^o[(S^(128|se>>2&63))&255],S=S>>>8^o[(S^(128|W>>6&15|(se&3)<<4))&255],S=S>>>8^o[(S^(128|W&63))&255]):(S=S>>>8^o[(S^(224|se>>12&15))&255],S=S>>>8^o[(S^(128|se>>6&63))&255],S=S>>>8^o[(S^(128|se&63))&255]);return~S}n.table=o,n.bstr=q,n.buf=Y,n.str=B})})(Io)),Io}var Ao={},vf;function xr(){return vf||(vf=1,(function(e){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function r(u,p){return Object.prototype.hasOwnProperty.call(u,p)}e.assign=function(u){for(var p=Array.prototype.slice.call(arguments,1);p.length;){var f=p.shift();if(f){if(typeof f!="object")throw new TypeError(f+"must be non-object");for(var h in f)r(f,h)&&(u[h]=f[h])}}return u},e.shrinkBuf=function(u,p){return u.length===p?u:u.subarray?u.subarray(0,p):(u.length=p,u)};var o={arraySet:function(u,p,f,h,x){if(p.subarray&&u.subarray){u.set(p.subarray(f,f+h),x);return}for(var _=0;_<h;_++)u[x+_]=p[f+_]},flattenChunks:function(u){var p,f,h,x,_,y;for(h=0,p=0,f=u.length;p<f;p++)h+=u[p].length;for(y=new Uint8Array(h),x=0,p=0,f=u.length;p<f;p++)_=u[p],y.set(_,x),x+=_.length;return y}},c={arraySet:function(u,p,f,h,x){for(var _=0;_<h;_++)u[x+_]=p[f+_]},flattenChunks:function(u){return[].concat.apply([],u)}};e.setTyped=function(u){u?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,o)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,c))},e.setTyped(n)})(Ao)),Ao}var Qr={},rr={},Mr={},xf;function Yw(){if(xf)return Mr;xf=1;var e=xr(),n=4,r=0,o=1,c=2;function u(P){for(var _e=P.length;--_e>=0;)P[_e]=0}var p=0,f=1,h=2,x=3,_=258,y=29,O=256,R=O+1+y,z=30,N=19,L=2*R+1,D=15,U=16,G=7,X=256,q=16,Y=17,B=18,K=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ce=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ie=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=512,se=new Array((R+2)*2);u(se);var W=new Array(z*2);u(W);var oe=new Array(Q);u(oe);var te=new Array(_-x+1);u(te);var re=new Array(y);u(re);var le=new Array(z);u(le);function me(P,_e,ke,Be,ee){this.static_tree=P,this.extra_bits=_e,this.extra_base=ke,this.elems=Be,this.max_length=ee,this.has_stree=P&&P.length}var Fe,ve,Re;function He(P,_e){this.dyn_tree=P,this.max_code=0,this.stat_desc=_e}function tt(P){return P<256?oe[P]:oe[256+(P>>>7)]}function it(P,_e){P.pending_buf[P.pending++]=_e&255,P.pending_buf[P.pending++]=_e>>>8&255}function Je(P,_e,ke){P.bi_valid>U-ke?(P.bi_buf|=_e<<P.bi_valid&65535,it(P,P.bi_buf),P.bi_buf=_e>>U-P.bi_valid,P.bi_valid+=ke-U):(P.bi_buf|=_e<<P.bi_valid&65535,P.bi_valid+=ke)}function Ge(P,_e,ke){Je(P,ke[_e*2],ke[_e*2+1])}function We(P,_e){var ke=0;do ke|=P&1,P>>>=1,ke<<=1;while(--_e>0);return ke>>>1}function rt(P){P.bi_valid===16?(it(P,P.bi_buf),P.bi_buf=0,P.bi_valid=0):P.bi_valid>=8&&(P.pending_buf[P.pending++]=P.bi_buf&255,P.bi_buf>>=8,P.bi_valid-=8)}function Xe(P,_e){var ke=_e.dyn_tree,Be=_e.max_code,ee=_e.stat_desc.static_tree,de=_e.stat_desc.has_stree,I=_e.stat_desc.extra_bits,Se=_e.stat_desc.extra_base,qe=_e.stat_desc.max_length,m,H,pe,C,Z,ue,Ue=0;for(C=0;C<=D;C++)P.bl_count[C]=0;for(ke[P.heap[P.heap_max]*2+1]=0,m=P.heap_max+1;m<L;m++)H=P.heap[m],C=ke[ke[H*2+1]*2+1]+1,C>qe&&(C=qe,Ue++),ke[H*2+1]=C,!(H>Be)&&(P.bl_count[C]++,Z=0,H>=Se&&(Z=I[H-Se]),ue=ke[H*2],P.opt_len+=ue*(C+Z),de&&(P.static_len+=ue*(ee[H*2+1]+Z)));if(Ue!==0){do{for(C=qe-1;P.bl_count[C]===0;)C--;P.bl_count[C]--,P.bl_count[C+1]+=2,P.bl_count[qe]--,Ue-=2}while(Ue>0);for(C=qe;C!==0;C--)for(H=P.bl_count[C];H!==0;)pe=P.heap[--m],!(pe>Be)&&(ke[pe*2+1]!==C&&(P.opt_len+=(C-ke[pe*2+1])*ke[pe*2],ke[pe*2+1]=C),H--)}}function at(P,_e,ke){var Be=new Array(D+1),ee=0,de,I;for(de=1;de<=D;de++)Be[de]=ee=ee+ke[de-1]<<1;for(I=0;I<=_e;I++){var Se=P[I*2+1];Se!==0&&(P[I*2]=We(Be[Se]++,Se))}}function ze(){var P,_e,ke,Be,ee,de=new Array(D+1);for(ke=0,Be=0;Be<y-1;Be++)for(re[Be]=ke,P=0;P<1<<K[Be];P++)te[ke++]=Be;for(te[ke-1]=Be,ee=0,Be=0;Be<16;Be++)for(le[Be]=ee,P=0;P<1<<ce[Be];P++)oe[ee++]=Be;for(ee>>=7;Be<z;Be++)for(le[Be]=ee<<7,P=0;P<1<<ce[Be]-7;P++)oe[256+ee++]=Be;for(_e=0;_e<=D;_e++)de[_e]=0;for(P=0;P<=143;)se[P*2+1]=8,P++,de[8]++;for(;P<=255;)se[P*2+1]=9,P++,de[9]++;for(;P<=279;)se[P*2+1]=7,P++,de[7]++;for(;P<=287;)se[P*2+1]=8,P++,de[8]++;for(at(se,R+1,de),P=0;P<z;P++)W[P*2+1]=5,W[P*2]=We(P,5);Fe=new me(se,K,O+1,R,D),ve=new me(W,ce,0,z,D),Re=new me(new Array(0),S,0,N,G)}function Ke(P){var _e;for(_e=0;_e<R;_e++)P.dyn_ltree[_e*2]=0;for(_e=0;_e<z;_e++)P.dyn_dtree[_e*2]=0;for(_e=0;_e<N;_e++)P.bl_tree[_e*2]=0;P.dyn_ltree[X*2]=1,P.opt_len=P.static_len=0,P.last_lit=P.matches=0}function pt(P){P.bi_valid>8?it(P,P.bi_buf):P.bi_valid>0&&(P.pending_buf[P.pending++]=P.bi_buf),P.bi_buf=0,P.bi_valid=0}function wt(P,_e,ke,Be){pt(P),it(P,ke),it(P,~ke),e.arraySet(P.pending_buf,P.window,_e,ke,P.pending),P.pending+=ke}function M(P,_e,ke,Be){var ee=_e*2,de=ke*2;return P[ee]<P[de]||P[ee]===P[de]&&Be[_e]<=Be[ke]}function g(P,_e,ke){for(var Be=P.heap[ke],ee=ke<<1;ee<=P.heap_len&&(ee<P.heap_len&&M(_e,P.heap[ee+1],P.heap[ee],P.depth)&&ee++,!M(_e,Be,P.heap[ee],P.depth));)P.heap[ke]=P.heap[ee],ke=ee,ee<<=1;P.heap[ke]=Be}function b(P,_e,ke){var Be,ee,de=0,I,Se;if(P.last_lit!==0)do Be=P.pending_buf[P.d_buf+de*2]<<8|P.pending_buf[P.d_buf+de*2+1],ee=P.pending_buf[P.l_buf+de],de++,Be===0?Ge(P,ee,_e):(I=te[ee],Ge(P,I+O+1,_e),Se=K[I],Se!==0&&(ee-=re[I],Je(P,ee,Se)),Be--,I=tt(Be),Ge(P,I,ke),Se=ce[I],Se!==0&&(Be-=le[I],Je(P,Be,Se)));while(de<P.last_lit);Ge(P,X,_e)}function $(P,_e){var ke=_e.dyn_tree,Be=_e.stat_desc.static_tree,ee=_e.stat_desc.has_stree,de=_e.stat_desc.elems,I,Se,qe=-1,m;for(P.heap_len=0,P.heap_max=L,I=0;I<de;I++)ke[I*2]!==0?(P.heap[++P.heap_len]=qe=I,P.depth[I]=0):ke[I*2+1]=0;for(;P.heap_len<2;)m=P.heap[++P.heap_len]=qe<2?++qe:0,ke[m*2]=1,P.depth[m]=0,P.opt_len--,ee&&(P.static_len-=Be[m*2+1]);for(_e.max_code=qe,I=P.heap_len>>1;I>=1;I--)g(P,ke,I);m=de;do I=P.heap[1],P.heap[1]=P.heap[P.heap_len--],g(P,ke,1),Se=P.heap[1],P.heap[--P.heap_max]=I,P.heap[--P.heap_max]=Se,ke[m*2]=ke[I*2]+ke[Se*2],P.depth[m]=(P.depth[I]>=P.depth[Se]?P.depth[I]:P.depth[Se])+1,ke[I*2+1]=ke[Se*2+1]=m,P.heap[1]=m++,g(P,ke,1);while(P.heap_len>=2);P.heap[--P.heap_max]=P.heap[1],Xe(P,_e),at(ke,qe,P.bl_count)}function ae(P,_e,ke){var Be,ee=-1,de,I=_e[1],Se=0,qe=7,m=4;for(I===0&&(qe=138,m=3),_e[(ke+1)*2+1]=65535,Be=0;Be<=ke;Be++)de=I,I=_e[(Be+1)*2+1],!(++Se<qe&&de===I)&&(Se<m?P.bl_tree[de*2]+=Se:de!==0?(de!==ee&&P.bl_tree[de*2]++,P.bl_tree[q*2]++):Se<=10?P.bl_tree[Y*2]++:P.bl_tree[B*2]++,Se=0,ee=de,I===0?(qe=138,m=3):de===I?(qe=6,m=3):(qe=7,m=4))}function ye(P,_e,ke){var Be,ee=-1,de,I=_e[1],Se=0,qe=7,m=4;for(I===0&&(qe=138,m=3),Be=0;Be<=ke;Be++)if(de=I,I=_e[(Be+1)*2+1],!(++Se<qe&&de===I)){if(Se<m)do Ge(P,de,P.bl_tree);while(--Se!==0);else de!==0?(de!==ee&&(Ge(P,de,P.bl_tree),Se--),Ge(P,q,P.bl_tree),Je(P,Se-3,2)):Se<=10?(Ge(P,Y,P.bl_tree),Je(P,Se-3,3)):(Ge(P,B,P.bl_tree),Je(P,Se-11,7));Se=0,ee=de,I===0?(qe=138,m=3):de===I?(qe=6,m=3):(qe=7,m=4)}}function xe(P){var _e;for(ae(P,P.dyn_ltree,P.l_desc.max_code),ae(P,P.dyn_dtree,P.d_desc.max_code),$(P,P.bl_desc),_e=N-1;_e>=3&&P.bl_tree[ie[_e]*2+1]===0;_e--);return P.opt_len+=3*(_e+1)+5+5+4,_e}function Ve(P,_e,ke,Be){var ee;for(Je(P,_e-257,5),Je(P,ke-1,5),Je(P,Be-4,4),ee=0;ee<Be;ee++)Je(P,P.bl_tree[ie[ee]*2+1],3);ye(P,P.dyn_ltree,_e-1),ye(P,P.dyn_dtree,ke-1)}function Ye(P){var _e=4093624447,ke;for(ke=0;ke<=31;ke++,_e>>>=1)if(_e&1&&P.dyn_ltree[ke*2]!==0)return r;if(P.dyn_ltree[18]!==0||P.dyn_ltree[20]!==0||P.dyn_ltree[26]!==0)return o;for(ke=32;ke<O;ke++)if(P.dyn_ltree[ke*2]!==0)return o;return r}var nt=!1;function ft(P){nt||(ze(),nt=!0),P.l_desc=new He(P.dyn_ltree,Fe),P.d_desc=new He(P.dyn_dtree,ve),P.bl_desc=new He(P.bl_tree,Re),P.bi_buf=0,P.bi_valid=0,Ke(P)}function st(P,_e,ke,Be){Je(P,(p<<1)+(Be?1:0),3),wt(P,_e,ke)}function yt(P){Je(P,f<<1,3),Ge(P,X,se),rt(P)}function Bt(P,_e,ke,Be){var ee,de,I=0;P.level>0?(P.strm.data_type===c&&(P.strm.data_type=Ye(P)),$(P,P.l_desc),$(P,P.d_desc),I=xe(P),ee=P.opt_len+3+7>>>3,de=P.static_len+3+7>>>3,de<=ee&&(ee=de)):ee=de=ke+5,ke+4<=ee&&_e!==-1?st(P,_e,ke,Be):P.strategy===n||de===ee?(Je(P,(f<<1)+(Be?1:0),3),b(P,se,W)):(Je(P,(h<<1)+(Be?1:0),3),Ve(P,P.l_desc.max_code+1,P.d_desc.max_code+1,I+1),b(P,P.dyn_ltree,P.dyn_dtree)),Ke(P),Be&&pt(P)}function Jt(P,_e,ke){return P.pending_buf[P.d_buf+P.last_lit*2]=_e>>>8&255,P.pending_buf[P.d_buf+P.last_lit*2+1]=_e&255,P.pending_buf[P.l_buf+P.last_lit]=ke&255,P.last_lit++,_e===0?P.dyn_ltree[ke*2]++:(P.matches++,_e--,P.dyn_ltree[(te[ke]+O+1)*2]++,P.dyn_dtree[tt(_e)*2]++),P.last_lit===P.lit_bufsize-1}return Mr._tr_init=ft,Mr._tr_stored_block=st,Mr._tr_flush_block=Bt,Mr._tr_tally=Jt,Mr._tr_align=yt,Mr}var Co,_f;function Zd(){if(_f)return Co;_f=1;function e(n,r,o,c){for(var u=n&65535|0,p=n>>>16&65535|0,f=0;o!==0;){f=o>2e3?2e3:o,o-=f;do u=u+r[c++]|0,p=p+u|0;while(--f);u%=65521,p%=65521}return u|p<<16|0}return Co=e,Co}var To,Sf;function Xd(){if(Sf)return To;Sf=1;function e(){for(var o,c=[],u=0;u<256;u++){o=u;for(var p=0;p<8;p++)o=o&1?3988292384^o>>>1:o>>>1;c[u]=o}return c}var n=e();function r(o,c,u,p){var f=n,h=p+u;o^=-1;for(var x=p;x<h;x++)o=o>>>8^f[(o^c[x])&255];return o^-1}return To=r,To}var Ro,kf;function As(){return kf||(kf=1,Ro={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),Ro}var Ef;function Jw(){if(Ef)return rr;Ef=1;var e=xr(),n=Yw(),r=Zd(),o=Xd(),c=As(),u=0,p=1,f=3,h=4,x=5,_=0,y=1,O=-2,R=-3,z=-5,N=-1,L=1,D=2,U=3,G=4,X=0,q=2,Y=8,B=9,K=15,ce=8,S=29,ie=256,Q=ie+1+S,se=30,W=19,oe=2*Q+1,te=15,re=3,le=258,me=le+re+1,Fe=32,ve=42,Re=69,He=73,tt=91,it=103,Je=113,Ge=666,We=1,rt=2,Xe=3,at=4,ze=3;function Ke(m,H){return m.msg=c[H],H}function pt(m){return(m<<1)-(m>4?9:0)}function wt(m){for(var H=m.length;--H>=0;)m[H]=0}function M(m){var H=m.state,pe=H.pending;pe>m.avail_out&&(pe=m.avail_out),pe!==0&&(e.arraySet(m.output,H.pending_buf,H.pending_out,pe,m.next_out),m.next_out+=pe,H.pending_out+=pe,m.total_out+=pe,m.avail_out-=pe,H.pending-=pe,H.pending===0&&(H.pending_out=0))}function g(m,H){n._tr_flush_block(m,m.block_start>=0?m.block_start:-1,m.strstart-m.block_start,H),m.block_start=m.strstart,M(m.strm)}function b(m,H){m.pending_buf[m.pending++]=H}function $(m,H){m.pending_buf[m.pending++]=H>>>8&255,m.pending_buf[m.pending++]=H&255}function ae(m,H,pe,C){var Z=m.avail_in;return Z>C&&(Z=C),Z===0?0:(m.avail_in-=Z,e.arraySet(H,m.input,m.next_in,Z,pe),m.state.wrap===1?m.adler=r(m.adler,H,Z,pe):m.state.wrap===2&&(m.adler=o(m.adler,H,Z,pe)),m.next_in+=Z,m.total_in+=Z,Z)}function ye(m,H){var pe=m.max_chain_length,C=m.strstart,Z,ue,Ue=m.prev_length,Me=m.nice_match,Ce=m.strstart>m.w_size-me?m.strstart-(m.w_size-me):0,Qe=m.window,Vt=m.w_mask,gt=m.prev,ot=m.strstart+le,vt=Qe[C+Ue-1],kt=Qe[C+Ue];m.prev_length>=m.good_match&&(pe>>=2),Me>m.lookahead&&(Me=m.lookahead);do if(Z=H,!(Qe[Z+Ue]!==kt||Qe[Z+Ue-1]!==vt||Qe[Z]!==Qe[C]||Qe[++Z]!==Qe[C+1])){C+=2,Z++;do;while(Qe[++C]===Qe[++Z]&&Qe[++C]===Qe[++Z]&&Qe[++C]===Qe[++Z]&&Qe[++C]===Qe[++Z]&&Qe[++C]===Qe[++Z]&&Qe[++C]===Qe[++Z]&&Qe[++C]===Qe[++Z]&&Qe[++C]===Qe[++Z]&&C<ot);if(ue=le-(ot-C),C=ot-le,ue>Ue){if(m.match_start=H,Ue=ue,ue>=Me)break;vt=Qe[C+Ue-1],kt=Qe[C+Ue]}}while((H=gt[H&Vt])>Ce&&--pe!==0);return Ue<=m.lookahead?Ue:m.lookahead}function xe(m){var H=m.w_size,pe,C,Z,ue,Ue;do{if(ue=m.window_size-m.lookahead-m.strstart,m.strstart>=H+(H-me)){e.arraySet(m.window,m.window,H,H,0),m.match_start-=H,m.strstart-=H,m.block_start-=H,C=m.hash_size,pe=C;do Z=m.head[--pe],m.head[pe]=Z>=H?Z-H:0;while(--C);C=H,pe=C;do Z=m.prev[--pe],m.prev[pe]=Z>=H?Z-H:0;while(--C);ue+=H}if(m.strm.avail_in===0)break;if(C=ae(m.strm,m.window,m.strstart+m.lookahead,ue),m.lookahead+=C,m.lookahead+m.insert>=re)for(Ue=m.strstart-m.insert,m.ins_h=m.window[Ue],m.ins_h=(m.ins_h<<m.hash_shift^m.window[Ue+1])&m.hash_mask;m.insert&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[Ue+re-1])&m.hash_mask,m.prev[Ue&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=Ue,Ue++,m.insert--,!(m.lookahead+m.insert<re)););}while(m.lookahead<me&&m.strm.avail_in!==0)}function Ve(m,H){var pe=65535;for(pe>m.pending_buf_size-5&&(pe=m.pending_buf_size-5);;){if(m.lookahead<=1){if(xe(m),m.lookahead===0&&H===u)return We;if(m.lookahead===0)break}m.strstart+=m.lookahead,m.lookahead=0;var C=m.block_start+pe;if((m.strstart===0||m.strstart>=C)&&(m.lookahead=m.strstart-C,m.strstart=C,g(m,!1),m.strm.avail_out===0)||m.strstart-m.block_start>=m.w_size-me&&(g(m,!1),m.strm.avail_out===0))return We}return m.insert=0,H===h?(g(m,!0),m.strm.avail_out===0?Xe:at):(m.strstart>m.block_start&&(g(m,!1),m.strm.avail_out===0),We)}function Ye(m,H){for(var pe,C;;){if(m.lookahead<me){if(xe(m),m.lookahead<me&&H===u)return We;if(m.lookahead===0)break}if(pe=0,m.lookahead>=re&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+re-1])&m.hash_mask,pe=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),pe!==0&&m.strstart-pe<=m.w_size-me&&(m.match_length=ye(m,pe)),m.match_length>=re)if(C=n._tr_tally(m,m.strstart-m.match_start,m.match_length-re),m.lookahead-=m.match_length,m.match_length<=m.max_lazy_match&&m.lookahead>=re){m.match_length--;do m.strstart++,m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+re-1])&m.hash_mask,pe=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart;while(--m.match_length!==0);m.strstart++}else m.strstart+=m.match_length,m.match_length=0,m.ins_h=m.window[m.strstart],m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+1])&m.hash_mask;else C=n._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++;if(C&&(g(m,!1),m.strm.avail_out===0))return We}return m.insert=m.strstart<re-1?m.strstart:re-1,H===h?(g(m,!0),m.strm.avail_out===0?Xe:at):m.last_lit&&(g(m,!1),m.strm.avail_out===0)?We:rt}function nt(m,H){for(var pe,C,Z;;){if(m.lookahead<me){if(xe(m),m.lookahead<me&&H===u)return We;if(m.lookahead===0)break}if(pe=0,m.lookahead>=re&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+re-1])&m.hash_mask,pe=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),m.prev_length=m.match_length,m.prev_match=m.match_start,m.match_length=re-1,pe!==0&&m.prev_length<m.max_lazy_match&&m.strstart-pe<=m.w_size-me&&(m.match_length=ye(m,pe),m.match_length<=5&&(m.strategy===L||m.match_length===re&&m.strstart-m.match_start>4096)&&(m.match_length=re-1)),m.prev_length>=re&&m.match_length<=m.prev_length){Z=m.strstart+m.lookahead-re,C=n._tr_tally(m,m.strstart-1-m.prev_match,m.prev_length-re),m.lookahead-=m.prev_length-1,m.prev_length-=2;do++m.strstart<=Z&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+re-1])&m.hash_mask,pe=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart);while(--m.prev_length!==0);if(m.match_available=0,m.match_length=re-1,m.strstart++,C&&(g(m,!1),m.strm.avail_out===0))return We}else if(m.match_available){if(C=n._tr_tally(m,0,m.window[m.strstart-1]),C&&g(m,!1),m.strstart++,m.lookahead--,m.strm.avail_out===0)return We}else m.match_available=1,m.strstart++,m.lookahead--}return m.match_available&&(C=n._tr_tally(m,0,m.window[m.strstart-1]),m.match_available=0),m.insert=m.strstart<re-1?m.strstart:re-1,H===h?(g(m,!0),m.strm.avail_out===0?Xe:at):m.last_lit&&(g(m,!1),m.strm.avail_out===0)?We:rt}function ft(m,H){for(var pe,C,Z,ue,Ue=m.window;;){if(m.lookahead<=le){if(xe(m),m.lookahead<=le&&H===u)return We;if(m.lookahead===0)break}if(m.match_length=0,m.lookahead>=re&&m.strstart>0&&(Z=m.strstart-1,C=Ue[Z],C===Ue[++Z]&&C===Ue[++Z]&&C===Ue[++Z])){ue=m.strstart+le;do;while(C===Ue[++Z]&&C===Ue[++Z]&&C===Ue[++Z]&&C===Ue[++Z]&&C===Ue[++Z]&&C===Ue[++Z]&&C===Ue[++Z]&&C===Ue[++Z]&&Z<ue);m.match_length=le-(ue-Z),m.match_length>m.lookahead&&(m.match_length=m.lookahead)}if(m.match_length>=re?(pe=n._tr_tally(m,1,m.match_length-re),m.lookahead-=m.match_length,m.strstart+=m.match_length,m.match_length=0):(pe=n._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++),pe&&(g(m,!1),m.strm.avail_out===0))return We}return m.insert=0,H===h?(g(m,!0),m.strm.avail_out===0?Xe:at):m.last_lit&&(g(m,!1),m.strm.avail_out===0)?We:rt}function st(m,H){for(var pe;;){if(m.lookahead===0&&(xe(m),m.lookahead===0)){if(H===u)return We;break}if(m.match_length=0,pe=n._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++,pe&&(g(m,!1),m.strm.avail_out===0))return We}return m.insert=0,H===h?(g(m,!0),m.strm.avail_out===0?Xe:at):m.last_lit&&(g(m,!1),m.strm.avail_out===0)?We:rt}function yt(m,H,pe,C,Z){this.good_length=m,this.max_lazy=H,this.nice_length=pe,this.max_chain=C,this.func=Z}var Bt;Bt=[new yt(0,0,0,0,Ve),new yt(4,4,8,4,Ye),new yt(4,5,16,8,Ye),new yt(4,6,32,32,Ye),new yt(4,4,16,16,nt),new yt(8,16,32,32,nt),new yt(8,16,128,128,nt),new yt(8,32,128,256,nt),new yt(32,128,258,1024,nt),new yt(32,258,258,4096,nt)];function Jt(m){m.window_size=2*m.w_size,wt(m.head),m.max_lazy_match=Bt[m.level].max_lazy,m.good_match=Bt[m.level].good_length,m.nice_match=Bt[m.level].nice_length,m.max_chain_length=Bt[m.level].max_chain,m.strstart=0,m.block_start=0,m.lookahead=0,m.insert=0,m.match_length=m.prev_length=re-1,m.match_available=0,m.ins_h=0}function P(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(oe*2),this.dyn_dtree=new e.Buf16((2*se+1)*2),this.bl_tree=new e.Buf16((2*W+1)*2),wt(this.dyn_ltree),wt(this.dyn_dtree),wt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(te+1),this.heap=new e.Buf16(2*Q+1),wt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*Q+1),wt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _e(m){var H;return!m||!m.state?Ke(m,O):(m.total_in=m.total_out=0,m.data_type=q,H=m.state,H.pending=0,H.pending_out=0,H.wrap<0&&(H.wrap=-H.wrap),H.status=H.wrap?ve:Je,m.adler=H.wrap===2?0:1,H.last_flush=u,n._tr_init(H),_)}function ke(m){var H=_e(m);return H===_&&Jt(m.state),H}function Be(m,H){return!m||!m.state||m.state.wrap!==2?O:(m.state.gzhead=H,_)}function ee(m,H,pe,C,Z,ue){if(!m)return O;var Ue=1;if(H===N&&(H=6),C<0?(Ue=0,C=-C):C>15&&(Ue=2,C-=16),Z<1||Z>B||pe!==Y||C<8||C>15||H<0||H>9||ue<0||ue>G)return Ke(m,O);C===8&&(C=9);var Me=new P;return m.state=Me,Me.strm=m,Me.wrap=Ue,Me.gzhead=null,Me.w_bits=C,Me.w_size=1<<Me.w_bits,Me.w_mask=Me.w_size-1,Me.hash_bits=Z+7,Me.hash_size=1<<Me.hash_bits,Me.hash_mask=Me.hash_size-1,Me.hash_shift=~~((Me.hash_bits+re-1)/re),Me.window=new e.Buf8(Me.w_size*2),Me.head=new e.Buf16(Me.hash_size),Me.prev=new e.Buf16(Me.w_size),Me.lit_bufsize=1<<Z+6,Me.pending_buf_size=Me.lit_bufsize*4,Me.pending_buf=new e.Buf8(Me.pending_buf_size),Me.d_buf=1*Me.lit_bufsize,Me.l_buf=3*Me.lit_bufsize,Me.level=H,Me.strategy=ue,Me.method=pe,ke(m)}function de(m,H){return ee(m,H,Y,K,ce,X)}function I(m,H){var pe,C,Z,ue;if(!m||!m.state||H>x||H<0)return m?Ke(m,O):O;if(C=m.state,!m.output||!m.input&&m.avail_in!==0||C.status===Ge&&H!==h)return Ke(m,m.avail_out===0?z:O);if(C.strm=m,pe=C.last_flush,C.last_flush=H,C.status===ve)if(C.wrap===2)m.adler=0,b(C,31),b(C,139),b(C,8),C.gzhead?(b(C,(C.gzhead.text?1:0)+(C.gzhead.hcrc?2:0)+(C.gzhead.extra?4:0)+(C.gzhead.name?8:0)+(C.gzhead.comment?16:0)),b(C,C.gzhead.time&255),b(C,C.gzhead.time>>8&255),b(C,C.gzhead.time>>16&255),b(C,C.gzhead.time>>24&255),b(C,C.level===9?2:C.strategy>=D||C.level<2?4:0),b(C,C.gzhead.os&255),C.gzhead.extra&&C.gzhead.extra.length&&(b(C,C.gzhead.extra.length&255),b(C,C.gzhead.extra.length>>8&255)),C.gzhead.hcrc&&(m.adler=o(m.adler,C.pending_buf,C.pending,0)),C.gzindex=0,C.status=Re):(b(C,0),b(C,0),b(C,0),b(C,0),b(C,0),b(C,C.level===9?2:C.strategy>=D||C.level<2?4:0),b(C,ze),C.status=Je);else{var Ue=Y+(C.w_bits-8<<4)<<8,Me=-1;C.strategy>=D||C.level<2?Me=0:C.level<6?Me=1:C.level===6?Me=2:Me=3,Ue|=Me<<6,C.strstart!==0&&(Ue|=Fe),Ue+=31-Ue%31,C.status=Je,$(C,Ue),C.strstart!==0&&($(C,m.adler>>>16),$(C,m.adler&65535)),m.adler=1}if(C.status===Re)if(C.gzhead.extra){for(Z=C.pending;C.gzindex<(C.gzhead.extra.length&65535)&&!(C.pending===C.pending_buf_size&&(C.gzhead.hcrc&&C.pending>Z&&(m.adler=o(m.adler,C.pending_buf,C.pending-Z,Z)),M(m),Z=C.pending,C.pending===C.pending_buf_size));)b(C,C.gzhead.extra[C.gzindex]&255),C.gzindex++;C.gzhead.hcrc&&C.pending>Z&&(m.adler=o(m.adler,C.pending_buf,C.pending-Z,Z)),C.gzindex===C.gzhead.extra.length&&(C.gzindex=0,C.status=He)}else C.status=He;if(C.status===He)if(C.gzhead.name){Z=C.pending;do{if(C.pending===C.pending_buf_size&&(C.gzhead.hcrc&&C.pending>Z&&(m.adler=o(m.adler,C.pending_buf,C.pending-Z,Z)),M(m),Z=C.pending,C.pending===C.pending_buf_size)){ue=1;break}C.gzindex<C.gzhead.name.length?ue=C.gzhead.name.charCodeAt(C.gzindex++)&255:ue=0,b(C,ue)}while(ue!==0);C.gzhead.hcrc&&C.pending>Z&&(m.adler=o(m.adler,C.pending_buf,C.pending-Z,Z)),ue===0&&(C.gzindex=0,C.status=tt)}else C.status=tt;if(C.status===tt)if(C.gzhead.comment){Z=C.pending;do{if(C.pending===C.pending_buf_size&&(C.gzhead.hcrc&&C.pending>Z&&(m.adler=o(m.adler,C.pending_buf,C.pending-Z,Z)),M(m),Z=C.pending,C.pending===C.pending_buf_size)){ue=1;break}C.gzindex<C.gzhead.comment.length?ue=C.gzhead.comment.charCodeAt(C.gzindex++)&255:ue=0,b(C,ue)}while(ue!==0);C.gzhead.hcrc&&C.pending>Z&&(m.adler=o(m.adler,C.pending_buf,C.pending-Z,Z)),ue===0&&(C.status=it)}else C.status=it;if(C.status===it&&(C.gzhead.hcrc?(C.pending+2>C.pending_buf_size&&M(m),C.pending+2<=C.pending_buf_size&&(b(C,m.adler&255),b(C,m.adler>>8&255),m.adler=0,C.status=Je)):C.status=Je),C.pending!==0){if(M(m),m.avail_out===0)return C.last_flush=-1,_}else if(m.avail_in===0&&pt(H)<=pt(pe)&&H!==h)return Ke(m,z);if(C.status===Ge&&m.avail_in!==0)return Ke(m,z);if(m.avail_in!==0||C.lookahead!==0||H!==u&&C.status!==Ge){var Ce=C.strategy===D?st(C,H):C.strategy===U?ft(C,H):Bt[C.level].func(C,H);if((Ce===Xe||Ce===at)&&(C.status=Ge),Ce===We||Ce===Xe)return m.avail_out===0&&(C.last_flush=-1),_;if(Ce===rt&&(H===p?n._tr_align(C):H!==x&&(n._tr_stored_block(C,0,0,!1),H===f&&(wt(C.head),C.lookahead===0&&(C.strstart=0,C.block_start=0,C.insert=0))),M(m),m.avail_out===0))return C.last_flush=-1,_}return H!==h?_:C.wrap<=0?y:(C.wrap===2?(b(C,m.adler&255),b(C,m.adler>>8&255),b(C,m.adler>>16&255),b(C,m.adler>>24&255),b(C,m.total_in&255),b(C,m.total_in>>8&255),b(C,m.total_in>>16&255),b(C,m.total_in>>24&255)):($(C,m.adler>>>16),$(C,m.adler&65535)),M(m),C.wrap>0&&(C.wrap=-C.wrap),C.pending!==0?_:y)}function Se(m){var H;return!m||!m.state?O:(H=m.state.status,H!==ve&&H!==Re&&H!==He&&H!==tt&&H!==it&&H!==Je&&H!==Ge?Ke(m,O):(m.state=null,H===Je?Ke(m,R):_))}function qe(m,H){var pe=H.length,C,Z,ue,Ue,Me,Ce,Qe,Vt;if(!m||!m.state||(C=m.state,Ue=C.wrap,Ue===2||Ue===1&&C.status!==ve||C.lookahead))return O;for(Ue===1&&(m.adler=r(m.adler,H,pe,0)),C.wrap=0,pe>=C.w_size&&(Ue===0&&(wt(C.head),C.strstart=0,C.block_start=0,C.insert=0),Vt=new e.Buf8(C.w_size),e.arraySet(Vt,H,pe-C.w_size,C.w_size,0),H=Vt,pe=C.w_size),Me=m.avail_in,Ce=m.next_in,Qe=m.input,m.avail_in=pe,m.next_in=0,m.input=H,xe(C);C.lookahead>=re;){Z=C.strstart,ue=C.lookahead-(re-1);do C.ins_h=(C.ins_h<<C.hash_shift^C.window[Z+re-1])&C.hash_mask,C.prev[Z&C.w_mask]=C.head[C.ins_h],C.head[C.ins_h]=Z,Z++;while(--ue);C.strstart=Z,C.lookahead=re-1,xe(C)}return C.strstart+=C.lookahead,C.block_start=C.strstart,C.insert=C.lookahead,C.lookahead=0,C.match_length=C.prev_length=re-1,C.match_available=0,m.next_in=Ce,m.input=Qe,m.avail_in=Me,C.wrap=Ue,_}return rr.deflateInit=de,rr.deflateInit2=ee,rr.deflateReset=ke,rr.deflateResetKeep=_e,rr.deflateSetHeader=Be,rr.deflate=I,rr.deflateEnd=Se,rr.deflateSetDictionary=qe,rr.deflateInfo="pako deflate (from Nodeca project)",rr}var Pr={},If;function Yd(){if(If)return Pr;If=1;var e=xr(),n=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch{n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{r=!1}for(var o=new e.Buf8(256),c=0;c<256;c++)o[c]=c>=252?6:c>=248?5:c>=240?4:c>=224?3:c>=192?2:1;o[254]=o[254]=1,Pr.string2buf=function(p){var f,h,x,_,y,O=p.length,R=0;for(_=0;_<O;_++)h=p.charCodeAt(_),(h&64512)===55296&&_+1<O&&(x=p.charCodeAt(_+1),(x&64512)===56320&&(h=65536+(h-55296<<10)+(x-56320),_++)),R+=h<128?1:h<2048?2:h<65536?3:4;for(f=new e.Buf8(R),y=0,_=0;y<R;_++)h=p.charCodeAt(_),(h&64512)===55296&&_+1<O&&(x=p.charCodeAt(_+1),(x&64512)===56320&&(h=65536+(h-55296<<10)+(x-56320),_++)),h<128?f[y++]=h:h<2048?(f[y++]=192|h>>>6,f[y++]=128|h&63):h<65536?(f[y++]=224|h>>>12,f[y++]=128|h>>>6&63,f[y++]=128|h&63):(f[y++]=240|h>>>18,f[y++]=128|h>>>12&63,f[y++]=128|h>>>6&63,f[y++]=128|h&63);return f};function u(p,f){if(f<65534&&(p.subarray&&r||!p.subarray&&n))return String.fromCharCode.apply(null,e.shrinkBuf(p,f));for(var h="",x=0;x<f;x++)h+=String.fromCharCode(p[x]);return h}return Pr.buf2binstring=function(p){return u(p,p.length)},Pr.binstring2buf=function(p){for(var f=new e.Buf8(p.length),h=0,x=f.length;h<x;h++)f[h]=p.charCodeAt(h);return f},Pr.buf2string=function(p,f){var h,x,_,y,O=f||p.length,R=new Array(O*2);for(x=0,h=0;h<O;){if(_=p[h++],_<128){R[x++]=_;continue}if(y=o[_],y>4){R[x++]=65533,h+=y-1;continue}for(_&=y===2?31:y===3?15:7;y>1&&h<O;)_=_<<6|p[h++]&63,y--;if(y>1){R[x++]=65533;continue}_<65536?R[x++]=_:(_-=65536,R[x++]=55296|_>>10&1023,R[x++]=56320|_&1023)}return u(R,x)},Pr.utf8border=function(p,f){var h;for(f=f||p.length,f>p.length&&(f=p.length),h=f-1;h>=0&&(p[h]&192)===128;)h--;return h<0||h===0?f:h+o[p[h]]>f?h:f},Pr}var Oo,Af;function Jd(){if(Af)return Oo;Af=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return Oo=e,Oo}var Cf;function Qw(){if(Cf)return Qr;Cf=1;var e=Jw(),n=xr(),r=Yd(),o=As(),c=Jd(),u=Object.prototype.toString,p=0,f=4,h=0,x=1,_=2,y=-1,O=0,R=8;function z(U){if(!(this instanceof z))return new z(U);this.options=n.assign({level:y,method:R,chunkSize:16384,windowBits:15,memLevel:8,strategy:O,to:""},U||{});var G=this.options;G.raw&&G.windowBits>0?G.windowBits=-G.windowBits:G.gzip&&G.windowBits>0&&G.windowBits<16&&(G.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var X=e.deflateInit2(this.strm,G.level,G.method,G.windowBits,G.memLevel,G.strategy);if(X!==h)throw new Error(o[X]);if(G.header&&e.deflateSetHeader(this.strm,G.header),G.dictionary){var q;if(typeof G.dictionary=="string"?q=r.string2buf(G.dictionary):u.call(G.dictionary)==="[object ArrayBuffer]"?q=new Uint8Array(G.dictionary):q=G.dictionary,X=e.deflateSetDictionary(this.strm,q),X!==h)throw new Error(o[X]);this._dict_set=!0}}z.prototype.push=function(U,G){var X=this.strm,q=this.options.chunkSize,Y,B;if(this.ended)return!1;B=G===~~G?G:G===!0?f:p,typeof U=="string"?X.input=r.string2buf(U):u.call(U)==="[object ArrayBuffer]"?X.input=new Uint8Array(U):X.input=U,X.next_in=0,X.avail_in=X.input.length;do{if(X.avail_out===0&&(X.output=new n.Buf8(q),X.next_out=0,X.avail_out=q),Y=e.deflate(X,B),Y!==x&&Y!==h)return this.onEnd(Y),this.ended=!0,!1;(X.avail_out===0||X.avail_in===0&&(B===f||B===_))&&(this.options.to==="string"?this.onData(r.buf2binstring(n.shrinkBuf(X.output,X.next_out))):this.onData(n.shrinkBuf(X.output,X.next_out)))}while((X.avail_in>0||X.avail_out===0)&&Y!==x);return B===f?(Y=e.deflateEnd(this.strm),this.onEnd(Y),this.ended=!0,Y===h):(B===_&&(this.onEnd(h),X.avail_out=0),!0)},z.prototype.onData=function(U){this.chunks.push(U)},z.prototype.onEnd=function(U){U===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=U,this.msg=this.strm.msg};function N(U,G){var X=new z(G);if(X.push(U,!0),X.err)throw X.msg||o[X.err];return X.result}function L(U,G){return G=G||{},G.raw=!0,N(U,G)}function D(U,G){return G=G||{},G.gzip=!0,N(U,G)}return Qr.Deflate=z,Qr.deflate=N,Qr.deflateRaw=L,Qr.gzip=D,Qr}var en={},Yt={},Mo,Tf;function ey(){if(Tf)return Mo;Tf=1;var e=30,n=12;return Mo=function(o,c){var u,p,f,h,x,_,y,O,R,z,N,L,D,U,G,X,q,Y,B,K,ce,S,ie,Q,se;u=o.state,p=o.next_in,Q=o.input,f=p+(o.avail_in-5),h=o.next_out,se=o.output,x=h-(c-o.avail_out),_=h+(o.avail_out-257),y=u.dmax,O=u.wsize,R=u.whave,z=u.wnext,N=u.window,L=u.hold,D=u.bits,U=u.lencode,G=u.distcode,X=(1<<u.lenbits)-1,q=(1<<u.distbits)-1;e:do{D<15&&(L+=Q[p++]<<D,D+=8,L+=Q[p++]<<D,D+=8),Y=U[L&X];t:for(;;){if(B=Y>>>24,L>>>=B,D-=B,B=Y>>>16&255,B===0)se[h++]=Y&65535;else if(B&16){K=Y&65535,B&=15,B&&(D<B&&(L+=Q[p++]<<D,D+=8),K+=L&(1<<B)-1,L>>>=B,D-=B),D<15&&(L+=Q[p++]<<D,D+=8,L+=Q[p++]<<D,D+=8),Y=G[L&q];r:for(;;){if(B=Y>>>24,L>>>=B,D-=B,B=Y>>>16&255,B&16){if(ce=Y&65535,B&=15,D<B&&(L+=Q[p++]<<D,D+=8,D<B&&(L+=Q[p++]<<D,D+=8)),ce+=L&(1<<B)-1,ce>y){o.msg="invalid distance too far back",u.mode=e;break e}if(L>>>=B,D-=B,B=h-x,ce>B){if(B=ce-B,B>R&&u.sane){o.msg="invalid distance too far back",u.mode=e;break e}if(S=0,ie=N,z===0){if(S+=O-B,B<K){K-=B;do se[h++]=N[S++];while(--B);S=h-ce,ie=se}}else if(z<B){if(S+=O+z-B,B-=z,B<K){K-=B;do se[h++]=N[S++];while(--B);if(S=0,z<K){B=z,K-=B;do se[h++]=N[S++];while(--B);S=h-ce,ie=se}}}else if(S+=z-B,B<K){K-=B;do se[h++]=N[S++];while(--B);S=h-ce,ie=se}for(;K>2;)se[h++]=ie[S++],se[h++]=ie[S++],se[h++]=ie[S++],K-=3;K&&(se[h++]=ie[S++],K>1&&(se[h++]=ie[S++]))}else{S=h-ce;do se[h++]=se[S++],se[h++]=se[S++],se[h++]=se[S++],K-=3;while(K>2);K&&(se[h++]=se[S++],K>1&&(se[h++]=se[S++]))}}else if((B&64)===0){Y=G[(Y&65535)+(L&(1<<B)-1)];continue r}else{o.msg="invalid distance code",u.mode=e;break e}break}}else if((B&64)===0){Y=U[(Y&65535)+(L&(1<<B)-1)];continue t}else if(B&32){u.mode=n;break e}else{o.msg="invalid literal/length code",u.mode=e;break e}break}}while(p<f&&h<_);K=D>>3,p-=K,D-=K<<3,L&=(1<<D)-1,o.next_in=p,o.next_out=h,o.avail_in=p<f?5+(f-p):5-(p-f),o.avail_out=h<_?257+(_-h):257-(h-_),u.hold=L,u.bits=D},Mo}var Po,Rf;function ty(){if(Rf)return Po;Rf=1;var e=xr(),n=15,r=852,o=592,c=0,u=1,p=2,f=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],h=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],x=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],_=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return Po=function(O,R,z,N,L,D,U,G){var X=G.bits,q=0,Y=0,B=0,K=0,ce=0,S=0,ie=0,Q=0,se=0,W=0,oe,te,re,le,me,Fe=null,ve=0,Re,He=new e.Buf16(n+1),tt=new e.Buf16(n+1),it=null,Je=0,Ge,We,rt;for(q=0;q<=n;q++)He[q]=0;for(Y=0;Y<N;Y++)He[R[z+Y]]++;for(ce=X,K=n;K>=1&&He[K]===0;K--);if(ce>K&&(ce=K),K===0)return L[D++]=1<<24|64<<16|0,L[D++]=1<<24|64<<16|0,G.bits=1,0;for(B=1;B<K&&He[B]===0;B++);for(ce<B&&(ce=B),Q=1,q=1;q<=n;q++)if(Q<<=1,Q-=He[q],Q<0)return-1;if(Q>0&&(O===c||K!==1))return-1;for(tt[1]=0,q=1;q<n;q++)tt[q+1]=tt[q]+He[q];for(Y=0;Y<N;Y++)R[z+Y]!==0&&(U[tt[R[z+Y]]++]=Y);if(O===c?(Fe=it=U,Re=19):O===u?(Fe=f,ve-=257,it=h,Je-=257,Re=256):(Fe=x,it=_,Re=-1),W=0,Y=0,q=B,me=D,S=ce,ie=0,re=-1,se=1<<ce,le=se-1,O===u&&se>r||O===p&&se>o)return 1;for(;;){Ge=q-ie,U[Y]<Re?(We=0,rt=U[Y]):U[Y]>Re?(We=it[Je+U[Y]],rt=Fe[ve+U[Y]]):(We=96,rt=0),oe=1<<q-ie,te=1<<S,B=te;do te-=oe,L[me+(W>>ie)+te]=Ge<<24|We<<16|rt|0;while(te!==0);for(oe=1<<q-1;W&oe;)oe>>=1;if(oe!==0?(W&=oe-1,W+=oe):W=0,Y++,--He[q]===0){if(q===K)break;q=R[z+U[Y]]}if(q>ce&&(W&le)!==re){for(ie===0&&(ie=ce),me+=B,S=q-ie,Q=1<<S;S+ie<K&&(Q-=He[S+ie],!(Q<=0));)S++,Q<<=1;if(se+=1<<S,O===u&&se>r||O===p&&se>o)return 1;re=W&le,L[re]=ce<<24|S<<16|me-D|0}}return W!==0&&(L[me+W]=q-ie<<24|64<<16|0),G.bits=ce,0},Po}var Of;function ry(){if(Of)return Yt;Of=1;var e=xr(),n=Zd(),r=Xd(),o=ey(),c=ty(),u=0,p=1,f=2,h=4,x=5,_=6,y=0,O=1,R=2,z=-2,N=-3,L=-4,D=-5,U=8,G=1,X=2,q=3,Y=4,B=5,K=6,ce=7,S=8,ie=9,Q=10,se=11,W=12,oe=13,te=14,re=15,le=16,me=17,Fe=18,ve=19,Re=20,He=21,tt=22,it=23,Je=24,Ge=25,We=26,rt=27,Xe=28,at=29,ze=30,Ke=31,pt=32,wt=852,M=592,g=15,b=g;function $(ee){return(ee>>>24&255)+(ee>>>8&65280)+((ee&65280)<<8)+((ee&255)<<24)}function ae(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ye(ee){var de;return!ee||!ee.state?z:(de=ee.state,ee.total_in=ee.total_out=de.total=0,ee.msg="",de.wrap&&(ee.adler=de.wrap&1),de.mode=G,de.last=0,de.havedict=0,de.dmax=32768,de.head=null,de.hold=0,de.bits=0,de.lencode=de.lendyn=new e.Buf32(wt),de.distcode=de.distdyn=new e.Buf32(M),de.sane=1,de.back=-1,y)}function xe(ee){var de;return!ee||!ee.state?z:(de=ee.state,de.wsize=0,de.whave=0,de.wnext=0,ye(ee))}function Ve(ee,de){var I,Se;return!ee||!ee.state||(Se=ee.state,de<0?(I=0,de=-de):(I=(de>>4)+1,de<48&&(de&=15)),de&&(de<8||de>15))?z:(Se.window!==null&&Se.wbits!==de&&(Se.window=null),Se.wrap=I,Se.wbits=de,xe(ee))}function Ye(ee,de){var I,Se;return ee?(Se=new ae,ee.state=Se,Se.window=null,I=Ve(ee,de),I!==y&&(ee.state=null),I):z}function nt(ee){return Ye(ee,b)}var ft=!0,st,yt;function Bt(ee){if(ft){var de;for(st=new e.Buf32(512),yt=new e.Buf32(32),de=0;de<144;)ee.lens[de++]=8;for(;de<256;)ee.lens[de++]=9;for(;de<280;)ee.lens[de++]=7;for(;de<288;)ee.lens[de++]=8;for(c(p,ee.lens,0,288,st,0,ee.work,{bits:9}),de=0;de<32;)ee.lens[de++]=5;c(f,ee.lens,0,32,yt,0,ee.work,{bits:5}),ft=!1}ee.lencode=st,ee.lenbits=9,ee.distcode=yt,ee.distbits=5}function Jt(ee,de,I,Se){var qe,m=ee.state;return m.window===null&&(m.wsize=1<<m.wbits,m.wnext=0,m.whave=0,m.window=new e.Buf8(m.wsize)),Se>=m.wsize?(e.arraySet(m.window,de,I-m.wsize,m.wsize,0),m.wnext=0,m.whave=m.wsize):(qe=m.wsize-m.wnext,qe>Se&&(qe=Se),e.arraySet(m.window,de,I-Se,qe,m.wnext),Se-=qe,Se?(e.arraySet(m.window,de,I-Se,Se,0),m.wnext=Se,m.whave=m.wsize):(m.wnext+=qe,m.wnext===m.wsize&&(m.wnext=0),m.whave<m.wsize&&(m.whave+=qe))),0}function P(ee,de){var I,Se,qe,m,H,pe,C,Z,ue,Ue,Me,Ce,Qe,Vt,gt=0,ot,vt,kt,Ft,_r,Sr,xt,Nt,Et=new e.Buf8(4),Kt,Zt,ti=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ee||!ee.state||!ee.output||!ee.input&&ee.avail_in!==0)return z;I=ee.state,I.mode===W&&(I.mode=oe),H=ee.next_out,qe=ee.output,C=ee.avail_out,m=ee.next_in,Se=ee.input,pe=ee.avail_in,Z=I.hold,ue=I.bits,Ue=pe,Me=C,Nt=y;e:for(;;)switch(I.mode){case G:if(I.wrap===0){I.mode=oe;break}for(;ue<16;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}if(I.wrap&2&&Z===35615){I.check=0,Et[0]=Z&255,Et[1]=Z>>>8&255,I.check=r(I.check,Et,2,0),Z=0,ue=0,I.mode=X;break}if(I.flags=0,I.head&&(I.head.done=!1),!(I.wrap&1)||(((Z&255)<<8)+(Z>>8))%31){ee.msg="incorrect header check",I.mode=ze;break}if((Z&15)!==U){ee.msg="unknown compression method",I.mode=ze;break}if(Z>>>=4,ue-=4,xt=(Z&15)+8,I.wbits===0)I.wbits=xt;else if(xt>I.wbits){ee.msg="invalid window size",I.mode=ze;break}I.dmax=1<<xt,ee.adler=I.check=1,I.mode=Z&512?Q:W,Z=0,ue=0;break;case X:for(;ue<16;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}if(I.flags=Z,(I.flags&255)!==U){ee.msg="unknown compression method",I.mode=ze;break}if(I.flags&57344){ee.msg="unknown header flags set",I.mode=ze;break}I.head&&(I.head.text=Z>>8&1),I.flags&512&&(Et[0]=Z&255,Et[1]=Z>>>8&255,I.check=r(I.check,Et,2,0)),Z=0,ue=0,I.mode=q;case q:for(;ue<32;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}I.head&&(I.head.time=Z),I.flags&512&&(Et[0]=Z&255,Et[1]=Z>>>8&255,Et[2]=Z>>>16&255,Et[3]=Z>>>24&255,I.check=r(I.check,Et,4,0)),Z=0,ue=0,I.mode=Y;case Y:for(;ue<16;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}I.head&&(I.head.xflags=Z&255,I.head.os=Z>>8),I.flags&512&&(Et[0]=Z&255,Et[1]=Z>>>8&255,I.check=r(I.check,Et,2,0)),Z=0,ue=0,I.mode=B;case B:if(I.flags&1024){for(;ue<16;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}I.length=Z,I.head&&(I.head.extra_len=Z),I.flags&512&&(Et[0]=Z&255,Et[1]=Z>>>8&255,I.check=r(I.check,Et,2,0)),Z=0,ue=0}else I.head&&(I.head.extra=null);I.mode=K;case K:if(I.flags&1024&&(Ce=I.length,Ce>pe&&(Ce=pe),Ce&&(I.head&&(xt=I.head.extra_len-I.length,I.head.extra||(I.head.extra=new Array(I.head.extra_len)),e.arraySet(I.head.extra,Se,m,Ce,xt)),I.flags&512&&(I.check=r(I.check,Se,Ce,m)),pe-=Ce,m+=Ce,I.length-=Ce),I.length))break e;I.length=0,I.mode=ce;case ce:if(I.flags&2048){if(pe===0)break e;Ce=0;do xt=Se[m+Ce++],I.head&&xt&&I.length<65536&&(I.head.name+=String.fromCharCode(xt));while(xt&&Ce<pe);if(I.flags&512&&(I.check=r(I.check,Se,Ce,m)),pe-=Ce,m+=Ce,xt)break e}else I.head&&(I.head.name=null);I.length=0,I.mode=S;case S:if(I.flags&4096){if(pe===0)break e;Ce=0;do xt=Se[m+Ce++],I.head&&xt&&I.length<65536&&(I.head.comment+=String.fromCharCode(xt));while(xt&&Ce<pe);if(I.flags&512&&(I.check=r(I.check,Se,Ce,m)),pe-=Ce,m+=Ce,xt)break e}else I.head&&(I.head.comment=null);I.mode=ie;case ie:if(I.flags&512){for(;ue<16;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}if(Z!==(I.check&65535)){ee.msg="header crc mismatch",I.mode=ze;break}Z=0,ue=0}I.head&&(I.head.hcrc=I.flags>>9&1,I.head.done=!0),ee.adler=I.check=0,I.mode=W;break;case Q:for(;ue<32;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}ee.adler=I.check=$(Z),Z=0,ue=0,I.mode=se;case se:if(I.havedict===0)return ee.next_out=H,ee.avail_out=C,ee.next_in=m,ee.avail_in=pe,I.hold=Z,I.bits=ue,R;ee.adler=I.check=1,I.mode=W;case W:if(de===x||de===_)break e;case oe:if(I.last){Z>>>=ue&7,ue-=ue&7,I.mode=rt;break}for(;ue<3;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}switch(I.last=Z&1,Z>>>=1,ue-=1,Z&3){case 0:I.mode=te;break;case 1:if(Bt(I),I.mode=Re,de===_){Z>>>=2,ue-=2;break e}break;case 2:I.mode=me;break;case 3:ee.msg="invalid block type",I.mode=ze}Z>>>=2,ue-=2;break;case te:for(Z>>>=ue&7,ue-=ue&7;ue<32;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}if((Z&65535)!==(Z>>>16^65535)){ee.msg="invalid stored block lengths",I.mode=ze;break}if(I.length=Z&65535,Z=0,ue=0,I.mode=re,de===_)break e;case re:I.mode=le;case le:if(Ce=I.length,Ce){if(Ce>pe&&(Ce=pe),Ce>C&&(Ce=C),Ce===0)break e;e.arraySet(qe,Se,m,Ce,H),pe-=Ce,m+=Ce,C-=Ce,H+=Ce,I.length-=Ce;break}I.mode=W;break;case me:for(;ue<14;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}if(I.nlen=(Z&31)+257,Z>>>=5,ue-=5,I.ndist=(Z&31)+1,Z>>>=5,ue-=5,I.ncode=(Z&15)+4,Z>>>=4,ue-=4,I.nlen>286||I.ndist>30){ee.msg="too many length or distance symbols",I.mode=ze;break}I.have=0,I.mode=Fe;case Fe:for(;I.have<I.ncode;){for(;ue<3;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}I.lens[ti[I.have++]]=Z&7,Z>>>=3,ue-=3}for(;I.have<19;)I.lens[ti[I.have++]]=0;if(I.lencode=I.lendyn,I.lenbits=7,Kt={bits:I.lenbits},Nt=c(u,I.lens,0,19,I.lencode,0,I.work,Kt),I.lenbits=Kt.bits,Nt){ee.msg="invalid code lengths set",I.mode=ze;break}I.have=0,I.mode=ve;case ve:for(;I.have<I.nlen+I.ndist;){for(;gt=I.lencode[Z&(1<<I.lenbits)-1],ot=gt>>>24,vt=gt>>>16&255,kt=gt&65535,!(ot<=ue);){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}if(kt<16)Z>>>=ot,ue-=ot,I.lens[I.have++]=kt;else{if(kt===16){for(Zt=ot+2;ue<Zt;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}if(Z>>>=ot,ue-=ot,I.have===0){ee.msg="invalid bit length repeat",I.mode=ze;break}xt=I.lens[I.have-1],Ce=3+(Z&3),Z>>>=2,ue-=2}else if(kt===17){for(Zt=ot+3;ue<Zt;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}Z>>>=ot,ue-=ot,xt=0,Ce=3+(Z&7),Z>>>=3,ue-=3}else{for(Zt=ot+7;ue<Zt;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}Z>>>=ot,ue-=ot,xt=0,Ce=11+(Z&127),Z>>>=7,ue-=7}if(I.have+Ce>I.nlen+I.ndist){ee.msg="invalid bit length repeat",I.mode=ze;break}for(;Ce--;)I.lens[I.have++]=xt}}if(I.mode===ze)break;if(I.lens[256]===0){ee.msg="invalid code -- missing end-of-block",I.mode=ze;break}if(I.lenbits=9,Kt={bits:I.lenbits},Nt=c(p,I.lens,0,I.nlen,I.lencode,0,I.work,Kt),I.lenbits=Kt.bits,Nt){ee.msg="invalid literal/lengths set",I.mode=ze;break}if(I.distbits=6,I.distcode=I.distdyn,Kt={bits:I.distbits},Nt=c(f,I.lens,I.nlen,I.ndist,I.distcode,0,I.work,Kt),I.distbits=Kt.bits,Nt){ee.msg="invalid distances set",I.mode=ze;break}if(I.mode=Re,de===_)break e;case Re:I.mode=He;case He:if(pe>=6&&C>=258){ee.next_out=H,ee.avail_out=C,ee.next_in=m,ee.avail_in=pe,I.hold=Z,I.bits=ue,o(ee,Me),H=ee.next_out,qe=ee.output,C=ee.avail_out,m=ee.next_in,Se=ee.input,pe=ee.avail_in,Z=I.hold,ue=I.bits,I.mode===W&&(I.back=-1);break}for(I.back=0;gt=I.lencode[Z&(1<<I.lenbits)-1],ot=gt>>>24,vt=gt>>>16&255,kt=gt&65535,!(ot<=ue);){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}if(vt&&(vt&240)===0){for(Ft=ot,_r=vt,Sr=kt;gt=I.lencode[Sr+((Z&(1<<Ft+_r)-1)>>Ft)],ot=gt>>>24,vt=gt>>>16&255,kt=gt&65535,!(Ft+ot<=ue);){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}Z>>>=Ft,ue-=Ft,I.back+=Ft}if(Z>>>=ot,ue-=ot,I.back+=ot,I.length=kt,vt===0){I.mode=We;break}if(vt&32){I.back=-1,I.mode=W;break}if(vt&64){ee.msg="invalid literal/length code",I.mode=ze;break}I.extra=vt&15,I.mode=tt;case tt:if(I.extra){for(Zt=I.extra;ue<Zt;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}I.length+=Z&(1<<I.extra)-1,Z>>>=I.extra,ue-=I.extra,I.back+=I.extra}I.was=I.length,I.mode=it;case it:for(;gt=I.distcode[Z&(1<<I.distbits)-1],ot=gt>>>24,vt=gt>>>16&255,kt=gt&65535,!(ot<=ue);){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}if((vt&240)===0){for(Ft=ot,_r=vt,Sr=kt;gt=I.distcode[Sr+((Z&(1<<Ft+_r)-1)>>Ft)],ot=gt>>>24,vt=gt>>>16&255,kt=gt&65535,!(Ft+ot<=ue);){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}Z>>>=Ft,ue-=Ft,I.back+=Ft}if(Z>>>=ot,ue-=ot,I.back+=ot,vt&64){ee.msg="invalid distance code",I.mode=ze;break}I.offset=kt,I.extra=vt&15,I.mode=Je;case Je:if(I.extra){for(Zt=I.extra;ue<Zt;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}I.offset+=Z&(1<<I.extra)-1,Z>>>=I.extra,ue-=I.extra,I.back+=I.extra}if(I.offset>I.dmax){ee.msg="invalid distance too far back",I.mode=ze;break}I.mode=Ge;case Ge:if(C===0)break e;if(Ce=Me-C,I.offset>Ce){if(Ce=I.offset-Ce,Ce>I.whave&&I.sane){ee.msg="invalid distance too far back",I.mode=ze;break}Ce>I.wnext?(Ce-=I.wnext,Qe=I.wsize-Ce):Qe=I.wnext-Ce,Ce>I.length&&(Ce=I.length),Vt=I.window}else Vt=qe,Qe=H-I.offset,Ce=I.length;Ce>C&&(Ce=C),C-=Ce,I.length-=Ce;do qe[H++]=Vt[Qe++];while(--Ce);I.length===0&&(I.mode=He);break;case We:if(C===0)break e;qe[H++]=I.length,C--,I.mode=He;break;case rt:if(I.wrap){for(;ue<32;){if(pe===0)break e;pe--,Z|=Se[m++]<<ue,ue+=8}if(Me-=C,ee.total_out+=Me,I.total+=Me,Me&&(ee.adler=I.check=I.flags?r(I.check,qe,Me,H-Me):n(I.check,qe,Me,H-Me)),Me=C,(I.flags?Z:$(Z))!==I.check){ee.msg="incorrect data check",I.mode=ze;break}Z=0,ue=0}I.mode=Xe;case Xe:if(I.wrap&&I.flags){for(;ue<32;){if(pe===0)break e;pe--,Z+=Se[m++]<<ue,ue+=8}if(Z!==(I.total&4294967295)){ee.msg="incorrect length check",I.mode=ze;break}Z=0,ue=0}I.mode=at;case at:Nt=O;break e;case ze:Nt=N;break e;case Ke:return L;case pt:default:return z}return ee.next_out=H,ee.avail_out=C,ee.next_in=m,ee.avail_in=pe,I.hold=Z,I.bits=ue,(I.wsize||Me!==ee.avail_out&&I.mode<ze&&(I.mode<rt||de!==h))&&Jt(ee,ee.output,ee.next_out,Me-ee.avail_out),Ue-=ee.avail_in,Me-=ee.avail_out,ee.total_in+=Ue,ee.total_out+=Me,I.total+=Me,I.wrap&&Me&&(ee.adler=I.check=I.flags?r(I.check,qe,Me,ee.next_out-Me):n(I.check,qe,Me,ee.next_out-Me)),ee.data_type=I.bits+(I.last?64:0)+(I.mode===W?128:0)+(I.mode===Re||I.mode===re?256:0),(Ue===0&&Me===0||de===h)&&Nt===y&&(Nt=D),Nt}function _e(ee){if(!ee||!ee.state)return z;var de=ee.state;return de.window&&(de.window=null),ee.state=null,y}function ke(ee,de){var I;return!ee||!ee.state||(I=ee.state,(I.wrap&2)===0)?z:(I.head=de,de.done=!1,y)}function Be(ee,de){var I=de.length,Se,qe,m;return!ee||!ee.state||(Se=ee.state,Se.wrap!==0&&Se.mode!==se)?z:Se.mode===se&&(qe=1,qe=n(qe,de,I,0),qe!==Se.check)?N:(m=Jt(ee,de,I,I),m?(Se.mode=Ke,L):(Se.havedict=1,y))}return Yt.inflateReset=xe,Yt.inflateReset2=Ve,Yt.inflateResetKeep=ye,Yt.inflateInit=nt,Yt.inflateInit2=Ye,Yt.inflate=P,Yt.inflateEnd=_e,Yt.inflateGetHeader=ke,Yt.inflateSetDictionary=Be,Yt.inflateInfo="pako inflate (from Nodeca project)",Yt}var jo,Mf;function Qd(){return Mf||(Mf=1,jo={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),jo}var Bo,Pf;function ny(){if(Pf)return Bo;Pf=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return Bo=e,Bo}var jf;function iy(){if(jf)return en;jf=1;var e=ry(),n=xr(),r=Yd(),o=Qd(),c=As(),u=Jd(),p=ny(),f=Object.prototype.toString;function h(y){if(!(this instanceof h))return new h(y);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},y||{});var O=this.options;O.raw&&O.windowBits>=0&&O.windowBits<16&&(O.windowBits=-O.windowBits,O.windowBits===0&&(O.windowBits=-15)),O.windowBits>=0&&O.windowBits<16&&!(y&&y.windowBits)&&(O.windowBits+=32),O.windowBits>15&&O.windowBits<48&&(O.windowBits&15)===0&&(O.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var R=e.inflateInit2(this.strm,O.windowBits);if(R!==o.Z_OK)throw new Error(c[R]);if(this.header=new p,e.inflateGetHeader(this.strm,this.header),O.dictionary&&(typeof O.dictionary=="string"?O.dictionary=r.string2buf(O.dictionary):f.call(O.dictionary)==="[object ArrayBuffer]"&&(O.dictionary=new Uint8Array(O.dictionary)),O.raw&&(R=e.inflateSetDictionary(this.strm,O.dictionary),R!==o.Z_OK)))throw new Error(c[R])}h.prototype.push=function(y,O){var R=this.strm,z=this.options.chunkSize,N=this.options.dictionary,L,D,U,G,X,q=!1;if(this.ended)return!1;D=O===~~O?O:O===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof y=="string"?R.input=r.binstring2buf(y):f.call(y)==="[object ArrayBuffer]"?R.input=new Uint8Array(y):R.input=y,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new n.Buf8(z),R.next_out=0,R.avail_out=z),L=e.inflate(R,o.Z_NO_FLUSH),L===o.Z_NEED_DICT&&N&&(L=e.inflateSetDictionary(this.strm,N)),L===o.Z_BUF_ERROR&&q===!0&&(L=o.Z_OK,q=!1),L!==o.Z_STREAM_END&&L!==o.Z_OK)return this.onEnd(L),this.ended=!0,!1;R.next_out&&(R.avail_out===0||L===o.Z_STREAM_END||R.avail_in===0&&(D===o.Z_FINISH||D===o.Z_SYNC_FLUSH))&&(this.options.to==="string"?(U=r.utf8border(R.output,R.next_out),G=R.next_out-U,X=r.buf2string(R.output,U),R.next_out=G,R.avail_out=z-G,G&&n.arraySet(R.output,R.output,U,G,0),this.onData(X)):this.onData(n.shrinkBuf(R.output,R.next_out))),R.avail_in===0&&R.avail_out===0&&(q=!0)}while((R.avail_in>0||R.avail_out===0)&&L!==o.Z_STREAM_END);return L===o.Z_STREAM_END&&(D=o.Z_FINISH),D===o.Z_FINISH?(L=e.inflateEnd(this.strm),this.onEnd(L),this.ended=!0,L===o.Z_OK):(D===o.Z_SYNC_FLUSH&&(this.onEnd(o.Z_OK),R.avail_out=0),!0)},h.prototype.onData=function(y){this.chunks.push(y)},h.prototype.onEnd=function(y){y===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg};function x(y,O){var R=new h(O);if(R.push(y,!0),R.err)throw R.msg||c[R.err];return R.result}function _(y,O){return O=O||{},O.raw=!0,x(y,O)}return en.Inflate=h,en.inflate=x,en.inflateRaw=_,en.ungzip=x,en}var Fo,Bf;function ay(){if(Bf)return Fo;Bf=1;var e=xr().assign,n=Qw(),r=iy(),o=Qd(),c={};return e(c,n,r,o),Fo=c,Fo}var Do,Ff;function oy(){if(Ff)return Do;Ff=1;const e=(n,r)=>function(...o){const c=r.promiseModule;return new c((u,p)=>{r.multiArgs?o.push((...f)=>{r.errorFirst?f[0]?p(f):(f.shift(),u(f)):u(f)}):r.errorFirst?o.push((f,h)=>{f?p(f):u(h)}):o.push(u),n.apply(this,o)})};return Do=(n,r)=>{r=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},r);const o=typeof n;if(!(n!==null&&(o==="object"||o==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${n===null?"null":o}\``);const c=p=>{const f=h=>typeof h=="string"?p===h:h.test(p);return r.include?r.include.some(f):!r.exclude.some(f)};let u;o==="function"?u=function(...p){return r.excludeMain?n(...p):e(n,r).apply(this,p)}:u=Object.create(Object.getPrototypeOf(n));for(const p in n){const f=n[p];u[p]=typeof f=="function"&&c(p)?e(f,r):f}return u},Do}var Lo,Df;function sy(){if(Df)return Lo;Df=1;var e={};function n(re){return Array.isArray(re)?re:[re]}const r="",o=" ",c="\\",u=/^\s+$/,p=/(?:[^\\]|^)\\$/,f=/^\\!/,h=/^\\#/,x=/\r?\n/g,_=/^\.*\/|^\.+$/,y="/";let O="node-ignore";typeof Symbol<"u"&&(O=Symbol.for("node-ignore"));const R=O,z=(re,le,me)=>Object.defineProperty(re,le,{value:me}),N=/([0-z])-([0-z])/g,L=()=>!1,D=re=>re.replace(N,(le,me,Fe)=>me.charCodeAt(0)<=Fe.charCodeAt(0)?le:r),U=re=>{const{length:le}=re;return re.slice(0,le-le%2)},G=[[/^\uFEFF/,()=>r],[/((?:\\\\)*?)(\\?\s+)$/,(re,le,me)=>le+(me.indexOf("\\")===0?o:r)],[/(\\+?)\s/g,(re,le)=>{const{length:me}=le;return le.slice(0,me-me%2)+o}],[/[\\$.|*+(){^]/g,re=>`\\${re}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(re,le,me)=>le+6<me.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(re,le,me)=>{const Fe=me.replace(/\\\*/g,"[^\\/]*");return le+Fe}],[/\\\\\\(?=[$.|*+(){^])/g,()=>c],[/\\\\/g,()=>c],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(re,le,me,Fe,ve)=>le===c?`\\[${me}${U(Fe)}${ve}`:ve==="]"&&Fe.length%2===0?`[${D(me)}${Fe}]`:"[]"],[/(?:[^*])$/,re=>/\/$/.test(re)?`${re}$`:`${re}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(re,le)=>`${le?`${le}[^/]+`:"[^/]*"}(?=$|\\/$)`]],X=Object.create(null),q=(re,le)=>{let me=X[re];return me||(me=G.reduce((Fe,[ve,Re])=>Fe.replace(ve,Re.bind(re)),re),X[re]=me),le?new RegExp(me,"i"):new RegExp(me)},Y=re=>typeof re=="string",B=re=>re&&Y(re)&&!u.test(re)&&!p.test(re)&&re.indexOf("#")!==0,K=re=>re.split(x);class ce{constructor(le,me,Fe,ve){this.origin=le,this.pattern=me,this.negative=Fe,this.regex=ve}}const S=(re,le)=>{const me=re;let Fe=!1;re.indexOf("!")===0&&(Fe=!0,re=re.substr(1)),re=re.replace(f,"!").replace(h,"#");const ve=q(re,le);return new ce(me,re,Fe,ve)},ie=(re,le)=>{throw new le(re)},Q=(re,le,me)=>Y(re)?re?Q.isNotRelative(re)?me(`path should be a \`path.relative()\`d string, but got "${le}"`,RangeError):!0:me("path must not be empty",TypeError):me(`path must be a string, but got \`${le}\``,TypeError),se=re=>_.test(re);Q.isNotRelative=se,Q.convert=re=>re;class W{constructor({ignorecase:le=!0,ignoreCase:me=le,allowRelativePaths:Fe=!1}={}){z(this,R,!0),this._rules=[],this._ignoreCase=me,this._allowRelativePaths=Fe,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(le){if(le&&le[R]){this._rules=this._rules.concat(le._rules),this._added=!0;return}if(B(le)){const me=S(le,this._ignoreCase);this._added=!0,this._rules.push(me)}}add(le){return this._added=!1,n(Y(le)?K(le):le).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(le){return this.add(le)}_testOne(le,me){let Fe=!1,ve=!1;return this._rules.forEach(Re=>{const{negative:He}=Re;if(ve===He&&Fe!==ve||He&&!Fe&&!ve&&!me)return;Re.regex.test(le)&&(Fe=!He,ve=He)}),{ignored:Fe,unignored:ve}}_test(le,me,Fe,ve){const Re=le&&Q.convert(le);return Q(Re,le,this._allowRelativePaths?L:ie),this._t(Re,me,Fe,ve)}_t(le,me,Fe,ve){if(le in me)return me[le];if(ve||(ve=le.split(y)),ve.pop(),!ve.length)return me[le]=this._testOne(le,Fe);const Re=this._t(ve.join(y)+y,me,Fe,ve);return me[le]=Re.ignored?Re:this._testOne(le,Fe)}ignores(le){return this._test(le,this._ignoreCache,!1).ignored}createFilter(){return le=>!this.ignores(le)}filter(le){return n(le).filter(this.createFilter())}test(le){return this._test(le,this._testCache,!0)}}const oe=re=>new W(re),te=re=>Q(re&&Q.convert(re),re,L);if(oe.isPathValid=te,oe.default=oe,Lo=oe,typeof process<"u"&&(e&&e.IGNORE_TEST_WIN32||process.platform==="win32")){const re=me=>/^\\\\\?\\/.test(me)||/["<>|\u0000-\u001F]+/u.test(me)?me:me.replace(/\\/g,"/");Q.convert=re;const le=/^[a-z]:\//i;Q.isNotRelative=me=>le.test(me)||se(me)}return Lo}var $o,Lf;function cy(){if(Lf)return $o;Lf=1;function e(o){return o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function n(o,c,u){return c=c instanceof RegExp?c:new RegExp(e(c),"g"),o.replace(c,u)}var r={clean:function(c){if(typeof c!="string")throw new Error("Expected a string, received: "+c);return c=n(c,"./","/"),c=n(c,"..","."),c=n(c," ","-"),c=n(c,/^[~^:?*\\\-]/g,""),c=n(c,/[~^:?*\\]/g,"-"),c=n(c,/[~^:?*\\\-]$/g,""),c=n(c,"@{","-"),c=n(c,/\.$/g,""),c=n(c,/\/$/g,""),c=n(c,/\.lock$/g,""),c}};return $o=r,$o}var No,$f;function ly(){return $f||($f=1,No=function(e,n){var r=e,o=n,c=r.length,u=o.length,p=!1,f=null,h=c+1,x=[],_=[],y=[],O="",R=-1,z=0,N=1,L,D,U=function(){c>=u&&(L=r,D=c,r=o,o=L,c=u,u=D,p=!0,h=c+1)},G=function(B,K,ce){return{x:B,y:K,k:ce}},X=function(B,K){return{elem:B,t:K}},q=function(B,K,ce){var S,ie,Q;for(K>ce?S=x[B-1+h]:S=x[B+1+h],Q=Math.max(K,ce),ie=Q-B;ie<c&&Q<u&&r[ie]===o[Q];)++ie,++Q;return x[B+h]=_.length,_[_.length]=new G(ie,Q,S),Q},Y=function(B){var K,ce,S;for(K=ce=0,S=B.length-1;S>=0;--S)for(;K<B[S].x||ce<B[S].y;)B[S].y-B[S].x>ce-K?(p?y[y.length]=new X(o[ce],R):y[y.length]=new X(o[ce],N),++ce):B[S].y-B[S].x<ce-K?(p?y[y.length]=new X(r[K],N):y[y.length]=new X(r[K],R),++K):(y[y.length]=new X(r[K],z),O+=r[K],++K,++ce)};return U(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return f},getlcs:function(){return O},getses:function(){return y},compose:function(){var B,K,ce,S,ie,Q,se,W;for(B=u-c,K=c+u+3,ce={},se=0;se<K;++se)ce[se]=-1,x[se]=-1;S=-1;do{for(++S,W=-S;W<=B-1;++W)ce[W+h]=q(W,ce[W-1+h]+1,ce[W+1+h]);for(W=B+S;W>=B+1;--W)ce[W+h]=q(W,ce[W-1+h]+1,ce[W+1+h]);ce[B+h]=q(B,ce[B-1+h]+1,ce[B+1+h])}while(ce[B+h]!==u);for(f=B+2*S,ie=x[B+h],Q=[];ie!==-1;)Q[Q.length]=new G(_[ie].x,_[ie].y,null),ie=_[ie].k;Y(Q)}}}),No}var Uo,Nf;function uy(){if(Nf)return Uo;Nf=1;var e=ly();function n(u,p){var f=new e(u,p);f.compose();for(var h=f.getses(),x,_,y=u.length-1,O=p.length-1,R=h.length-1;R>=0;--R)h[R].t===f.SES_COMMON?(_?(_.chain={file1index:y,file2index:O,chain:null},_=_.chain):(x={file1index:y,file2index:O,chain:null},_=x),y--,O--):h[R].t===f.SES_DELETE?y--:h[R].t===f.SES_ADD&&O--;var z={file1index:-1,file2index:-1,chain:null};return _?(_.chain=z,x):z}function r(u,p){for(var f=[],h=u.length,x=p.length,_=n(u,p);_!==null;_=_.chain){var y=h-_.file1index-1,O=x-_.file2index-1;h=_.file1index,x=_.file2index,(y||O)&&f.push({file1:[h+1,y],file2:[x+1,O]})}return f.reverse(),f}function o(u,p,f){var h,x=r(p,u),_=r(p,f),y=[];function O(le,me){y.push([le.file1[0],me,le.file1[1],le.file2[0],le.file2[1]])}for(h=0;h<x.length;h++)O(x[h],0);for(h=0;h<_.length;h++)O(_[h],2);y.sort(function(le,me){return le[0]-me[0]});var R=[],z=0;function N(le){le>z&&(R.push([1,z,le-z]),z=le)}for(var L=0;L<y.length;L++){for(var D=L,U=y[L],G=U[0],X=G+U[2];L<y.length-1;){var q=y[L+1],Y=q[0];if(Y>X)break;X=Math.max(X,Y+q[2]),L++}if(N(G),D==L)U[4]>0&&R.push([U[1],U[3],U[4]]);else{var B={0:[u.length,-1,p.length,-1],2:[f.length,-1,p.length,-1]};for(h=D;h<=L;h++){U=y[h];var K=U[1],ce=B[K],S=U[0],ie=S+U[2],Q=U[3],se=Q+U[4];ce[0]=Math.min(Q,ce[0]),ce[1]=Math.max(se,ce[1]),ce[2]=Math.min(S,ce[2]),ce[3]=Math.max(ie,ce[3])}var W=B[0][0]+(G-B[0][2]),oe=B[0][1]+(X-B[0][3]),te=B[2][0]+(G-B[2][2]),re=B[2][1]+(X-B[2][3]);R.push([-1,W,oe-W,G,X-G,te,re-te])}z=X}return N(p.length),R}function c(u,p,f){var h=[],x=[u,p,f],_=o(u,p,f),y=[];function O(){y.length&&h.push({ok:y}),y=[]}function R(U){for(var G=0;G<U.length;G++)y.push(U[G])}function z(U){if(U[2]!=U[6])return!0;for(var G=U[1],X=U[5],q=0;q<U[2];q++)if(u[q+G]!=f[q+X])return!0;return!1}for(var N=0;N<_.length;N++){var L=_[N],D=L[0];D==-1?z(L)?(O(),h.push({conflict:{a:u.slice(L[1],L[1]+L[2]),aIndex:L[1],o:p.slice(L[3],L[3]+L[4]),oIndex:L[3],b:f.slice(L[5],L[5]+L[6]),bIndex:L[5]}})):R(x[0].slice(L[1],L[1]+L[2])):R(x[D].slice(L[1],L[1]+L[2]))}return O(),h}return Uo=c,Uo}var Uf;function fy(){if(Uf)return Oe;Uf=1,Object.defineProperty(Oe,"__esModule",{value:!0});function e(a){return a&&typeof a=="object"&&"default"in a?a.default:a}var n=e(lw()),r=e(Zw()),o=e(Xw()),c=e(ay()),u=e(oy()),p=e(sy()),f=e(cy()),h=e(uy());class x extends Error{constructor(t){super(t),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(t){const i=new x(t.message);return i.code=t.code,i.data=t.data,i.caller=t.caller,i.stack=t.stack,i}get isIsomorphicGitError(){return!0}}class _ extends x{constructor(t){super(`Modifying the index is not possible because you have unmerged files: ${t.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=_.code,this.data={filepaths:t}}}_.code="UnmergedPathsError";class y extends x{constructor(t){super(`An internal error caused this command to fail.

If you're not a developer, report the bug to the developers of the application you're using. If this is a bug in isomorphic-git then you should create a proper bug yourselves. The bug should include a minimal reproduction and details about the version and environment.

Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${t}`),this.code=this.name=y.code,this.data={message:t}}}y.code="InternalError";class O extends x{constructor(t){super(`The filepath "${t}" contains unsafe character sequences`),this.code=this.name=O.code,this.data={filepath:t}}}O.code="UnsafeFilepathError";class R{constructor(t){this.buffer=t,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(t){this._start=t}slice(t){const i=this.buffer.slice(this._start,this._start+t);return this._start+=t,i}toString(t,i){const s=this.buffer.toString(t,this._start,this._start+i);return this._start+=i,s}write(t,i,s){const l=this.buffer.write(t,this._start,i,s);return this._start+=i,l}copy(t,i,s){const l=t.copy(this.buffer,this._start,i,s);return this._start+=l,l}readUInt8(){const t=this.buffer.readUInt8(this._start);return this._start+=1,t}writeUInt8(t){const i=this.buffer.writeUInt8(t,this._start);return this._start+=1,i}readUInt16BE(){const t=this.buffer.readUInt16BE(this._start);return this._start+=2,t}writeUInt16BE(t){const i=this.buffer.writeUInt16BE(t,this._start);return this._start+=2,i}readUInt32BE(){const t=this.buffer.readUInt32BE(this._start);return this._start+=4,t}writeUInt32BE(t){const i=this.buffer.writeUInt32BE(t,this._start);return this._start+=4,i}}function z(a,t){return-(a<t)||+(a>t)}function N(a,t){return z(a.path,t.path)}function L(a){let t=a>0?a>>12:0;t!==4&&t!==8&&t!==10&&t!==14&&(t=8);let i=a&511;return i&73?i=493:i=420,t!==8&&(i=0),(t<<12)+i}const D=2**32;function U(a,t,i,s){if(a!==void 0&&t!==void 0)return[a,t];i===void 0&&(i=s.valueOf());const l=Math.floor(i/1e3),d=(i-l*1e3)*1e6;return[l,d]}function G(a){const[t,i]=U(a.ctimeSeconds,a.ctimeNanoseconds,a.ctimeMs,a.ctime),[s,l]=U(a.mtimeSeconds,a.mtimeNanoseconds,a.mtimeMs,a.mtime);return{ctimeSeconds:t%D,ctimeNanoseconds:i%D,mtimeSeconds:s%D,mtimeNanoseconds:l%D,dev:a.dev%D,ino:a.ino%D,mode:L(a.mode%D),uid:a.uid%D,gid:a.gid%D,size:a.size>-1?a.size%D:0}}function X(a){let t="";for(const i of new Uint8Array(a))i<16&&(t+="0"),t+=i.toString(16);return t}let q=null;async function Y(a){return q===null&&(q=await ce()),q?K(a):B(a)}function B(a){return new r().update(a).digest("hex")}async function K(a){const t=await crypto.subtle.digest("SHA-1",a);return X(t)}async function ce(){try{return await K(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709"}catch{}return!1}function S(a){return{assumeValid:!!(a&32768),extended:!!(a&16384),stage:(a&12288)>>12,nameLength:a&4095}}function ie(a){const t=a.flags;return t.extended=!1,t.nameLength=Math.min(Buffer.from(a.path).length,4095),(t.assumeValid?32768:0)+(t.extended?16384:0)+((t.stage&3)<<12)+(t.nameLength&4095)}class Q{constructor(t,i){this._dirty=!1,this._unmergedPaths=i||new Set,this._entries=t||new Map}_addEntry(t){if(t.flags.stage===0)t.stages=[t],this._entries.set(t.path,t),this._unmergedPaths.delete(t.path);else{let i=this._entries.get(t.path);i||(this._entries.set(t.path,t),i=t),i.stages[t.flags.stage]=t,this._unmergedPaths.add(t.path)}}static async from(t){if(Buffer.isBuffer(t))return Q.fromBuffer(t);if(t===null)return new Q(null);throw new y("invalid type passed to GitIndex.from")}static async fromBuffer(t){if(t.length===0)throw new y("Index file is empty (.git/index)");const i=new Q,s=new R(t),l=s.toString("utf8",4);if(l!=="DIRC")throw new y(`Invalid dircache magic file number: ${l}`);const d=await Y(t.slice(0,-20)),w=t.slice(-20).toString("hex");if(w!==d)throw new y(`Invalid checksum in GitIndex buffer: expected ${w} but saw ${d}`);const v=s.readUInt32BE();if(v!==2)throw new y(`Unsupported dircache version: ${v}`);const A=s.readUInt32BE();let T=0;for(;!s.eof()&&T<A;){const k={};k.ctimeSeconds=s.readUInt32BE(),k.ctimeNanoseconds=s.readUInt32BE(),k.mtimeSeconds=s.readUInt32BE(),k.mtimeNanoseconds=s.readUInt32BE(),k.dev=s.readUInt32BE(),k.ino=s.readUInt32BE(),k.mode=s.readUInt32BE(),k.uid=s.readUInt32BE(),k.gid=s.readUInt32BE(),k.size=s.readUInt32BE(),k.oid=s.slice(20).toString("hex");const j=s.readUInt16BE();k.flags=S(j);const F=t.indexOf(0,s.tell()+1)-s.tell();if(F<1)throw new y(`Got a path length of: ${F}`);if(k.path=s.toString("utf8",F),k.path.includes("..\\")||k.path.includes("../"))throw new O(k.path);let V=8-(s.tell()-12)%8;for(V===0&&(V=8);V--;){const ne=s.readUInt8();if(ne!==0)throw new y(`Expected 1-8 null characters but got '${ne}' after ${k.path}`);if(s.eof())throw new y("Unexpected end of file")}k.stages=[],i._addEntry(k),T++}return i}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(N)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(t=>t.stages.length>1?t.stages.filter(i=>i):t)}*[Symbol.iterator](){for(const t of this.entries)yield t}insert({filepath:t,stats:i,oid:s,stage:l=0}){i||(i={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),i=G(i);const d=Buffer.from(t),w={ctimeSeconds:i.ctimeSeconds,ctimeNanoseconds:i.ctimeNanoseconds,mtimeSeconds:i.mtimeSeconds,mtimeNanoseconds:i.mtimeNanoseconds,dev:i.dev,ino:i.ino,mode:i.mode||33188,uid:i.uid,gid:i.gid,size:i.size,path:t,oid:s,flags:{assumeValid:!1,extended:!1,stage:l,nameLength:d.length<4095?d.length:4095},stages:[]};this._addEntry(w),this._dirty=!0}delete({filepath:t}){if(this._entries.has(t))this._entries.delete(t);else for(const i of this._entries.keys())i.startsWith(t+"/")&&this._entries.delete(i);this._unmergedPaths.has(t)&&this._unmergedPaths.delete(t),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:t}){return this._entries.has(t)}render(){return this.entries.map(t=>`${t.mode.toString(8)} ${t.oid}    ${t.path}`).join(`
`)}static async _entryToBuffer(t){const i=Buffer.from(t.path),s=Math.ceil((62+i.length+1)/8)*8,l=Buffer.alloc(s),d=new R(l),w=G(t);return d.writeUInt32BE(w.ctimeSeconds),d.writeUInt32BE(w.ctimeNanoseconds),d.writeUInt32BE(w.mtimeSeconds),d.writeUInt32BE(w.mtimeNanoseconds),d.writeUInt32BE(w.dev),d.writeUInt32BE(w.ino),d.writeUInt32BE(w.mode),d.writeUInt32BE(w.uid),d.writeUInt32BE(w.gid),d.writeUInt32BE(w.size),d.write(t.oid,20,"hex"),d.writeUInt16BE(ie(t)),d.write(t.path,i.length,"utf8"),l}async toObject(){const t=Buffer.alloc(12),i=new R(t);i.write("DIRC",4,"utf8"),i.writeUInt32BE(2),i.writeUInt32BE(this.entriesFlat.length);let s=[];for(const v of this.entries)if(s.push(Q._entryToBuffer(v)),v.stages.length>1)for(const A of v.stages)A&&A!==v&&s.push(Q._entryToBuffer(A));s=await Promise.all(s);const l=Buffer.concat(s),d=Buffer.concat([t,l]),w=await Y(d);return Buffer.concat([d,Buffer.from(w,"hex")])}}function se(a,t,i=!0,s=!0){const l=G(a),d=G(t);return i&&l.mode!==d.mode||l.mtimeSeconds!==d.mtimeSeconds||l.ctimeSeconds!==d.ctimeSeconds||l.uid!==d.uid||l.gid!==d.gid||s&&l.ino!==d.ino||l.size!==d.size}let W=null;const oe=Symbol("IndexCache");function te(){return{map:new Map,stats:new Map}}async function re(a,t,i){const[s,l]=await Promise.all([a.lstat(t),a.read(t)]),d=await Q.from(l);i.map.set(t,d),i.stats.set(t,s)}async function le(a,t,i){const s=i.stats.get(t);if(s===void 0)return!0;if(s===null)return!1;const l=await a.lstat(t);return l===null?!1:se(s,l)}class me{static async acquire({fs:t,gitdir:i,cache:s,allowUnmerged:l=!0},d){s[oe]||(s[oe]=te());const w=`${i}/index`;W===null&&(W=new n({maxPending:1/0}));let v,A=[];return await W.acquire(w,async()=>{const T=s[oe];await le(t,w,T)&&await re(t,w,T);const k=T.map.get(w);if(A=k.unmergedPaths,A.length&&!l)throw new _(A);if(v=await d(k),k._dirty){const j=await k.toObject();await t.write(w,j),T.stats.set(w,await t.lstat(w)),k._dirty=!1}}),v}}function Fe(a){const t=Math.max(a.lastIndexOf("/"),a.lastIndexOf("\\"));return t>-1&&(a=a.slice(t+1)),a}function ve(a){const t=Math.max(a.lastIndexOf("/"),a.lastIndexOf("\\"));return t===-1?".":t===0?"/":a.slice(0,t)}function Re(a){const t=new Map,i=function(l){if(!t.has(l)){const d={type:"tree",fullpath:l,basename:Fe(l),metadata:{},children:[]};t.set(l,d),d.parent=i(ve(l)),d.parent&&d.parent!==d&&d.parent.children.push(d)}return t.get(l)},s=function(l,d){if(!t.has(l)){const w={type:"blob",fullpath:l,basename:Fe(l),metadata:d,parent:i(ve(l)),children:[]};w.parent&&w.parent.children.push(w),t.set(l,w)}return t.get(l)};i(".");for(const l of a)s(l.path,l);return t}function He(a){switch(a){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new y(`Unexpected GitTree entry mode: ${a.toString(8)}`)}class tt{constructor({fs:t,gitdir:i,cache:s}){this.treePromise=me.acquire({fs:t,gitdir:i,cache:s},async function(d){return Re(d.entries)});const l=this;this.ConstructEntry=class{constructor(w){this._fullpath=w,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return l.type(this)}async mode(){return l.mode(this)}async stat(){return l.stat(this)}async content(){return l.content(this)}async oid(){return l.oid(this)}}}async readdir(t){const i=t._fullpath,l=(await this.treePromise).get(i);if(!l||l.type==="blob")return null;if(l.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${i}'`);const d=l.children.map(w=>w.fullpath);return d.sort(z),d}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const s=(await this.treePromise).get(t._fullpath);if(!s)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);const l=s.type==="tree"?{}:G(s.metadata);t._type=s.type==="tree"?"tree":He(l.mode),t._mode=l.mode,s.type==="tree"?t._stat=void 0:t._stat=l}return t._stat}async content(t){}async oid(t){if(t._oid===!1){const s=(await this.treePromise).get(t._fullpath);t._oid=s.metadata.oid}return t._oid}}const it=Symbol("GitWalkSymbol");function Je(){const a=Object.create(null);return Object.defineProperty(a,it,{value:function({fs:t,gitdir:i,cache:s}){return new tt({fs:t,gitdir:i,cache:s})}}),Object.freeze(a),a}class Ge extends x{constructor(t){super(`Could not find ${t}.`),this.code=this.name=Ge.code,this.data={what:t}}}Ge.code="NotFoundError";class We extends x{constructor(t,i,s,l){super(`Object ${t} ${l?`at ${l}`:""}was anticipated to be a ${s} but it is a ${i}.`),this.code=this.name=We.code,this.data={oid:t,actual:i,expected:s,filepath:l}}}We.code="ObjectTypeError";class rt extends x{constructor(t){super(`Expected a 40-char hex object id but saw "${t}".`),this.code=this.name=rt.code,this.data={value:t}}}rt.code="InvalidOidError";class Xe extends x{constructor(t){super(`Could not find a fetch refspec for remote "${t}". Make sure the config file has an entry like the following:
[remote "${t}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=Xe.code,this.data={remote:t}}}Xe.code="NoRefspecError";class at{constructor(t){if(this.refs=new Map,this.parsedConfig=[],t){let i=null;this.parsedConfig=t.trim().split(`
`).map(s=>{if(/^\s*#/.test(s))return{line:s,comment:!0};const l=s.indexOf(" ");if(s.startsWith("^")){const d=s.slice(1);return this.refs.set(i+"^{}",d),{line:s,ref:i,peeled:d}}else{const d=s.slice(0,l);return i=s.slice(l+1),this.refs.set(i,d),{line:s,ref:i,oid:d}}})}return this}static from(t){return new at(t)}delete(t){this.parsedConfig=this.parsedConfig.filter(i=>i.ref!==t),this.refs.delete(t)}toString(){return this.parsedConfig.map(({line:t})=>t).join(`
`)+`
`}}class ze{constructor({remotePath:t,localPath:i,force:s,matchPrefix:l}){Object.assign(this,{remotePath:t,localPath:i,force:s,matchPrefix:l})}static from(t){const[i,s,l,d,w]=t.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),v=i==="+",A=l==="*";if(A!==(w==="*"))throw new y("Invalid refspec");return new ze({remotePath:s,localPath:d,force:v,matchPrefix:A})}translate(t){if(this.matchPrefix){if(t.startsWith(this.remotePath))return this.localPath+t.replace(this.remotePath,"")}else if(t===this.remotePath)return this.localPath;return null}reverseTranslate(t){if(this.matchPrefix){if(t.startsWith(this.localPath))return this.remotePath+t.replace(this.localPath,"")}else if(t===this.localPath)return this.remotePath;return null}}class Ke{constructor(t=[]){this.rules=t}static from(t){const i=[];for(const s of t)i.push(ze.from(s));return new Ke(i)}add(t){const i=ze.from(t);this.rules.push(i)}translate(t){const i=[];for(const s of this.rules)for(const l of t){const d=s.translate(l);d&&i.push([l,d])}return i}translateOne(t){let i=null;for(const s of this.rules){const l=s.translate(t);l&&(i=l)}return i}localNamespaces(){return this.rules.filter(t=>t.matchPrefix).map(t=>t.localPath.replace(/\/$/,""))}}function pt(a,t){const i=a.replace(/\^\{\}$/,""),s=t.replace(/\^\{\}$/,""),l=-(i<s)||+(i>s);return l===0?a.endsWith("^{}")?1:-1:l}/*!
 * This code for `path.join` is directly copied from @zenfs/core/path for bundle size improvements.
 * SPDX-License-Identifier: LGPL-3.0-or-later
 * Copyright (c) James Prevett and other ZenFS contributors.
 */function wt(a,t){let i="",s=0,l=-1,d=0,w="\0";for(let v=0;v<=a.length;++v){if(v<a.length)w=a[v];else{if(w==="/")break;w="/"}if(w==="/"){if(!(l===v-1||d===1))if(d===2){if(i.length<2||s!==2||i.at(-1)!=="."||i.at(-2)!=="."){if(i.length>2){const A=i.lastIndexOf("/");A===-1?(i="",s=0):(i=i.slice(0,A),s=i.length-1-i.lastIndexOf("/")),l=v,d=0;continue}else if(i.length!==0){i="",s=0,l=v,d=0;continue}}t&&(i+=i.length>0?"/..":"..",s=2)}else i.length>0?i+="/"+a.slice(l+1,v):i=a.slice(l+1,v),s=v-l-1;l=v,d=0}else w==="."&&d!==-1?++d:d=-1}return i}function M(a){if(!a.length)return".";const t=a[0]==="/",i=a.at(-1)==="/";return a=wt(a,!t),a.length?(i&&(a+="/"),t?`/${a}`:a):t?"/":i?"./":"."}function g(...a){if(a.length===0)return".";let t;for(let i=0;i<a.length;++i){const s=a[i];s.length>0&&(t===void 0?t=s:t+="/"+s)}return t===void 0?".":M(t)}const b=a=>{if(typeof a=="number")return a;a=a.toLowerCase();let t=parseInt(a);return a.endsWith("k")&&(t*=1024),a.endsWith("m")&&(t*=1024*1024),a.endsWith("g")&&(t*=1024*1024*1024),t},$=a=>{if(typeof a=="boolean")return a;if(a=a.trim().toLowerCase(),a==="true"||a==="yes"||a==="on")return!0;if(a==="false"||a==="no"||a==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${a}`)},ae={core:{filemode:$,bare:$,logallrefupdates:$,symlinks:$,ignorecase:$,bigFileThreshold:b}},ye=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,xe=/^[A-Za-z0-9-.]+$/,Ve=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,Ye=/^[A-Za-z][A-Za-z-]*$/,nt=/^(.*?)( *[#;].*)$/,ft=a=>{const t=ye.exec(a);if(t!=null){const[i,s]=t.slice(1);return[i,s]}return null},st=a=>{const t=Ve.exec(a);if(t!=null){const[i,s="true"]=t.slice(1),l=yt(s),d=Jt(l);return[i,d]}return null},yt=a=>{const t=nt.exec(a);if(t==null)return a;const[i,s]=t.slice(1);return Bt(i)&&Bt(s)?`${i}${s}`:i},Bt=a=>(a.match(/(?:^|[^\\])"/g)||[]).length%2!==0,Jt=a=>a.split("").reduce((t,i,s,l)=>{const d=i==='"'&&l[s-1]!=="\\",w=i==="\\"&&l[s+1]==='"';return d||w?t:t+i},""),P=a=>a!=null?a.toLowerCase():null,_e=(a,t,i)=>[P(a),t,P(i)].filter(s=>s!=null).join("."),ke=a=>{const t=a.split("."),i=t.shift(),s=t.pop(),l=t.length?t.join("."):void 0;return{section:i,subsection:l,name:s,path:_e(i,l,s),sectionPath:_e(i,l,null),isSection:!!i}},Be=(a,t)=>a.reduce((i,s,l)=>t(s)?l:i,-1);class ee{constructor(t){let i=null,s=null;this.parsedConfig=t?t.split(`
`).map(l=>{let d=null,w=null;const v=l.trim(),A=ft(v),T=A!=null;if(T)[i,s]=A;else{const j=st(v);j!=null&&([d,w]=j)}const k=_e(i,s,d);return{line:l,isSection:T,section:i,subsection:s,name:d,value:w,path:k}}):[]}static from(t){return new ee(t)}async get(t,i=!1){const s=ke(t).path,l=this.parsedConfig.filter(d=>d.path===s).map(({section:d,name:w,value:v})=>{const A=ae[d]&&ae[d][w];return A?A(v):v});return i?l:l.pop()}async getall(t){return this.get(t,!0)}async getSubsections(t){return this.parsedConfig.filter(i=>i.isSection&&i.section===t).map(i=>i.subsection)}async deleteSection(t,i){this.parsedConfig=this.parsedConfig.filter(s=>!(s.section===t&&s.subsection===i))}async append(t,i){return this.set(t,i,!0)}async set(t,i,s=!1){const{section:l,subsection:d,name:w,path:v,sectionPath:A,isSection:T}=ke(t),k=Be(this.parsedConfig,j=>j.path===v);if(i==null)k!==-1&&this.parsedConfig.splice(k,1);else if(k!==-1){const j=this.parsedConfig[k],F=Object.assign({},j,{name:w,value:i,modified:!0});s?this.parsedConfig.splice(k+1,0,F):this.parsedConfig[k]=F}else{const j=this.parsedConfig.findIndex(V=>V.path===A),F={section:l,subsection:d,name:w,value:i,modified:!0,path:v};if(xe.test(l)&&Ye.test(w))if(j>=0)this.parsedConfig.splice(j+1,0,F);else{const V={isSection:T,section:l,subsection:d,modified:!0,path:A};this.parsedConfig.push(V,F)}}}toString(){return this.parsedConfig.map(({line:t,section:i,subsection:s,name:l,value:d,modified:w=!1})=>w?l!=null&&d!=null?typeof d=="string"&&/[#;]/.test(d)?`	${l} = "${d}"`:`	${l} = ${d}`:s!=null?`[${i} "${s}"]`:`[${i}]`:t).join(`
`)}}class de{static async get({fs:t,gitdir:i}){const s=await t.read(`${i}/config`,{encoding:"utf8"});return ee.from(s)}static async save({fs:t,gitdir:i,config:s}){await t.write(`${i}/config`,s.toString(),{encoding:"utf8"})}}const I=a=>[`${a}`,`refs/${a}`,`refs/tags/${a}`,`refs/heads/${a}`,`refs/remotes/${a}`,`refs/remotes/${a}/HEAD`],Se=["config","description","index","shallow","commondir"];let qe;async function m(a,t){return qe===void 0&&(qe=new n),qe.acquire(a,t)}class H{static async updateRemoteRefs({fs:t,gitdir:i,remote:s,refs:l,symrefs:d,tags:w,refspecs:v=void 0,prune:A=!1,pruneTags:T=!1}){for(const he of l.values())if(!he.match(/[0-9a-f]{40}/))throw new rt(he);const k=await de.get({fs:t,gitdir:i});if(!v){if(v=await k.getall(`remote.${s}.fetch`),v.length===0)throw new Xe(s);v.unshift(`+HEAD:refs/remotes/${s}/HEAD`)}const j=Ke.from(v),F=new Map;if(T){const he=await H.listRefs({fs:t,gitdir:i,filepath:"refs/tags"});await H.deleteRefs({fs:t,gitdir:i,refs:he.map(we=>`refs/tags/${we}`)})}if(w){for(const he of l.keys())if(he.startsWith("refs/tags")&&!he.endsWith("^{}")&&!await H.exists({fs:t,gitdir:i,ref:he})){const we=l.get(he);F.set(he,we)}}const V=j.translate([...l.keys()]);for(const[he,we]of V){const be=l.get(he);F.set(we,be)}const ne=j.translate([...d.keys()]);for(const[he,we]of ne){const be=d.get(he),Ae=j.translateOne(be);Ae&&F.set(we,`ref: ${Ae}`)}const ge=[];if(A){for(const he of j.localNamespaces()){const we=(await H.listRefs({fs:t,gitdir:i,filepath:he})).map(be=>`${he}/${be}`);for(const be of we)F.has(be)||ge.push(be)}ge.length>0&&await H.deleteRefs({fs:t,gitdir:i,refs:ge})}for(const[he,we]of F)await m(he,async()=>t.write(g(i,he),`${we.trim()}
`,"utf8"));return{pruned:ge}}static async writeRef({fs:t,gitdir:i,ref:s,value:l}){if(!l.match(/[0-9a-f]{40}/))throw new rt(l);await m(s,async()=>t.write(g(i,s),`${l.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:t,gitdir:i,ref:s,value:l}){await m(s,async()=>t.write(g(i,s),`ref: ${l.trim()}
`,"utf8"))}static async deleteRef({fs:t,gitdir:i,ref:s}){return H.deleteRefs({fs:t,gitdir:i,refs:[s]})}static async deleteRefs({fs:t,gitdir:i,refs:s}){await Promise.all(s.map(v=>t.rm(g(i,v))));let l=await m("packed-refs",async()=>t.read(`${i}/packed-refs`,{encoding:"utf8"}));const d=at.from(l),w=d.refs.size;for(const v of s)d.refs.has(v)&&d.delete(v);d.refs.size<w&&(l=d.toString(),await m("packed-refs",async()=>t.write(`${i}/packed-refs`,l,{encoding:"utf8"})))}static async resolve({fs:t,gitdir:i,ref:s,depth:l=void 0}){if(l!==void 0&&(l--,l===-1))return s;if(s.startsWith("ref: "))return s=s.slice(5),H.resolve({fs:t,gitdir:i,ref:s,depth:l});if(s.length===40&&/[0-9a-f]{40}/.test(s))return s;const d=await H.packedRefs({fs:t,gitdir:i}),w=I(s).filter(v=>!Se.includes(v));for(const v of w){const A=await m(v,async()=>await t.read(`${i}/${v}`,{encoding:"utf8"})||d.get(v));if(A)return H.resolve({fs:t,gitdir:i,ref:A.trim(),depth:l})}throw new Ge(s)}static async exists({fs:t,gitdir:i,ref:s}){try{return await H.expand({fs:t,gitdir:i,ref:s}),!0}catch{return!1}}static async expand({fs:t,gitdir:i,ref:s}){if(s.length===40&&/[0-9a-f]{40}/.test(s))return s;const l=await H.packedRefs({fs:t,gitdir:i}),d=I(s);for(const w of d)if(await m(w,async()=>t.exists(`${i}/${w}`))||l.has(w))return w;throw new Ge(s)}static async expandAgainstMap({ref:t,map:i}){const s=I(t);for(const l of s)if(await i.has(l))return l;throw new Ge(t)}static resolveAgainstMap({ref:t,fullref:i=t,depth:s=void 0,map:l}){if(s!==void 0&&(s--,s===-1))return{fullref:i,oid:t};if(t.startsWith("ref: "))return t=t.slice(5),H.resolveAgainstMap({ref:t,fullref:i,depth:s,map:l});if(t.length===40&&/[0-9a-f]{40}/.test(t))return{fullref:i,oid:t};const d=I(t);for(const w of d){const v=l.get(w);if(v)return H.resolveAgainstMap({ref:v.trim(),fullref:w,depth:s,map:l})}throw new Ge(t)}static async packedRefs({fs:t,gitdir:i}){const s=await m("packed-refs",async()=>t.read(`${i}/packed-refs`,{encoding:"utf8"}));return at.from(s).refs}static async listRefs({fs:t,gitdir:i,filepath:s}){const l=H.packedRefs({fs:t,gitdir:i});let d=null;try{d=await t.readdirDeep(`${i}/${s}`),d=d.map(w=>w.replace(`${i}/${s}/`,""))}catch{d=[]}for(let w of(await l).keys())w.startsWith(s)&&(w=w.replace(s+"/",""),d.includes(w)||d.push(w));return d.sort(pt),d}static async listBranches({fs:t,gitdir:i,remote:s}){return s?H.listRefs({fs:t,gitdir:i,filepath:`refs/remotes/${s}`}):H.listRefs({fs:t,gitdir:i,filepath:"refs/heads"})}static async listTags({fs:t,gitdir:i}){return(await H.listRefs({fs:t,gitdir:i,filepath:"refs/tags"})).filter(l=>!l.endsWith("^{}"))}}function pe(a,t){return z(C(a),C(t))}function C(a){return a.mode==="040000"?a.path+"/":a.path}function Z(a){switch(a){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new y(`Unexpected GitTree entry mode: ${a}`)}function ue(a){const t=[];let i=0;for(;i<a.length;){const s=a.indexOf(32,i);if(s===-1)throw new y(`GitTree: Error parsing buffer at byte location ${i}: Could not find the next space character.`);const l=a.indexOf(0,i);if(l===-1)throw new y(`GitTree: Error parsing buffer at byte location ${i}: Could not find the next null character.`);let d=a.slice(i,s).toString("utf8");d==="40000"&&(d="040000");const w=Z(d),v=a.slice(s+1,l).toString("utf8");if(v.includes("\\")||v.includes("/"))throw new O(v);const A=a.slice(l+1,l+21).toString("hex");i=l+21,t.push({mode:d,path:v,oid:A,type:w})}return t}function Ue(a){if(typeof a=="number"&&(a=a.toString(8)),a.match(/^0?4.*/))return"040000";if(a.match(/^1006.*/))return"100644";if(a.match(/^1007.*/))return"100755";if(a.match(/^120.*/))return"120000";if(a.match(/^160.*/))return"160000";throw new y(`Could not understand file mode: ${a}`)}function Me(a){return!a.oid&&a.sha&&(a.oid=a.sha),a.mode=Ue(a.mode),a.type||(a.type=Z(a.mode)),a}class Ce{constructor(t){if(Buffer.isBuffer(t))this._entries=ue(t);else if(Array.isArray(t))this._entries=t.map(Me);else throw new y("invalid type passed to GitTree constructor");this._entries.sort(N)}static from(t){return new Ce(t)}render(){return this._entries.map(t=>`${t.mode} ${t.type} ${t.oid}    ${t.path}`).join(`
`)}toObject(){const t=[...this._entries];return t.sort(pe),Buffer.concat(t.map(i=>{const s=Buffer.from(i.mode.replace(/^0/,"")),l=Buffer.from(" "),d=Buffer.from(i.path,"utf8"),w=Buffer.from([0]),v=Buffer.from(i.oid,"hex");return Buffer.concat([s,l,d,w,v])}))}entries(){return this._entries}*[Symbol.iterator](){for(const t of this._entries)yield t}}class Qe{static wrap({type:t,object:i}){const s=`${t} ${i.length}\0`,l=s.length,d=l+i.length,w=new Uint8Array(d);for(let v=0;v<l;v++)w[v]=s.charCodeAt(v);return w.set(i,l),w}static unwrap(t){const i=t.indexOf(32),s=t.indexOf(0),l=t.slice(0,i).toString("utf8"),d=t.slice(i+1,s).toString("utf8"),w=t.length-(s+1);if(parseInt(d)!==w)throw new y(`Length mismatch: expected ${d} bytes but got ${w} instead.`);return{type:l,object:Buffer.from(t.slice(s+1))}}}async function Vt({fs:a,gitdir:t,oid:i}){const s=`objects/${i.slice(0,2)}/${i.slice(2)}`,l=await a.read(`${t}/${s}`);return l?{object:l,format:"deflated",source:s}:null}function gt(a,t){const i=new R(a),s=ot(i);if(s!==t.byteLength)throw new y(`applyDelta expected source buffer to be ${s} bytes but the provided buffer was ${t.length} bytes`);const l=ot(i);let d;const w=kt(i,t);if(w.byteLength===l)d=w;else{d=Buffer.alloc(l);const v=new R(d);for(v.copy(w);!i.eof();)v.copy(kt(i,t));const A=v.tell();if(l!==A)throw new y(`applyDelta expected target buffer to be ${l} bytes but the resulting buffer was ${A} bytes`)}return d}function ot(a){let t=0,i=0,s=null;do s=a.readUInt8(),t|=(s&127)<<i,i+=7;while(s&128);return t}function vt(a,t,i){let s=0,l=0;for(;i--;)t&1&&(s|=a.readUInt8()<<l),t>>=1,l+=8;return s}function kt(a,t){const i=a.readUInt8(),s=128,l=15,d=112;if(i&s){const w=vt(a,i&l,4);let v=vt(a,(i&d)>>4,3);return v===0&&(v=65536),t.slice(w,w+v)}else return a.slice(i)}function Ft(a){let t=[a];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function _r(a){return a[Symbol.asyncIterator]?a[Symbol.asyncIterator]():a[Symbol.iterator]?a[Symbol.iterator]():a.next?a:Ft(a)}class Sr{constructor(t){if(typeof Buffer>"u")throw new Error("Missing Buffer dependency");this.stream=_r(t),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(t){if(!this.eof())return this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t),this.buffer.slice(this.undoCursor,this.cursor)}async skip(t){this.eof()||(this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:t,value:i}=await this.stream.next();return t&&(this._ended=!0,!i)?Buffer.alloc(0):(i&&(i=Buffer.from(i)),i)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(t){this.undoCursor=this.cursor,this.cursor+=t,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(t){if(this._ended)return;const i=[this.buffer];for(;this.cursor+t>xt(i);){const s=await this._next();if(this._ended)break;i.push(s)}this.buffer=Buffer.concat(i)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function xt(a){return a.reduce((t,i)=>t+i.length,0)}async function Nt(a,t){const i=new Sr(a);let s=await i.read(4);if(s=s.toString("utf8"),s!=="PACK")throw new y(`Invalid PACK header '${s}'`);let l=await i.read(4);if(l=l.readUInt32BE(0),l!==2)throw new y(`Invalid packfile version: ${l}`);let d=await i.read(4);if(d=d.readUInt32BE(0),!(d<1))for(;!i.eof()&&d--;){const w=i.tell(),{type:v,length:A,ofs:T,reference:k}=await Et(i),j=new c.Inflate;for(;!j.result;){const F=await i.chunk();if(!F)break;if(j.push(F,!1),j.err)throw new y(`Pako error: ${j.msg}`);if(j.result){if(j.result.length!==A)throw new y("Inflated object size is different from that stated in packfile.");await i.undo(),await i.read(F.length-j.strm.avail_in);const V=i.tell();await t({data:j.result,type:v,num:d,offset:w,end:V,reference:k,ofs:T})}}}}async function Et(a){let t=await a.byte();const i=t>>4&7;let s=t&15;if(t&128){let w=4;do t=await a.byte(),s|=(t&127)<<w,w+=7;while(t&128)}let l,d;if(i===6){let w=0;l=0;const v=[];do t=await a.byte(),l|=(t&127)<<w,w+=7,v.push(t);while(t&128);d=Buffer.from(v)}return i===7&&(d=await a.read(20)),{type:i,length:s,ofs:l,reference:d}}async function Kt(a){return c.inflate(a)}function Zt(a){const t=[];let i=0,s=0;do{i=a.readUInt8();const l=i&127;t.push(l),s=i&128}while(s);return t.reduce((l,d)=>l+1<<7|d,-1)}function ti(a,t){let i=t,s=4,l=null;do l=a.readUInt8(),i|=(l&127)<<s,s+=7;while(l&128);return i}class Ur{constructor(t){Object.assign(this,t),this.offsetCache={}}static async fromIdx({idx:t,getExternalRefDelta:i}){const s=new R(t);if(s.slice(4).toString("hex")!=="ff744f63")return;const d=s.readUInt32BE();if(d!==2)throw new y(`Unable to read version ${d} packfile IDX. (Only version 2 supported)`);if(t.byteLength>2048*1024*1024)throw new y("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");s.seek(s.tell()+1020);const w=s.readUInt32BE(),v=[];for(let k=0;k<w;k++){const j=s.slice(20).toString("hex");v[k]=j}s.seek(s.tell()+4*w);const A=new Map;for(let k=0;k<w;k++)A.set(v[k],s.readUInt32BE());const T=s.slice(20).toString("hex");return new Ur({hashes:v,crcs:{},offsets:A,packfileSha:T,getExternalRefDelta:i})}static async fromPack({pack:t,getExternalRefDelta:i,onProgress:s}){const l={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},d={},w=t.slice(-20).toString("hex"),v=[],A={},T=new Map;let k=null,j=null;await Nt([t],async({data:he,type:we,reference:be,offset:Ae,num:Pe})=>{k===null&&(k=Pe);const De=Math.floor((k-Pe)*100/k);De!==j&&s&&await s({phase:"Receiving objects",loaded:k-Pe,total:k}),j=De,we=l[we],["commit","tree","blob","tag"].includes(we)?d[Ae]={type:we,offset:Ae}:we==="ofs-delta"?d[Ae]={type:we,offset:Ae}:we==="ref-delta"&&(d[Ae]={type:we,offset:Ae})});const F=Object.keys(d).map(Number);for(const[he,we]of F.entries()){const be=he+1===F.length?t.byteLength-20:F[he+1],Ae=d[we],Pe=o.buf(t.slice(we,be))>>>0;Ae.end=be,Ae.crc=Pe}const V=new Ur({pack:Promise.resolve(t),packfileSha:w,crcs:A,hashes:v,offsets:T,getExternalRefDelta:i});j=null;let ne=0;const ge=[0,0,0,0,0,0,0,0,0,0,0,0];for(let he in d){he=Number(he);const we=Math.floor(ne*100/k);we!==j&&s&&await s({phase:"Resolving deltas",loaded:ne,total:k}),ne++,j=we;const be=d[he];if(!be.oid)try{V.readDepth=0,V.externalReadDepth=0;const{type:Ae,object:Pe}=await V.readSlice({start:he});ge[V.readDepth]+=1;const De=await Y(Qe.wrap({type:Ae,object:Pe}));be.oid=De,v.push(De),T.set(De,he),A[De]=be.crc}catch{continue}}return v.sort(),V}async toBuffer(){const t=[],i=(T,k)=>{t.push(Buffer.from(T,k))};i("ff744f63","hex"),i("00000002","hex");const s=new R(Buffer.alloc(256*4));for(let T=0;T<256;T++){let k=0;for(const j of this.hashes)parseInt(j.slice(0,2),16)<=T&&k++;s.writeUInt32BE(k)}t.push(s.buffer);for(const T of this.hashes)i(T,"hex");const l=new R(Buffer.alloc(this.hashes.length*4));for(const T of this.hashes)l.writeUInt32BE(this.crcs[T]);t.push(l.buffer);const d=new R(Buffer.alloc(this.hashes.length*4));for(const T of this.hashes)d.writeUInt32BE(this.offsets.get(T));t.push(d.buffer),i(this.packfileSha,"hex");const w=Buffer.concat(t),v=await Y(w),A=Buffer.alloc(20);return A.write(v,"hex"),Buffer.concat([w,A])}async load({pack:t}){this.pack=t}async unload(){this.pack=null}async read({oid:t}){if(!this.offsets.get(t)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(t);throw new y(`Could not read object ${t} from packfile`)}const i=this.offsets.get(t);return this.readSlice({start:i})}async readSlice({start:t}){if(this.offsetCache[t])return Object.assign({},this.offsetCache[t]);this.readDepth++;const i={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new y("Tried to read from a GitPackIndex with no packfile loaded into memory");const s=(await this.pack).slice(t),l=new R(s),d=l.readUInt8(),w=d&112;let v=i[w];if(v===void 0)throw new y("Unrecognized type: 0b"+w.toString(2));const A=d&15;let T=A;d&128&&(T=ti(l,A));let j=null,F=null;if(v==="ofs_delta"){const ne=Zt(l),ge=t-ne;({object:j,type:v}=await this.readSlice({start:ge}))}if(v==="ref_delta"){const ne=l.slice(20).toString("hex");({object:j,type:v}=await this.read({oid:ne}))}const V=s.slice(l.tell());if(F=Buffer.from(await Kt(V)),F.byteLength!==T)throw new y(`Packfile told us object would have length ${T} but it had length ${F.byteLength}`);return j&&(F=Buffer.from(gt(F,j))),this.readDepth>3&&(this.offsetCache[t]={type:v,object:F}),{type:v,format:"content",object:F}}}const ri=Symbol("PackfileCache");async function Th({fs:a,filename:t,getExternalRefDelta:i,emitter:s,emitterPrefix:l}){const d=await a.read(t);return Ur.fromIdx({idx:d,getExternalRefDelta:i})}function Gi({fs:a,cache:t,filename:i,getExternalRefDelta:s,emitter:l,emitterPrefix:d}){t[ri]||(t[ri]=new Map);let w=t[ri].get(i);return w||(w=Th({fs:a,filename:i,getExternalRefDelta:s,emitter:l,emitterPrefix:d}),t[ri].set(i,w)),w}async function Rh({fs:a,cache:t,gitdir:i,oid:s,format:l="content",getExternalRefDelta:d}){let w=await a.readdir(g(i,"objects/pack"));w=w.filter(v=>v.endsWith(".idx"));for(const v of w){const A=`${i}/objects/pack/${v}`,T=await Gi({fs:a,cache:t,filename:A,getExternalRefDelta:d});if(T.error)throw new y(T.error);if(T.offsets.has(s)){if(!T.pack){const j=A.replace(/idx$/,"pack");T.pack=a.read(j)}const k=await T.read({oid:s,getExternalRefDelta:d});return k.format="content",k.source=`objects/pack/${v.replace(/idx$/,"pack")}`,k}}return null}async function dt({fs:a,cache:t,gitdir:i,oid:s,format:l="content"}){const d=k=>dt({fs:a,cache:t,gitdir:i,oid:k});let w;if(s==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(w={format:"wrapped",object:Buffer.from("tree 0\0")}),w||(w=await Vt({fs:a,gitdir:i,oid:s})),!w){if(w=await Rh({fs:a,cache:t,gitdir:i,oid:s,getExternalRefDelta:d}),!w)throw new Ge(s);return w}if(l==="deflated"||(w.format==="deflated"&&(w.object=Buffer.from(await Kt(w.object)),w.format="wrapped"),l==="wrapped"))return w;const v=await Y(w.object);if(v!==s)throw new y(`SHA check failed! Expected ${s}, computed ${v}`);const{object:A,type:T}=Qe.unwrap(w.object);if(w.type=T,w.object=A,w.format="content",l==="content")return w;throw new y(`invalid requested format "${l}"`)}class Qt extends x{constructor(t,i,s=!0){super(`Failed to create ${t} at ${i} because it already exists.${s?` (Hint: use 'force: true' parameter to overwrite existing ${t}.)`:""}`),this.code=this.name=Qt.code,this.data={noun:t,where:i,canForce:s}}}Qt.code="AlreadyExistsError";class cn extends x{constructor(t,i,s){super(`Found multiple ${t} matching "${i}" (${s.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=cn.code,this.data={nouns:t,short:i,matches:s}}}cn.code="AmbiguousError";class ln extends x{constructor(t){super(`Your local changes to the following files would be overwritten by checkout: ${t.join(", ")}`),this.code=this.name=ln.code,this.data={filepaths:t}}}ln.code="CheckoutConflictError";class un extends x{constructor(t,i){super(`Cannot cherry-pick merge commit ${t}. Merge commits have ${i} parents and require specifying which parent to use as the base.`),this.code=this.name=un.code,this.data={oid:t,parentCount:i}}}un.code="CherryPickMergeCommitError";class fn extends x{constructor(t){super(`Cannot cherry-pick root commit ${t}. Root commits have no parents.`),this.code=this.name=fn.code,this.data={oid:t}}}fn.code="CherryPickRootCommitError";class dn extends x{constructor(t,i){super(`Failed to checkout "${t}" because commit ${i} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=dn.code,this.data={ref:t,oid:i}}}dn.code="CommitNotFetchedError";class hn extends x{constructor(){super("Empty response from git server."),this.code=this.name=hn.code,this.data={}}}hn.code="EmptyServerResponseError";class pn extends x{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=pn.code,this.data={}}}pn.code="FastForwardError";class gn extends x{constructor(t,i){super(`One or more branches were not updated: ${t}`),this.code=this.name=gn.code,this.data={prettyDetails:t,result:i}}}gn.code="GitPushError";class zr extends x{constructor(t,i,s){super(`HTTP Error: ${t} ${i}`),this.code=this.name=zr.code,this.data={statusCode:t,statusMessage:i,response:s}}}zr.code="HttpError";class dr extends x{constructor(t){let i="invalid filepath";t==="leading-slash"||t==="trailing-slash"?i='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':t==="directory"&&(i='"filepath" should not be a directory.'),super(i),this.code=this.name=dr.code,this.data={reason:t}}}dr.code="InvalidFilepathError";class er extends x{constructor(t,i){super(`"${t}" would be an invalid git reference. (Hint: a valid alternative would be "${i}".)`),this.code=this.name=er.code,this.data={ref:t,suggestion:i}}}er.code="InvalidRefNameError";class mn extends x{constructor(t){super(`Maximum search depth of ${t} exceeded.`),this.code=this.name=mn.code,this.data={depth:t}}}mn.code="MaxDepthError";class Gr extends x{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=Gr.code,this.data={}}}Gr.code="MergeNotSupportedError";class kr extends x{constructor(t,i,s,l){super(`Automatic merge failed with one or more merge conflicts in the following files: ${t.toString()}. Fix conflicts then commit the result.`),this.code=this.name=kr.code,this.data={filepaths:t,bothModified:i,deleteByUs:s,deleteByTheirs:l}}}kr.code="MergeConflictError";class Rt extends x{constructor(t){super(`No name was provided for ${t} in the argument or in the .git/config file.`),this.code=this.name=Rt.code,this.data={role:t}}}Rt.code="MissingNameError";class Ut extends x{constructor(t){super(`The function requires a "${t}" parameter but none was provided.`),this.code=this.name=Ut.code,this.data={parameter:t}}}Ut.code="MissingParameterError";class wn extends x{constructor(t){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=wn.code,this.data={errors:t},this.errors=t}}wn.code="MultipleGitError";class Er extends x{constructor(t,i){super(`Expected "${t}" but received "${i}".`),this.code=this.name=Er.code,this.data={expected:t,actual:i}}}Er.code="ParseError";class Hr extends x{constructor(t){let i="";t==="not-fast-forward"?i=" because it was not a simple fast-forward":t==="tag-exists"&&(i=" because tag already exists"),super(`Push rejected${i}. Use "force: true" to override.`),this.code=this.name=Hr.code,this.data={reason:t}}}Hr.code="PushRejectedError";class hr extends x{constructor(t,i){super(`Remote does not support the "${t}" so the "${i}" parameter cannot be used.`),this.code=this.name=hr.code,this.data={capability:t,parameter:i}}}hr.code="RemoteCapabilityError";class yn extends x{constructor(t,i){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${t}`),this.code=this.name=yn.code,this.data={preview:t,response:i}}}yn.code="SmartHttpError";class bn extends x{constructor(t,i,s){super(`Git remote "${t}" uses an unrecognized transport protocol: "${i}"`),this.code=this.name=bn.code,this.data={url:t,transport:i,suggestion:s}}}bn.code="UnknownTransportError";class vn extends x{constructor(t){super(`Cannot parse remote URL: "${t}"`),this.code=this.name=vn.code,this.data={url:t}}}vn.code="UrlParseError";class Wr extends x{constructor(){super("The operation was canceled."),this.code=this.name=Wr.code,this.data={}}}Wr.code="UserCanceledError";class xn extends x{constructor(t){super(`Could not merge index: Entry for '${t}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=xn.code,this.data={filepath:t}}}xn.code="IndexResetError";class _n extends x{constructor(t){super(`"${t}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=_n.code,this.data={ref:t}}}_n.code="NoCommitError";var Ms=Object.freeze({__proto__:null,AlreadyExistsError:Qt,AmbiguousError:cn,CheckoutConflictError:ln,CherryPickMergeCommitError:un,CherryPickRootCommitError:fn,CommitNotFetchedError:dn,EmptyServerResponseError:hn,FastForwardError:pn,GitPushError:gn,HttpError:zr,InternalError:y,InvalidFilepathError:dr,InvalidOidError:rt,InvalidRefNameError:er,MaxDepthError:mn,MergeNotSupportedError:Gr,MergeConflictError:kr,MissingNameError:Rt,MissingParameterError:Ut,MultipleGitError:wn,NoRefspecError:Xe,NotFoundError:Ge,ObjectTypeError:We,ParseError:Er,PushRejectedError:Hr,RemoteCapabilityError:hr,SmartHttpError:yn,UnknownTransportError:bn,UnsafeFilepathError:O,UrlParseError:vn,UserCanceledError:Wr,UnmergedPathsError:_,IndexResetError:xn,NoCommitError:_n});function Hi({name:a,email:t,timestamp:i,timezoneOffset:s}){return s=Oh(s),`${a} <${t}> ${i} ${s}`}function Oh(a){const t=Mh(Ph(a));a=Math.abs(a);const i=Math.floor(a/60);a-=i*60;let s=String(i),l=String(a);return s.length<2&&(s="0"+s),l.length<2&&(l="0"+l),(t===-1?"-":"+")+s+l}function Mh(a){return Math.sign(a)||(Object.is(a,-0)?-1:1)}function Ph(a){return a===0?a:-a}function cr(a){return a=a.replace(/\r/g,""),a=a.replace(/^\n+/,""),a=a.replace(/\n+$/,"")+`
`,a}function ni(a){const[,t,i,s,l]=a.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:t,email:i,timestamp:Number(s),timezoneOffset:jh(l)}}function jh(a){let[,t,i,s]=a.match(/(\+|-)(\d\d)(\d\d)/);return s=(t==="+"?1:-1)*(Number(i)*60+Number(s)),Bh(s)}function Bh(a){return a===0?a:-a}class $t{constructor(t){if(typeof t=="string")this._tag=t;else if(Buffer.isBuffer(t))this._tag=t.toString("utf8");else if(typeof t=="object")this._tag=$t.render(t);else throw new y("invalid type passed to GitAnnotatedTag constructor")}static from(t){return new $t(t)}static render(t){return`object ${t.object}
type ${t.type}
tag ${t.tag}
tagger ${Hi(t.tagger)}

${t.message}
${t.gpgsig?t.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const t=this.withoutSignature();return t.slice(t.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const t=this.justHeaders().split(`
`),i=[];for(const l of t)l[0]===" "?i[i.length-1]+=`
`+l.slice(1):i.push(l);const s={};for(const l of i){const d=l.slice(0,l.indexOf(" ")),w=l.slice(l.indexOf(" ")+1);Array.isArray(s[d])?s[d].push(w):s[d]=w}return s.tagger&&(s.tagger=ni(s.tagger)),s.committer&&(s.committer=ni(s.committer)),s}withoutSignature(){const t=cr(this._tag);return t.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?t:t.slice(0,t.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const t=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return cr(t)}payload(){return this.withoutSignature()+`
`}toObject(){return Buffer.from(this._tag,"utf8")}static async sign(t,i,s){const l=t.payload();let{signature:d}=await i({payload:l,secretKey:s});d=cr(d);const w=l+d;return $t.from(w)}}function Wi(a){return a.trim().split(`
`).map(t=>" "+t).join(`
`)+`
`}function Fh(a){return a.split(`
`).map(t=>t.replace(/^ /,"")).join(`
`)}class mt{constructor(t){if(typeof t=="string")this._commit=t;else if(Buffer.isBuffer(t))this._commit=t.toString("utf8");else if(typeof t=="object")this._commit=mt.render(t);else throw new y("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:t,signature:i}){const s=mt.justHeaders(t),l=mt.justMessage(t),d=cr(s+`
gpgsig`+Wi(i)+`
`+l);return new mt(d)}static from(t){return new mt(t)}toObject(){return Buffer.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return mt.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(t){return cr(t.slice(t.indexOf(`

`)+2))}static justHeaders(t){return t.slice(0,t.indexOf(`

`))}parseHeaders(){const t=mt.justHeaders(this._commit).split(`
`),i=[];for(const l of t)l[0]===" "?i[i.length-1]+=`
`+l.slice(1):i.push(l);const s={parent:[]};for(const l of i){const d=l.slice(0,l.indexOf(" ")),w=l.slice(l.indexOf(" ")+1);Array.isArray(s[d])?s[d].push(w):s[d]=w}return s.author&&(s.author=ni(s.author)),s.committer&&(s.committer=ni(s.committer)),s}static renderHeaders(t){let i="";if(t.tree?i+=`tree ${t.tree}
`:i+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,t.parent){if(t.parent.length===void 0)throw new y("commit 'parent' property should be an array");for(const d of t.parent)i+=`parent ${d}
`}const s=t.author;i+=`author ${Hi(s)}
`;const l=t.committer||t.author;return i+=`committer ${Hi(l)}
`,t.gpgsig&&(i+="gpgsig"+Wi(t.gpgsig)),i}static render(t){return mt.renderHeaders(t)+`
`+cr(t.message)}render(){return this._commit}withoutSignature(){const t=cr(this._commit);if(t.indexOf(`
gpgsig`)===-1)return t;const i=t.slice(0,t.indexOf(`
gpgsig`)),s=t.slice(t.indexOf(`-----END PGP SIGNATURE-----
`)+28);return cr(i+`
`+s)}isolateSignature(){const t=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return Fh(t)}static async sign(t,i,s){const l=t.withoutSignature(),d=mt.justMessage(t._commit);let{signature:w}=await i({payload:l,secretKey:s});w=cr(w);const A=mt.justHeaders(t._commit)+`
gpgsig`+Wi(w)+`
`+d;return mt.from(A)}}async function qr({fs:a,cache:t,gitdir:i,oid:s}){if(s==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:Ce.from([]),oid:s};const{type:l,object:d}=await dt({fs:a,cache:t,gitdir:i,oid:s});if(l==="tag")return s=$t.from(d).parse().object,qr({fs:a,cache:t,gitdir:i,oid:s});if(l==="commit")return s=mt.from(d).parse().tree,qr({fs:a,cache:t,gitdir:i,oid:s});if(l!=="tree")throw new We(s,l,"tree");return{tree:Ce.from(d),oid:s}}class Dh{constructor({fs:t,gitdir:i,ref:s,cache:l}){this.fs=t,this.cache=l,this.gitdir=i,this.mapPromise=(async()=>{const w=new Map;let v;try{v=await H.resolve({fs:t,gitdir:i,ref:s})}catch(T){T instanceof Ge&&(v="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const A=await qr({fs:t,cache:this.cache,gitdir:i,oid:v});return A.type="tree",A.mode="40000",w.set(".",A),w})();const d=this;this.ConstructEntry=class{constructor(v){this._fullpath=v,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return d.type(this)}async mode(){return d.mode(this)}async stat(){return d.stat(this)}async content(){return d.content(this)}async oid(){return d.oid(this)}}}async readdir(t){const i=t._fullpath,{fs:s,cache:l,gitdir:d}=this,w=await this.mapPromise,v=w.get(i);if(!v)throw new Error(`No obj for ${i}`);const A=v.oid;if(!A)throw new Error(`No oid for obj ${JSON.stringify(v)}`);if(v.type!=="tree")return null;const{type:T,object:k}=await dt({fs:s,cache:l,gitdir:d,oid:A});if(T!==v.type)throw new We(A,T,v.type);const j=Ce.from(k);for(const F of j)w.set(g(i,F.path),F);return j.entries().map(F=>g(i,F.path))}async type(t){if(t._type===!1){const i=await this.mapPromise,{type:s}=i.get(t._fullpath);t._type=s}return t._type}async mode(t){if(t._mode===!1){const i=await this.mapPromise,{mode:s}=i.get(t._fullpath);t._mode=L(parseInt(s,8))}return t._mode}async stat(t){}async content(t){if(t._content===!1){const i=await this.mapPromise,{fs:s,cache:l,gitdir:d}=this,v=i.get(t._fullpath).oid,{type:A,object:T}=await dt({fs:s,cache:l,gitdir:d,oid:v});A!=="blob"?t._content=void 0:t._content=new Uint8Array(T)}return t._content}async oid(t){if(t._oid===!1){const s=(await this.mapPromise).get(t._fullpath);t._oid=s.oid}return t._oid}}function Gt({ref:a="HEAD"}={}){const t=Object.create(null);return Object.defineProperty(t,it,{value:function({fs:i,gitdir:s,cache:l}){return new Dh({fs:i,gitdir:s,ref:a,cache:l})}}),Object.freeze(t),t}class Lh{constructor({fs:t,dir:i,gitdir:s,cache:l}){this.fs=t,this.cache=l,this.dir=i,this.gitdir=s,this.config=null;const d=this;this.ConstructEntry=class{constructor(v){this._fullpath=v,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return d.type(this)}async mode(){return d.mode(this)}async stat(){return d.stat(this)}async content(){return d.content(this)}async oid(){return d.oid(this)}}}async readdir(t){const i=t._fullpath,{fs:s,dir:l}=this,d=await s.readdir(g(l,i));return d===null?null:d.map(w=>g(i,w))}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const{fs:i,dir:s}=this;let l=await i.lstat(`${s}/${t._fullpath}`);if(!l)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);let d=l.isDirectory()?"tree":"blob";d==="blob"&&!l.isFile()&&!l.isSymbolicLink()&&(d="special"),t._type=d,l=G(l),t._mode=l.mode,l.size===-1&&t._actualSize&&(l.size=t._actualSize),t._stat=l}return t._stat}async content(t){if(t._content===!1){const{fs:i,dir:s,gitdir:l}=this;if(await t.type()==="tree")t._content=void 0;else{let d;if(await t.mode()>>12===10)d=await i.readlink(`${s}/${t._fullpath}`);else{const v=await(await this._getGitConfig(i,l)).get("core.autocrlf");d=await i.read(`${s}/${t._fullpath}`,{autocrlf:v})}t._actualSize=d.length,t._stat&&t._stat.size===-1&&(t._stat.size=t._actualSize),t._content=new Uint8Array(d)}}return t._content}async oid(t){if(t._oid===!1){const i=this,{fs:s,gitdir:l,cache:d}=this;let w;await me.acquire({fs:s,gitdir:l,cache:d},async function(v){const A=v.entriesMap.get(t._fullpath),T=await t.stat(),j=await(await i._getGitConfig(s,l)).get("core.filemode"),F=typeof process<"u"?process.platform!=="win32":!0;if(!A||se(T,A,j,F)){const V=await t.content();V===void 0?w=void 0:(w=await Y(Qe.wrap({type:"blob",object:V})),A&&w===A.oid&&(!j||T.mode===A.mode)&&se(T,A,j,F)&&v.insert({filepath:t._fullpath,stats:T,oid:w}))}else w=A.oid}),t._oid=w}return t._oid}async _getGitConfig(t,i){return this.config?this.config:(this.config=await de.get({fs:t,gitdir:i}),this.config)}}function Vr(){const a=Object.create(null);return Object.defineProperty(a,it,{value:function({fs:t,dir:i,gitdir:s,cache:l}){return new Lh({fs:t,dir:i,gitdir:s,cache:l})}}),Object.freeze(a),a}function $h(a,t){const i=t-a;return Array.from({length:i},(s,l)=>a+l)}const Ps=typeof Array.prototype.flat>"u"?a=>a.reduce((t,i)=>t.concat(i),[]):a=>a.flat();class Nh{constructor(){this.value=null}consider(t){t!=null&&(this.value===null?this.value=t:t<this.value&&(this.value=t))}reset(){this.value=null}}function*Uh(a){const t=new Nh;let i;const s=[],l=a.length;for(let d=0;d<l;d++)s[d]=a[d].next().value,s[d]!==void 0&&t.consider(s[d]);if(t.value!==null)for(;;){const d=[];i=t.value,t.reset();for(let w=0;w<l;w++)s[w]!==void 0&&s[w]===i?(d[w]=s[w],s[w]=a[w].next().value):d[w]=null,s[w]!==void 0&&t.consider(s[w]);if(yield d,t.value===null)return}}async function pr({fs:a,cache:t,dir:i,gitdir:s,trees:l,map:d=async(A,T)=>T,reduce:w=async(A,T)=>{const k=Ps(T);return A!==void 0&&k.unshift(A),k},iterate:v=(A,T)=>Promise.all([...T].map(A))}){const A=l.map(V=>V[it]({fs:a,dir:i,gitdir:s,cache:t})),T=new Array(A.length).fill("."),k=$h(0,A.length),j=async V=>{k.forEach(he=>{const we=V[he];V[he]=we&&new A[he].ConstructEntry(we)});const ge=(await Promise.all(k.map(he=>{const we=V[he];return we?A[he].readdir(we):[]}))).map(he=>(he===null?[]:he)[Symbol.iterator]());return{entries:V,children:Uh(ge)}},F=async V=>{const{entries:ne,children:ge}=await j(V),he=ne.find(be=>be&&be._fullpath)._fullpath,we=await d(he,ne);if(we!==null){let be=await v(F,ge);return be=be.filter(Ae=>Ae!==void 0),w(we,be)}};return F(T)}async function qi(a,t){const i=await a.readdir(t);i==null?await a.rm(t):i.length?await Promise.all(i.map(s=>{const l=g(t,s);return a.lstat(l).then(d=>{if(d)return d.isDirectory()?qi(a,l):a.rm(l)})})).then(()=>a.rmdir(t)):await a.rmdir(t)}function zh(a){return Gh(a)&&js(a.then)&&js(a.catch)}function Gh(a){return a&&typeof a=="object"}function js(a){return typeof a=="function"}function Bs(a){return zh((i=>{try{return i.readFile().catch(s=>s)}catch(s){return s}})(a))}const Fs=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function Ds(a,t){if(Bs(t))for(const i of Fs)a[`_${i}`]=t[i].bind(t);else for(const i of Fs)a[`_${i}`]=u(t[i].bind(t));Bs(t)?(t.cp&&(a._cp=t.cp.bind(t)),t.rm?a._rm=t.rm.bind(t):t.rmdir.length>1?a._rm=t.rmdir.bind(t):a._rm=qi.bind(null,a)):(t.cp&&(a._cp=u(t.cp.bind(t))),t.rm?a._rm=u(t.rm.bind(t)):t.rmdir.length>2?a._rm=u(t.rmdir.bind(t)):a._rm=qi.bind(null,a))}class $e{constructor(t){if(typeof t._original_unwrapped_fs<"u")return t;const i=Object.getOwnPropertyDescriptor(t,"promises");i&&i.enumerable?Ds(this,t.promises):Ds(this,t),this._original_unwrapped_fs=t}async exists(t,i={}){try{return await this._stat(t),!0}catch(s){if(s.code==="ENOENT"||s.code==="ENOTDIR"||(s.code||"").includes("ENS"))return!1;throw s}}async read(t,i={}){try{let s=await this._readFile(t,i);if(i.autocrlf==="true")try{s=new TextDecoder("utf8",{fatal:!0}).decode(s),s=s.replace(/\r\n/g,`
`),s=new TextEncoder().encode(s)}catch{}return typeof s!="string"&&(s=Buffer.from(s)),s}catch{return null}}async write(t,i,s={}){try{await this._writeFile(t,i,s)}catch{await this.mkdir(ve(t)),await this._writeFile(t,i,s)}}async mkdir(t,i=!1){try{await this._mkdir(t)}catch(s){if(s===null||s.code==="EEXIST")return;if(i)throw s;if(s.code==="ENOENT"){const l=ve(t);if(l==="."||l==="/"||l===t)throw s;await this.mkdir(l),await this.mkdir(t,!0)}}}async rm(t){try{await this._unlink(t)}catch(i){if(i.code!=="ENOENT")throw i}}async rmdir(t,i){try{i&&i.recursive?await this._rm(t,i):await this._rmdir(t)}catch(s){if(s.code!=="ENOENT")throw s}}async readdir(t){try{const i=await this._readdir(t);return i.sort(z),i}catch(i){return i.code==="ENOTDIR"?null:[]}}async readdirDeep(t){const i=await this._readdir(t);return(await Promise.all(i.map(async l=>{const d=t+"/"+l;return(await this._stat(d)).isDirectory()?this.readdirDeep(d):d}))).reduce((l,d)=>l.concat(d),[])}async lstat(t){try{return await this._lstat(t)}catch(i){if(i.code==="ENOENT"||(i.code||"").includes("ENS"))return null;throw i}}async readlink(t,i={encoding:"buffer"}){try{const s=await this._readlink(t,i);return Buffer.isBuffer(s)?s:Buffer.from(s)}catch(s){if(s.code==="ENOENT"||(s.code||"").includes("ENS"))return null;throw s}}async writelink(t,i){return this._symlink(i.toString("utf8"),t)}}function J(a,t){if(t===void 0)throw new Ut(a)}async function Ne({fsp:a,dotgit:t}){J("fsp",a),J("dotgit",t);const i=await a._stat(t).catch(()=>({isFile:()=>!1,isDirectory:()=>!1}));return i.isDirectory()?t:i.isFile()?a._readFile(t,"utf8").then(s=>s.trimRight().substr(8)).then(s=>g(ve(t),s)):t}async function ii(a,t){return!a&&!t?!1:a&&!t||!a&&t?!0:!(await a.type()==="tree"&&await t.type()==="tree"||await a.type()===await t.type()&&await a.mode()===await t.mode()&&await a.oid()===await t.oid())}async function Ls({fs:a,dir:t,gitdir:i=g(t,".git"),commit:s="HEAD",cache:l={}}){try{J("fs",a),J("dir",t),J("gitdir",i);const d=new $e(a),w=[Gt({ref:s}),Vr(),Je()];let v=[];const A=await Ne({fsp:d,dotgit:i});await me.acquire({fs:d,gitdir:A,cache:l},async function(k){v=k.unmergedPaths});const T=await pr({fs:d,cache:l,dir:t,gitdir:A,trees:w,map:async function(k,[j,F,V]){const ne=!await ii(F,V),ge=v.includes(k),he=!await ii(V,j);if(ne||ge)return j?{path:k,mode:await j.mode(),oid:await j.oid(),type:await j.type(),content:await j.content()}:void 0;if(he)return!1;throw new xn(k)}});await me.acquire({fs:d,gitdir:A,cache:l},async function(k){for(const j of T)if(j!==!1){if(!j){await d.rmdir(`${t}/${j.path}`,{recursive:!0}),k.delete({filepath:j.path});continue}if(j.type==="blob"){const F=new TextDecoder().decode(j.content);await d.write(`${t}/${j.path}`,F,{mode:j.mode}),k.insert({filepath:j.path,oid:j.oid,stage:0})}}})}catch(d){throw d.caller="git.abortMerge",d}}class Kr{static async isIgnored({fs:t,dir:i,gitdir:s=g(i,".git"),filepath:l}){if(Fe(l)===".git")return!0;if(l===".")return!1;let d="";const w=g(s,"info","exclude");await t.exists(w)&&(d=await t.read(w,"utf8"));const v=[{gitignore:g(i,".gitignore"),filepath:l}],A=l.split("/").filter(Boolean);for(let k=1;k<A.length;k++){const j=A.slice(0,k).join("/"),F=A.slice(k).join("/");v.push({gitignore:g(i,j,".gitignore"),filepath:F})}let T=!1;for(const k of v){let j;try{j=await t.read(k.gitignore,"utf8")}catch(ne){if(ne.code==="NOENT")continue}const F=p().add(d);F.add(j);const V=ve(k.filepath);if(V!=="."&&F.ignores(V))return!0;T?T=!F.test(k.filepath).unignored:T=F.test(k.filepath).ignored}return T}}async function Hh({fs:a,gitdir:t,object:i,format:s,oid:l}){const d=`objects/${l.slice(0,2)}/${l.slice(2)}`,w=`${t}/${d}`;await a.exists(w)||await a.write(w,i)}let Vi=null;async function $s(a){return Vi===null&&(Vi=qh()),Vi?Wh(a):c.deflate(a)}async function Wh(a){const t=new CompressionStream("deflate"),i=new Blob([a]).stream().pipeThrough(t);return new Uint8Array(await new Response(i).arrayBuffer())}function qh(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function zt({fs:a,gitdir:t,type:i,object:s,format:l="content",oid:d=void 0,dryRun:w=!1}){return l!=="deflated"&&(l!=="wrapped"&&(s=Qe.wrap({type:i,object:s})),d=await Y(s),s=Buffer.from(await $s(s))),w||await Hh({fs:a,gitdir:t,object:s,format:"deflated",oid:d}),d}function Ns(a){let t;for(;~(t=a.indexOf(92));)a[t]=47;return a}async function Us({fs:a,dir:t,gitdir:i=g(t,".git"),filepath:s,cache:l={},force:d=!1,parallel:w=!0}){try{J("fs",a),J("dir",t),J("gitdir",i),J("filepath",s);const v=new $e(a),A=await Ne({fsp:v,dotgit:i});await me.acquire({fs:v,gitdir:A,cache:l},async T=>{const j=await(await de.get({fs:v,gitdir:A})).get("core.autocrlf");return Ki({dir:t,gitdir:A,fs:v,filepath:s,index:T,force:d,parallel:w,autocrlf:j})})}catch(v){throw v.caller="git.add",v}}async function Ki({dir:a,gitdir:t,fs:i,filepath:s,index:l,force:d,parallel:w,autocrlf:v}){s=Array.isArray(s)?s:[s];const A=s.map(async F=>{if(!d&&await Kr.isIgnored({fs:i,dir:a,gitdir:t,filepath:F}))return;const V=await i.lstat(g(a,F));if(!V)throw new Ge(F);if(V.isDirectory()){const ne=await i.readdir(g(a,F));if(w){const ge=ne.map(he=>Ki({dir:a,gitdir:t,fs:i,filepath:[g(F,he)],index:l,force:d,parallel:w,autocrlf:v}));await Promise.all(ge)}else for(const ge of ne)await Ki({dir:a,gitdir:t,fs:i,filepath:[g(F,ge)],index:l,force:d,parallel:w,autocrlf:v})}else{const ne=V.isSymbolicLink()?await i.readlink(g(a,F)).then(Ns):await i.read(g(a,F),{autocrlf:v});if(ne===null)throw new Ge(F);const ge=await zt({fs:i,gitdir:t,type:"blob",object:ne});l.insert({filepath:F,stats:V,oid:ge})}}),T=await Promise.allSettled(A),k=T.filter(F=>F.status==="rejected").map(F=>F.reason);if(k.length>1)throw new wn(k);if(k.length===1)throw k[0];return T.filter(F=>F.status==="fulfilled"&&F.value).map(F=>F.value)}async function Sn({fs:a,gitdir:t,path:i}){return(await de.get({fs:a,gitdir:t})).get(i)}function zs(a,...t){for(const i of t)if(i)for(const s of Object.keys(i)){const l=i[s];l!==void 0&&(a[s]=l)}return a}async function gr({fs:a,gitdir:t,author:i,commit:s}){const l=Math.floor(Date.now()/1e3),d={name:await Sn({fs:a,gitdir:t,path:"user.name"}),email:await Sn({fs:a,gitdir:t,path:"user.email"})||"",timestamp:l,timezoneOffset:new Date(l*1e3).getTimezoneOffset()},w=zs({},d,s?s.author:void 0,i);if(w.name!==void 0)return w}async function Ir({fs:a,gitdir:t,author:i,committer:s,commit:l}){const d=Math.floor(Date.now()/1e3),w={name:await Sn({fs:a,gitdir:t,path:"user.name"}),email:await Sn({fs:a,gitdir:t,path:"user.email"})||"",timestamp:d,timezoneOffset:new Date(d*1e3).getTimezoneOffset()},v=zs({},w,l?l.committer:void 0,i,s);if(v.name!==void 0)return v}async function Gs({fs:a,cache:t,gitdir:i,oid:s}){const{type:l,object:d}=await dt({fs:a,cache:t,gitdir:i,oid:s});if(l==="tag")return s=$t.from(d).parse().object,Gs({fs:a,cache:t,gitdir:i,oid:s});if(l!=="commit")throw new We(s,l,"commit");return{commit:mt.from(d),oid:s}}async function ir({fs:a,cache:t,gitdir:i,oid:s}){const{commit:l,oid:d}=await Gs({fs:a,cache:t,gitdir:i,oid:s});return{oid:d,commit:l.parse(),payload:l.withoutSignature()}}async function kn({fs:a,cache:t,onSign:i,gitdir:s,message:l,author:d,committer:w,signingKey:v,amend:A=!1,dryRun:T=!1,noUpdateBranch:k=!1,ref:j,parent:F,tree:V}){let ne=!1,ge=!1;j||(ge=!(await a.read(`${s}/HEAD`,{encoding:"utf8"})).startsWith("ref:"),j=await H.resolve({fs:a,gitdir:s,ref:"HEAD",depth:2}));let he,we;try{he=await H.resolve({fs:a,gitdir:s,ref:j}),we=await ir({fs:a,gitdir:s,oid:he,cache:{}})}catch{ne=!0}if(A&&ne)throw new _n(j);const be=A?await gr({fs:a,gitdir:s,author:d,commit:we.commit}):await gr({fs:a,gitdir:s,author:d});if(!be)throw new Rt("author");const Ae=A?await Ir({fs:a,gitdir:s,author:be,committer:w,commit:we.commit}):await Ir({fs:a,gitdir:s,author:be,committer:w});if(!Ae)throw new Rt("committer");return me.acquire({fs:a,gitdir:s,cache:t,allowUnmerged:!1},async function(Pe){const Le=Re(Pe.entries).get(".");if(V||(V=await Hs({fs:a,gitdir:s,inode:Le,dryRun:T})),F?F=await Promise.all(F.map(Te=>H.resolve({fs:a,gitdir:s,ref:Te}))):A?F=we.commit.parent:F=he?[he]:[],!l)if(A)l=we.commit.message;else throw new Ut("message");let Ee=mt.from({tree:V,parent:F,author:be,committer:Ae,message:l});v&&(Ee=await mt.sign(Ee,i,v));const Ie=await zt({fs:a,gitdir:s,type:"commit",object:Ee.toObject(),dryRun:T});return!k&&!T&&await H.writeRef({fs:a,gitdir:s,ref:ge?"HEAD":j,value:Ie}),Ie})}async function Hs({fs:a,gitdir:t,inode:i,dryRun:s}){const l=i.children;for(const A of l)A.type==="tree"&&(A.metadata.mode="040000",A.metadata.oid=await Hs({fs:a,gitdir:t,inode:A,dryRun:s}));const d=l.map(A=>({mode:A.metadata.mode,path:A.basename,oid:A.metadata.oid,type:A.type})),w=Ce.from(d);return await zt({fs:a,gitdir:t,type:"tree",object:w.toObject(),dryRun:s})}async function En({fs:a,cache:t,gitdir:i,oid:s,filepath:l}){if(l.startsWith("/"))throw new dr("leading-slash");if(l.endsWith("/"))throw new dr("trailing-slash");const d=s,w=await qr({fs:a,cache:t,gitdir:i,oid:s}),v=w.tree;if(l==="")s=w.oid;else{const A=l.split("/");s=await Ws({fs:a,cache:t,gitdir:i,tree:v,pathArray:A,oid:d,filepath:l})}return s}async function Ws({fs:a,cache:t,gitdir:i,tree:s,pathArray:l,oid:d,filepath:w}){const v=l.shift();for(const A of s)if(A.path===v){if(l.length===0)return A.oid;{const{type:T,object:k}=await dt({fs:a,cache:t,gitdir:i,oid:A.oid});if(T!=="tree")throw new We(d,T,"tree",w);return s=Ce.from(k),Ws({fs:a,cache:t,gitdir:i,tree:s,pathArray:l,oid:d,filepath:w})}}throw new Ge(`file or directory found at "${d}:${w}"`)}async function Zr({fs:a,cache:t,gitdir:i,oid:s,filepath:l=void 0}){l!==void 0&&(s=await En({fs:a,cache:t,gitdir:i,oid:s,filepath:l}));const{tree:d,oid:w}=await qr({fs:a,cache:t,gitdir:i,oid:s});return{oid:w,tree:d.entries()}}async function In({fs:a,gitdir:t,tree:i}){const s=Ce.from(i).toObject();return await zt({fs:a,gitdir:t,type:"tree",object:s,format:"content"})}async function Vh({fs:a,cache:t,onSign:i,gitdir:s,ref:l,oid:d,note:w,force:v,author:A,committer:T,signingKey:k}){let j;try{j=await H.resolve({gitdir:s,fs:a,ref:l})}catch(we){if(!(we instanceof Ge))throw we}let V=(await Zr({fs:a,cache:t,gitdir:s,oid:j||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(v)V=V.filter(we=>we.path!==d);else for(const we of V)if(we.path===d)throw new Qt("note",d);typeof w=="string"&&(w=Buffer.from(w,"utf8"));const ne=await zt({fs:a,gitdir:s,type:"blob",object:w,format:"content"});V.push({mode:"100644",path:d,oid:ne,type:"blob"});const ge=await In({fs:a,gitdir:s,tree:V});return await kn({fs:a,cache:t,onSign:i,gitdir:s,ref:l,tree:ge,parent:j&&[j],message:`Note added by 'isomorphic-git addNote'
`,author:A,committer:T,signingKey:k})}async function qs({fs:a,onSign:t,dir:i,gitdir:s=g(i,".git"),ref:l="refs/notes/commits",oid:d,note:w,force:v,author:A,committer:T,signingKey:k,cache:j={}}){try{J("fs",a),J("gitdir",s),J("oid",d),J("note",w),k&&J("onSign",t);const F=new $e(a),V=await gr({fs:F,gitdir:s,author:A});if(!V)throw new Rt("author");const ne=await Ir({fs:F,gitdir:s,author:V,committer:T});if(!ne)throw new Rt("committer");const ge=await Ne({fsp:F,dotgit:s});return await Vh({fs:F,cache:j,onSign:t,gitdir:ge,ref:l,oid:d,note:w,force:v,author:V,committer:ne,signingKey:k})}catch(F){throw F.caller="git.addNote",F}}const Kh=/(^|[/.])([/.]|$)|^@$|@{|[\x00-\x20\x7f~^:?*[\\]|\.lock(\/|$)/;function An(a,t){if(typeof a!="string")throw new TypeError("Reference name must be a string");return!Kh.test(a)&&!0}async function Vs({fs:a,gitdir:t,remote:i,url:s,force:l}){if(!An(i))throw new er(i,f.clean(i));const d=await de.get({fs:a,gitdir:t});if(!l&&(await d.getSubsections("remote")).includes(i)&&s!==await d.get(`remote.${i}.url`))throw new Qt("remote",i);await d.set(`remote.${i}.url`,s),await d.set(`remote.${i}.fetch`,`+refs/heads/*:refs/remotes/${i}/*`),await de.save({fs:a,gitdir:t,config:d})}async function Ks({fs:a,dir:t,gitdir:i=g(t,".git"),remote:s,url:l,force:d=!1}){try{J("fs",a),J("gitdir",i),J("remote",s),J("url",l);const w=new $e(a),v=await Ne({fsp:w,dotgit:i});return await Vs({fs:w,gitdir:v,remote:s,url:l,force:d})}catch(w){throw w.caller="git.addRemote",w}}async function Zh({fs:a,cache:t,onSign:i,gitdir:s,ref:l,tagger:d,message:w=l,gpgsig:v,object:A,signingKey:T,force:k=!1}){if(l=l.startsWith("refs/tags/")?l:`refs/tags/${l}`,!k&&await H.exists({fs:a,gitdir:s,ref:l}))throw new Qt("tag",l);const j=await H.resolve({fs:a,gitdir:s,ref:A||"HEAD"}),{type:F}=await dt({fs:a,cache:t,gitdir:s,oid:j});let V=$t.from({object:j,type:F,tag:l.replace("refs/tags/",""),tagger:d,message:w,gpgsig:v});T&&(V=await $t.sign(V,i,T));const ne=await zt({fs:a,gitdir:s,type:"tag",object:V.toObject()});await H.writeRef({fs:a,gitdir:s,ref:l,value:ne})}async function Zs({fs:a,onSign:t,dir:i,gitdir:s=g(i,".git"),ref:l,tagger:d,message:w=l,gpgsig:v,object:A,signingKey:T,force:k=!1,cache:j={}}){try{J("fs",a),J("gitdir",s),J("ref",l),T&&J("onSign",t);const F=new $e(a),V=await Ne({fsp:F,dotgit:s}),ne=await gr({fs:F,gitdir:V,author:d});if(!ne)throw new Rt("tagger");return await Zh({fs:F,cache:j,onSign:t,gitdir:V,ref:l,tagger:ne,message:w,gpgsig:v,object:A,signingKey:T,force:k})}catch(F){throw F.caller="git.annotatedTag",F}}async function Xh({fs:a,gitdir:t,ref:i,object:s,checkout:l=!1,force:d=!1}){if(!An(i))throw new er(i,f.clean(i));const w=`refs/heads/${i}`;if(!d&&await H.exists({fs:a,gitdir:t,ref:w}))throw new Qt("branch",i,!1);let v;try{v=await H.resolve({fs:a,gitdir:t,ref:s||"HEAD"})}catch{}v&&await H.writeRef({fs:a,gitdir:t,ref:w,value:v}),l&&await H.writeSymbolicRef({fs:a,gitdir:t,ref:"HEAD",value:w})}async function Xs({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s,object:l,checkout:d=!1,force:w=!1}){try{J("fs",a),J("gitdir",i),J("ref",s);const v=new $e(a),A=await Ne({fsp:v,dotgit:i});return await Xh({fs:v,gitdir:A,ref:s,object:l,checkout:d,force:w})}catch(v){throw v.caller="git.branch",v}}const Ys=(a,t)=>a==="."||t==null||t.length===0||t==="."?!0:t.length>=a.length?t.startsWith(a):a.startsWith(t);async function Zi({fs:a,cache:t,onProgress:i,onPostCheckout:s,dir:l,gitdir:d,remote:w,ref:v,filepaths:A,noCheckout:T,noUpdateHead:k,dryRun:j,force:F,track:V=!0,nonBlocking:ne=!1,batchSize:ge=100}){let he;if(s)try{he=await H.resolve({fs:a,gitdir:d,ref:"HEAD"})}catch{he="0000000000000000000000000000000000000000"}let we;try{we=await H.resolve({fs:a,gitdir:d,ref:v})}catch(be){if(v==="HEAD")throw be;const Ae=`${w}/${v}`;if(we=await H.resolve({fs:a,gitdir:d,ref:Ae}),V){const Pe=await de.get({fs:a,gitdir:d});await Pe.set(`branch.${v}.remote`,w),await Pe.set(`branch.${v}.merge`,`refs/heads/${v}`),await de.save({fs:a,gitdir:d,config:Pe})}await H.writeRef({fs:a,gitdir:d,ref:`refs/heads/${v}`,value:we})}if(!T){let be;try{be=await Yh({fs:a,cache:t,onProgress:i,dir:l,gitdir:d,ref:v,force:F,filepaths:A})}catch(Ee){throw Ee instanceof Ge&&Ee.data.what===we?new dn(v,we):Ee}const Ae=be.filter(([Ee])=>Ee==="conflict").map(([Ee,Ie])=>Ie);if(Ae.length>0)throw new ln(Ae);const Pe=be.filter(([Ee])=>Ee==="error").map(([Ee,Ie])=>Ie);if(Pe.length>0)throw new y(Pe.join(", "));if(j){s&&await s({previousHead:he,newHead:we,type:A!=null&&A.length>0?"file":"branch"});return}let De=0;const Le=be.length;if(await me.acquire({fs:a,gitdir:d,cache:t},async function(Ee){await Promise.all(be.filter(([Ie])=>Ie==="delete"||Ie==="delete-index").map(async function([Ie,Te]){const Ze=`${l}/${Te}`;Ie==="delete"&&await a.rm(Ze),Ee.delete({filepath:Te}),i&&await i({phase:"Updating workdir",loaded:++De,total:Le})}))}),await me.acquire({fs:a,gitdir:d,cache:t},async function(Ee){for(const[Ie,Te]of be)if(Ie==="rmdir"||Ie==="rmdir-index"){const Ze=`${l}/${Te}`;try{Ie==="rmdir"&&await a.rmdir(Ze),Ee.delete({filepath:Te}),i&&await i({phase:"Updating workdir",loaded:++De,total:Le})}catch(ct){if(ct.code!=="ENOTEMPTY")throw ct}}}),await Promise.all(be.filter(([Ee])=>Ee==="mkdir"||Ee==="mkdir-index").map(async function([Ee,Ie]){const Te=`${l}/${Ie}`;await a.mkdir(Te),i&&await i({phase:"Updating workdir",loaded:++De,total:Le})})),ne){const Ee=be.filter(([Te])=>Te==="create"||Te==="create-index"||Te==="update"||Te==="mkdir-index"),Ie=await Js("Update Working Dir",Ee.map(([Te,Ze,ct,It,lt])=>()=>Qh({fs:a,cache:t,gitdir:d,dir:l},[Te,Ze,ct,It,lt])),i,ge);await me.acquire({fs:a,gitdir:d,cache:t,allowUnmerged:!0},async function(Te){await Js("Update Index",Ie.map(([Ze,ct,It])=>()=>Jh({index:Te,fullpath:Ze,oid:ct,stats:It})),i,ge)})}else await me.acquire({fs:a,gitdir:d,cache:t,allowUnmerged:!0},async function(Ee){await Promise.all(be.filter(([Ie])=>Ie==="create"||Ie==="create-index"||Ie==="update"||Ie==="mkdir-index").map(async function([Ie,Te,Ze,ct,It]){const lt=`${l}/${Te}`;try{if(Ie!=="create-index"&&Ie!=="mkdir-index"){const{object:Ot}=await dt({fs:a,cache:t,gitdir:d,oid:Ze});if(It&&await a.rm(lt),ct===33188)await a.write(lt,Ot);else if(ct===33261)await a.write(lt,Ot,{mode:511});else if(ct===40960)await a.writelink(lt,Ot);else throw new y(`Invalid mode 0o${ct.toString(8)} detected in blob ${Ze}`)}const Ct=await a.lstat(lt);ct===33261&&(Ct.mode=493),Ie==="mkdir-index"&&(Ct.mode=57344),Ee.insert({filepath:Te,stats:Ct,oid:Ze}),i&&await i({phase:"Updating workdir",loaded:++De,total:Le})}catch{}}))});s&&await s({previousHead:he,newHead:we,type:A!=null&&A.length>0?"file":"branch"})}if(!k){const be=await H.expand({fs:a,gitdir:d,ref:v});be.startsWith("refs/heads")?await H.writeSymbolicRef({fs:a,gitdir:d,ref:"HEAD",value:be}):await H.writeRef({fs:a,gitdir:d,ref:"HEAD",value:we})}}async function Yh({fs:a,cache:t,onProgress:i,dir:s,gitdir:l,ref:d,force:w,filepaths:v}){let A=0;return pr({fs:a,cache:t,dir:s,gitdir:l,trees:[Gt({ref:d}),Vr(),Je()],map:async function(T,[k,j,F]){if(T===".")return;if(v&&!v.some(ne=>Ys(T,ne)))return null;switch(i&&await i({phase:"Analyzing workdir",loaded:++A}),[!!F,!!k,!!j].map(Number).join("")){case"000":return;case"001":return w&&v&&v.includes(T)?["delete",T]:void 0;case"010":switch(await k.type()){case"tree":return["mkdir",T];case"blob":return["create",T,await k.oid(),await k.mode()];case"commit":return["mkdir-index",T,await k.oid(),await k.mode()];default:return["error",`new entry Unhandled type ${await k.type()}`]}case"011":switch(`${await k.type()}-${await j.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",T];case"blob-blob":return await k.oid()!==await j.oid()?w?["update",T,await k.oid(),await k.mode(),await k.mode()!==await j.mode()]:["conflict",T]:await k.mode()!==await j.mode()?w?["update",T,await k.oid(),await k.mode(),!0]:["conflict",T]:["create-index",T,await k.oid(),await k.mode()];case"commit-tree":return;case"commit-blob":return["conflict",T];default:return["error",`new entry Unhandled type ${k.type}`]}case"100":return["delete-index",T];case"101":switch(await F.type()){case"tree":return["rmdir-index",T];case"blob":return await F.oid()!==await j.oid()?w?["delete",T]:["conflict",T]:["delete",T];case"commit":return["rmdir-index",T];default:return["error",`delete entry Unhandled type ${await F.type()}`]}case"110":case"111":switch(`${await F.type()}-${await k.type()}`){case"tree-tree":return;case"blob-blob":{if(await F.oid()===await k.oid()&&await F.mode()===await k.mode()&&!w)return;if(j){if(await j.oid()!==await F.oid()&&await j.oid()!==await k.oid())return w?["update",T,await k.oid(),await k.mode(),await k.mode()!==await j.mode()]:["conflict",T]}else if(w)return["update",T,await k.oid(),await k.mode(),await k.mode()!==await F.mode()];return await k.mode()!==await F.mode()?["update",T,await k.oid(),await k.mode(),!0]:await k.oid()!==await F.oid()?["update",T,await k.oid(),await k.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",T,await k.oid()];case"blob-tree":return["update-blob-to-tree",T];case"commit-commit":return["mkdir-index",T,await k.oid(),await k.mode()];default:return["error",`update entry Unhandled type ${await F.type()}-${await k.type()}`]}}},reduce:async function(T,k){return k=Ps(k),T?T&&T[0]==="rmdir"?(k.push(T),k):(k.unshift(T),k):k}})}async function Jh({index:a,fullpath:t,stats:i,oid:s}){try{a.insert({filepath:t,stats:i,oid:s})}catch{}}async function Qh({fs:a,cache:t,gitdir:i,dir:s},[l,d,w,v,A]){const T=`${s}/${d}`;if(l!=="create-index"&&l!=="mkdir-index"){const{object:j}=await dt({fs:a,cache:t,gitdir:i,oid:w});if(A&&await a.rm(T),v===33188)await a.write(T,j);else if(v===33261)await a.write(T,j,{mode:511});else if(v===40960)await a.writelink(T,j);else throw new y(`Invalid mode 0o${v.toString(8)} detected in blob ${w}`)}const k=await a.lstat(T);return v===33261&&(k.mode=493),l==="mkdir-index"&&(k.mode=57344),[d,w,k]}async function Js(a,t,i,s){const l=[];try{for(let d=0;d<t.length;d+=s){const w=t.slice(d,d+s).map(A=>A());(await Promise.allSettled(w)).forEach(A=>{A.status==="fulfilled"&&l.push(A.value)}),i&&await i({phase:"Updating workdir",loaded:d+w.length,total:t.length})}return l}catch{}return l}async function Xi({fs:a,onProgress:t,onPostCheckout:i,dir:s,gitdir:l=g(s,".git"),remote:d="origin",ref:w,filepaths:v,noCheckout:A=!1,noUpdateHead:T=w===void 0,dryRun:k=!1,force:j=!1,track:F=!0,cache:V={},nonBlocking:ne=!1,batchSize:ge=100}){try{J("fs",a),J("dir",s),J("gitdir",l);const he=w||"HEAD",we=new $e(a),be=await Ne({fsp:we,dotgit:l});return await Zi({fs:we,cache:V,onProgress:t,onPostCheckout:i,dir:s,gitdir:be,remote:d,ref:he,filepaths:v,noCheckout:A,noUpdateHead:T,dryRun:k,force:j,track:F,nonBlocking:ne,batchSize:ge})}catch(he){throw he.caller="git.checkout",he}}const Yi=/^.*(\r?\n|$)/gm;function ep({branches:a,contents:t}){const i=a[1],s=a[2],l=t[0],d=t[1],w=t[2],v=d.match(Yi),A=l.match(Yi),T=w.match(Yi),k=h(v,A,T),j=7;let F="",V=!0;for(const ne of k)ne.ok&&(F+=ne.ok.join("")),ne.conflict&&(V=!1,F+=`${"<".repeat(j)} ${i}
`,F+=ne.conflict.a.join(""),F+=`${"=".repeat(j)}
`,F+=ne.conflict.b.join(""),F+=`${">".repeat(j)} ${s}
`);return{cleanMerge:V,mergedText:F}}async function Qs({fs:a,cache:t,dir:i,gitdir:s=g(i,".git"),index:l,ourOid:d,baseOid:w,theirOid:v,ourName:A="ours",baseName:T="base",theirName:k="theirs",dryRun:j=!1,abortOnConflict:F=!0,mergeDriver:V}){const ne=Gt({ref:d}),ge=Gt({ref:w}),he=Gt({ref:v}),we=[],be=[],Ae=[],Pe=[],De=await pr({fs:a,cache:t,dir:i,gitdir:s,trees:[ne,ge,he],map:async function(Le,[Ee,Ie,Te]){const Ze=Fe(Le),ct=await ii(Ee,Ie),It=await ii(Te,Ie);switch(`${ct}-${It}`){case"false-false":return{mode:await Ie.mode(),path:Ze,oid:await Ie.oid(),type:await Ie.type()};case"false-true":return!Te&&await Ee.type()==="tree"?{mode:await Ee.mode(),path:Ze,oid:await Ee.oid(),type:await Ee.type()}:Te?{mode:await Te.mode(),path:Ze,oid:await Te.oid(),type:await Te.type()}:void 0;case"true-false":return!Ee&&await Te.type()==="tree"?{mode:await Te.mode(),path:Ze,oid:await Te.oid(),type:await Te.type()}:Ee?{mode:await Ee.mode(),path:Ze,oid:await Ee.oid(),type:await Ee.type()}:void 0;case"true-true":{if(Ee&&Te&&await Ee.type()==="tree"&&await Te.type()==="tree")return{mode:await Ee.mode(),path:Ze,oid:await Ee.oid(),type:"tree"};if(Ee&&Te&&await Ee.type()==="blob"&&await Te.type()==="blob")return tp({fs:a,gitdir:s,path:Ze,ours:Ee,base:Ie,theirs:Te,ourName:A,baseName:T,theirName:k,mergeDriver:V}).then(async lt=>{if(lt.cleanMerge)F||l.insert({filepath:Le,oid:lt.mergeResult.oid,stage:0});else if(we.push(Le),be.push(Le),!F){let Ct="";Ie&&await Ie.type()==="blob"&&(Ct=await Ie.oid());const Ot=await Ee.oid(),Tr=await Te.oid();l.delete({filepath:Le}),Ct&&l.insert({filepath:Le,oid:Ct,stage:1}),l.insert({filepath:Le,oid:Ot,stage:2}),l.insert({filepath:Le,oid:Tr,stage:3})}return lt.mergeResult});if(Ie&&!Ee&&Te&&await Ie.type()==="blob"&&await Te.type()==="blob"){if(we.push(Le),Ae.push(Le),!F){const lt=await Ie.oid(),Ct=await Te.oid();l.delete({filepath:Le}),l.insert({filepath:Le,oid:lt,stage:1}),l.insert({filepath:Le,oid:Ct,stage:3})}return{mode:await Te.mode(),oid:await Te.oid(),type:"blob",path:Ze}}if(Ie&&Ee&&!Te&&await Ie.type()==="blob"&&await Ee.type()==="blob"){if(we.push(Le),Pe.push(Le),!F){const lt=await Ie.oid(),Ct=await Ee.oid();l.delete({filepath:Le}),l.insert({filepath:Le,oid:lt,stage:1}),l.insert({filepath:Le,oid:Ct,stage:2})}return{mode:await Ee.mode(),oid:await Ee.oid(),type:"blob",path:Ze}}if(Ie&&!Ee&&!Te&&(await Ie.type()==="blob"||await Ie.type()==="tree"))return;throw new Gr}}},reduce:we.length!==0&&(!i||F)?void 0:async(Le,Ee)=>{const Ie=Ee.filter(Boolean);if(Le&&!(Le&&Le.type==="tree"&&Ie.length===0&&Le.path!==".")){if(Ie.length>0||Le.path==="."&&Ie.length===0){const Ze=new Ce(Ie).toObject(),ct=await zt({fs:a,gitdir:s,type:"tree",object:Ze,dryRun:j});Le.oid=ct}return Le}}});return we.length!==0?(i&&!F&&await pr({fs:a,cache:t,dir:i,gitdir:s,trees:[Gt({ref:De.oid})],map:async function(Le,[Ee]){const Ie=`${i}/${Le}`;if(await Ee.type()==="blob"){const Te=await Ee.mode(),Ze=new TextDecoder().decode(await Ee.content());await a.write(Ie,Ze,{mode:Te})}return!0}}),new kr(we,be,Ae,Pe)):De.oid}async function tp({fs:a,gitdir:t,path:i,ours:s,base:l,theirs:d,ourName:w,theirName:v,baseName:A,dryRun:T,mergeDriver:k=ep}){const j="blob";let F="100755",V="",ne="";l&&await l.type()==="blob"&&(F=await l.mode(),V=await l.oid(),ne=Buffer.from(await l.content()).toString("utf8"));const ge=F===await s.mode()?await d.mode():await s.mode();if(await s.oid()===await d.oid())return{cleanMerge:!0,mergeResult:{mode:ge,path:i,oid:await s.oid(),type:j}};if(await s.oid()===V)return{cleanMerge:!0,mergeResult:{mode:ge,path:i,oid:await d.oid(),type:j}};if(await d.oid()===V)return{cleanMerge:!0,mergeResult:{mode:ge,path:i,oid:await s.oid(),type:j}};const he=Buffer.from(await s.content()).toString("utf8"),we=Buffer.from(await d.content()).toString("utf8"),{mergedText:be,cleanMerge:Ae}=await k({branches:[A,w,v],contents:[ne,he,we],path:i}),Pe=await zt({fs:a,gitdir:t,type:"blob",object:Buffer.from(be,"utf8"),dryRun:T});return{cleanMerge:Ae,mergeResult:{mode:ge,path:i,oid:Pe,type:j}}}const rp={stage:Je,workdir:Vr};let Ji;async function Xr(a,t){return Ji===void 0&&(Ji=new n),Ji.acquire(a,t)}async function np(a,t,i,s,l=null){const d=g(i,s),w=await a.lstat(d);if(!w)throw new Ge(d);if(w.isDirectory())throw new y(`${d}: file expected, but found directory`);const v=l?await Vt({fs:a,gitdir:t,oid:l}):void 0;let A=v?l:void 0;return v||await Xr({fs:a,gitdir:t,currentFilepath:d},async()=>{const T=w.isSymbolicLink()?await a.readlink(d).then(Ns):await a.read(d);if(T===null)throw new Ge(d);A=await zt({fs:a,gitdir:t,type:"blob",object:T})}),A}async function ip({fs:a,dir:t,gitdir:i,entries:s}){async function l(d){if(d.type==="tree"){if(!d.oid){const w=await Promise.all(d.children.map(l));d.oid=await In({fs:a,gitdir:i,tree:w}),d.mode=16384}}else d.type==="blob"&&(d.oid=await np(a,i,t,d.path,d.oid),d.mode=33188);return d.path=d.path.split("/").pop(),d}return Promise.all(s.map(l))}async function ec({fs:a,dir:t,gitdir:i,treePair:s}){const l=s[1]==="stage",d=s.map(V=>typeof V=="string"?rp[V]():V),w=[],k=await pr({fs:a,cache:{},dir:t,gitdir:i,trees:d,map:async(V,[ne,ge])=>{if(!(V==="."||await Kr.isIgnored({fs:a,dir:t,gitdir:i,filepath:V}))&&ge)return(!ne||await ne.oid()!==await ge.oid()&&await ge.oid()!==void 0)&&w.push([ne,ge]),{mode:await ge.mode(),path:V,oid:await ge.oid(),type:await ge.type()}},reduce:async(V,ne)=>(ne=ne.filter(Boolean),V?(V.children=ne,V):ne.length>0?ne:void 0),iterate:async(V,ne)=>{const ge=[];for(const he of ne){const[we,be]=he;l?be&&(await a.exists(`${t}/${be.toString()}`)?ge.push(he):w.push([null,be])):we&&(be?ge.push(he):w.push([we,null]))}return ge.length?Promise.all(ge.map(V)):[]}});if(w.length===0||k.length===0)return null;const F=(await ip({fs:a,dir:t,gitdir:i,entries:k})).filter(Boolean).map(V=>({mode:V.mode,path:V.path,oid:V.oid,type:V.type}));return In({fs:a,gitdir:i,tree:F})}async function tc({fs:a,dir:t,gitdir:i,stashCommit:s,parentCommit:l,wasStaged:d}){const w=[],v=[],A=await pr({fs:a,cache:{},dir:t,gitdir:i,trees:[Gt({ref:l}),Gt({ref:s})],map:async(T,[k,j])=>{if(T==="."||await Kr.isIgnored({fs:a,dir:t,gitdir:i,filepath:T}))return;const F=j?await j.type():await k.type();if(F!=="tree"&&F!=="blob")return;if(!j&&k){const ne=F==="tree"?"rmdir":"rm";return F==="tree"&&w.push(T),F==="blob"&&d&&v.push({filepath:T,oid:await k.oid()}),{method:ne,filepath:T}}const V=await j.oid();if(!k||await k.oid()!==V)return F==="tree"?{method:"mkdir",filepath:T}:(d&&v.push({filepath:T,oid:V,stats:await a.lstat(g(t,T))}),{method:"write",filepath:T,oid:V})}});await Xr({fs:a,gitdir:i,dirRemoved:w,ops:A},async()=>{for(const T of A){const k=g(t,T.filepath);switch(T.method){case"rmdir":await a.rmdir(k);break;case"mkdir":await a.mkdir(k);break;case"rm":await a.rm(k);break;case"write":if(!w.some(j=>k.startsWith(j))){const{object:j}=await dt({fs:a,cache:{},gitdir:i,oid:T.oid});await a.exists(k)&&await a.rm(k),await a.write(k,j)}break}}}),await me.acquire({fs:a,gitdir:i,cache:{}},async T=>{v.forEach(({filepath:k,stats:j,oid:F})=>{T.insert({filepath:k,stats:j,oid:F})})})}async function rc({fs:a,cache:t,dir:i,gitdir:s,oid:l,dryRun:d=!1,noUpdateBranch:w=!1,abortOnConflict:v=!0,committer:A,mergeDriver:T}){const{commit:k,oid:j}=await ir({fs:a,cache:t,gitdir:s,oid:l});if(k.parent.length>1)throw new un(j,k.parent.length);if(k.parent.length===0)throw new fn(j);const F=await H.resolve({fs:a,gitdir:s,ref:"HEAD"}),{commit:V}=await ir({fs:a,cache:t,gitdir:s,oid:F}),ne=k.parent[0],{commit:ge}=await ir({fs:a,cache:t,gitdir:s,oid:ne}),he=await me.acquire({fs:a,gitdir:s,cache:t,allowUnmerged:!1},async be=>Qs({fs:a,cache:t,dir:i,gitdir:s,index:be,ourOid:V.tree,baseOid:ge.tree,theirOid:k.tree,ourName:"HEAD",baseName:`parent of ${j.slice(0,7)}`,theirName:j.slice(0,7),dryRun:d,abortOnConflict:v,mergeDriver:T}));if(he instanceof kr)throw he;const we=await kn({fs:a,cache:t,gitdir:s,message:k.message,tree:he,parent:[F],author:k.author,committer:A,dryRun:d,noUpdateBranch:w});return i&&!d&&!w&&await tc({fs:a,dir:i,gitdir:s,stashCommit:we,parentCommit:F,wasStaged:!0}),we}async function nc({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,cache:l={},committer:d,dryRun:w=!1,noUpdateBranch:v=!1,abortOnConflict:A=!0,mergeDriver:T}){try{J("fs",a),J("gitdir",i),J("oid",s);const k=new $e(a),j=await Ne({fsp:k,dotgit:i}),{commit:F}=await ir({fs:k,cache:l,gitdir:j,oid:s});if(F.parent&&F.parent.length>1)return await rc({fs:k,cache:l,dir:t,gitdir:j,oid:s,dryRun:w,noUpdateBranch:v,abortOnConflict:A,committer:void 0,mergeDriver:T});const V=await Ir({fs:k,gitdir:j,committer:d});if(!V)throw new Rt("committer");return await rc({fs:k,cache:l,dir:t,gitdir:j,oid:s,dryRun:w,noUpdateBranch:v,abortOnConflict:A,committer:V,mergeDriver:T})}catch(k){throw k.caller="git.cherryPick",k}}const ap=/^refs\/(heads\/|tags\/|remotes\/)?(.*)/;function Ar(a){const t=ap.exec(a);return t?t[1]==="remotes/"&&a.endsWith("/HEAD")?t[2].slice(0,-5):t[2]:a}async function mr({fs:a,gitdir:t,fullname:i=!1,test:s=!1}){const l=await H.resolve({fs:a,gitdir:t,ref:"HEAD",depth:2});if(s)try{await H.resolve({fs:a,gitdir:t,ref:l})}catch{return}if(l.startsWith("refs/"))return i?l:Ar(l)}function op(a){return a=a.replace(/^git@([^:]+):/,"https://$1/"),a=a.replace(/^ssh:\/\//,"https://"),a}function ic({username:a="",password:t=""}){return`Basic ${Buffer.from(`${a}:${t}`).toString("base64")}`}async function Cn(a,t){const i=_r(a);for(;;){const{value:s,done:l}=await i.next();if(s&&await t(s),l)break}i.return&&i.return()}async function ai(a){let t=0;const i=[];await Cn(a,d=>{i.push(d),t+=d.byteLength});const s=new Uint8Array(t);let l=0;for(const d of i)s.set(d,l),l+=d.byteLength;return s}function ac(a){let t=a.match(/^https?:\/\/([^/]+)@/);if(t==null)return{url:a,auth:{}};t=t[1];const[i,s]=t.split(":");return a=a.replace(`${t}@`,""),{url:a,auth:{username:i,password:s}}}function Qi(a,t){const i=t.toString(16);return"0".repeat(a-i.length)+i}class _t{static flush(){return Buffer.from("0000","utf8")}static delim(){return Buffer.from("0001","utf8")}static encode(t){typeof t=="string"&&(t=Buffer.from(t));const i=t.length+4,s=Qi(4,i);return Buffer.concat([Buffer.from(s,"utf8"),t])}static streamReader(t){const i=new Sr(t);return async function(){try{let l=await i.read(4);if(l==null)return!0;if(l=parseInt(l.toString("utf8"),16),l===0||l===1)return null;const d=await i.read(l-4);return d??!0}catch(l){return t.error=l,!0}}}}async function oc(a){const t={};let i;for(;i=await a(),i!==!0;){if(i===null)continue;i=i.toString("utf8").replace(/\n$/,"");const s=i.indexOf("=");if(s>-1){const l=i.slice(0,s),d=i.slice(s+1);t[l]=d}else t[i]=!0}return{protocolVersion:2,capabilities2:t}}async function sc(a,{service:t}){const i=new Set,s=new Map,l=new Map,d=_t.streamReader(a);let w=await d();for(;w===null;)w=await d();if(w===!0)throw new hn;if(w.includes("version 2"))return oc(d);if(w.toString("utf8").replace(/\n$/,"")!==`# service=${t}`)throw new Er(`# service=${t}\\n`,w.toString("utf8"));let v=await d();for(;v===null;)v=await d();if(v===!0)return{capabilities:i,refs:s,symrefs:l};if(v=v.toString("utf8"),v.includes("version 2"))return oc(d);const[A,T]=ea(v,"\0","\\x00");if(T.split(" ").map(k=>i.add(k)),A!=="0000000000000000000000000000000000000000 capabilities^{}"){const[k,j]=ea(A," "," ");for(s.set(j,k);;){const F=await d();if(F===!0)break;if(F!==null){const[V,ne]=ea(F.toString("utf8")," "," ");s.set(ne,V)}}}for(const k of i)if(k.startsWith("symref=")){const j=k.match(/symref=([^:]+):(.*)/);j.length===3&&l.set(j[1],j[2])}return{protocolVersion:1,capabilities:i,refs:s,symrefs:l}}function ea(a,t,i){const s=a.trim().split(t);if(s.length!==2)throw new Er(`Two strings separated by '${i}'`,a.toString("utf8"));return s}const cc=(a,t)=>a.endsWith("?")?`${a}${t}`:`${a}/${t.replace(/^https?:\/\//,"")}`,lc=(a,t)=>{(t.username||t.password)&&(a.Authorization=ic(t)),t.headers&&Object.assign(a,t.headers)},ta=async a=>{try{const t=Buffer.from(await ai(a.body)),i=t.toString("utf8");return{preview:i.length<256?i:i.slice(0,256)+"...",response:i,data:t}}catch{return{}}};class oi{static async capabilities(){return["discover","connect"]}static async discover({http:t,onProgress:i,onAuth:s,onAuthSuccess:l,onAuthFailure:d,corsProxy:w,service:v,url:A,headers:T,protocolVersion:k}){let{url:j,auth:F}=ac(A);const V=w?cc(w,j):j;(F.username||F.password)&&(T.Authorization=ic(F)),k===2&&(T["Git-Protocol"]="version=2");let ne,ge,he=!1;do if(ne=await t.request({onProgress:i,method:"GET",url:`${V}/info/refs?service=${v}`,headers:T}),ge=!1,ne.statusCode===401||ne.statusCode===203){const we=he?d:s;if(we){if(F=await we(j,{...F,headers:{...T}}),F&&F.cancel)throw new Wr;F&&(lc(T,F),he=!0,ge=!0)}}else ne.statusCode===200&&he&&l&&await l(j,F);while(ge);if(ne.statusCode!==200){const{response:we}=await ta(ne);throw new zr(ne.statusCode,ne.statusMessage,we)}if(ne.headers["content-type"]===`application/x-${v}-advertisement`){const we=await sc(ne.body,{service:v});return we.auth=F,we}else{const{preview:we,response:be,data:Ae}=await ta(ne);try{const Pe=await sc([Ae],{service:v});return Pe.auth=F,Pe}catch{throw new yn(we,be)}}}static async connect({http:t,onProgress:i,corsProxy:s,service:l,url:d,auth:w,body:v,headers:A}){const T=ac(d);T&&(d=T.url),s&&(d=cc(s,d)),A["content-type"]=`application/x-${l}-request`,A.accept=`application/x-${l}-result`,lc(A,w);const k=await t.request({onProgress:i,method:"POST",url:`${d}/${l}`,body:v,headers:A});if(k.statusCode!==200){const{response:j}=ta(k);throw new zr(k.statusCode,k.statusMessage,j)}return k}}class si{static getRemoteHelperFor({url:t}){const i=new Map;i.set("http",oi),i.set("https",oi);const s=sp({url:t});if(!s)throw new vn(t);if(i.has(s.transport))return i.get(s.transport);throw new bn(t,s.transport,s.transport==="ssh"?op(t):void 0)}}function sp({url:a}){if(a.startsWith("git@"))return{transport:"ssh",address:a};const t=a.match(/(\w+)(:\/\/|::)(.*)/);if(t!==null){if(t[2]==="://")return{transport:t[1],address:t[0]};if(t[2]==="::")return{transport:t[1],address:t[3]}}}let Cr=null;class Tn{static async read({fs:t,gitdir:i}){Cr===null&&(Cr=new n);const s=g(i,"shallow"),l=new Set;return await Cr.acquire(s,async function(){const d=await t.read(s,{encoding:"utf8"});if(d===null||d.trim()==="")return l;d.trim().split(`
`).map(w=>l.add(w))}),l}static async write({fs:t,gitdir:i,oids:s}){Cr===null&&(Cr=new n);const l=g(i,"shallow");if(s.size>0){const d=[...s].join(`
`)+`
`;await Cr.acquire(l,async function(){await t.write(l,d,{encoding:"utf8"})})}else await Cr.acquire(l,async function(){await t.rm(l)})}}async function cp({fs:a,gitdir:t,oid:i}){const s=`objects/${i.slice(0,2)}/${i.slice(2)}`;return a.exists(`${t}/${s}`)}async function lp({fs:a,cache:t,gitdir:i,oid:s,getExternalRefDelta:l}){let d=await a.readdir(g(i,"objects/pack"));d=d.filter(w=>w.endsWith(".idx"));for(const w of d){const v=`${i}/objects/pack/${w}`,A=await Gi({fs:a,cache:t,filename:v,getExternalRefDelta:l});if(A.error)throw new y(A.error);if(A.offsets.has(s))return!0}return!1}async function uc({fs:a,cache:t,gitdir:i,oid:s,format:l="content"}){const d=v=>dt({fs:a,cache:t,gitdir:i,oid:v});let w=await cp({fs:a,gitdir:i,oid:s});return w||(w=await lp({fs:a,cache:t,gitdir:i,oid:s,getExternalRefDelta:d})),w}function up(a){const l="5041434b"+"00000002"+"00000000";return a.slice(0,12).toString("hex")===l}function fc(a,t){const i=a.map(s=>s.split("=",1)[0]);return t.filter(s=>{const l=s.split("=",1)[0];return i.includes(l)})}const ci={name:"isomorphic-git",version:"1.37.1",agent:"git/isomorphic-git@1.37.1"};class li{constructor(){this._queue=[]}write(t){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const i=this._waiting;this._waiting=null,i({value:t})}else this._queue.push(t)}end(){if(this._ended=!0,this._waiting){const t=this._waiting;this._waiting=null,t({done:!0})}}destroy(t){this.error=t,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(t=>{this._waiting=t})}}function fp(a){const t=a.indexOf("\r"),i=a.indexOf(`
`);return t===-1&&i===-1?-1:t===-1?i+1:i===-1?t+1:i===t+1?i+1:Math.min(t,i)+1}function dc(a){const t=new li;let i="";return(async()=>(await Cn(a,s=>{for(s=s.toString("utf8"),i+=s;;){const l=fp(i);if(l===-1)break;t.write(i.slice(0,l)),i=i.slice(l)}}),i.length>0&&t.write(i),t.end()))(),t}class hc{static demux(t){const i=_t.streamReader(t),s=new li,l=new li,d=new li,w=async function(){const v=await i();if(v===null)return w();if(v===!0){s.end(),d.end(),t.error?l.destroy(t.error):l.end();return}switch(v[0]){case 1:{l.write(v.slice(1));break}case 2:{d.write(v.slice(1));break}case 3:{const A=v.slice(1);d.write(A),s.end(),d.end(),l.destroy(new Error(A.toString("utf8")));return}default:s.write(v)}w()};return w(),{packetlines:s,packfile:l,progress:d}}}async function dp(a){const{packetlines:t,packfile:i,progress:s}=hc.demux(a),l=[],d=[],w=[];let v=!1,A=!1;return new Promise((T,k)=>{Cn(t,j=>{const F=j.toString("utf8").trim();if(F.startsWith("shallow")){const V=F.slice(-41).trim();V.length!==40&&k(new rt(V)),l.push(V)}else if(F.startsWith("unshallow")){const V=F.slice(-41).trim();V.length!==40&&k(new rt(V)),d.push(V)}else if(F.startsWith("ACK")){const[,V,ne]=F.split(" ");w.push({oid:V,status:ne}),ne||(A=!0)}else F.startsWith("NAK")?(v=!0,A=!0):(A=!0,v=!0);A&&(a.error?k(a.error):T({shallows:l,unshallows:d,acks:w,nak:v,packfile:i,progress:s}))}).finally(()=>{A||(a.error?k(a.error):T({shallows:l,unshallows:d,acks:w,nak:v,packfile:i,progress:s}))})})}function hp({capabilities:a=[],wants:t=[],haves:i=[],shallows:s=[],depth:l=null,since:d=null,exclude:w=[]}){const v=[];t=[...new Set(t)];let A=` ${a.join(" ")}`;for(const T of t)v.push(_t.encode(`want ${T}${A}
`)),A="";for(const T of s)v.push(_t.encode(`shallow ${T}
`));l!==null&&v.push(_t.encode(`deepen ${l}
`)),d!==null&&v.push(_t.encode(`deepen-since ${Math.floor(d.valueOf()/1e3)}
`));for(const T of w)v.push(_t.encode(`deepen-not ${T}
`));v.push(_t.flush());for(const T of i)v.push(_t.encode(`have ${T}
`));return v.push(_t.encode(`done
`)),v}async function ra({fs:a,cache:t,http:i,onProgress:s,onMessage:l,onAuth:d,onAuthSuccess:w,onAuthFailure:v,gitdir:A,ref:T,remoteRef:k,remote:j,url:F,corsProxy:V,depth:ne=null,since:ge=null,exclude:he=[],relative:we=!1,tags:be=!1,singleBranch:Ae=!1,headers:Pe={},prune:De=!1,pruneTags:Le=!1}){const Ee=T||await mr({fs:a,gitdir:A,test:!0}),Ie=await de.get({fs:a,gitdir:A}),Te=j||Ee&&await Ie.get(`branch.${Ee}.remote`)||"origin",Ze=F||await Ie.get(`remote.${Te}.url`);if(typeof Ze>"u")throw new Ut("remote OR url");const ct=k||Ee&&await Ie.get(`branch.${Ee}.merge`)||T||"HEAD";V===void 0&&(V=await Ie.get("http.corsProxy"));const It=si.getRemoteHelperFor({url:Ze}),lt=await It.discover({http:i,onAuth:d,onAuthSuccess:w,onAuthFailure:v,corsProxy:V,service:"git-upload-pack",url:Ze,headers:Pe,protocolVersion:1}),Ct=lt.auth,Ot=lt.refs;if(Ot.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(ne!==null&&!lt.capabilities.has("shallow"))throw new hr("shallow","depth");if(ge!==null&&!lt.capabilities.has("deepen-since"))throw new hr("deepen-since","since");if(he.length>0&&!lt.capabilities.has("deepen-not"))throw new hr("deepen-not","exclude");if(we===!0&&!lt.capabilities.has("deepen-relative"))throw new hr("deepen-relative","relative");const{oid:Tr,fullref:Rr}=H.resolveAgainstMap({ref:ct,map:Ot});for(const ut of Ot.keys())ut===Rr||ut==="HEAD"||ut.startsWith("refs/heads/")||be&&ut.startsWith("refs/tags/")||Ot.delete(ut);const Yr=fc([...lt.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${ci.agent}`]);we&&Yr.push("deepen-relative");const oa=Ae?[Tr]:Ot.values(),sa=Ae?[Ee]:await H.listRefs({fs:a,gitdir:A,filepath:"refs"});let Ht=[];for(let ut of sa)try{ut=await H.expand({fs:a,gitdir:A,ref:ut});const Mt=await H.resolve({fs:a,gitdir:A,ref:ut});await uc({fs:a,cache:t,gitdir:A,oid:Mt})&&Ht.push(Mt)}catch{}Ht=[...new Set(Ht)];const bt=await Tn.read({fs:a,gitdir:A}),ar=lt.capabilities.has("shallow")?[...bt]:[],Dt=hp({capabilities:Yr,wants:oa,haves:Ht,shallows:ar,depth:ne,since:ge,exclude:he}),Rn=Buffer.from(await ai(Dt)),Or=await It.connect({http:i,onProgress:s,corsProxy:V,service:"git-upload-pack",url:Ze,auth:Ct,body:[Rn],headers:Pe}),At=await dp(Or.body);Or.headers&&(At.headers=Or.headers);for(const ut of At.shallows)if(!bt.has(ut))try{const{object:Mt}=await dt({fs:a,cache:t,gitdir:A,oid:ut}),Xt=new mt(Mt),or=await Promise.all(Xt.headers().parent.map(Mn=>uc({fs:a,cache:t,gitdir:A,oid:Mn})));or.length===0||or.every(Mn=>Mn)||bt.add(ut)}catch{bt.add(ut)}for(const ut of At.unshallows)bt.delete(ut);if(await Tn.write({fs:a,gitdir:A,oids:bt}),Ae){const ut=new Map([[Rr,Tr]]),Mt=new Map;let Xt=10,or=Rr;for(;Xt--;){const la=lt.symrefs.get(or);if(la===void 0)break;Mt.set(or,la),or=la}const ca=Ot.get(or);ca&&ut.set(or,ca);const{pruned:Mn}=await H.updateRemoteRefs({fs:a,gitdir:A,remote:Te,refs:ut,symrefs:Mt,tags:be,prune:De});De&&(At.pruned=Mn)}else{const{pruned:ut}=await H.updateRemoteRefs({fs:a,gitdir:A,remote:Te,refs:Ot,symrefs:lt.symrefs,tags:be,prune:De,pruneTags:Le});De&&(At.pruned=ut)}if(At.HEAD=lt.symrefs.get("HEAD"),At.HEAD===void 0){const{oid:ut}=H.resolveAgainstMap({ref:"HEAD",map:Ot});for(const[Mt,Xt]of Ot.entries())if(Mt!=="HEAD"&&Xt===ut){At.HEAD=Mt;break}}const Xp=Rr.startsWith("refs/tags")?"tag":"branch";if(At.FETCH_HEAD={oid:Tr,description:`${Xp} '${Ar(Rr)}' of ${Ze}`},s||l){const ut=dc(At.progress);Cn(ut,async Mt=>{if(l&&await l(Mt),s){const Xt=Mt.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);Xt&&await s({phase:Xt[1].trim(),loaded:parseInt(Xt[2],10),total:parseInt(Xt[3],10)})}})}const fi=Buffer.from(await ai(At.packfile));if(Or.body.error)throw Or.body.error;const Fl=fi.slice(-20).toString("hex"),On={defaultBranch:At.HEAD,fetchHead:At.FETCH_HEAD.oid,fetchHeadDescription:At.FETCH_HEAD.description};if(At.headers&&(On.headers=At.headers),De&&(On.pruned=At.pruned),Fl!==""&&!up(fi)){On.packfile=`objects/pack/pack-${Fl}.pack`;const ut=g(A,On.packfile);await a.write(ut,fi);const Mt=or=>dt({fs:a,cache:t,gitdir:A,oid:or}),Xt=await Ur.fromPack({pack:fi,getExternalRefDelta:Mt,onProgress:s});await a.write(ut.replace(/\.pack$/,".idx"),await Xt.toBuffer())}return On}async function pc({fs:a,bare:t=!1,dir:i,gitdir:s=t?i:g(i,".git"),defaultBranch:l="master"}){if(await a.exists(s+"/config"))return;let d=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];d=d.map(w=>s+"/"+w);for(const w of d)await a.mkdir(w);await a.write(s+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${t}
`+(t?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await a.write(s+"/HEAD",`ref: refs/heads/${l}
`)}async function pp({fs:a,cache:t,http:i,onProgress:s,onMessage:l,onAuth:d,onAuthSuccess:w,onAuthFailure:v,onPostCheckout:A,dir:T,gitdir:k,url:j,corsProxy:F,ref:V,remote:ne,depth:ge,since:he,exclude:we,relative:be,singleBranch:Ae,noCheckout:Pe,noTags:De,headers:Le,nonBlocking:Ee,batchSize:Ie=100}){try{if(await pc({fs:a,gitdir:k}),await Vs({fs:a,gitdir:k,remote:ne,url:j,force:!1}),F){const ct=await de.get({fs:a,gitdir:k});await ct.set("http.corsProxy",F),await de.save({fs:a,gitdir:k,config:ct})}const{defaultBranch:Te,fetchHead:Ze}=await ra({fs:a,cache:t,http:i,onProgress:s,onMessage:l,onAuth:d,onAuthSuccess:w,onAuthFailure:v,gitdir:k,ref:V,remote:ne,corsProxy:F,depth:ge,since:he,exclude:we,relative:be,singleBranch:Ae,headers:Le,tags:!De});if(Ze===null)return;V=V||Te,V=V.replace("refs/heads/",""),await Zi({fs:a,cache:t,onProgress:s,onPostCheckout:A,dir:T,gitdir:k,ref:V,remote:ne,noCheckout:Pe,nonBlocking:Ee,batchSize:Ie})}catch(Te){throw await a.rmdir(k,{recursive:!0,maxRetries:10}).catch(()=>{}),Te}}async function gc({fs:a,http:t,onProgress:i,onMessage:s,onAuth:l,onAuthSuccess:d,onAuthFailure:w,onPostCheckout:v,dir:A,gitdir:T=g(A,".git"),url:k,corsProxy:j=void 0,ref:F=void 0,remote:V="origin",depth:ne=void 0,since:ge=void 0,exclude:he=[],relative:we=!1,singleBranch:be=!1,noCheckout:Ae=!1,noTags:Pe=!1,headers:De={},cache:Le={},nonBlocking:Ee=!1,batchSize:Ie=100}){try{J("fs",a),J("http",t),J("gitdir",T),Ae||J("dir",A),J("url",k);const Te=new $e(a),Ze=await Ne({fsp:Te,dotgit:T});return await pp({fs:Te,cache:Le,http:t,onProgress:i,onMessage:s,onAuth:l,onAuthSuccess:d,onAuthFailure:w,onPostCheckout:v,dir:A,gitdir:Ze,url:k,corsProxy:j,ref:F,remote:V,depth:ne,since:ge,exclude:he,relative:we,singleBranch:be,noCheckout:Ae,noTags:Pe,headers:De,nonBlocking:Ee,batchSize:Ie})}catch(Te){throw Te.caller="git.clone",Te}}async function mc({fs:a,onSign:t,dir:i,gitdir:s=g(i,".git"),message:l,author:d,committer:w,signingKey:v,amend:A=!1,dryRun:T=!1,noUpdateBranch:k=!1,ref:j,parent:F,tree:V,cache:ne={}}){try{J("fs",a),A||J("message",l),v&&J("onSign",t);const ge=new $e(a),he=await Ne({fsp:ge,dotgit:s});return await kn({fs:ge,cache:ne,onSign:t,gitdir:he,message:l,author:d,committer:w,signingKey:v,amend:A,dryRun:T,noUpdateBranch:k,ref:j,parent:F,tree:V})}catch(ge){throw ge.caller="git.commit",ge}}async function wc({fs:a,dir:t,gitdir:i=g(t,".git"),fullname:s=!1,test:l=!1}){try{J("fs",a),J("gitdir",i);const d=new $e(a),w=await Ne({fsp:d,dotgit:i});return await mr({fs:d,gitdir:w,fullname:s,test:l})}catch(d){throw d.caller="git.currentBranch",d}}async function gp({fs:a,gitdir:t,ref:i}){if(i=i.startsWith("refs/heads/")?i:`refs/heads/${i}`,!await H.exists({fs:a,gitdir:t,ref:i}))throw new Ge(i);const l=await H.expand({fs:a,gitdir:t,ref:i}),d=await mr({fs:a,gitdir:t,fullname:!0});if(l===d){const A=await H.resolve({fs:a,gitdir:t,ref:l});await H.writeRef({fs:a,gitdir:t,ref:"HEAD",value:A})}await H.deleteRef({fs:a,gitdir:t,ref:l});const w=Ar(i),v=await de.get({fs:a,gitdir:t});await v.deleteSection("branch",w),await de.save({fs:a,gitdir:t,config:v})}async function yc({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s}){try{J("fs",a),J("ref",s);const l=new $e(a),d=await Ne({fsp:l,dotgit:i});return await gp({fs:l,gitdir:d,ref:s})}catch(l){throw l.caller="git.deleteBranch",l}}async function bc({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s}){try{J("fs",a),J("ref",s);const l=new $e(a),d=await Ne({fsp:l,dotgit:i});await H.deleteRef({fs:l,gitdir:d,ref:s})}catch(l){throw l.caller="git.deleteRef",l}}async function mp({fs:a,gitdir:t,remote:i}){const s=await de.get({fs:a,gitdir:t});await s.deleteSection("remote",i),await de.save({fs:a,gitdir:t,config:s})}async function vc({fs:a,dir:t,gitdir:i=g(t,".git"),remote:s}){try{J("fs",a),J("remote",s);const l=new $e(a),d=await Ne({fsp:l,dotgit:i});return await mp({fs:l,gitdir:d,remote:s})}catch(l){throw l.caller="git.deleteRemote",l}}async function wp({fs:a,gitdir:t,ref:i}){i=i.startsWith("refs/tags/")?i:`refs/tags/${i}`,await H.deleteRef({fs:a,gitdir:t,ref:i})}async function xc({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s}){try{J("fs",a),J("ref",s);const l=new $e(a),d=await Ne({fsp:l,dotgit:i});return await wp({fs:l,gitdir:d,ref:s})}catch(l){throw l.caller="git.deleteTag",l}}async function yp({fs:a,gitdir:t,oid:i}){const s=i.slice(0,2);return(await a.readdir(`${t}/objects/${s}`)).map(d=>`${s}${d}`).filter(d=>d.startsWith(i))}async function bp({fs:a,cache:t,gitdir:i,oid:s,getExternalRefDelta:l}){const d=[];let w=await a.readdir(g(i,"objects/pack"));w=w.filter(v=>v.endsWith(".idx"));for(const v of w){const A=`${i}/objects/pack/${v}`,T=await Gi({fs:a,cache:t,filename:A,getExternalRefDelta:l});if(T.error)throw new y(T.error);for(const k of T.offsets.keys())k.startsWith(s)&&d.push(k)}return d}async function vp({fs:a,cache:t,gitdir:i,oid:s}){const l=v=>dt({fs:a,cache:t,gitdir:i,oid:v}),d=await yp({fs:a,gitdir:i,oid:s}),w=await bp({fs:a,cache:t,gitdir:i,oid:s,getExternalRefDelta:l});for(const v of w)d.indexOf(v)===-1&&d.push(v);if(d.length===1)return d[0];throw d.length>1?new cn("oids",s,d):new Ge(`an object matching "${s}"`)}async function _c({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,cache:l={}}){try{J("fs",a),J("gitdir",i),J("oid",s);const d=new $e(a),w=await Ne({fsp:d,dotgit:i});return await vp({fs:d,cache:l,gitdir:w,oid:s})}catch(d){throw d.caller="git.expandOid",d}}async function Sc({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s}){try{J("fs",a),J("gitdir",i),J("ref",s);const l=new $e(a),d=await Ne({fsp:l,dotgit:i});return await H.expand({fs:l,gitdir:d,ref:s})}catch(l){throw l.caller="git.expandRef",l}}async function na({fs:a,cache:t,gitdir:i,oids:s}){const l={},d=s.length;let w=s.map((v,A)=>({index:A,oid:v}));for(;w.length;){const v=new Set;for(const{oid:T,index:k}of w)l[T]||(l[T]=new Set),l[T].add(k),l[T].size===d&&v.add(T);if(v.size>0)return[...v];const A=new Map;for(const{oid:T,index:k}of w)try{const{object:j}=await dt({fs:a,cache:t,gitdir:i,oid:T}),F=mt.from(j),{parent:V}=F.parseHeaders();for(const ne of V)(!l[ne]||!l[ne].has(k))&&A.set(ne+":"+k,{oid:ne,index:k})}catch{}w=Array.from(A.values())}return[]}async function kc({fs:a,cache:t,dir:i,gitdir:s,ours:l,theirs:d,fastForward:w=!0,fastForwardOnly:v=!1,dryRun:A=!1,noUpdateBranch:T=!1,abortOnConflict:k=!0,message:j,author:F,committer:V,signingKey:ne,onSign:ge,mergeDriver:he,allowUnrelatedHistories:we=!1}){l===void 0&&(l=await mr({fs:a,gitdir:s,fullname:!0})),l=await H.expand({fs:a,gitdir:s,ref:l}),d=await H.expand({fs:a,gitdir:s,ref:d});const be=await H.resolve({fs:a,gitdir:s,ref:l}),Ae=await H.resolve({fs:a,gitdir:s,ref:d}),Pe=await na({fs:a,cache:t,gitdir:s,oids:[be,Ae]});if(Pe.length!==1)if(Pe.length===0&&we)Pe.push("4b825dc642cb6eb9a060e54bf8d69288fbee4904");else throw new Gr;const De=Pe[0];if(De===Ae)return{oid:be,alreadyMerged:!0};if(w&&De===be)return!A&&!T&&await H.writeRef({fs:a,gitdir:s,ref:l,value:Ae}),{oid:Ae,fastForward:!0};{if(v)throw new pn;const Le=await me.acquire({fs:a,gitdir:s,cache:t,allowUnmerged:!1},async Ie=>Qs({fs:a,cache:t,dir:i,gitdir:s,index:Ie,ourOid:be,theirOid:Ae,baseOid:De,ourName:Ar(l),baseName:"base",theirName:Ar(d),dryRun:A,abortOnConflict:k,mergeDriver:he}));if(Le instanceof kr)throw Le;return j||(j=`Merge branch '${Ar(d)}' into ${Ar(l)}`),{oid:await kn({fs:a,cache:t,gitdir:s,message:j,ref:l,tree:Le,parent:[be,Ae],author:F,committer:V,signingKey:ne,onSign:ge,dryRun:A,noUpdateBranch:T}),tree:Le,mergeCommit:!0}}}async function Ec({fs:a,cache:t,http:i,onProgress:s,onMessage:l,onAuth:d,onAuthSuccess:w,onAuthFailure:v,dir:A,gitdir:T,ref:k,url:j,remote:F,remoteRef:V,prune:ne,pruneTags:ge,fastForward:he,fastForwardOnly:we,corsProxy:be,singleBranch:Ae,headers:Pe,author:De,committer:Le,signingKey:Ee}){try{if(!k){const Ze=await mr({fs:a,gitdir:T});if(!Ze)throw new Ut("ref");k=Ze}const{fetchHead:Ie,fetchHeadDescription:Te}=await ra({fs:a,cache:t,http:i,onProgress:s,onMessage:l,onAuth:d,onAuthSuccess:w,onAuthFailure:v,gitdir:T,corsProxy:be,ref:k,url:j,remote:F,remoteRef:V,singleBranch:Ae,headers:Pe,prune:ne,pruneTags:ge});await kc({fs:a,cache:t,gitdir:T,ours:k,theirs:Ie,fastForward:he,fastForwardOnly:we,message:`Merge ${Te}`,author:De,committer:Le,signingKey:Ee,dryRun:!1,noUpdateBranch:!1}),await Zi({fs:a,cache:t,onProgress:s,dir:A,gitdir:T,ref:k,remote:F,noCheckout:!1})}catch(Ie){throw Ie.caller="git.pull",Ie}}async function Ic({fs:a,http:t,onProgress:i,onMessage:s,onAuth:l,onAuthSuccess:d,onAuthFailure:w,dir:v,gitdir:A=g(v,".git"),ref:T,url:k,remote:j,remoteRef:F,corsProxy:V,singleBranch:ne,headers:ge={},cache:he={}}){try{J("fs",a),J("http",t),J("gitdir",A);const we={name:"",email:"",timestamp:Date.now(),timezoneOffset:0},be=new $e(a),Ae=await Ne({fsp:be,dotgit:A});return await Ec({fs:be,cache:he,http:t,onProgress:i,onMessage:s,onAuth:l,onAuthSuccess:d,onAuthFailure:w,dir:v,gitdir:Ae,ref:T,url:k,remote:j,remoteRef:F,fastForwardOnly:!0,corsProxy:V,singleBranch:ne,headers:ge,author:we,committer:we})}catch(we){throw we.caller="git.fastForward",we}}async function Ac({fs:a,http:t,onProgress:i,onMessage:s,onAuth:l,onAuthSuccess:d,onAuthFailure:w,dir:v,gitdir:A=g(v,".git"),ref:T,remote:k,remoteRef:j,url:F,corsProxy:V,depth:ne=null,since:ge=null,exclude:he=[],relative:we=!1,tags:be=!1,singleBranch:Ae=!1,headers:Pe={},prune:De=!1,pruneTags:Le=!1,cache:Ee={}}){try{J("fs",a),J("http",t),J("gitdir",A);const Ie=new $e(a),Te=await Ne({fsp:Ie,dotgit:A});return await ra({fs:Ie,cache:Ee,http:t,onProgress:i,onMessage:s,onAuth:l,onAuthSuccess:d,onAuthFailure:w,gitdir:Te,ref:T,remote:k,remoteRef:j,url:F,corsProxy:V,depth:ne,since:ge,exclude:he,relative:we,tags:be,singleBranch:Ae,headers:Pe,prune:De,pruneTags:Le})}catch(Ie){throw Ie.caller="git.fetch",Ie}}async function Cc({fs:a,dir:t,gitdir:i=g(t,".git"),oids:s,cache:l={}}){try{J("fs",a),J("gitdir",i),J("oids",s);const d=new $e(a),w=await Ne({fsp:d,dotgit:i});return await na({fs:d,cache:l,gitdir:w,oids:s})}catch(d){throw d.caller="git.findMergeBase",d}}async function Tc({fs:a,filepath:t}){if(await a.exists(g(t,".git")))return t;{const i=ve(t);if(i===t)throw new Ge(`git root for ${t}`);return Tc({fs:a,filepath:i})}}async function Rc({fs:a,filepath:t}){try{return J("fs",a),J("filepath",t),await Tc({fs:new $e(a),filepath:t})}catch(i){throw i.caller="git.findRoot",i}}async function Oc({fs:a,dir:t,gitdir:i=g(t,".git"),path:s}){try{J("fs",a),J("gitdir",i),J("path",s);const l=new $e(a),d=await Ne({fsp:l,dotgit:i});return await Sn({fs:l,gitdir:d,path:s})}catch(l){throw l.caller="git.getConfig",l}}async function xp({fs:a,gitdir:t,path:i}){return(await de.get({fs:a,gitdir:t})).getall(i)}async function Mc({fs:a,dir:t,gitdir:i=g(t,".git"),path:s}){try{J("fs",a),J("gitdir",i),J("path",s);const l=new $e(a),d=await Ne({fsp:l,dotgit:i});return await xp({fs:l,gitdir:d,path:s})}catch(l){throw l.caller="git.getConfigAll",l}}async function Pc({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:s,corsProxy:l,url:d,headers:w={},forPush:v=!1}){try{J("http",a),J("url",d);const T=await si.getRemoteHelperFor({url:d}).discover({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:s,corsProxy:l,service:v?"git-receive-pack":"git-upload-pack",url:d,headers:w,protocolVersion:1}),k={capabilities:[...T.capabilities]};for(const[j,F]of T.refs){const V=j.split("/"),ne=V.pop();let ge=k;for(const he of V)ge[he]=ge[he]||{},ge=ge[he];ge[ne]=F}for(const[j,F]of T.symrefs){const V=j.split("/"),ne=V.pop();let ge=k;for(const he of V)ge[he]=ge[he]||{},ge=ge[he];ge[ne]=F}return k}catch(A){throw A.caller="git.getRemoteInfo",A}}function jc(a,t,i,s){const l=[];for(const[d,w]of a.refs){if(t&&!d.startsWith(t))continue;if(d.endsWith("^{}")){if(s){const A=d.replace("^{}",""),T=l[l.length-1],k=T.ref===A?T:l.find(j=>j.ref===A);if(k===void 0)throw new Error("I did not expect this to happen");k.peeled=w}continue}const v={ref:d,oid:w};i&&a.symrefs.has(d)&&(v.target=a.symrefs.get(d)),l.push(v)}return l}async function Bc({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:s,corsProxy:l,url:d,headers:w={},forPush:v=!1,protocolVersion:A=2}){try{J("http",a),J("url",d);const k=await si.getRemoteHelperFor({url:d}).discover({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:s,corsProxy:l,service:v?"git-receive-pack":"git-upload-pack",url:d,headers:w,protocolVersion:A});if(k.protocolVersion===2)return{protocolVersion:k.protocolVersion,capabilities:k.capabilities2};const j={};for(const F of k.capabilities){const[V,ne]=F.split("=");ne?j[V]=ne:j[V]=!0}return{protocolVersion:1,capabilities:j,refs:jc(k,void 0,!0,!0)}}catch(T){throw T.caller="git.getRemoteInfo2",T}}async function _p({type:a,object:t,format:i="content",oid:s=void 0}){return i!=="deflated"&&(i!=="wrapped"&&(t=Qe.wrap({type:a,object:t})),s=await Y(t)),{oid:s,object:t}}async function Fc({object:a}){try{J("object",a),typeof a=="string"?a=Buffer.from(a,"utf8"):a instanceof Uint8Array||(a=new Uint8Array(a));const t="blob",{oid:i,object:s}=await _p({type:t,format:"content",object:a});return{oid:i,type:t,object:s,format:"wrapped"}}catch(t){throw t.caller="git.hashBlob",t}}async function Sp({fs:a,cache:t,onProgress:i,dir:s,gitdir:l,filepath:d}){try{d=g(s,d);const w=await a.read(d),v=T=>dt({fs:a,cache:t,gitdir:l,oid:T}),A=await Ur.fromPack({pack:w,getExternalRefDelta:v,onProgress:i});return await a.write(d.replace(/\.pack$/,".idx"),await A.toBuffer()),{oids:[...A.hashes]}}catch(w){throw w.caller="git.indexPack",w}}async function Dc({fs:a,onProgress:t,dir:i,gitdir:s=g(i,".git"),filepath:l,cache:d={}}){try{J("fs",a),J("dir",i),J("gitdir",i),J("filepath",l);const w=new $e(a),v=await Ne({fsp:w,dotgit:s});return await Sp({fs:w,cache:d,onProgress:t,dir:i,gitdir:v,filepath:l})}catch(w){throw w.caller="git.indexPack",w}}async function Lc({fs:a,bare:t=!1,dir:i,gitdir:s=t?i:g(i,".git"),defaultBranch:l="master"}){try{J("fs",a),J("gitdir",s),t||J("dir",i);const d=new $e(a),w=await Ne({fsp:d,dotgit:s});return await pc({fs:d,bare:t,dir:i,gitdir:w,defaultBranch:l})}catch(d){throw d.caller="git.init",d}}async function $c({fs:a,cache:t,gitdir:i,oid:s,ancestor:l,depth:d}){const w=await Tn.read({fs:a,gitdir:i});if(!s)throw new Ut("oid");if(!l)throw new Ut("ancestor");if(s===l)return!1;const v=[s],A=new Set;let T=0;for(;v.length;){if(T++===d)throw new mn(d);const k=v.shift(),{type:j,object:F}=await dt({fs:a,cache:t,gitdir:i,oid:k});if(j!=="commit")throw new We(k,j,"commit");const V=mt.from(F).parse();for(const ne of V.parent)if(ne===l)return!0;if(!w.has(k))for(const ne of V.parent)A.has(ne)||(v.push(ne),A.add(ne))}return!1}async function Nc({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,ancestor:l,depth:d=-1,cache:w={}}){try{J("fs",a),J("gitdir",i),J("oid",s),J("ancestor",l);const v=new $e(a),A=await Ne({fsp:v,dotgit:i});return await $c({fs:v,cache:w,gitdir:A,oid:s,ancestor:l,depth:d})}catch(v){throw v.caller="git.isDescendent",v}}async function Uc({fs:a,dir:t,gitdir:i=g(t,".git"),filepath:s}){try{J("fs",a),J("dir",t),J("gitdir",i),J("filepath",s);const l=new $e(a),d=await Ne({fsp:l,dotgit:i});return Kr.isIgnored({fs:l,dir:t,gitdir:d,filepath:s})}catch(l){throw l.caller="git.isIgnored",l}}async function zc({fs:a,dir:t,gitdir:i=g(t,".git"),remote:s}){try{J("fs",a),J("gitdir",i);const l=new $e(a),d=await Ne({fsp:l,dotgit:i});return H.listBranches({fs:l,gitdir:d,remote:s})}catch(l){throw l.caller="git.listBranches",l}}async function kp({fs:a,gitdir:t,ref:i,cache:s}){if(i){const l=await H.resolve({gitdir:t,fs:a,ref:i}),d=[];return await Gc({fs:a,cache:s,gitdir:t,oid:l,filenames:d,prefix:""}),d}else return me.acquire({fs:a,gitdir:t,cache:s},async function(l){return l.entries.map(d=>d.path)})}async function Gc({fs:a,cache:t,gitdir:i,oid:s,filenames:l,prefix:d}){const{tree:w}=await Zr({fs:a,cache:t,gitdir:i,oid:s});for(const v of w)v.type==="tree"?await Gc({fs:a,cache:t,gitdir:i,oid:v.oid,filenames:l,prefix:g(d,v.path)}):l.push(g(d,v.path))}async function Hc({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s,cache:l={}}){try{J("fs",a),J("gitdir",i);const d=new $e(a),w=await Ne({fsp:d,dotgit:i});return await kp({fs:d,cache:l,gitdir:w,ref:s})}catch(d){throw d.caller="git.listFiles",d}}async function Ep({fs:a,cache:t,gitdir:i,ref:s}){let l;try{l=await H.resolve({gitdir:i,fs:a,ref:s})}catch(v){if(v instanceof Ge)return[]}return(await Zr({fs:a,cache:t,gitdir:i,oid:l})).tree.map(v=>({target:v.path,note:v.oid}))}async function Wc({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s="refs/notes/commits",cache:l={}}){try{J("fs",a),J("gitdir",i),J("ref",s);const d=new $e(a),w=await Ne({fsp:d,dotgit:i});return await Ep({fs:d,cache:l,gitdir:w,ref:s})}catch(d){throw d.caller="git.listNotes",d}}async function qc({fs:a,dir:t,gitdir:i=g(t,".git"),filepath:s}){try{J("fs",a),J("gitdir",i);const l=new $e(a),d=await Ne({fsp:l,dotgit:i});return H.listRefs({fs:l,gitdir:d,filepath:s})}catch(l){throw l.caller="git.listRefs",l}}async function Ip({fs:a,gitdir:t}){const i=await de.get({fs:a,gitdir:t}),s=await i.getSubsections("remote");return Promise.all(s.map(async d=>{const w=await i.get(`remote.${d}.url`);return{remote:d,url:w}}))}async function Vc({fs:a,dir:t,gitdir:i=g(t,".git")}){try{J("fs",a),J("gitdir",i);const s=new $e(a),l=await Ne({fsp:s,dotgit:i});return await Ip({fs:s,gitdir:l})}catch(s){throw s.caller="git.listRemotes",s}}async function Ap(a){const t=_t.streamReader(a),i=[];let s;for(;s=await t(),s!==!0;){if(s===null)continue;s=s.toString("utf8").replace(/\n$/,"");const[l,d,...w]=s.split(" "),v={ref:d,oid:l};for(const A of w){const[T,k]=A.split(":");T==="symref-target"?v.target=k:T==="peeled"&&(v.peeled=k)}i.push(v)}return i}async function Cp({prefix:a,symrefs:t,peelTags:i}){const s=[];return s.push(_t.encode(`command=ls-refs
`)),s.push(_t.encode(`agent=${ci.agent}
`)),(i||t||a)&&s.push(_t.delim()),i&&s.push(_t.encode("peel")),t&&s.push(_t.encode("symrefs")),a&&s.push(_t.encode(`ref-prefix ${a}`)),s.push(_t.flush()),s}async function Kc({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:s,corsProxy:l,url:d,headers:w={},forPush:v=!1,protocolVersion:A=2,prefix:T,symrefs:k,peelTags:j}){try{J("http",a),J("url",d);const F=await oi.discover({http:a,onAuth:t,onAuthSuccess:i,onAuthFailure:s,corsProxy:l,service:v?"git-receive-pack":"git-upload-pack",url:d,headers:w,protocolVersion:A});if(F.protocolVersion===1)return jc(F,T,k,j);const V=await Cp({prefix:T,symrefs:k,peelTags:j}),ne=await oi.connect({http:a,auth:F.auth,headers:w,corsProxy:l,service:v?"git-receive-pack":"git-upload-pack",url:d,body:V});return Ap(ne.body)}catch(F){throw F.caller="git.listServerRefs",F}}async function Zc({fs:a,dir:t,gitdir:i=g(t,".git")}){try{J("fs",a),J("gitdir",i);const s=new $e(a),l=await Ne({fsp:s,dotgit:i});return H.listTags({fs:s,gitdir:l})}catch(s){throw s.caller="git.listTags",s}}function Tp(a,t){return a.committer.timestamp-t.committer.timestamp}const Rp="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function Xc({fs:a,cache:t,gitdir:i,oid:s,fileId:l}){if(l===Rp)return;const d=s;let w;const v=await qr({fs:a,cache:t,gitdir:i,oid:s}),A=v.tree;return l===v.oid?w=v.path:(w=await Yc({fs:a,cache:t,gitdir:i,tree:A,fileId:l,oid:d}),Array.isArray(w)&&(w.length===0?w=void 0:w.length===1&&(w=w[0]))),w}async function Yc({fs:a,cache:t,gitdir:i,tree:s,fileId:l,oid:d,filepaths:w=[],parentPath:v=""}){const A=s.entries().map(function(T){let k;return T.oid===l?(k=g(v,T.path),w.push(k)):T.type==="tree"&&(k=dt({fs:a,cache:t,gitdir:i,oid:T.oid}).then(function({object:j}){return Yc({fs:a,cache:t,gitdir:i,tree:Ce.from(j),fileId:l,oid:d,filepaths:w,parentPath:g(v,T.path)})})),k});return await Promise.all(A),w}async function Op({fs:a,cache:t,gitdir:i,filepath:s,ref:l,depth:d,since:w,force:v,follow:A}){const T=typeof w>"u"?void 0:Math.floor(w.valueOf()/1e3),k=[],j=await Tn.read({fs:a,gitdir:i}),F=await H.resolve({fs:a,gitdir:i,ref:l}),V=[await ir({fs:a,cache:t,gitdir:i,oid:F})];let ne,ge,he;function we(be){he&&s&&k.push(be)}for(;V.length>0;){const be=V.pop();if(T!==void 0&&be.commit.committer.timestamp<=T)break;if(s){let Ae;try{Ae=await En({fs:a,cache:t,gitdir:i,oid:be.commit.tree,filepath:s}),ge&&ne!==Ae&&k.push(ge),ne=Ae,ge=be,he=!0}catch(Pe){if(Pe instanceof Ge){let De=A&&ne;if(De&&(De=await Xc({fs:a,cache:t,gitdir:i,oid:be.commit.tree,fileId:ne}),De))if(Array.isArray(De)){if(ge){const Le=await Xc({fs:a,cache:t,gitdir:i,oid:ge.commit.tree,fileId:ne});if(Array.isArray(Le))if(De=De.filter(Ee=>Le.indexOf(Ee)===-1),De.length===1)De=De[0],s=De,ge&&k.push(ge);else{De=!1,ge&&k.push(ge);break}}}else s=De,ge&&k.push(ge);if(!De){if(he&&ne&&(k.push(ge),!v))break;if(!v&&!A)throw Pe}ge=be,he=!1}else throw Pe}}else k.push(be);if(d!==void 0&&k.length===d){we(be);break}if(!j.has(be.oid))for(const Ae of be.commit.parent){const Pe=await ir({fs:a,cache:t,gitdir:i,oid:Ae});V.map(De=>De.oid).includes(Pe.oid)||V.push(Pe)}V.length===0&&we(be),V.sort((Ae,Pe)=>Tp(Ae.commit,Pe.commit))}return k}async function Jc({fs:a,dir:t,gitdir:i=g(t,".git"),filepath:s,ref:l="HEAD",depth:d,since:w,force:v,follow:A,cache:T={}}){try{J("fs",a),J("gitdir",i),J("ref",l);const k=new $e(a),j=await Ne({fsp:k,dotgit:i});return await Op({fs:k,cache:T,gitdir:j,filepath:s,ref:l,depth:d,since:w,force:v,follow:A})}catch(k){throw k.caller="git.log",k}}async function Qc({fs:a,onSign:t,dir:i,gitdir:s=g(i,".git"),ours:l,theirs:d,fastForward:w=!0,fastForwardOnly:v=!1,dryRun:A=!1,noUpdateBranch:T=!1,abortOnConflict:k=!0,message:j,author:F,committer:V,signingKey:ne,cache:ge={},mergeDriver:he,allowUnrelatedHistories:we=!1}){try{J("fs",a),ne&&J("onSign",t);const be=new $e(a),Ae=await Ne({fsp:be,dotgit:s}),Pe=await gr({fs:be,gitdir:Ae,author:F});if(!Pe&&(!v||!w))throw new Rt("author");const De=await Ir({fs:be,gitdir:Ae,author:Pe,committer:V});if(!De&&(!v||!w))throw new Rt("committer");return await kc({fs:be,cache:ge,dir:i,gitdir:Ae,ours:l,theirs:d,fastForward:w,fastForwardOnly:v,dryRun:A,noUpdateBranch:T,abortOnConflict:k,message:j,author:Pe,committer:De,signingKey:ne,onSign:t,mergeDriver:he,allowUnrelatedHistories:we})}catch(be){throw be.caller="git.merge",be}}const Mp={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function el({fs:a,cache:t,dir:i,gitdir:s=g(i,".git"),oids:l}){const d=new r,w=[];function v(k,j){const F=Buffer.from(k,j);w.push(F),d.update(F)}async function A({stype:k,object:j}){const F=Mp[k];let V=j.length,ne=V>15?128:0;const ge=V&15;V=V>>>4;let he=(ne|F|ge).toString(16);for(v(he,"hex");ne;)ne=V>127?128:0,he=ne|V&127,v(Qi(2,he),"hex"),V=V>>>7;v(Buffer.from(await $s(j)))}v("PACK"),v("00000002","hex"),v(Qi(8,l.length),"hex");for(const k of l){const{type:j,object:F}=await dt({fs:a,cache:t,gitdir:s,oid:k});await A({object:F,stype:j})}const T=d.digest();return w.push(T),w}async function Pp({fs:a,cache:t,gitdir:i,oids:s,write:l}){const d=await el({fs:a,cache:t,gitdir:i,oids:s}),w=Buffer.from(await ai(d)),A=`pack-${w.slice(-20).toString("hex")}.pack`;return l?(await a.write(g(i,`objects/pack/${A}`),w),{filename:A}):{filename:A,packfile:new Uint8Array(w)}}async function tl({fs:a,dir:t,gitdir:i=g(t,".git"),oids:s,write:l=!1,cache:d={}}){try{J("fs",a),J("gitdir",i),J("oids",s);const w=new $e(a),v=await Ne({fsp:w,dotgit:i});return await Pp({fs:w,cache:d,gitdir:v,oids:s,write:l})}catch(w){throw w.caller="git.packObjects",w}}async function rl({fs:a,http:t,onProgress:i,onMessage:s,onAuth:l,onAuthSuccess:d,onAuthFailure:w,dir:v,gitdir:A=g(v,".git"),ref:T,url:k,remote:j,remoteRef:F,prune:V=!1,pruneTags:ne=!1,fastForward:ge=!0,fastForwardOnly:he=!1,corsProxy:we,singleBranch:be,headers:Ae={},author:Pe,committer:De,signingKey:Le,cache:Ee={}}){try{J("fs",a),J("gitdir",A);const Ie=new $e(a),Te=await Ne({fsp:Ie,dotgit:A}),Ze=await gr({fs:Ie,gitdir:Te,author:Pe});if(!Ze)throw new Rt("author");const ct=await Ir({fs:Ie,gitdir:Te,author:Ze,committer:De});if(!ct)throw new Rt("committer");return await Ec({fs:Ie,cache:Ee,http:t,onProgress:i,onMessage:s,onAuth:l,onAuthSuccess:d,onAuthFailure:w,dir:v,gitdir:Te,ref:T,url:k,remote:j,remoteRef:F,fastForward:ge,fastForwardOnly:he,corsProxy:we,singleBranch:be,headers:Ae,author:Ze,committer:ct,signingKey:Le,prune:V,pruneTags:ne})}catch(Ie){throw Ie.caller="git.pull",Ie}}async function jp({fs:a,cache:t,dir:i,gitdir:s=g(i,".git"),start:l,finish:d}){const w=await Tn.read({fs:a,gitdir:s}),v=new Set,A=new Set;for(const j of l)v.add(await H.resolve({fs:a,gitdir:s,ref:j}));for(const j of d)try{const F=await H.resolve({fs:a,gitdir:s,ref:j});A.add(F)}catch{}const T=new Set;async function k(j){T.add(j);const{type:F,object:V}=await dt({fs:a,cache:t,gitdir:s,oid:j});if(F==="tag"){const ge=$t.from(V).headers().object;return k(ge)}if(F!=="commit")throw new We(j,F,"commit");if(!w.has(j)){const ge=mt.from(V).headers().parent;for(j of ge)!A.has(j)&&!T.has(j)&&await k(j)}}for(const j of v)await k(j);return T}async function ia({fs:a,cache:t,dir:i,gitdir:s=g(i,".git"),oids:l}){const d=new Set;async function w(v){if(d.has(v))return;d.add(v);const{type:A,object:T}=await dt({fs:a,cache:t,gitdir:s,oid:v});if(A==="tag"){const j=$t.from(T).headers().object;await w(j)}else if(A==="commit"){const j=mt.from(T).headers().tree;await w(j)}else if(A==="tree"){const k=Ce.from(T);for(const j of k)j.type==="blob"&&d.add(j.oid),j.type==="tree"&&await w(j.oid)}}for(const v of l)await w(v);return d}async function Bp(a){const t={};let i="";const s=_t.streamReader(a);let l=await s();for(;l!==!0;)l!==null&&(i+=l.toString("utf8")+`
`),l=await s();const d=i.toString("utf8").split(`
`);if(l=d.shift(),!l.startsWith("unpack "))throw new Er('unpack ok" or "unpack [error message]',l);t.ok=l==="unpack ok",t.ok||(t.error=l.slice(7)),t.refs={};for(const w of d){if(w.trim()==="")continue;const v=w.slice(0,2),A=w.slice(3);let T=A.indexOf(" ");T===-1&&(T=A.length);const k=A.slice(0,T),j=A.slice(T+1);t.refs[k]={ok:v==="ok",error:j}}return t}async function Fp({capabilities:a=[],triplets:t=[]}){const i=[];let s=`\0 ${a.join(" ")}`;for(const l of t)i.push(_t.encode(`${l.oldoid} ${l.oid} ${l.fullRef}${s}
`)),s="";return i.push(_t.flush()),i}async function Dp({fs:a,cache:t,http:i,onProgress:s,onMessage:l,onAuth:d,onAuthSuccess:w,onAuthFailure:v,onPrePush:A,gitdir:T,ref:k,remoteRef:j,remote:F,url:V,force:ne=!1,delete:ge=!1,corsProxy:he,headers:we={}}){const be=k||await mr({fs:a,gitdir:T});if(typeof be>"u")throw new Ut("ref");const Ae=await de.get({fs:a,gitdir:T});F=F||await Ae.get(`branch.${be}.pushRemote`)||await Ae.get("remote.pushDefault")||await Ae.get(`branch.${be}.remote`)||"origin";const Pe=V||await Ae.get(`remote.${F}.pushurl`)||await Ae.get(`remote.${F}.url`);if(typeof Pe>"u")throw new Ut("remote OR url");const De=j||await Ae.get(`branch.${be}.merge`);if(typeof Pe>"u")throw new Ut("remoteRef");he===void 0&&(he=await Ae.get("http.corsProxy"));const Le=await H.expand({fs:a,gitdir:T,ref:be}),Ee=ge?"0000000000000000000000000000000000000000":await H.resolve({fs:a,gitdir:T,ref:Le}),Ie=si.getRemoteHelperFor({url:Pe}),Te=await Ie.discover({http:i,onAuth:d,onAuthSuccess:w,onAuthFailure:v,corsProxy:he,service:"git-receive-pack",url:Pe,headers:we,protocolVersion:1}),Ze=Te.auth;let ct;if(!De)ct=Le;else try{ct=await H.expandAgainstMap({ref:De,map:Te.refs})}catch(bt){if(bt instanceof Ge)ct=De.startsWith("refs/")?De:`refs/heads/${De}`;else throw bt}const It=Te.refs.get(ct)||"0000000000000000000000000000000000000000";if(A&&!await A({remote:F,url:Pe,localRef:{ref:ge?"(delete)":Le,oid:Ee},remoteRef:{ref:ct,oid:It}}))throw new Wr;const lt=!Te.capabilities.has("no-thin");let Ct=new Set;if(!ge){const bt=[...Te.refs.values()];let ar=new Set;if(It!=="0000000000000000000000000000000000000000"){const Dt=await na({fs:a,cache:t,gitdir:T,oids:[Ee,It]});for(const Rn of Dt)bt.push(Rn);lt&&(ar=await ia({fs:a,cache:t,gitdir:T,oids:Dt}))}if(!bt.includes(Ee)){const Dt=await jp({fs:a,cache:t,gitdir:T,start:[Ee],finish:bt});Ct=await ia({fs:a,cache:t,gitdir:T,oids:Dt})}if(lt){try{const Dt=await H.resolve({fs:a,gitdir:T,ref:`refs/remotes/${F}/HEAD`,depth:2}),{oid:Rn}=await H.resolveAgainstMap({ref:Dt.replace(`refs/remotes/${F}/`,""),fullref:Dt,map:Te.refs}),Or=[Rn];for(const At of await ia({fs:a,cache:t,gitdir:T,oids:Or}))ar.add(At)}catch{}for(const Dt of ar)Ct.delete(Dt)}if(Ee===It&&(ne=!0),!ne){if(Le.startsWith("refs/tags")&&It!=="0000000000000000000000000000000000000000")throw new Hr("tag-exists");if(Ee!=="0000000000000000000000000000000000000000"&&It!=="0000000000000000000000000000000000000000"&&!await $c({fs:a,cache:t,gitdir:T,oid:Ee,ancestor:It,depth:-1}))throw new Hr("not-fast-forward")}}const Ot=fc([...Te.capabilities],["report-status","side-band-64k",`agent=${ci.agent}`]),Tr=await Fp({capabilities:Ot,triplets:[{oldoid:It,oid:Ee,fullRef:ct}]}),Rr=ge?[]:await el({fs:a,cache:t,gitdir:T,oids:[...Ct]}),Yr=await Ie.connect({http:i,onProgress:s,corsProxy:he,service:"git-receive-pack",url:Pe,auth:Ze,headers:we,body:[...Tr,...Rr]}),{packfile:oa,progress:sa}=await hc.demux(Yr.body);if(l){const bt=dc(sa);Cn(bt,async ar=>{await l(ar)})}const Ht=await Bp(oa);if(Yr.headers&&(Ht.headers=Yr.headers),F&&Ht.ok&&Ht.refs[ct].ok&&!Le.startsWith("refs/tags")){const bt=`refs/remotes/${F}/${ct.replace("refs/heads","")}`;ge?await H.deleteRef({fs:a,gitdir:T,ref:bt}):await H.writeRef({fs:a,gitdir:T,ref:bt,value:Ee})}if(Ht.ok&&Object.values(Ht.refs).every(bt=>bt.ok))return Ht;{const bt=Object.entries(Ht.refs).filter(([ar,Dt])=>!Dt.ok).map(([ar,Dt])=>`
  - ${ar}: ${Dt.error}`).join("");throw new gn(bt,Ht)}}async function nl({fs:a,http:t,onProgress:i,onMessage:s,onAuth:l,onAuthSuccess:d,onAuthFailure:w,onPrePush:v,dir:A,gitdir:T=g(A,".git"),ref:k,remoteRef:j,remote:F="origin",url:V,force:ne=!1,delete:ge=!1,corsProxy:he,headers:we={},cache:be={}}){try{J("fs",a),J("http",t),J("gitdir",T);const Ae=new $e(a),Pe=await Ne({fsp:Ae,dotgit:T});return await Dp({fs:Ae,cache:be,http:t,onProgress:i,onMessage:s,onAuth:l,onAuthSuccess:d,onAuthFailure:w,onPrePush:v,gitdir:Pe,ref:k,remoteRef:j,remote:F,url:V,force:ne,delete:ge,corsProxy:he,headers:we})}catch(Ae){throw Ae.caller="git.push",Ae}}async function il({fs:a,cache:t,gitdir:i,oid:s}){const{type:l,object:d}=await dt({fs:a,cache:t,gitdir:i,oid:s});if(l==="tag")return s=$t.from(d).parse().object,il({fs:a,cache:t,gitdir:i,oid:s});if(l!=="blob")throw new We(s,l,"blob");return{oid:s,blob:new Uint8Array(d)}}async function al({fs:a,cache:t,gitdir:i,oid:s,filepath:l=void 0}){return l!==void 0&&(s=await En({fs:a,cache:t,gitdir:i,oid:s,filepath:l})),await il({fs:a,cache:t,gitdir:i,oid:s})}async function ol({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,filepath:l,cache:d={}}){try{J("fs",a),J("gitdir",i),J("oid",s);const w=new $e(a),v=await Ne({fsp:w,dotgit:i});return await al({fs:w,cache:d,gitdir:v,oid:s,filepath:l})}catch(w){throw w.caller="git.readBlob",w}}async function aa({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,cache:l={}}){try{J("fs",a),J("gitdir",i),J("oid",s);const d=new $e(a),w=await Ne({fsp:d,dotgit:i});return await ir({fs:d,cache:l,gitdir:w,oid:s})}catch(d){throw d.caller="git.readCommit",d}}async function Lp({fs:a,cache:t,gitdir:i,ref:s="refs/notes/commits",oid:l}){const d=await H.resolve({gitdir:i,fs:a,ref:s}),{blob:w}=await al({fs:a,cache:t,gitdir:i,oid:d,filepath:l});return w}async function sl({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s="refs/notes/commits",oid:l,cache:d={}}){try{J("fs",a),J("gitdir",i),J("ref",s),J("oid",l);const w=new $e(a),v=await Ne({fsp:w,dotgit:i});return await Lp({fs:w,cache:d,gitdir:v,ref:s,oid:l})}catch(w){throw w.caller="git.readNote",w}}async function cl({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,format:l="parsed",filepath:d=void 0,encoding:w=void 0,cache:v={}}){try{J("fs",a),J("gitdir",i),J("oid",s);const A=new $e(a),T=await Ne({fsp:A,dotgit:i});d!==void 0&&(s=await En({fs:A,cache:v,gitdir:T,oid:s,filepath:d}));const j=await dt({fs:A,cache:v,gitdir:T,oid:s,format:l==="parsed"?"content":l});if(j.oid=s,l==="parsed")switch(j.format="parsed",j.type){case"commit":j.object=mt.from(j.object).parse();break;case"tree":j.object=Ce.from(j.object).entries();break;case"blob":w?j.object=j.object.toString(w):(j.object=new Uint8Array(j.object),j.format="content");break;case"tag":j.object=$t.from(j.object).parse();break;default:throw new We(j.oid,j.type,"blob|commit|tag|tree")}else(j.format==="deflated"||j.format==="wrapped")&&(j.type=j.format);return j}catch(A){throw A.caller="git.readObject",A}}async function $p({fs:a,cache:t,gitdir:i,oid:s}){const{type:l,object:d}=await dt({fs:a,cache:t,gitdir:i,oid:s,format:"content"});if(l!=="tag")throw new We(s,l,"tag");const w=$t.from(d);return{oid:s,tag:w.parse(),payload:w.payload()}}async function ll({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,cache:l={}}){try{J("fs",a),J("gitdir",i),J("oid",s);const d=new $e(a),w=await Ne({fsp:d,dotgit:i});return await $p({fs:d,cache:l,gitdir:w,oid:s})}catch(d){throw d.caller="git.readTag",d}}async function ul({fs:a,dir:t,gitdir:i=g(t,".git"),oid:s,filepath:l=void 0,cache:d={}}){try{J("fs",a),J("gitdir",i),J("oid",s);const w=new $e(a),v=await Ne({fsp:w,dotgit:i});return await Zr({fs:w,cache:d,gitdir:v,oid:s,filepath:l})}catch(w){throw w.caller="git.readTree",w}}async function fl({fs:a,dir:t,gitdir:i=g(t,".git"),filepath:s,cache:l={}}){try{J("fs",a),J("gitdir",i),J("filepath",s);const d=new $e(a),w=await Ne({fsp:d,dotgit:i});await me.acquire({fs:d,gitdir:w,cache:l},async function(v){v.delete({filepath:s})})}catch(d){throw d.caller="git.remove",d}}async function Np({fs:a,cache:t,onSign:i,gitdir:s,ref:l="refs/notes/commits",oid:d,author:w,committer:v,signingKey:A}){let T;try{T=await H.resolve({gitdir:s,fs:a,ref:l})}catch(ne){if(!(ne instanceof Ge))throw ne}let j=(await Zr({fs:a,cache:t,gitdir:s,oid:T||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;j=j.filter(ne=>ne.path!==d);const F=await In({fs:a,gitdir:s,tree:j});return await kn({fs:a,cache:t,onSign:i,gitdir:s,ref:l,tree:F,parent:T&&[T],message:`Note removed by 'isomorphic-git removeNote'
`,author:w,committer:v,signingKey:A})}async function dl({fs:a,onSign:t,dir:i,gitdir:s=g(i,".git"),ref:l="refs/notes/commits",oid:d,author:w,committer:v,signingKey:A,cache:T={}}){try{J("fs",a),J("gitdir",s),J("oid",d);const k=new $e(a),j=await Ne({fsp:k,dotgit:s}),F=await gr({fs:k,gitdir:j,author:w});if(!F)throw new Rt("author");const V=await Ir({fs:k,gitdir:j,author:F,committer:v});if(!V)throw new Rt("committer");return await Np({fs:k,cache:T,onSign:t,gitdir:j,ref:l,oid:d,author:F,committer:V,signingKey:A})}catch(k){throw k.caller="git.removeNote",k}}async function Up({fs:a,gitdir:t,oldref:i,ref:s,checkout:l=!1}){if(!An(s))throw new er(s,f.clean(s));if(!An(i))throw new er(i,f.clean(i));const d=`refs/heads/${i}`,w=`refs/heads/${s}`;if(await H.exists({fs:a,gitdir:t,ref:w}))throw new Qt("branch",s,!1);const A=await H.resolve({fs:a,gitdir:t,ref:d,depth:1});await H.writeRef({fs:a,gitdir:t,ref:w,value:A}),await H.deleteRef({fs:a,gitdir:t,ref:d});const k=await mr({fs:a,gitdir:t,fullname:!0})===d;(l||k)&&await H.writeSymbolicRef({fs:a,gitdir:t,ref:"HEAD",value:w})}async function hl({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s,oldref:l,checkout:d=!1}){try{J("fs",a),J("gitdir",i),J("ref",s),J("oldref",l);const w=new $e(a),v=await Ne({fsp:w,dotgit:i});return await Up({fs:w,gitdir:v,ref:s,oldref:l,checkout:d})}catch(w){throw w.caller="git.renameBranch",w}}async function pl({gitdir:a,type:t,object:i}){return Y(Qe.wrap({type:t,object:i}))}async function gl({fs:a,dir:t,gitdir:i=g(t,".git"),filepath:s,ref:l,cache:d={}}){try{J("fs",a),J("gitdir",i),J("filepath",s);const w=new $e(a),v=await Ne({fsp:w,dotgit:i});let A,T;try{A=await H.resolve({fs:w,gitdir:v,ref:l||"HEAD"})}catch(F){if(l)throw F}if(A)try{A=await En({fs:w,cache:d,gitdir:v,oid:A,filepath:s})}catch{A=null}let k={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const j=t&&await w.read(g(t,s));j&&(T=await pl({gitdir:v,type:"blob",object:j}),A===T&&(k=await w.lstat(g(t,s)))),await me.acquire({fs:w,gitdir:v,cache:d},async function(F){F.delete({filepath:s}),A&&F.insert({filepath:s,stats:k,oid:A})})}catch(w){throw w.caller="git.reset",w}}async function ml({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s,depth:l}){try{J("fs",a),J("gitdir",i),J("ref",s);const d=new $e(a),w=await Ne({fsp:d,dotgit:i});return await H.resolve({fs:d,gitdir:w,ref:s,depth:l})}catch(d){throw d.caller="git.resolveRef",d}}async function wl({fs:a,dir:t,gitdir:i=g(t,".git"),path:s,value:l,append:d=!1}){try{J("fs",a),J("gitdir",i),J("path",s);const w=new $e(a),v=await Ne({fsp:w,dotgit:i}),A=await de.get({fs:w,gitdir:v});d?await A.append(s,l):await A.set(s,l),await de.save({fs:w,gitdir:v,config:A})}catch(w){throw w.caller="git.setConfig",w}}async function yl({fs:a,gitdir:t,commit:i}){const s=mt.from(i).toObject();return await zt({fs:a,gitdir:t,type:"commit",object:s,format:"content"})}class ui{static get timezoneOffsetForRefLogEntry(){const t=new Date().getTimezoneOffset(),i=Math.abs(Math.floor(t/60)),s=Math.abs(t%60).toString().padStart(2,"0");return`${t>0?"-":"+"}${i.toString().padStart(2,"0")}${s}`}static createStashReflogEntry(t,i,s){const l=t.name.replace(/\s/g,""),d="0000000000000000000000000000000000000000",w=Math.floor(Date.now()/1e3),v=ui.timezoneOffsetForRefLogEntry;return`${d} ${i} ${l} ${t.email} ${w} ${v}	${s}
`}static getStashReflogEntry(t,i=!1){return t.split(`
`).filter(d=>d).reverse().map((d,w)=>i?`stash@{${w}}: ${d.split("	")[1]}`:d)}}class lr{constructor({fs:t,dir:i,gitdir:s=g(i,".git")}){Object.assign(this,{fs:t,dir:i,gitdir:s,_author:null})}static get refStash(){return"refs/stash"}static get refLogsStash(){return"logs/refs/stash"}get refStashPath(){return g(this.gitdir,lr.refStash)}get refLogsStashPath(){return g(this.gitdir,lr.refLogsStash)}async getAuthor(){if(!this._author&&(this._author=await gr({fs:this.fs,gitdir:this.gitdir,author:{}}),!this._author))throw new Rt("author");return this._author}async getStashSHA(t,i){return await this.fs.exists(this.refStashPath)?(i||await this.readStashReflogs({parsed:!1}))[t].split(" ")[1]:null}async writeStashCommit({message:t,tree:i,parent:s}){return yl({fs:this.fs,gitdir:this.gitdir,commit:{message:t,tree:i,parent:s,author:await this.getAuthor(),committer:await this.getAuthor()}})}async readStashCommit(t){const i=await this.readStashReflogs({parsed:!1});if(t!==0&&(t<0||t>i.length-1))throw new er(`stash@${t}`,"number that is in range of [0, num of stash pushed]");const s=await this.getStashSHA(t,i);return s?ir({fs:this.fs,cache:{},gitdir:this.gitdir,oid:s}):{}}async writeStashRef(t){return H.writeRef({fs:this.fs,gitdir:this.gitdir,ref:lr.refStash,value:t})}async writeStashReflogEntry({stashCommit:t,message:i}){const s=await this.getAuthor(),l=ui.createStashReflogEntry(s,t,i),d=this.refLogsStashPath;await Xr({filepath:d,entry:l},async()=>{const w=await this.fs.exists(d)?await this.fs.read(d,"utf8"):"";await this.fs.write(d,w+l,"utf8")})}async readStashReflogs({parsed:t=!1}){if(!await this.fs.exists(this.refLogsStashPath))return[];const i=await this.fs.read(this.refLogsStashPath,"utf8");return ui.getStashReflogEntry(i,t)}}async function bl({fs:a,dir:t,gitdir:i,message:s=""}){const l=new lr({fs:a,dir:t,gitdir:i});await l.getAuthor();const d=await mr({fs:a,gitdir:i,fullname:!1}),w=await H.resolve({fs:a,gitdir:i,ref:"HEAD"}),A=(await aa({fs:a,dir:t,gitdir:i,oid:w})).commit.message,T=[w];let k=null,j=Gt({ref:"HEAD"});const F=await ec({fs:a,dir:t,gitdir:i,treePair:[Gt({ref:"HEAD"}),"stage"]});if(F){const he=await l.writeStashCommit({message:`stash-Index: WIP on ${d} - ${new Date().toISOString()}`,tree:F,parent:T});T.push(he),k=F,j=Je()}const V=await ec({fs:a,dir:t,gitdir:i,treePair:[j,"workdir"]});if(V){const he=await l.writeStashCommit({message:`stash-WorkDir: WIP on ${d} - ${new Date().toISOString()}`,tree:V,parent:[T[T.length-1]]});T.push(he),k=V}if(!k||!F&&!V)throw new Ge("changes, nothing to stash");const ne=(s.trim()||`WIP on ${d}`)+`: ${w.substring(0,7)} ${A}`;return{stashCommit:await l.writeStashCommit({message:ne,tree:k,parent:T}),stashMsg:ne,branch:d,stashMgr:l}}async function zp({fs:a,dir:t,gitdir:i,message:s=""}){const{stashCommit:l,stashMsg:d,branch:w,stashMgr:v}=await bl({fs:a,dir:t,gitdir:i,message:s});return await v.writeStashRef(l),await v.writeStashReflogEntry({stashCommit:l,message:d}),await Xi({fs:a,dir:t,gitdir:i,ref:w,track:!1,force:!0}),l}async function Gp({fs:a,dir:t,gitdir:i,message:s=""}){const{stashCommit:l}=await bl({fs:a,dir:t,gitdir:i,message:s});return l}async function vl({fs:a,dir:t,gitdir:i,refIdx:s=0}){const d=await new lr({fs:a,dir:t,gitdir:i}).readStashCommit(s),{parent:w=null}=d.commit?d.commit:{};if(!(!w||!Array.isArray(w)))for(let v=0;v<w.length-1;v++){const T=(await ir({fs:a,cache:{},gitdir:i,oid:w[v+1]})).commit.message.startsWith("stash-Index");await tc({fs:a,dir:t,gitdir:i,stashCommit:w[v+1],parentCommit:w[v],wasStaged:T})}}async function xl({fs:a,dir:t,gitdir:i,refIdx:s=0}){const l=new lr({fs:a,dir:t,gitdir:i});if(!(await l.readStashCommit(s)).commit)return;const w=l.refStashPath;await Xr(w,async()=>{await a.exists(w)&&await a.rm(w)});const v=await l.readStashReflogs({parsed:!1});if(!v.length)return;v.splice(s,1);const A=l.refLogsStashPath;await Xr({reflogEntries:v,stashReflogPath:A,stashMgr:l},async()=>{if(v.length){await a.write(A,v.reverse().join(`
`)+`
`,"utf8");const T=v[v.length-1].split(" ")[1];await l.writeStashRef(T)}else await a.rm(A)})}async function Hp({fs:a,dir:t,gitdir:i}){return new lr({fs:a,dir:t,gitdir:i}).readStashReflogs({parsed:!0})}async function Wp({fs:a,dir:t,gitdir:i}){const s=new lr({fs:a,dir:t,gitdir:i}),l=[s.refStashPath,s.refLogsStashPath];await Xr(l,async()=>{await Promise.all(l.map(async d=>{if(await a.exists(d))return a.rm(d)}))})}async function qp({fs:a,dir:t,gitdir:i,refIdx:s=0}){await vl({fs:a,dir:t,gitdir:i,refIdx:s}),await xl({fs:a,dir:t,gitdir:i,refIdx:s})}async function _l({fs:a,dir:t,gitdir:i=g(t,".git"),op:s="push",message:l="",refIdx:d=0}){J("fs",a),J("dir",t),J("gitdir",i),J("op",s);const w={push:zp,apply:vl,drop:xl,list:Hp,clear:Wp,pop:qp,create:Gp},v=["apply","drop","pop"];try{const A=new $e(a),T=await Ne({fsp:A,dotgit:i});["refs","logs","logs/refs"].map(F=>g(T,F)).forEach(async F=>{await A.exists(F)||await A.mkdir(F)});const j=w[s];if(j){if(v.includes(s)&&d<0)throw new er(`stash@${d}`,"number that is in range of [0, num of stash pushed]");return await j({fs:A,dir:t,gitdir:T,message:l,refIdx:d})}throw new Error(`To be implemented: ${s}`)}catch(A){throw A.caller="git.stash",A}}async function Sl({fs:a,dir:t,gitdir:i=g(t,".git"),filepath:s,cache:l={}}){try{J("fs",a),J("gitdir",i),J("filepath",s);const d=new $e(a),w=await Ne({fsp:d,dotgit:i});if(await Kr.isIgnored({fs:d,gitdir:w,dir:t,filepath:s}))return"ignored";const A=await Vp({fs:d,cache:l,gitdir:w}),T=await kl({fs:d,cache:l,gitdir:w,tree:A,path:s}),k=await me.acquire({fs:d,gitdir:w,cache:l},async function(he){for(const we of he)if(we.path===s)return we;return null}),j=await d.lstat(g(t,s)),F=T!==null,V=k!==null,ne=j!==null,ge=async()=>{if(V&&!se(k,j))return k.oid;{const he=await d.read(g(t,s)),we=await pl({gitdir:w,type:"blob",object:he});return V&&k.oid===we&&j.size!==-1&&me.acquire({fs:d,gitdir:w,cache:l},async function(be){be.insert({filepath:s,stats:j,oid:we})}),we}};if(!F&&!ne&&!V)return"absent";if(!F&&!ne&&V)return"*absent";if(!F&&ne&&!V)return"*added";if(!F&&ne&&V)return await ge()===k.oid?"added":"*added";if(F&&!ne&&!V)return"deleted";if(F&&!ne&&V)return T===k.oid,"*deleted";if(F&&ne&&!V)return await ge()===T?"*undeleted":"*undeletemodified";if(F&&ne&&V){const he=await ge();return he===T?he===k.oid?"unmodified":"*unmodified":he===k.oid?"modified":"*modified"}}catch(d){throw d.caller="git.status",d}}async function kl({fs:a,cache:t,gitdir:i,tree:s,path:l}){typeof l=="string"&&(l=l.split("/"));const d=l.shift();for(const w of s)if(w.path===d){if(l.length===0)return w.oid;const{type:v,object:A}=await dt({fs:a,cache:t,gitdir:i,oid:w.oid});if(v==="tree"){const T=Ce.from(A);return kl({fs:a,cache:t,gitdir:i,tree:T,path:l})}if(v==="blob")throw new We(w.oid,v,"blob",l.join("/"))}return null}async function Vp({fs:a,cache:t,gitdir:i}){let s;try{s=await H.resolve({fs:a,gitdir:i,ref:"HEAD"})}catch(d){if(d instanceof Ge)return[]}const{tree:l}=await Zr({fs:a,cache:t,gitdir:i,oid:s});return l}async function El({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s="HEAD",filepaths:l=["."],filter:d,cache:w={},ignored:v=!1}){try{J("fs",a),J("gitdir",i),J("ref",s);const A=new $e(a),T=await Ne({fsp:A,dotgit:i});return await pr({fs:A,cache:w,dir:t,gitdir:T,trees:[Gt({ref:s}),Vr(),Je()],map:async function(k,[j,F,V]){if(!j&&!V&&F&&!v&&await Kr.isIgnored({fs:A,dir:t,filepath:k})||!l.some(Ee=>Ys(k,Ee)))return null;if(d&&!d(k))return;const[ne,ge,he]=await Promise.all([j&&j.type(),F&&F.type(),V&&V.type()]),we=[ne,ge,he].includes("blob");if((ne==="tree"||ne==="special")&&!we)return;if(ne==="commit")return null;if((ge==="tree"||ge==="special")&&!we)return;if(he==="commit")return null;if((he==="tree"||he==="special")&&!we)return;const be=ne==="blob"?await j.oid():void 0,Ae=he==="blob"?await V.oid():void 0;let Pe;ne!=="blob"&&ge==="blob"&&he!=="blob"?Pe="42":ge==="blob"&&(Pe=await F.oid());const De=[void 0,be,Pe,Ae],Le=De.map(Ee=>De.indexOf(Ee));return Le.shift(),[k,...Le]}})}catch(A){throw A.caller="git.statusMatrix",A}}async function Il({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s,object:l,force:d=!1}){try{J("fs",a),J("gitdir",i),J("ref",s);const w=new $e(a);if(s===void 0)throw new Ut("ref");s=s.startsWith("refs/tags/")?s:`refs/tags/${s}`;const v=await Ne({fsp:w,dotgit:i}),A=await H.resolve({fs:w,gitdir:v,ref:l||"HEAD"});if(!d&&await H.exists({fs:w,gitdir:v,ref:s}))throw new Qt("tag",s);await H.writeRef({fs:w,gitdir:v,ref:s,value:A})}catch(w){throw w.caller="git.tag",w}}async function Al({fs:a,dir:t,gitdir:i=g(t,".git"),cache:s={},filepath:l,oid:d,mode:w,add:v,remove:A,force:T}){try{J("fs",a),J("gitdir",i),J("filepath",l);const k=new $e(a),j=await Ne({fsp:k,dotgit:i});if(A)return await me.acquire({fs:k,gitdir:j,cache:s},async function(V){if(!T){const ne=await k.lstat(g(t,l));if(ne){if(ne.isDirectory())throw new dr("directory");return}}V.has({filepath:l})&&V.delete({filepath:l})});let F;if(!d){if(F=await k.lstat(g(t,l)),!F)throw new Ge(`file at "${l}" on disk and "remove" not set`);if(F.isDirectory())throw new dr("directory")}return await me.acquire({fs:k,gitdir:j,cache:s},async function(V){if(!v&&!V.has({filepath:l}))throw new Ge(`file at "${l}" in index and "add" not set`);let ne;if(d)ne={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:w,uid:0,gid:0,size:0};else{ne=F;const ge=ne.isSymbolicLink()?await k.readlink(g(t,l)):await k.read(g(t,l));d=await zt({fs:k,gitdir:j,type:"blob",format:"content",object:ge})}return V.insert({filepath:l,oid:d,stats:ne}),d})}catch(k){throw k.caller="git.updateIndex",k}}function Cl(){try{return ci.version}catch(a){throw a.caller="git.version",a}}async function Tl({fs:a,dir:t,gitdir:i=g(t,".git"),trees:s,map:l,reduce:d,iterate:w,cache:v={}}){try{J("fs",a),J("gitdir",i),J("trees",s);const A=new $e(a),T=await Ne({fsp:A,dotgit:i});return await pr({fs:A,cache:v,dir:t,gitdir:T,trees:s,map:l,reduce:d,iterate:w})}catch(A){throw A.caller="git.walk",A}}async function Rl({fs:a,dir:t,gitdir:i=g(t,".git"),blob:s}){try{J("fs",a),J("gitdir",i),J("blob",s);const l=new $e(a),d=await Ne({fsp:l,dotgit:i});return await zt({fs:l,gitdir:d,type:"blob",object:s,format:"content"})}catch(l){throw l.caller="git.writeBlob",l}}async function Ol({fs:a,dir:t,gitdir:i=g(t,".git"),commit:s}){try{J("fs",a),J("gitdir",i),J("commit",s);const l=new $e(a),d=await Ne({fsp:l,dotgit:i});return await yl({fs:l,gitdir:d,commit:s})}catch(l){throw l.caller="git.writeCommit",l}}async function Ml({fs:a,dir:t,gitdir:i=g(t,".git"),type:s,object:l,format:d="parsed",oid:w,encoding:v=void 0}){try{const A=new $e(a),T=await Ne({fsp:A,dotgit:i});if(d==="parsed"){switch(s){case"commit":l=mt.from(l).toObject();break;case"tree":l=Ce.from(l).toObject();break;case"blob":l=Buffer.from(l,v);break;case"tag":l=$t.from(l).toObject();break;default:throw new We(w||"",s,"blob|commit|tag|tree")}d="content"}return w=await zt({fs:A,gitdir:T,type:s,object:l,oid:w,format:d}),w}catch(A){throw A.caller="git.writeObject",A}}async function Pl({fs:a,dir:t,gitdir:i=g(t,".git"),ref:s,value:l,force:d=!1,symbolic:w=!1}){try{J("fs",a),J("gitdir",i),J("ref",s),J("value",l);const v=new $e(a);if(!An(s,!0))throw new er(s,f.clean(s));const A=await Ne({fsp:v,dotgit:i});if(!d&&await H.exists({fs:v,gitdir:A,ref:s}))throw new Qt("ref",s);w?await H.writeSymbolicRef({fs:v,gitdir:A,ref:s,value:l}):(l=await H.resolve({fs:v,gitdir:A,ref:l}),await H.writeRef({fs:v,gitdir:A,ref:s,value:l}))}catch(v){throw v.caller="git.writeRef",v}}async function Kp({fs:a,gitdir:t,tag:i}){const s=$t.from(i).toObject();return await zt({fs:a,gitdir:t,type:"tag",object:s,format:"content"})}async function jl({fs:a,dir:t,gitdir:i=g(t,".git"),tag:s}){try{J("fs",a),J("gitdir",i),J("tag",s);const l=new $e(a),d=await Ne({fsp:l,dotgit:i});return await Kp({fs:l,gitdir:d,tag:s})}catch(l){throw l.caller="git.writeTag",l}}async function Bl({fs:a,dir:t,gitdir:i=g(t,".git"),tree:s}){try{J("fs",a),J("gitdir",i),J("tree",s);const l=new $e(a),d=await Ne({fsp:l,dotgit:i});return await In({fs:l,gitdir:d,tree:s})}catch(l){throw l.caller="git.writeTree",l}}var Zp={Errors:Ms,STAGE:Je,TREE:Gt,WORKDIR:Vr,add:Us,abortMerge:Ls,addNote:qs,addRemote:Ks,annotatedTag:Zs,branch:Xs,cherryPick:nc,checkout:Xi,clone:gc,commit:mc,getConfig:Oc,getConfigAll:Mc,setConfig:wl,currentBranch:wc,deleteBranch:yc,deleteRef:bc,deleteRemote:vc,deleteTag:xc,expandOid:_c,expandRef:Sc,fastForward:Ic,fetch:Ac,findMergeBase:Cc,findRoot:Rc,getRemoteInfo:Pc,getRemoteInfo2:Bc,hashBlob:Fc,indexPack:Dc,init:Lc,isDescendent:Nc,isIgnored:Uc,listBranches:zc,listFiles:Hc,listNotes:Wc,listRefs:qc,listRemotes:Vc,listServerRefs:Kc,listTags:Zc,log:Jc,merge:Qc,packObjects:tl,pull:rl,push:nl,readBlob:ol,readCommit:aa,readNote:sl,readObject:cl,readTag:ll,readTree:ul,remove:fl,removeNote:dl,renameBranch:hl,resetIndex:gl,updateIndex:Al,resolveRef:ml,status:Sl,statusMatrix:El,tag:Il,version:Cl,walk:Tl,writeBlob:Rl,writeCommit:Ol,writeObject:Ml,writeRef:Pl,writeTag:jl,writeTree:Bl,stash:_l};return Oe.Errors=Ms,Oe.STAGE=Je,Oe.TREE=Gt,Oe.WORKDIR=Vr,Oe.abortMerge=Ls,Oe.add=Us,Oe.addNote=qs,Oe.addRemote=Ks,Oe.annotatedTag=Zs,Oe.branch=Xs,Oe.checkout=Xi,Oe.cherryPick=nc,Oe.clone=gc,Oe.commit=mc,Oe.currentBranch=wc,Oe.default=Zp,Oe.deleteBranch=yc,Oe.deleteRef=bc,Oe.deleteRemote=vc,Oe.deleteTag=xc,Oe.expandOid=_c,Oe.expandRef=Sc,Oe.fastForward=Ic,Oe.fetch=Ac,Oe.findMergeBase=Cc,Oe.findRoot=Rc,Oe.getConfig=Oc,Oe.getConfigAll=Mc,Oe.getRemoteInfo=Pc,Oe.getRemoteInfo2=Bc,Oe.hashBlob=Fc,Oe.indexPack=Dc,Oe.init=Lc,Oe.isDescendent=Nc,Oe.isIgnored=Uc,Oe.listBranches=zc,Oe.listFiles=Hc,Oe.listNotes=Wc,Oe.listRefs=qc,Oe.listRemotes=Vc,Oe.listServerRefs=Kc,Oe.listTags=Zc,Oe.log=Jc,Oe.merge=Qc,Oe.packObjects=tl,Oe.pull=rl,Oe.push=nl,Oe.readBlob=ol,Oe.readCommit=aa,Oe.readNote=sl,Oe.readObject=cl,Oe.readTag=ll,Oe.readTree=ul,Oe.remove=fl,Oe.removeNote=dl,Oe.renameBranch=hl,Oe.resetIndex=gl,Oe.resolveRef=ml,Oe.setConfig=wl,Oe.stash=_l,Oe.status=Sl,Oe.statusMatrix=El,Oe.tag=Il,Oe.updateIndex=Al,Oe.version=Cl,Oe.walk=Tl,Oe.writeBlob=Rl,Oe.writeCommit=Ol,Oe.writeObject=Ml,Oe.writeRef=Pl,Oe.writeTag=jl,Oe.writeTree=Bl,Oe}var dy=fy();const Cs=qn(dy);function hy(e){let n=[e];return{next(){return Promise.resolve({done:n.length===0,value:n.pop()})},return(){return n=[],{}},[Symbol.asyncIterator](){return this}}}function py(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:hy(e)}async function gy(e,n){const r=py(e);for(;;){const{value:o,done:c}=await r.next();if(o&&await n(o),c)break}r.return&&r.return()}async function my(e){let n=0;const r=[];await gy(e,u=>{r.push(u),n+=u.byteLength});const o=new Uint8Array(n);let c=0;for(const u of r)o.set(u,c),c+=u.byteLength;return o}function wy(e){if(e[Symbol.asyncIterator])return e;const n=e.getReader();return{next(){return n.read()},return(){return n.releaseLock(),{}},[Symbol.asyncIterator](){return this}}}async function yy({onProgress:e,url:n,method:r="GET",headers:o={},body:c}){c&&(c=await my(c));const u=await fetch(n,{method:r,headers:o,body:c}),p=u.body&&u.body.getReader?wy(u.body):[new Uint8Array(await u.arrayBuffer())];o={};for(const[f,h]of u.headers.entries())o[f]=h;return{url:u.url,method:u.method,statusCode:u.status,statusMessage:u.statusText,body:p,headers:o}}var by={request:yy};const an=new Map;function vy(e,n){an.has(e)||an.set(e,new Set),an.get(e).add(n)}function xy(e,n){const r=an.get(e);r&&(r.delete(n),r.size===0&&an.delete(e))}function Nn(e,n){const r=an.get(e);r&&r.forEach(o=>o(n))}const Fr={FIND:"notemac-find",REPLACE:"notemac-replace",MARK:"notemac-mark",GOTO_LINE:"notemac-goto-line",COLUMN_EDIT:"notemac-column-edit",CLEAR_MARKS:"notemac-clear-marks",EDITOR_ACTION:"notemac-editor-action",INSERT_SNIPPET:"notemac-insert-snippet",EXECUTE_COMMAND:"notemac-execute-command",GIT_STATUS_CHANGED:"notemac-git-status-changed",GIT_BRANCH_CHANGED:"notemac-git-branch-changed",GIT_OPERATION_COMPLETE:"notemac-git-operation-complete",AI_RESPONSE_COMPLETE:"notemac-ai-response-complete",AI_STREAM_CHUNK:"notemac-ai-stream-chunk",AI_INLINE_SUGGESTION:"notemac-ai-inline-suggestion",AI_ERROR:"notemac-ai-error",AI_ACTION:"notemac-ai-action"};var zo,zf;function _y(){if(zf)return zo;zf=1,zo=e;function e(n){var r,o;if(typeof n!="function")throw new Error("expected a function but got "+n);return function(){return r||(r=!0,o=n.apply(this,arguments)),o}}return zo}var Go={},Gf;function Sy(){return Gf||(Gf=1,(function(e){function n(D,U){var G;return D instanceof Buffer?G=D:G=Buffer.from(D.buffer,D.byteOffset,D.byteLength),G.toString(U)}var r=function(D){return Buffer.from(D)};function o(D){for(var U=0,G=Math.min(256*256,D.length+1),X=new Uint16Array(G),q=[],Y=0;;){var B=U<D.length;if(!B||Y>=G-1){var K=X.subarray(0,Y),ce=K;if(q.push(String.fromCharCode.apply(null,ce)),!B)return q.join("");D=D.subarray(U),U=0,Y=0}var S=D[U++];if((S&128)===0)X[Y++]=S;else if((S&224)===192){var ie=D[U++]&63;X[Y++]=(S&31)<<6|ie}else if((S&240)===224){var ie=D[U++]&63,Q=D[U++]&63;X[Y++]=(S&31)<<12|ie<<6|Q}else if((S&248)===240){var ie=D[U++]&63,Q=D[U++]&63,se=D[U++]&63,W=(S&7)<<18|ie<<12|Q<<6|se;W>65535&&(W-=65536,X[Y++]=W>>>10&1023|55296,W=56320|W&1023),X[Y++]=W}}}function c(D){for(var U=0,G=D.length,X=0,q=Math.max(32,G+(G>>>1)+7),Y=new Uint8Array(q>>>3<<3);U<G;){var B=D.charCodeAt(U++);if(B>=55296&&B<=56319){if(U<G){var K=D.charCodeAt(U);(K&64512)===56320&&(++U,B=((B&1023)<<10)+(K&1023)+65536)}if(B>=55296&&B<=56319)continue}if(X+4>Y.length){q+=8,q*=1+U/D.length*2,q=q>>>3<<3;var ce=new Uint8Array(q);ce.set(Y),Y=ce}if((B&4294967168)===0){Y[X++]=B;continue}else if((B&4294965248)===0)Y[X++]=B>>>6&31|192;else if((B&4294901760)===0)Y[X++]=B>>>12&15|224,Y[X++]=B>>>6&63|128;else if((B&4292870144)===0)Y[X++]=B>>>18&7|240,Y[X++]=B>>>12&63|128,Y[X++]=B>>>6&63|128;else continue;Y[X++]=B&63|128}return Y.slice?Y.slice(0,X):Y.subarray(0,X)}var u="Failed to ",p=function(D,U,G){if(D)throw new Error("".concat(u).concat(U,": the '").concat(G,"' option is unsupported."))},f=typeof Buffer=="function"&&Buffer.from,h=f?r:c;function x(){this.encoding="utf-8"}x.prototype.encode=function(D,U){return p(U&&U.stream,"encode","stream"),h(D)};function _(D){var U;try{var G=new Blob([D],{type:"text/plain;charset=UTF-8"});U=URL.createObjectURL(G);var X=new XMLHttpRequest;return X.open("GET",U,!1),X.send(),X.responseText}finally{U&&URL.revokeObjectURL(U)}}var y=!f&&typeof Blob=="function"&&typeof URL=="function"&&typeof URL.createObjectURL=="function",O=["utf-8","utf8","unicode-1-1-utf-8"],R=o;f?R=n:y&&(R=function(D){try{return _(D)}catch{return o(D)}});var z="construct 'TextDecoder'",N="".concat(u," ").concat(z,": the ");function L(D,U){p(U&&U.fatal,z,"fatal"),D=D||"utf-8";var G;if(f?G=Buffer.isEncoding(D):G=O.indexOf(D.toLowerCase())!==-1,!G)throw new RangeError("".concat(N," encoding label provided ('").concat(D,"') is invalid."));this.encoding=D,this.fatal=!1,this.ignoreBOM=!1}L.prototype.decode=function(D,U){p(U&&U.stream,"decode","stream");var G;return D instanceof Uint8Array?G=D:D.buffer instanceof ArrayBuffer?G=new Uint8Array(D.buffer):G=new Uint8Array(D),R(G,this.encoding)},e.TextEncoder=e.TextEncoder||x,e.TextDecoder=e.TextDecoder||L})(typeof window<"u"?window:typeof Ii<"u"?Ii:Go)),Go}var Ho,Hf;function ky(){return Hf||(Hf=1,Sy(),Ho={encode:e=>new TextEncoder().encode(e),decode:e=>new TextDecoder().decode(e)}),Ho}var Wo,Wf;function Ey(){if(Wf)return Wo;Wf=1,Wo=e;function e(n,r,o){var c;return function(){if(!r)return n.apply(this,arguments);var u=this,p=arguments,f=o&&!c;if(clearTimeout(c),c=setTimeout(function(){if(c=null,!f)return n.apply(u,p)},r),f)return n.apply(this,arguments)}}return Wo}var qo,qf;function Ts(){if(qf)return qo;qf=1;function e(f){if(f.length===0)return".";let h=o(f);return h=h.reduce(p,[]),r(...h)}function n(...f){let h="";for(let x of f)x.startsWith("/")?h=x:h=e(r(h,x));return h}function r(...f){if(f.length===0)return"";let h=f.join("/");return h=h.replace(/\/{2,}/g,"/"),h}function o(f){if(f.length===0)return[];if(f==="/")return["/"];let h=f.split("/");return h[h.length-1]===""&&h.pop(),f[0]==="/"?h[0]="/":h[0]!=="."&&h.unshift("."),h}function c(f){const h=f.lastIndexOf("/");if(h===-1)throw new Error(`Cannot get dirname of "${f}"`);return h===0?"/":f.slice(0,h)}function u(f){if(f==="/")throw new Error(`Cannot get basename of "${f}"`);const h=f.lastIndexOf("/");return h===-1?f:f.slice(h+1)}function p(f,h){if(f.length===0)return f.push(h),f;if(h===".")return f;if(h===".."){if(f.length===1){if(f[0]==="/")throw new Error("Unable to normalize path - traverses above root directory");if(f[0]===".")return f.push(h),f}return f[f.length-1]===".."?(f.push(".."),f):(f.pop(),f)}return f.push(h),f}return qo={join:r,normalize:e,split:o,basename:u,dirname:c,resolve:n},qo}var Vo,Vf;function eh(){if(Vf)return Vo;Vf=1;function e(f){return class extends Error{constructor(...h){super(...h),this.code=f,this.message?this.message=f+": "+this.message:this.message=f}}}const n=e("EEXIST"),r=e("ENOENT"),o=e("ENOTDIR"),c=e("ENOTEMPTY"),u=e("ETIMEDOUT"),p=e("EISDIR");return Vo={EEXIST:n,ENOENT:r,ENOTDIR:o,ENOTEMPTY:c,ETIMEDOUT:u,EISDIR:p},Vo}var Ko,Kf;function Iy(){if(Kf)return Ko;Kf=1;const e=Ts(),{EEXIST:n,ENOENT:r,ENOTDIR:o,ENOTEMPTY:c,EISDIR:u}=eh(),p=0;return Ko=class{constructor(){}_makeRoot(h=new Map){return h.set(p,{mode:511,type:"dir",size:0,ino:0,mtimeMs:Date.now()}),h}activate(h=null){h===null?this._root=new Map([["/",this._makeRoot()]]):typeof h=="string"?this._root=new Map([["/",this._makeRoot(this.parse(h))]]):this._root=h}get activated(){return!!this._root}deactivate(){this._root=void 0}size(){return this._countInodes(this._root.get("/"))-1}_countInodes(h){let x=1;for(let[_,y]of h)_!==p&&(x+=this._countInodes(y));return x}autoinc(){return this._maxInode(this._root.get("/"))+1}_maxInode(h){let x=h.get(p).ino;for(let[_,y]of h)_!==p&&(x=Math.max(x,this._maxInode(y)));return x}print(h=this._root.get("/")){let x="";const _=(y,O)=>{for(let[R,z]of y){if(R===0)continue;let N=z.get(p),L=N.mode.toString(8);x+=`${"	".repeat(O)}${R}	${L}`,N.type==="file"?x+=`	${N.size}	${N.mtimeMs}
`:(x+=`
`,_(z,O+1))}};return _(h,0),x}parse(h){let x=0;function _(z){const N=++x,L=z.length===1?"dir":"file";let[D,U,G]=z;return D=parseInt(D,8),U=U?parseInt(U):0,G=G?parseInt(G):Date.now(),new Map([[p,{mode:D,type:L,size:U,mtimeMs:G,ino:N}]])}let y=h.trim().split(`
`),O=this._makeRoot(),R=[{indent:-1,node:O},{indent:0,node:null}];for(let z of y){let L=z.match(/^\t*/)[0].length;z=z.slice(L);let[D,...U]=z.split("	"),G=_(U);if(L<=R[R.length-1].indent)for(;L<=R[R.length-1].indent;)R.pop();R.push({indent:L,node:G}),R[R.length-2].node.set(D,G)}return O}_lookup(h,x=!0){let _=this._root,y="/",O=e.split(h);for(let R=0;R<O.length;++R){let z=O[R];if(_=_.get(z),!_)throw new r(h);if(x||R<O.length-1){const N=_.get(p);if(N.type==="symlink"){let L=e.resolve(y,N.target);_=this._lookup(L)}y?y=e.join(y,z):y=z}}return _}mkdir(h,{mode:x}){if(h==="/")throw new n;let _=this._lookup(e.dirname(h)),y=e.basename(h);if(_.has(y))throw new n;let O=new Map,R={mode:x,type:"dir",size:0,mtimeMs:Date.now(),ino:this.autoinc()};O.set(p,R),_.set(y,O)}rmdir(h){let x=this._lookup(h);if(x.get(p).type!=="dir")throw new o;if(x.size>1)throw new c;let _=this._lookup(e.dirname(h)),y=e.basename(h);_.delete(y)}readdir(h){let x=this._lookup(h);if(x.get(p).type!=="dir")throw new o;return[...x.keys()].filter(_=>typeof _=="string")}writeStat(h,x,{mode:_}){let y,O;try{O=this.stat(h)}catch{}if(O!==void 0){if(O.type==="dir")throw new u;_==null&&(_=O.mode),y=O.ino}_==null&&(_=438),y==null&&(y=this.autoinc());let R=this._lookup(e.dirname(h)),z=e.basename(h),N={mode:_,type:"file",size:x,mtimeMs:Date.now(),ino:y},L=new Map;return L.set(p,N),R.set(z,L),N}unlink(h){let x=this._lookup(e.dirname(h)),_=e.basename(h);x.delete(_)}rename(h,x){let _=e.basename(x),y=this._lookup(h);this._lookup(e.dirname(x)).set(_,y),this.unlink(h)}stat(h){return this._lookup(h).get(p)}lstat(h){return this._lookup(h,!1).get(p)}readlink(h){return this._lookup(h,!1).get(p).target}symlink(h,x){let _,y;try{let L=this.stat(x);y===null&&(y=L.mode),_=L.ino}catch{}y==null&&(y=40960),_==null&&(_=this.autoinc());let O=this._lookup(e.dirname(x)),R=e.basename(x),z={mode:y,type:"symlink",target:h,size:0,mtimeMs:Date.now(),ino:_},N=new Map;return N.set(p,z),O.set(R,N),z}_du(h){let x=0;for(const[_,y]of h.entries())_===p?x+=y.size:x+=this._du(y);return x}du(h){let x=this._lookup(h);return this._du(x)}},Ko}class th{constructor(n="keyval-store",r="keyval"){this.storeName=r,this._dbName=n,this._storeName=r,this._init()}_init(){this._dbp||(this._dbp=new Promise((n,r)=>{const o=indexedDB.open(this._dbName);o.onerror=()=>r(o.error),o.onsuccess=()=>n(o.result),o.onupgradeneeded=()=>{o.result.createObjectStore(this._storeName)}}))}_withIDBStore(n,r){return this._init(),this._dbp.then(o=>new Promise((c,u)=>{const p=o.transaction(this.storeName,n);p.oncomplete=()=>c(),p.onabort=p.onerror=()=>u(p.error),r(p.objectStore(this.storeName))}))}_close(){return this._init(),this._dbp.then(n=>{n.close(),this._dbp=void 0})}}let Zo;function $r(){return Zo||(Zo=new th),Zo}function Ay(e,n=$r()){let r;return n._withIDBStore("readwrite",o=>{r=o.get(e)}).then(()=>r.result)}function Cy(e,n,r=$r()){return r._withIDBStore("readwrite",o=>{o.put(n,e)})}function Ty(e,n,r=$r()){return r._withIDBStore("readwrite",o=>{const c=o.get(e);c.onsuccess=()=>{o.put(n(c.result),e)}})}function Ry(e,n=$r()){return n._withIDBStore("readwrite",r=>{r.delete(e)})}function Oy(e=$r()){return e._withIDBStore("readwrite",n=>{n.clear()})}function My(e=$r()){const n=[];return e._withIDBStore("readwrite",r=>{(r.openKeyCursor||r.openCursor).call(r).onsuccess=function(){this.result&&(n.push(this.result.key),this.result.continue())}}).then(()=>n)}function Py(e=$r()){return e._close()}const jy=Object.freeze(Object.defineProperty({__proto__:null,Store:th,clear:Oy,close:Py,del:Ry,get:Ay,keys:My,set:Cy,update:Ty},Symbol.toStringTag,{value:"Module"})),rh=eg(jy);var Xo,Zf;function By(){if(Zf)return Xo;Zf=1;const e=rh;return Xo=class{constructor(r,o){this._database=r,this._storename=o,this._store=new e.Store(this._database,this._storename)}saveSuperblock(r){return e.set("!root",r,this._store)}loadSuperblock(){return e.get("!root",this._store)}readFile(r){return e.get(r,this._store)}writeFile(r,o){return e.set(r,o,this._store)}unlink(r){return e.del(r,this._store)}wipe(){return e.clear(this._store)}close(){return e.close(this._store)}},Xo}var Yo,Xf;function Fy(){return Xf||(Xf=1,Yo=class{constructor(n){this._url=n}loadSuperblock(){return fetch(this._url+"/.superblock.txt").then(n=>n.ok?n.text():null)}async readFile(n){const r=await fetch(this._url+n);if(r.status===200)return r.arrayBuffer();throw new Error("ENOENT")}async sizeFile(n){const r=await fetch(this._url+n,{method:"HEAD"});if(r.status===200)return r.headers.get("content-length");throw new Error("ENOENT")}}),Yo}var Jo,Yf;function Dy(){if(Yf)return Jo;Yf=1;const e=rh,n=r=>new Promise(o=>setTimeout(o,r));return Jo=class{constructor(o,c){this._id=Math.random(),this._database=o,this._storename=c,this._store=new e.Store(this._database,this._storename),this._lock=null}async has({margin:o=2e3}={}){if(this._lock&&this._lock.holder===this._id){const c=Date.now();return this._lock.expires>c+o?!0:await this.renew()}else return!1}async renew({ttl:o=5e3}={}){let c;return await e.update("lock",u=>{const f=Date.now()+o;return c=u&&u.holder===this._id,this._lock=c?{holder:this._id,expires:f}:u,this._lock},this._store),c}async acquire({ttl:o=5e3}={}){let c,u,p;if(await e.update("lock",f=>{const h=Date.now(),x=h+o;return u=f&&f.expires<h,c=f===void 0||u,p=f&&f.holder===this._id,this._lock=c?{holder:this._id,expires:x}:f,this._lock},this._store),p)throw new Error("Mutex double-locked");return c}async wait({interval:o=100,limit:c=6e3,ttl:u}={}){for(;c--;){if(await this.acquire({ttl:u}))return!0;await n(o)}throw new Error("Mutex timeout")}async release({force:o=!1}={}){let c,u,p;if(await e.update("lock",f=>(c=o||f&&f.holder===this._id,u=f===void 0,p=f&&f.holder!==this._id,this._lock=c?void 0:f,this._lock),this._store),await e.close(this._store),!c&&!o){if(u)throw new Error("Mutex double-freed");if(p)throw new Error("Mutex lost ownership")}return c}},Jo}var Qo,Jf;function Ly(){return Jf||(Jf=1,Qo=class{constructor(n){this._id=Math.random(),this._database=n,this._has=!1,this._release=null}async has(){return this._has}async acquire(){return new Promise(n=>{navigator.locks.request(this._database+"_lock",{ifAvailable:!0},r=>(this._has=!!r,n(!!r),new Promise(o=>{this._release=o})))})}async wait({timeout:n=6e5}={}){return new Promise((r,o)=>{const c=new AbortController;setTimeout(()=>{c.abort(),o(new Error("Mutex timeout"))},n),navigator.locks.request(this._database+"_lock",{signal:c.signal},u=>(this._has=!!u,r(!!u),new Promise(p=>{this._release=p})))})}async release({force:n=!1}={}){this._has=!1,this._release?this._release():n&&navigator.locks.request(this._database+"_lock",{steal:!0},r=>!0)}}),Qo}var es,Qf;function $y(){if(Qf)return es;Qf=1;const{encode:e,decode:n}=ky(),r=Ey(),o=Iy(),{ENOENT:c,ENOTEMPTY:u,ETIMEDOUT:p}=eh(),f=By(),h=Fy(),x=Dy(),_=Ly(),y=Ts();return es=class{constructor(){this.saveSuperblock=r(()=>{this.flush()},500)}async init(R,{wipe:z,url:N,urlauto:L,fileDbName:D=R,db:U=null,fileStoreName:G=R+"_files",lockDbName:X=R+"_lock",lockStoreName:q=R+"_lock"}={}){this._name=R,this._idb=U||new f(D,G),this._mutex=navigator.locks?new _(R):new x(X,q),this._cache=new o(R),this._opts={wipe:z,url:N},this._needsWipe=!!z,N&&(this._http=new h(N),this._urlauto=!!L)}async activate(){if(this._cache.activated)return;this._needsWipe&&(this._needsWipe=!1,await this._idb.wipe(),await this._mutex.release({force:!0})),await this._mutex.has()||await this._mutex.wait();const R=await this._idb.loadSuperblock();if(R)this._cache.activate(R);else if(this._http){const z=await this._http.loadSuperblock();this._cache.activate(z),await this._saveSuperblock()}else this._cache.activate();if(!await this._mutex.has())throw new p}async deactivate(){await this._mutex.has()&&await this._saveSuperblock(),this._cache.deactivate();try{await this._mutex.release()}catch{}await this._idb.close()}async _saveSuperblock(){this._cache.activated&&(this._lastSavedAt=Date.now(),await this._idb.saveSuperblock(this._cache._root))}_writeStat(R,z,N){let L=y.split(y.dirname(R)),D=L.shift();for(let U of L){D=y.join(D,U);try{this._cache.mkdir(D,{mode:511})}catch{}}return this._cache.writeStat(R,z,N)}async readFile(R,z){const N=typeof z=="string"?z:z&&z.encoding;if(N&&N!=="utf8")throw new Error('Only "utf8" encoding is supported in readFile');let L=null,D=null;try{D=this._cache.stat(R),L=await this._idb.readFile(D.ino)}catch(U){if(!this._urlauto)throw U}if(!L&&this._http){let U=this._cache.lstat(R);for(;U.type==="symlink";)R=y.resolve(y.dirname(R),U.target),U=this._cache.lstat(R);L=await this._http.readFile(R)}if(L&&((!D||D.size!=L.byteLength)&&(D=await this._writeStat(R,L.byteLength,{mode:D?D.mode:438}),this.saveSuperblock()),N==="utf8"?L=n(L):L.toString=()=>n(L)),!D)throw new c(R);return L}async writeFile(R,z,N){const{mode:L,encoding:D="utf8"}=N;if(typeof z=="string"){if(D!=="utf8")throw new Error('Only "utf8" encoding is supported in writeFile');z=e(z)}const U=await this._cache.writeStat(R,z.byteLength,{mode:L});await this._idb.writeFile(U.ino,z)}async unlink(R,z){const N=this._cache.lstat(R);this._cache.unlink(R),N.type!=="symlink"&&await this._idb.unlink(N.ino)}readdir(R,z){return this._cache.readdir(R)}mkdir(R,z){const{mode:N=511}=z;this._cache.mkdir(R,{mode:N})}rmdir(R,z){if(R==="/")throw new u;this._cache.rmdir(R)}rename(R,z){this._cache.rename(R,z)}stat(R,z){return this._cache.stat(R)}lstat(R,z){return this._cache.lstat(R)}readlink(R,z){return this._cache.readlink(R)}symlink(R,z){this._cache.symlink(R,z)}async backFile(R,z){let N=await this._http.sizeFile(R);await this._writeStat(R,N,z)}du(R){return this._cache.du(R)}flush(){return this._saveSuperblock()}},es}var ts,ed;function Ny(){return ed||(ed=1,ts=class{constructor(n){this.type=n.type,this.mode=n.mode,this.size=n.size,this.ino=n.ino,this.mtimeMs=n.mtimeMs,this.ctimeMs=n.ctimeMs||n.mtimeMs,this.uid=1,this.gid=1,this.dev=1}isFile(){return this.type==="file"}isDirectory(){return this.type==="dir"}isSymbolicLink(){return this.type==="symlink"}}),ts}var rs,td;function Uy(){if(td)return rs;td=1;const e=$y(),n=Ny(),r=Ts();function o(p,f,...h){return p=r.normalize(p),(typeof f>"u"||typeof f=="function")&&(f={}),typeof f=="string"&&(f={encoding:f}),[p,f,...h]}function c(p,f,h,...x){return p=r.normalize(p),(typeof h>"u"||typeof h=="function")&&(h={}),typeof h=="string"&&(h={encoding:h}),[p,f,h,...x]}function u(p,f,...h){return[r.normalize(p),r.normalize(f),...h]}return rs=class{constructor(f,h={}){this.init=this.init.bind(this),this.readFile=this._wrap(this.readFile,o,!1),this.writeFile=this._wrap(this.writeFile,c,!0),this.unlink=this._wrap(this.unlink,o,!0),this.readdir=this._wrap(this.readdir,o,!1),this.mkdir=this._wrap(this.mkdir,o,!0),this.rmdir=this._wrap(this.rmdir,o,!0),this.rename=this._wrap(this.rename,u,!0),this.stat=this._wrap(this.stat,o,!1),this.lstat=this._wrap(this.lstat,o,!1),this.readlink=this._wrap(this.readlink,o,!1),this.symlink=this._wrap(this.symlink,u,!0),this.backFile=this._wrap(this.backFile,o,!0),this.du=this._wrap(this.du,o,!1),this._deactivationPromise=null,this._deactivationTimeout=null,this._activationPromise=null,this._operations=new Set,f&&this.init(f,h)}async init(...f){return this._initPromiseResolve&&await this._initPromise,this._initPromise=this._init(...f),this._initPromise}async _init(f,h={}){await this._gracefulShutdown(),this._activationPromise&&await this._deactivate(),this._backend&&this._backend.destroy&&await this._backend.destroy(),this._backend=h.backend||new e,this._backend.init&&await this._backend.init(f,h),this._initPromiseResolve&&(this._initPromiseResolve(),this._initPromiseResolve=null),h.defer||this.stat("/")}async _gracefulShutdown(){this._operations.size>0&&(this._isShuttingDown=!0,await new Promise(f=>this._gracefulShutdownResolve=f),this._isShuttingDown=!1,this._gracefulShutdownResolve=null)}_wrap(f,h,x){return async(..._)=>{_=h(..._);let y={name:f.name,args:_};this._operations.add(y);try{return await this._activate(),await f.apply(this,_)}finally{this._operations.delete(y),x&&this._backend.saveSuperblock(),this._operations.size===0&&(this._deactivationTimeout||clearTimeout(this._deactivationTimeout),this._deactivationTimeout=setTimeout(this._deactivate.bind(this),500))}}}async _activate(){this._initPromise,await this._initPromise,this._deactivationTimeout&&(clearTimeout(this._deactivationTimeout),this._deactivationTimeout=null),this._deactivationPromise&&await this._deactivationPromise,this._deactivationPromise=null,this._activationPromise||(this._activationPromise=this._backend.activate?this._backend.activate():Promise.resolve()),await this._activationPromise}async _deactivate(){return this._activationPromise&&await this._activationPromise,this._deactivationPromise||(this._deactivationPromise=this._backend.deactivate?this._backend.deactivate():Promise.resolve()),this._activationPromise=null,this._gracefulShutdownResolve&&this._gracefulShutdownResolve(),this._deactivationPromise}async readFile(f,h){return this._backend.readFile(f,h)}async writeFile(f,h,x){return await this._backend.writeFile(f,h,x),null}async unlink(f,h){return await this._backend.unlink(f,h),null}async readdir(f,h){return this._backend.readdir(f,h)}async mkdir(f,h){return await this._backend.mkdir(f,h),null}async rmdir(f,h){return await this._backend.rmdir(f,h),null}async rename(f,h){return await this._backend.rename(f,h),null}async stat(f,h){const x=await this._backend.stat(f,h);return new n(x)}async lstat(f,h){const x=await this._backend.lstat(f,h);return new n(x)}async readlink(f,h){return this._backend.readlink(f,h)}async symlink(f,h){return await this._backend.symlink(f,h),null}async backFile(f,h){return await this._backend.backFile(f,h),null}async du(f){return this._backend.du(f)}async flush(){return this._backend.flush()}},rs}var ns,rd;function zy(){if(rd)return ns;rd=1;const e=_y(),n=Uy();function r(o,c){return typeof o=="function"&&(c=o),c=e(c),[(...p)=>c(null,...p),c]}return ns=class{constructor(...c){this.promises=new n(...c),this.init=this.init.bind(this),this.readFile=this.readFile.bind(this),this.writeFile=this.writeFile.bind(this),this.unlink=this.unlink.bind(this),this.readdir=this.readdir.bind(this),this.mkdir=this.mkdir.bind(this),this.rmdir=this.rmdir.bind(this),this.rename=this.rename.bind(this),this.stat=this.stat.bind(this),this.lstat=this.lstat.bind(this),this.readlink=this.readlink.bind(this),this.symlink=this.symlink.bind(this),this.backFile=this.backFile.bind(this),this.du=this.du.bind(this),this.flush=this.flush.bind(this)}init(c,u){return this.promises.init(c,u)}readFile(c,u,p){const[f,h]=r(u,p);this.promises.readFile(c,u).then(f).catch(h)}writeFile(c,u,p,f){const[h,x]=r(p,f);this.promises.writeFile(c,u,p).then(h).catch(x)}unlink(c,u,p){const[f,h]=r(u,p);this.promises.unlink(c,u).then(f).catch(h)}readdir(c,u,p){const[f,h]=r(u,p);this.promises.readdir(c,u).then(f).catch(h)}mkdir(c,u,p){const[f,h]=r(u,p);this.promises.mkdir(c,u).then(f).catch(h)}rmdir(c,u,p){const[f,h]=r(u,p);this.promises.rmdir(c,u).then(f).catch(h)}rename(c,u,p){const[f,h]=r(p);this.promises.rename(c,u).then(f).catch(h)}stat(c,u,p){const[f,h]=r(u,p);this.promises.stat(c).then(f).catch(h)}lstat(c,u,p){const[f,h]=r(u,p);this.promises.lstat(c).then(f).catch(h)}readlink(c,u,p){const[f,h]=r(u,p);this.promises.readlink(c).then(f).catch(h)}symlink(c,u,p){const[f,h]=r(p);this.promises.symlink(c,u).then(f).catch(h)}backFile(c,u,p){const[f,h]=r(u,p);this.promises.backFile(c,u).then(f).catch(h)}du(c,u){const[p,f]=r(u);this.promises.du(c).then(p).catch(f)}flush(c){const[u,p]=r(c);this.promises.flush().then(u).catch(p)}},ns}var Gy=zy();const Hy=qn(Gy);function fr(){return typeof window<"u"&&window.__TAURI__?"tauri":typeof window<"u"&&window.electronAPI?"electron":"showDirectoryPicker"in window?"webfs":"lightningfs"}function Wy(){return fr()==="tauri"}function qy(){return fr()==="electron"}function Vy(){const e=fr();return e==="electron"||e==="tauri"}function Ky(){return fr()==="webfs"}function Zy(){return fr()==="lightningfs"}const Ei=new Map;function nh(e){return Ei.has(e)||Ei.set(e,new Hy(e)),Ei.get(e)}function Xy(e){Ei.delete(e),"indexedDB"in window&&window.indexedDB.deleteDatabase(e)}function Rs(e){return nh(e).promises}const ih=new Map;function ah(e,n){ih.set(e,n)}function oh(e){return ih.get(e)}function sh(e){async function n(c){const u=c.split("/").filter(h=>0<h.length);if(u.length===0)return{dir:e,name:""};const p=u.pop();let f=e;for(const h of u)f=await f.getDirectoryHandle(h,{create:!1});return{dir:f,name:p}}async function r(c){const u=c.split("/").filter(f=>0<f.length);let p=e;for(const f of u)p=await p.getDirectoryHandle(f,{create:!1});return p}const o={readFile:async(c,u)=>{const{dir:p,name:f}=await n(c),x=await(await p.getFileHandle(f)).getFile();return(typeof u=="string"?u:u==null?void 0:u.encoding)==="utf8"?await x.text():new Uint8Array(await x.arrayBuffer())},writeFile:async(c,u,p)=>{const f=c.split("/").filter(O=>0<O.length),h=f.pop();let x=e;for(const O of f)x=await x.getDirectoryHandle(O,{create:!0});const y=await(await x.getFileHandle(h,{create:!0})).createWritable();await y.write(u),await y.close()},unlink:async c=>{const{dir:u,name:p}=await n(c);await u.removeEntry(p)},readdir:async c=>{const u=c.length===0||c==="/"||c==="."?e:await r(c),p=[];for await(const f of u.values())p.push(f.name);return p},mkdir:async c=>{const u=c.split("/").filter(f=>0<f.length);let p=e;for(const f of u)p=await p.getDirectoryHandle(f,{create:!0})},rmdir:async c=>{const{dir:u,name:p}=await n(c);await u.removeEntry(p,{recursive:!0})},stat:async c=>{if(c.length===0||c==="/"||c===".")return{isFile:()=>!1,isDirectory:()=>!0,isSymbolicLink:()=>!1,size:0,mode:16877,mtimeMs:Date.now()};try{return await r(c),{isFile:()=>!1,isDirectory:()=>!0,isSymbolicLink:()=>!1,size:0,mode:16877,mtimeMs:Date.now()}}catch{const{dir:u,name:p}=await n(c),h=await(await u.getFileHandle(p)).getFile();return{isFile:()=>!0,isDirectory:()=>!1,isSymbolicLink:()=>!1,size:h.size,mode:33188,mtimeMs:h.lastModified}}},lstat:async c=>o.stat(c)};return o}function ch(e,n){const r=fr();return r==="electron"||r==="tauri"?null:r==="webfs"&&n?sh(n):Rs(e)}const Qv=Object.freeze(Object.defineProperty({__proto__:null,CreateLightningFsAdapter:Rs,CreateWebFsAdapter:sh,DeleteLightningFs:Xy,DetectFsBackend:fr,GetDirHandle:oh,GetFsForGit:ch,GetLightningFs:nh,IsBrowserWorkspaceEnvironment:Zy,IsDesktopNativeEnvironment:Vy,IsElectronEnvironment:qy,IsTauriEnvironment:Wy,IsWebFsEnvironment:Ky,RegisterDirHandle:ah},Symbol.toStringTag,{value:"Module"}));let Br=null,Dn=!1,tn=null,Mi=null;function Nr(){return je.getState()}function Yy(){Br=null,Dn=!1,tn=null,Mi=null}function Os(){const n=Nr().workspacePath||"";if(Dn&&n===Mi)return Br;Mi=n;const r=fr();if(r==="electron")return Br=null,Dn=!0,null;if(r==="webfs"){const o=oh(n);if(o)return Br=ch(n,o),Dn=!0,Br}return Br=Rs(n||"notemac-default"),Dn=!0,Br}function lh(){const e=Nr().workspacePath||"";return tn!==null&&e===Mi?tn:fr()==="webfs"?(tn="/","/"):(tn=e||"/",tn)}function Jy(){return Nr().gitSettings.corsProxy||_d}function Qy(e){const n=e||Nr().gitCredentials;if(n!=null)return()=>({username:n.username||n.token||"",password:n.token||""})}async function e0(){const e=Os();if(e===null)return!1;try{const n=lh();return await Cs.findRoot({fs:e,filepath:n}),!0}catch{return!1}}async function uh(e){const n=Nr();if(e){const o=n.workspacePath||e.name;ah(o,e)}if(Yy(),Os()!==null)try{const o=await e0();if(n.SetRepoInitialized(o),o){const{RefreshGitStatus:c}=await ht(async()=>{const{RefreshGitStatus:f}=await import("./GitStatusController-782ohgNT.js");return{RefreshGitStatus:f}},__vite__mapDeps([0,1,2,3])),{RefreshBranches:u}=await ht(async()=>{const{RefreshBranches:f}=await import("./GitBranchController-69ZAEWuh.js");return{RefreshBranches:f}},__vite__mapDeps([4,2,3,1])),{FetchCommitLog:p}=await ht(async()=>{const{FetchCommitLog:f}=await import("./GitLogController-C6_nDoQD.js");return{FetchCommitLog:f}},__vite__mapDeps([5,1,2,3]));await c(),await u(),await p()}}catch{n.SetRepoInitialized(!1)}}async function e1(){const e=Nr(),n=Os();if(n!==null)try{e.SetGitOperationInProgress(!0),e.SetGitOperationError(null),await Cs.init({fs:n,dir:lh(),defaultBranch:"main"}),e.SetRepoInitialized(!0),e.SetCurrentBranch("main");const{RefreshGitStatus:r}=await ht(async()=>{const{RefreshGitStatus:o}=await import("./GitStatusController-782ohgNT.js");return{RefreshGitStatus:o}},__vite__mapDeps([0,1,2,3]));await r(),Nn(Fr.GIT_STATUS_CHANGED)}catch(r){e.SetGitOperationError(r instanceof Error?r.message:String(r))}finally{e.SetGitOperationInProgress(!1)}}async function t1(e,n,r,o){const c=Nr();try{c.SetGitOperationInProgress(!0),c.SetCurrentGitOperation("clone"),c.SetGitOperationProgress(0),c.SetGitOperationError(null),await Cs.clone({fs:n,http:by,dir:r,url:e,corsProxy:Jy(),singleBranch:!0,depth:1,onAuth:Qy(o),onProgress:u=>{u.total&&c.SetGitOperationProgress(Math.round(u.loaded/u.total*100))}}),c.SetRepoInitialized(!0),Nn(Fr.GIT_OPERATION_COMPLETE,{operation:"clone"})}catch(u){throw c.SetGitOperationError(u instanceof Error?u.message:String(u)),u}finally{c.SetGitOperationInProgress(!1),c.SetCurrentGitOperation(null),c.SetGitOperationProgress(0)}}let Pi=null,ms=null;async function t0(){if(Pi!==null)return!0;try{const e=await ht(()=>import("./core-DhEqZVGG.js"),[]),n=await ht(()=>import("./event-DjZVAIBO.js"),__vite__mapDeps([6,7]));return Pi=e.invoke,ms=n.listen,!0}catch{return!1}}async function r0(){if(!await t0()||Pi===null||ms===null)return null;const n=Pi,r=ms;return{onMenuAction(o){r("menu-action",c=>{const u=c.payload;o(u.action,u.value??void 0)})},onFileOpened(o){r("file-opened",c=>{o(c.payload)})},onFolderOpened(o){r("folder-opened",c=>{o(c.payload)})},onFileSaved(o){r("file-saved",c=>{o(c.payload)})},openFile(){n("open_file_dialog")},openFolder(){n("open_folder_dialog")},async readFile(o){return await n("read_file",{path:o})},async writeFile(o,c){return await n("write_file",{path:o,content:c})},async readDir(o){return await n("read_dir",{path:o})},saveFileAs(o,c){n("save_file_dialog",{content:o,suggestedName:c})},renameFile(o,c){n("rename_file",{oldPath:o,newName:c})},setAlwaysOnTop(o){n("set_always_on_top",{value:o})},async safeStorageEncrypt(o){return await n("safe_storage_encrypt",{plaintext:o})},async safeStorageDecrypt(o){return await n("safe_storage_decrypt",{encrypted:o})},async isSafeStorageAvailable(){return await n("is_safe_storage_available")}}}function nd(e){e.preventDefault(),e.stopPropagation()}async function id(e){var n;if(e.preventDefault(),e.stopPropagation(),(n=e.dataTransfer)!=null&&n.files){const r=Array.from(e.dataTransfer.files),o=je.getState();for(const c of r){const u=await c.text();o.addTab({name:c.name,content:u,language:sr(c.name),lineEnding:br(u)})}}}function fh(e){const n=je.getState(),r=n.tabs.find(o=>o.path===e.path);r?n.setActiveTab(r.id):(n.addTab({name:e.name,path:e.path,content:e.content,language:sr(e.name),lineEnding:br(e.content)}),n.addRecentFile(e.path,e.name))}function dh(e){const n=je.getState();n.setFileTree(e.tree),n.setWorkspacePath(e.path),n.setSidebarPanel("explorer"),uh()}function hh(e,n){const r=je.getState();$d(e,r.activeTabId,r.tabs,r.zoomLevel,n)}function ph(e){const n=je.getState();n.activeTabId!==null&&n.updateTab(n.activeTabId,{name:e.name,path:e.path,isModified:!1,language:sr(e.name)})}function n0(){var e,n;if(Kn()){i0();return}window.electronAPI&&(window.electronAPI.onFileOpened(fh),window.electronAPI.onFolderOpened(dh),window.electronAPI.onMenuAction(hh),(n=(e=window.electronAPI).onFileSaved)==null||n.call(e,ph))}async function i0(){const e=await r0();e!==null&&(e.onFileOpened(fh),e.onFolderOpened(dh),e.onMenuAction(hh),e.onFileSaved(ph))}const a0=[{group:"Unicode",items:[{value:"utf-8",label:"UTF-8"},{value:"utf-8-bom",label:"UTF-8 BOM"},{value:"utf-16le",label:"UTF-16 LE"},{value:"utf-16be",label:"UTF-16 BE"}]},{group:"Western European",items:[{value:"windows-1252",label:"Windows-1252 (ANSI)"},{value:"iso-8859-1",label:"ISO 8859-1 (Latin I)"},{value:"iso-8859-15",label:"ISO 8859-15 (Latin 9)"},{value:"cp850",label:"OEM 850 (DOS Latin)"}]},{group:"Central European",items:[{value:"windows-1250",label:"Windows-1250"},{value:"iso-8859-2",label:"ISO 8859-2 (Latin II)"}]},{group:"Cyrillic",items:[{value:"windows-1251",label:"Windows-1251"},{value:"iso-8859-5",label:"ISO 8859-5"},{value:"koi8-r",label:"KOI8-R"},{value:"koi8-u",label:"KOI8-U"},{value:"cp866",label:"OEM 866 (DOS Cyrillic)"}]},{group:"Greek",items:[{value:"windows-1253",label:"Windows-1253"},{value:"iso-8859-7",label:"ISO 8859-7"}]},{group:"Turkish",items:[{value:"windows-1254",label:"Windows-1254"},{value:"iso-8859-9",label:"ISO 8859-9"}]},{group:"Hebrew",items:[{value:"windows-1255",label:"Windows-1255"},{value:"iso-8859-8",label:"ISO 8859-8"}]},{group:"Arabic",items:[{value:"windows-1256",label:"Windows-1256"},{value:"iso-8859-6",label:"ISO 8859-6"}]},{group:"Baltic",items:[{value:"windows-1257",label:"Windows-1257"},{value:"iso-8859-13",label:"ISO 8859-13"}]},{group:"Vietnamese",items:[{value:"windows-1258",label:"Windows-1258"}]},{group:"East Asian",items:[{value:"big5",label:"Big5 (Traditional Chinese)"},{value:"gb2312",label:"GB2312 (Simplified Chinese)"},{value:"shift_jis",label:"Shift JIS (Japanese)"},{value:"euc-kr",label:"EUC-KR (Korean)"},{value:"iso-2022-jp",label:"ISO-2022-JP"}]},{group:"Thai",items:[{value:"tis-620",label:"TIS-620 (Thai)"}]},{group:"DOS",items:[{value:"cp437",label:"OEM 437 (US)"},{value:"cp737",label:"OEM 737 (Greek)"},{value:"cp775",label:"OEM 775 (Baltic)"},{value:"cp852",label:"OEM 852 (Latin II)"},{value:"cp855",label:"OEM 855 (Cyrillic)"},{value:"cp857",label:"OEM 857 (Turkish)"},{value:"cp858",label:"OEM 858 (Latin I + Euro)"},{value:"cp860",label:"OEM 860 (Portuguese)"},{value:"cp861",label:"OEM 861 (Icelandic)"},{value:"cp862",label:"OEM 862 (Hebrew)"},{value:"cp863",label:"OEM 863 (French Canadian)"},{value:"cp865",label:"OEM 865 (Nordic)"},{value:"cp869",label:"OEM 869 (Greek)"}]}];function ad(){return a0}const o0=[{value:"plaintext",label:"Normal Text"},{value:"actionscript",label:"ActionScript"},{value:"ada",label:"Ada"},{value:"asp",label:"ASP"},{value:"asm",label:"Assembly"},{value:"autoit",label:"AutoIt"},{value:"bat",label:"Batch"},{value:"c",label:"C"},{value:"cpp",label:"C++"},{value:"csharp",label:"C#"},{value:"caml",label:"OCaml"},{value:"cmake",label:"CMake"},{value:"cobol",label:"COBOL"},{value:"coffeescript",label:"CoffeeScript"},{value:"css",label:"CSS"},{value:"d",label:"D"},{value:"dart",label:"Dart"},{value:"diff",label:"Diff"},{value:"dockerfile",label:"Dockerfile"},{value:"elixir",label:"Elixir"},{value:"erlang",label:"Erlang"},{value:"fortran",label:"Fortran"},{value:"fsharp",label:"F#"},{value:"gdscript",label:"GDScript"},{value:"go",label:"Go"},{value:"graphql",label:"GraphQL"},{value:"haskell",label:"Haskell"},{value:"html",label:"HTML"},{value:"ini",label:"INI"},{value:"java",label:"Java"},{value:"javascript",label:"JavaScript"},{value:"json",label:"JSON"},{value:"json5",label:"JSON5"},{value:"julia",label:"Julia"},{value:"kotlin",label:"Kotlin"},{value:"latex",label:"LaTeX"},{value:"less",label:"LESS"},{value:"lisp",label:"Lisp"},{value:"lua",label:"Lua"},{value:"makefile",label:"Makefile"},{value:"markdown",label:"Markdown"},{value:"matlab",label:"MATLAB"},{value:"nim",label:"Nim"},{value:"nsis",label:"NSIS"},{value:"objective-c",label:"Objective-C"},{value:"pascal",label:"Pascal"},{value:"perl",label:"Perl"},{value:"php",label:"PHP"},{value:"powershell",label:"PowerShell"},{value:"properties",label:"Properties"},{value:"python",label:"Python"},{value:"r",label:"R"},{value:"raku",label:"Raku"},{value:"restructuredtext",label:"reStructuredText"},{value:"ruby",label:"Ruby"},{value:"rust",label:"Rust"},{value:"sas",label:"SAS"},{value:"scala",label:"Scala"},{value:"scheme",label:"Scheme"},{value:"scss",label:"SCSS"},{value:"shell",label:"Shell/Bash"},{value:"smalltalk",label:"Smalltalk"},{value:"sql",label:"SQL"},{value:"swift",label:"Swift"},{value:"tcl",label:"Tcl"},{value:"toml",label:"TOML"},{value:"typescript",label:"TypeScript"},{value:"vb",label:"Visual Basic"},{value:"verilog",label:"Verilog"},{value:"vhdl",label:"VHDL"},{value:"xml",label:"XML"},{value:"yaml",label:"YAML"}];function s0(){return o0}function c0({theme:e,onAction:n,isElectron:r}){const[o,c]=fe.useState(null),[u,p]=fe.useState(null),[f,h]=fe.useState(null),[x,_]=fe.useState(-1),y=fe.useRef(null),{settings:O,isRecordingMacro:R}=je(),z=navigator.platform.includes("Mac"),N=z?"":"Ctrl+",L=z?"":"Shift+",D=z?"":"Alt+";fe.useEffect(()=>{const B=K=>{y.current&&!y.current.contains(K.target)&&(c(null),h(null),_(-1))};return document.addEventListener("mousedown",B),()=>document.removeEventListener("mousedown",B)},[]);const U=(B,K)=>{const ce=f?K.indexOf(f):-1;switch(B.key){case"ArrowLeft":case"ArrowRight":B.preventDefault();const S=B.key==="ArrowRight"?1:-1,ie=ce===-1?0:(ce+S+K.length)%K.length,Q=K[ie];h(Q),c(Q),_(-1);break;case"ArrowDown":B.preventDefault(),!o&&f?(c(f),_(0)):o&&_(x+1);break;case"ArrowUp":B.preventDefault(),o&&x>0&&_(x-1);break;case"Enter":case" ":if(B.preventDefault(),o&&x>=0){const W=q[o].filter(oe=>oe.type!=="separator"&&!oe.label.startsWith(""));if(x<W.length){const oe=W[x];Y(oe)}}else f&&(c(f),_(0));break;case"Escape":B.preventDefault(),c(null),h(null),_(-1);break}},G=[];ad().forEach(B=>{G.push({type:"separator",label:`--- ${B.group} ---`}),B.items.forEach(K=>{G.push({label:K.label,action:"encoding",value:K.value})})});const X=s0().map(B=>({label:B.label,action:"language",value:B.value})),q={File:[{label:"New",shortcut:`${N}N`,action:"new"},{type:"separator",label:""},{label:"Open...",shortcut:`${N}O`,action:"open"},{label:"Open Folder as Workspace",action:"open-folder"},{label:"Reload from Disk",action:"reload-from-disk"},{type:"separator",label:""},{label:"Save",shortcut:`${N}S`,action:"save"},{label:"Save As...",shortcut:`${L}${N}S`,action:"save-as"},{label:"Save Copy As...",action:"save-copy-as"},{label:"Save All",action:"save-all"},{type:"separator",label:""},{label:"Rename...",action:"rename-file"},{label:"Delete from Disk",action:"delete-file"},{type:"separator",label:""},{label:"Restore Last Closed Tab",shortcut:`${L}${N}T`,action:"restore-last-closed"},{type:"separator",label:""},{label:"Close Tab",shortcut:`${N}W`,action:"close-tab"},{label:"Close All",action:"close-all"},{label:"Close Others",action:"close-others"},{label:"Close Tabs to Left",action:"close-tabs-to-left"},{label:"Close Tabs to Right",action:"close-tabs-to-right"},{label:"Close Unchanged",action:"close-unchanged"},{label:"Close All but Pinned",action:"close-all-but-pinned"},{type:"separator",label:""},{label:"Pin Tab",action:"pin-tab"},{type:"separator",label:""},{label:"Load Session...",action:"load-session"},{label:"Save Session...",action:"save-session"},{type:"separator",label:""},{label:"Print...",shortcut:`${N}P`,action:"print"}],Edit:[{label:"Undo",shortcut:`${N}Z`,action:"undo"},{label:"Redo",shortcut:`${L}${N}Z`,action:"redo"},{type:"separator",label:""},{label:"Cut",shortcut:`${N}X`,action:"cut"},{label:"Copy",shortcut:`${N}C`,action:"copy"},{label:"Paste",shortcut:`${N}V`,action:"paste"},{label:"Select All",shortcut:`${N}A`,action:"select-all"},{type:"separator",label:""},{label:"Duplicate Line",shortcut:`${N}D`,action:"duplicate-line"},{label:"Delete Line",shortcut:`${L}${N}K`,action:"delete-line"},{label:"Transpose Line",shortcut:`${D}T`,action:"transpose-line"},{label:"Move Line Up",shortcut:`${D}`,action:"move-line-up"},{label:"Move Line Down",shortcut:`${D}`,action:"move-line-down"},{label:"Split Lines",action:"split-lines"},{label:"Join Lines",action:"join-lines"},{type:"separator",label:""},{label:"Toggle Comment",shortcut:`${N}/`,action:"toggle-comment"},{label:"Block Comment",shortcut:`${L}${D}A`,action:"block-comment"},{type:"separator",label:""},{label:"UPPERCASE",shortcut:`${L}${N}U`,action:"uppercase"},{label:"lowercase",shortcut:`${N}U`,action:"lowercase"},{label:"Proper Case",action:"proper-case"},{label:"Sentence Case",action:"sentence-case"},{label:"Invert Case",action:"invert-case"},{label:"Random Case",action:"random-case"},{type:"separator",label:""},{label:"Insert Date/Time",action:"insert-datetime"},{type:"separator",label:""},{label:"Column Editor...",shortcut:`${D}C`,action:"column-editor"},{label:"Clipboard History",shortcut:`${N}${L}V`,action:"clipboard-history"},{label:"Character Panel",action:"char-panel"},{type:"separator",label:""},{label:"Copy File Path",action:"copy-file-path"},{label:"Copy File Name",action:"copy-file-name"},{label:"Copy File Dir",action:"copy-file-dir"},{type:"separator",label:""},{label:"Compare Files...",action:"compare-files"},{label:"Snippet Manager...",action:"snippet-manager"},{type:"separator",label:""},{label:"Set Read-Only",action:"toggle-readonly"}],Search:[{label:"Find...",shortcut:`${N}F`,action:"find"},{label:"Replace...",shortcut:`${N}H`,action:"replace"},{label:"Find in Files...",shortcut:`${L}${N}F`,action:"find-in-files"},{label:"Incremental Search",shortcut:`${N}${D}I`,action:"incremental-search"},{type:"separator",label:""},{label:"Mark...",action:"mark"},{label:"Mark Style 1",action:"mark-style",value:1},{label:"Mark Style 2",action:"mark-style",value:2},{label:"Mark Style 3",action:"mark-style",value:3},{label:"Mark Style 4",action:"mark-style",value:4},{label:"Mark Style 5",action:"mark-style",value:5},{label:"Clear All Marks",action:"clear-marks"},{type:"separator",label:""},{label:"Cut Marked Lines",action:"cut-marked-lines"},{label:"Copy Marked Lines",action:"copy-marked-lines"},{label:"Paste to (Replace) Marked Lines",action:"paste-marked-lines"},{label:"Delete Marked Lines",action:"delete-marked-lines"},{label:"Delete Unmarked Lines",action:"delete-unmarked-lines"},{label:"Inverse Marks",action:"inverse-marks"},{type:"separator",label:""},{label:"Go to Line...",shortcut:`${N}G`,action:"goto-line"},{label:"Go to Matching Bracket",shortcut:`${L}${N}\\`,action:"goto-bracket"},{label:"Select to Matching Bracket",action:"select-to-bracket"},{type:"separator",label:""},{label:"Toggle Bookmark",shortcut:`${N}F2`,action:"toggle-bookmark"},{label:"Next Bookmark",shortcut:"F2",action:"next-bookmark"},{label:"Previous Bookmark",shortcut:`${L}F2`,action:"prev-bookmark"},{label:"Clear All Bookmarks",action:"clear-bookmarks"},{type:"separator",label:""},{label:"Find Characters in Range...",action:"find-char-in-range"}],View:[{label:"Word Wrap",type:"checkbox",checked:O.wordWrap,action:"word-wrap"},{type:"separator",label:""},{label:"Show Whitespace",type:"checkbox",checked:O.showWhitespace,action:"show-whitespace"},{label:"Show EOL",type:"checkbox",checked:O.showEOL,action:"show-eol"},{label:"Show Non-Printable Characters",type:"checkbox",checked:O.showNonPrintable,action:"show-non-printable"},{label:"Show Wrap Symbol",type:"checkbox",checked:O.showWrapSymbol,action:"show-wrap-symbol"},{label:"Show Indent Guides",type:"checkbox",checked:O.showIndentGuides,action:"indent-guide"},{label:"Show Line Numbers",type:"checkbox",checked:O.showLineNumbers,action:"show-line-numbers"},{label:"Show Minimap",type:"checkbox",checked:O.showMinimap,action:"toggle-minimap"},{type:"separator",label:""},{label:"Fold All",action:"fold-all"},{label:"Unfold All",action:"unfold-all"},{label:"Fold Level 1",action:"fold-level",value:1},{label:"Fold Level 2",action:"fold-level",value:2},{label:"Fold Level 3",action:"fold-level",value:3},{label:"Fold Level 4",action:"fold-level",value:4},{label:"Fold Level 5",action:"fold-level",value:5},{label:"Fold Level 6",action:"fold-level",value:6},{label:"Fold Level 7",action:"fold-level",value:7},{label:"Fold Level 8",action:"fold-level",value:8},{type:"separator",label:""},{label:"Zoom In",shortcut:`${N}+`,action:"zoom-in"},{label:"Zoom Out",shortcut:`${N}-`,action:"zoom-out"},{label:"Reset Zoom",shortcut:`${N}0`,action:"zoom-reset"},{type:"separator",label:""},{label:"Toggle Sidebar",shortcut:`${N}B`,action:"toggle-sidebar"},{label:"Document List",action:"show-doc-list"},{label:"Function List",action:"show-function-list"},{label:"Project Panel",action:"show-project-panel"},{type:"separator",label:""},{label:"Distraction-Free Mode",type:"checkbox",checked:O.distractionFreeMode,action:"distraction-free"},{label:"Always on Top",type:"checkbox",checked:O.alwaysOnTop,action:"always-on-top"},{type:"separator",label:""},{label:"Synchronize Vertical Scrolling",type:"checkbox",checked:O.syncScrollVertical,action:"sync-scroll-v"},{label:"Synchronize Horizontal Scrolling",type:"checkbox",checked:O.syncScrollHorizontal,action:"sync-scroll-h"},{type:"separator",label:""},{label:"Split Right",action:"split-right"},{label:"Split Down",action:"split-down"},{label:"Close Split",action:"close-split"},{type:"separator",label:""},{label:"Summary...",action:"show-summary"},{label:"Monitoring (tail -f)",action:"toggle-monitoring"},{type:"separator",label:""},{label:"Command Palette...",shortcut:`${L}${N}P`,action:"command-palette"},{label:"Quick Open...",shortcut:`${N}P`,action:"quick-open"},{label:"Toggle Terminal",shortcut:"Ctrl+`",action:"toggle-terminal"}],Encoding:[...ad().flatMap(B=>[{type:"separator",label:` ${B.group} `},...B.items.map(K=>({label:K.label,action:"encoding",value:K.value}))]),{type:"separator",label:""},{label:"Line Ending: LF (Unix/Mac)",action:"line-ending",value:"LF"},{label:"Line Ending: CRLF (Windows)",action:"line-ending",value:"CRLF"},{label:"Line Ending: CR (Old Mac)",action:"line-ending",value:"CR"}],Language:X,"Line Ops":[{label:"Sort Lines Ascending",action:"sort-asc"},{label:"Sort Lines Descending",action:"sort-desc"},{label:"Sort Lines Case Insensitive (Asc)",action:"sort-asc-ci"},{label:"Sort Lines Case Insensitive (Desc)",action:"sort-desc-ci"},{label:"Sort Lines by Length (Asc)",action:"sort-len-asc"},{label:"Sort Lines by Length (Desc)",action:"sort-len-desc"},{type:"separator",label:""},{label:"Remove Duplicate Lines",action:"remove-duplicates"},{label:"Remove Consecutive Duplicate Lines",action:"remove-consecutive-duplicates"},{label:"Remove Empty Lines",action:"remove-empty-lines"},{label:"Remove Empty Lines (Containing Blank)",action:"remove-blank-lines"},{type:"separator",label:""},{label:"Trim Trailing Spaces",action:"trim-trailing"},{label:"Trim Leading Spaces",action:"trim-leading"},{label:"Trim Leading and Trailing Spaces",action:"trim-both"},{label:"EOL to Space",action:"eol-to-space"},{type:"separator",label:""},{label:"TAB to Space",action:"tab-to-space"},{label:"Space to TAB (Leading)",action:"space-to-tab-leading"},{label:"Space to TAB (All)",action:"space-to-tab-all"},{type:"separator",label:""},{label:"Insert Blank Line Above",action:"insert-blank-above"},{label:"Insert Blank Line Below",action:"insert-blank-below"},{label:"Reverse Line Order",action:"reverse-lines"}],Macro:[{label:R?"Stop Recording":"Start Recording",shortcut:`${L}${N}R`,action:R?"macro-stop":"macro-start"},{label:"Playback",shortcut:`${L}${N}P`,action:"macro-playback"},{type:"separator",label:""},{label:"Run Macro Multiple Times...",action:"macro-run-multiple"},{label:"Save Recorded Macro...",action:"macro-save"}],Git:[{label:"Source Control Panel",action:"show-git-panel"},{type:"separator",label:""},{label:"Clone Repository...",action:"clone-repository"},{type:"separator",label:""},{label:"Compare with HEAD",action:"compare-files"},{type:"separator",label:""},{label:"Git Settings...",action:"git-settings"}],Run:[{label:"Run Command...",action:"run-command"},{type:"separator",label:""},{label:"Search on Google",action:"search-google"},{label:"Search on Wikipedia",action:"search-wikipedia"},{label:"Open in Browser",action:"open-in-browser"}],Tools:[{label:"MD5 - Generate",action:"hash-md5"},{label:"MD5 - Copy to Clipboard",action:"hash-md5-clipboard"},{label:"SHA-1 - Generate",action:"hash-sha1"},{label:"SHA-1 - Copy to Clipboard",action:"hash-sha1-clipboard"},{label:"SHA-256 - Generate",action:"hash-sha256"},{label:"SHA-256 - Copy to Clipboard",action:"hash-sha256-clipboard"},{label:"SHA-512 - Generate",action:"hash-sha512"},{label:"SHA-512 - Copy to Clipboard",action:"hash-sha512-clipboard"},{type:"separator",label:""},{label:"MD5 - Generate from File",action:"hash-md5-file"},{label:"SHA-256 - Generate from File",action:"hash-sha256-file"},{type:"separator",label:""},{label:"Base64 Encode",action:"base64-encode"},{label:"Base64 Decode",action:"base64-decode"},{type:"separator",label:""},{label:"URL Encode",action:"url-encode"},{label:"URL Decode",action:"url-decode"},{type:"separator",label:""},{label:"JSON Format",action:"json-format"},{label:"JSON Minify",action:"json-minify"}],AI:[{label:"AI Chat Panel",shortcut:"Ctrl+Shift+A",action:"ai-chat"},{type:"separator",label:""},{label:"Explain Code",shortcut:"Ctrl+Shift+E",action:"ai-explain"},{label:"Refactor Code",shortcut:"Ctrl+Shift+R",action:"ai-refactor"},{label:"Generate Tests",action:"ai-generate-tests"},{label:"Generate Documentation",action:"ai-generate-docs"},{label:"Fix Error",action:"ai-fix-error"},{label:"Simplify Code",action:"ai-simplify"},{type:"separator",label:""},{label:"Toggle Inline Completions",action:"ai-toggle-inline"},{type:"separator",label:""},{label:"AI Settings...",action:"ai-settings"}],Settings:[{label:"Preferences...",shortcut:`${N},`,action:"preferences"},{label:"Shortcut Mapper...",action:"shortcut-mapper"},{type:"separator",label:""},{label:"About Notemac++",action:"about"}]},Y=B=>{B.type!=="separator"&&(B.label.startsWith("")||(B.type==="checkbox"?n(B.action,!B.checked):B.action&&n(B.action,B.value),c(null)))};return E.jsxs("div",{ref:y,role:"menubar",onKeyDown:B=>U(B,Object.keys(q)),style:{display:"flex",alignItems:"center",height:30,backgroundColor:e.menuBg,borderBottom:`1px solid ${e.border}`,paddingLeft:8,flexShrink:0,outline:"none"},tabIndex:0,children:[E.jsx("span",{style:{fontWeight:600,fontSize:13,marginRight:16,color:e.accent},children:"N++"}),Object.entries(q).map(([B,K])=>E.jsxs("div",{style:{position:"relative"},children:[E.jsx("div",{role:"menuitem","aria-haspopup":"true","aria-expanded":o===B,tabIndex:f===B?0:-1,style:{padding:"4px 10px",cursor:"pointer",borderRadius:4,fontSize:13,backgroundColor:o===B||f===B?e.bgHover:"transparent",color:o===B?e.text:e.menuText,outline:f===B?`1px solid ${e.accent}`:"none",outlineOffset:"-1px"},onClick:()=>{h(B),c(o===B?null:B),_(-1)},onMouseEnter:()=>{h(B),o&&c(B)},onMouseLeave:()=>h(null),children:B}),o===B&&E.jsx("div",{role:"menu",style:{position:"absolute",top:"100%",left:0,minWidth:280,maxHeight:"calc(100vh - 80px)",overflowY:"auto",backgroundColor:e.menuBg,border:`1px solid ${e.border}`,borderRadius:6,padding:"4px 0",zIndex:Ed,boxShadow:"0 4px 16px rgba(0,0,0,0.3)"},children:K.map((ce,S)=>{if(ce.type==="separator")return ce.label&&ce.label.startsWith("")?E.jsx("div",{style:{padding:"4px 16px",fontSize:11,fontWeight:700,color:e.textMuted,textTransform:"uppercase",letterSpacing:.5,cursor:"default"},children:ce.label.replace(/\u2500 /g,"").replace(/ \u2500/g,"")},`sep-header-${S}`):E.jsx("div",{style:{height:1,backgroundColor:e.border,margin:"4px 0"}},`sep-divider-${S}`);const Q=K.filter(oe=>oe.type!=="separator"&&!oe.label.startsWith("")).findIndex(oe=>oe.label===ce.label),se=`${B}-${ce.label}-${S}`,W=x===Q;return E.jsxs("div",{role:"menuitem",tabIndex:W?0:-1,style:{padding:"5px 16px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:24,fontSize:13,backgroundColor:W||u===se?e.bgHover:"transparent",color:e.menuText,outline:W?`1px solid ${e.accent}`:"none",outlineOffset:"-1px"},onClick:()=>Y(ce),onMouseEnter:()=>{p(se),_(Q)},onMouseLeave:()=>p(null),children:[E.jsxs("span",{style:{display:"flex",alignItems:"center",gap:8},children:[ce.type==="checkbox"&&E.jsx("span",{style:{width:16,textAlign:"center"},children:ce.checked?"":""}),ce.label]}),ce.shortcut&&E.jsx("span",{style:{opacity:.5,fontSize:11},children:ce.shortcut})]},`${B}-${ce.action||ce.label}-${S}`)})})]},B)),R&&E.jsxs("div",{className:"recording-indicator",style:{display:"flex",alignItems:"center",gap:6,marginLeft:"auto",marginRight:12,color:"#ff4444",fontSize:12,fontWeight:600},children:[E.jsx("span",{style:{width:8,height:8,borderRadius:"50%",backgroundColor:"#ff4444",display:"inline-block"}}),"REC"]})]})}const Pt={newFile:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M9 1H4a1 1 0 00-1 1v12a1 1 0 001 1h8a1 1 0 001-1V5L9 1z"}),E.jsx("path",{d:"M9 1v4h4"}),E.jsx("path",{d:"M8 8v4M6 10h4"})]}),open:e=>E.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:E.jsx("path",{d:"M2 13V4a1 1 0 011-1h3.5l1.5 1.5H13a1 1 0 011 1V13a1 1 0 01-1 1H3a1 1 0 01-1-1z"})}),save:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M13 14H3a1 1 0 01-1-1V3a1 1 0 011-1h7l3 3v8a1 1 0 01-1 1z"}),E.jsx("path",{d:"M11 14V9H5v5"}),E.jsx("path",{d:"M5 2v3h5"})]}),saveAll:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M12 14H4a1 1 0 01-1-1V4a1 1 0 011-1h5.5l2.5 2.5V13a1 1 0 01-1 1z"}),E.jsx("path",{d:"M10 14V10H6v4"}),E.jsx("path",{d:"M6 3v2h3.5"}),E.jsx("path",{d:"M14 5v7.5",opacity:"0.5"}),E.jsx("path",{d:"M5 2H14.5",opacity:"0.5"})]}),undo:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M3 7h6a3.5 3.5 0 010 7H7"}),E.jsx("path",{d:"M6 4L3 7l3 3"})]}),redo:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M13 7H7a3.5 3.5 0 000 7h2"}),E.jsx("path",{d:"M10 4l3 3-3 3"})]}),find:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"7",cy:"7",r:"4"}),E.jsx("path",{d:"M14 14l-3.5-3.5"})]}),replace:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"5.5",cy:"5.5",r:"3"}),E.jsx("path",{d:"M14 14l-2.8-2.8"}),E.jsx("path",{d:"M10 7l2-2 2 2"}),E.jsx("path",{d:"M12 5v5.5a1.5 1.5 0 01-3 0"})]}),zoomIn:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"7",cy:"7",r:"4"}),E.jsx("path",{d:"M14 14l-3.5-3.5"}),E.jsx("path",{d:"M7 5v4M5 7h4"})]}),zoomOut:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"7",cy:"7",r:"4"}),E.jsx("path",{d:"M14 14l-3.5-3.5"}),E.jsx("path",{d:"M5 7h4"})]}),record:e=>E.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:E.jsx("circle",{cx:"8",cy:"8",r:"5",fill:e})}),stop:e=>E.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:E.jsx("rect",{x:"4",y:"4",width:"8",height:"8",rx:"1",fill:e})}),play:e=>E.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:e,children:E.jsx("polygon",{points:"5,3 13,8 5,13"})}),sidebar:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("rect",{x:"2",y:"2",width:"12",height:"12",rx:"1"}),E.jsx("path",{d:"M6 2v12"})]}),wordWrap:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M3 4h10M3 8h8a2 2 0 010 4H8"}),E.jsx("path",{d:"M10 10l-2 2 2 2"})]}),whitespace:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("path",{d:"M3 12h10"}),E.jsx("circle",{cx:"5",cy:"7",r:"0.8",fill:e}),E.jsx("circle",{cx:"8",cy:"7",r:"0.8",fill:e}),E.jsx("circle",{cx:"11",cy:"7",r:"0.8",fill:e})]}),settings:e=>E.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",stroke:e,strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",children:[E.jsx("circle",{cx:"8",cy:"8",r:"2"}),E.jsx("path",{d:"M8 1.5v2M8 12.5v2M1.5 8h2M12.5 8h2M3.4 3.4l1.4 1.4M11.2 11.2l1.4 1.4M3.4 12.6l1.4-1.4M11.2 4.8l1.4-1.4"})]})};function Lt({icon:e,title:n,onClick:r,theme:o,active:c,danger:u}){const[p,f]=St.useState(!1);return E.jsx("button",{title:n,"aria-label":n,onClick:r,onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),style:{background:p?o.bgHover:c?o.bgActive:"transparent",border:"none",color:u?o.danger:c?o.accent:o.textSecondary,cursor:"pointer",padding:"4px 6px",borderRadius:4,fontSize:16,lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:28,height:28},children:e})}function Fn({theme:e}){return E.jsx("div",{style:{width:1,height:20,backgroundColor:e.border,margin:"0 4px"}})}function l0({theme:e,onAction:n}){const{isRecordingMacro:r,settings:o}=je(),c=e.textSecondary,u=e.danger||"#e53e3e";return E.jsxs("div",{style:{display:"flex",alignItems:"center",height:36,backgroundColor:e.bgSecondary,borderBottom:`1px solid ${e.border}`,padding:"0 8px",gap:2,flexShrink:0},children:[E.jsx(Lt,{icon:Pt.newFile(c),title:"New (Cmd+N)",onClick:()=>n("new"),theme:e}),E.jsx(Lt,{icon:Pt.open(c),title:"Open (Cmd+O)",onClick:()=>n("open"),theme:e}),E.jsx(Lt,{icon:Pt.save(c),title:"Save (Cmd+S)",onClick:()=>n("save"),theme:e}),E.jsx(Lt,{icon:Pt.saveAll(c),title:"Save All",onClick:()=>n("save-all"),theme:e}),E.jsx(Fn,{theme:e}),E.jsx(Lt,{icon:Pt.undo(c),title:"Undo (Cmd+Z)",onClick:()=>n("undo"),theme:e}),E.jsx(Lt,{icon:Pt.redo(c),title:"Redo (Cmd+Shift+Z)",onClick:()=>n("redo"),theme:e}),E.jsx(Fn,{theme:e}),E.jsx(Lt,{icon:Pt.find(c),title:"Find (Cmd+F)",onClick:()=>n("find"),theme:e}),E.jsx(Lt,{icon:Pt.replace(c),title:"Replace (Cmd+H)",onClick:()=>n("replace"),theme:e}),E.jsx(Fn,{theme:e}),E.jsx(Lt,{icon:Pt.zoomIn(c),title:"Zoom In (Cmd++)",onClick:()=>n("zoom-in"),theme:e}),E.jsx(Lt,{icon:Pt.zoomOut(c),title:"Zoom Out (Cmd+-)",onClick:()=>n("zoom-out"),theme:e}),E.jsx(Fn,{theme:e}),E.jsx(Lt,{icon:r?Pt.stop(u):Pt.record(c),title:r?"Stop Recording":"Start Recording",onClick:()=>n(r?"macro-stop":"macro-start"),theme:e,danger:r}),E.jsx(Lt,{icon:Pt.play(c),title:"Playback Macro",onClick:()=>n("macro-playback"),theme:e}),E.jsx(Fn,{theme:e}),E.jsx(Lt,{icon:Pt.sidebar(c),title:"Toggle Sidebar (Cmd+B)",onClick:()=>n("toggle-sidebar"),theme:e}),E.jsx(Lt,{icon:Pt.wordWrap(c),title:"Word Wrap",onClick:()=>n("word-wrap",!o.wordWrap),theme:e}),E.jsx(Lt,{icon:Pt.whitespace(c),title:"Show Whitespace",onClick:()=>n("show-whitespace",!o.showWhitespace),theme:e}),E.jsx("div",{style:{flex:1}}),E.jsx(Lt,{icon:Pt.settings(c),title:"Settings (Cmd+,)",onClick:()=>n("preferences"),theme:e})]})}function u0({theme:e}){const{tabs:n,activeTabId:r,setActiveTab:o,closeTab:c,addTab:u,closeOtherTabs:p,closeAllTabs:f,moveTab:h,setSplitView:x,closeTabsToLeft:_,closeTabsToRight:y,closeUnchangedTabs:O,closeAllButPinned:R,togglePinTab:z,setTabColor:N}=je(),[L,D]=fe.useState(null),[U,G]=fe.useState(null),[X,q]=fe.useState(null),[Y,B]=fe.useState(!1),K=W=>{D(W)},ce=(W,oe)=>{W.preventDefault(),G(oe)},S=W=>{L!==null&&L!==W&&h(L,W),D(null),G(null)},ie=(W,oe)=>{W.preventDefault(),q({x:W.clientX,y:W.clientY,tabId:oe}),B(!1)},Q=(W,oe)=>{W.button===1&&(W.preventDefault(),c(oe))};St.useEffect(()=>{const W=()=>{q(null),B(!1)};if(X)return document.addEventListener("click",W),()=>document.removeEventListener("click",W)},[X]);const se=X?n.find(W=>W.id===X.tabId):null;return E.jsxs(E.Fragment,{children:[E.jsxs("div",{style:{display:"flex",alignItems:"flex-end",backgroundColor:e.tabBg,borderBottom:`1px solid ${e.border}`,overflowX:"auto",overflowY:"hidden",scrollbarWidth:"thin",flexShrink:0,height:va},children:[n.map((W,oe)=>{const te=W.id===r,re=tu[W.tabColor];return E.jsxs("div",{draggable:!0,onDragStart:()=>K(oe),onDragOver:le=>ce(le,oe),onDrop:()=>S(oe),onDragEnd:()=>{D(null),G(null)},onClick:()=>o(W.id),onMouseDown:le=>Q(le,W.id),onContextMenu:le=>ie(le,W.id),style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",cursor:"pointer",backgroundColor:te?e.tabActiveBg:e.tabBg,color:te?e.tabActiveText:e.textSecondary,borderRight:`1px solid ${e.tabBorder}`,borderTop:W.tabColor!=="none"?`3px solid ${re}`:te?`2px solid ${e.accent}`:"2px solid transparent",borderBottom:te?"none":`1px solid ${e.border}`,minWidth:nm,maxWidth:im,height:va,position:"relative",opacity:L===oe?.5:1,borderLeft:U===oe?`2px solid ${e.accent}`:"none",fontSize:13,whiteSpace:"nowrap",flexShrink:0},children:[E.jsxs("span",{style:{overflow:"hidden",textOverflow:"ellipsis",flex:1,display:"flex",alignItems:"center",gap:4},children:[W.isPinned&&E.jsx("span",{style:{fontSize:10,opacity:.7},title:"Pinned",children:""}),W.isModified&&E.jsx("span",{style:{color:e.warning},children:""}),W.isReadOnly&&E.jsx("span",{style:{fontSize:10,opacity:.7},title:"Read Only",children:""}),W.name]}),!W.isPinned&&E.jsx("button",{"aria-label":`Close tab: ${W.name}`,onClick:le=>{le.stopPropagation(),c(W.id)},style:{width:au,height:au,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,fontSize:14,opacity:.5,flexShrink:0,backgroundColor:"transparent",border:"none",cursor:"pointer",color:"inherit",padding:0},onMouseEnter:le=>{le.target.style.opacity="1",le.target.style.backgroundColor=e.bgHover},onMouseLeave:le=>{le.target.style.opacity="0.5",le.target.style.backgroundColor="transparent"},children:""})]},W.id)}),E.jsx("button",{"aria-label":"New tab",onClick:()=>u(),style:{display:"flex",alignItems:"center",justifyContent:"center",width:am,height:va,cursor:"pointer",color:e.textMuted,fontSize:18,flexShrink:0,backgroundColor:"transparent",border:"none",padding:0},onMouseEnter:W=>{W.target.style.color=e.text},onMouseLeave:W=>{W.target.style.color=e.textMuted},children:"+"})]}),X&&E.jsxs("div",{className:"context-menu",style:{left:X.x,top:X.y,backgroundColor:e.menuBg,border:`1px solid ${e.border}`,position:"fixed",zIndex:2e4,borderRadius:6,padding:"4px 0",minWidth:200,boxShadow:"0 4px 16px rgba(0,0,0,0.3)"},children:[[{label:"Close",action:()=>c(X.tabId)},{label:"Close Others",action:()=>p(X.tabId)},{label:"Close Tabs to the Left",action:()=>_(X.tabId)},{label:"Close Tabs to the Right",action:()=>y(X.tabId)},{label:"Close All",action:()=>f()},{label:"Close Unchanged",action:()=>O()},{label:"Close All but Pinned",action:()=>R()},{label:"separator"},{label:se!=null&&se.isPinned?"Unpin Tab":"Pin Tab",action:()=>z(X.tabId)},{label:"separator"},{label:"Tab Color",action:()=>B(!Y)},{label:"separator"},{label:"Clone to Split View",action:()=>x("vertical",X.tabId)}].map((W,oe)=>W.label==="separator"?E.jsx("div",{style:{height:1,backgroundColor:e.border,margin:"4px 0"}},`sep-${oe}`):E.jsx("div",{style:{padding:"5px 16px",cursor:"pointer",fontSize:13,color:e.menuText},onClick:te=>{te.stopPropagation(),W.action(),W.label!=="Tab Color"&&q(null)},onMouseEnter:te=>{te.target.style.backgroundColor=e.bgHover},onMouseLeave:te=>{te.target.style.backgroundColor="transparent"},children:W.label},`contextmenu-${W.label}-${oe}`)),Y&&E.jsx("div",{style:{display:"flex",gap:4,padding:"4px 16px 8px"},children:["none","color1","color2","color3","color4","color5"].map(W=>E.jsx("div",{onClick:oe=>{oe.stopPropagation(),N(X.tabId,W),q(null)},style:{width:20,height:20,borderRadius:4,backgroundColor:W==="none"?e.bgTertiary:tu[W],border:(se==null?void 0:se.tabColor)===W?"2px solid white":`1px solid ${e.border}`,cursor:"pointer"},title:W==="none"?"No color":W},`color-${W}`))})]})]})}function od(e,n){(n==null||n>e.length)&&(n=e.length);for(var r=0,o=Array(n);r<n;r++)o[r]=e[r];return o}function f0(e){if(Array.isArray(e))return e}function d0(e,n,r){return(n=b0(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function h0(e,n){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var o,c,u,p,f=[],h=!0,x=!1;try{if(u=(r=r.call(e)).next,n!==0)for(;!(h=(o=u.call(r)).done)&&(f.push(o.value),f.length!==n);h=!0);}catch(_){x=!0,c=_}finally{try{if(!h&&r.return!=null&&(p=r.return(),Object(p)!==p))return}finally{if(x)throw c}}return f}}function p0(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sd(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,o)}return r}function cd(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?sd(Object(r),!0).forEach(function(o){d0(e,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sd(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))})}return e}function g0(e,n){if(e==null)return{};var r,o,c=m0(e,n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(o=0;o<u.length;o++)r=u[o],n.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(c[r]=e[r])}return c}function m0(e,n){if(e==null)return{};var r={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(n.indexOf(o)!==-1)continue;r[o]=e[o]}return r}function w0(e,n){return f0(e)||h0(e,n)||v0(e,n)||p0()}function y0(e,n){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var o=r.call(e,n);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function b0(e){var n=y0(e,"string");return typeof n=="symbol"?n:n+""}function v0(e,n){if(e){if(typeof e=="string")return od(e,n);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?od(e,n):void 0}}function x0(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function ld(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),r.push.apply(r,o)}return r}function ud(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?ld(Object(r),!0).forEach(function(o){x0(e,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ld(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))})}return e}function _0(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(o){return n.reduceRight(function(c,u){return u(c)},o)}}function Ln(e){return function n(){for(var r=this,o=arguments.length,c=new Array(o),u=0;u<o;u++)c[u]=arguments[u];return c.length>=e.length?e.apply(this,c):function(){for(var p=arguments.length,f=new Array(p),h=0;h<p;h++)f[h]=arguments[h];return n.apply(r,[].concat(c,f))}}}function ji(e){return{}.toString.call(e).includes("Object")}function S0(e){return!Object.keys(e).length}function Wn(e){return typeof e=="function"}function k0(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function E0(e,n){return ji(n)||yr("changeType"),Object.keys(n).some(function(r){return!k0(e,r)})&&yr("changeField"),n}function I0(e){Wn(e)||yr("selectorType")}function A0(e){Wn(e)||ji(e)||yr("handlerType"),ji(e)&&Object.values(e).some(function(n){return!Wn(n)})&&yr("handlersType")}function C0(e){e||yr("initialIsRequired"),ji(e)||yr("initialType"),S0(e)&&yr("initialContent")}function T0(e,n){throw new Error(e[n]||e.default)}var R0={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},yr=Ln(T0)(R0),Si={changes:E0,selector:I0,handler:A0,initial:C0};function O0(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Si.initial(e),Si.handler(n);var r={current:e},o=Ln(j0)(r,n),c=Ln(P0)(r),u=Ln(Si.changes)(e),p=Ln(M0)(r);function f(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(_){return _};return Si.selector(x),x(r.current)}function h(x){_0(o,c,u,p)(x)}return[f,h]}function M0(e,n){return Wn(n)?n(e.current):n}function P0(e,n){return e.current=ud(ud({},e.current),n),n}function j0(e,n,r){return Wn(n)?n(e.current):Object.keys(r).forEach(function(o){var c;return(c=n[o])===null||c===void 0?void 0:c.call(n,e.current[o])}),r}var B0={create:O0},F0={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function D0(e){return function n(){for(var r=this,o=arguments.length,c=new Array(o),u=0;u<o;u++)c[u]=arguments[u];return c.length>=e.length?e.apply(this,c):function(){for(var p=arguments.length,f=new Array(p),h=0;h<p;h++)f[h]=arguments[h];return n.apply(r,[].concat(c,f))}}}function L0(e){return{}.toString.call(e).includes("Object")}function $0(e){return e||fd("configIsRequired"),L0(e)||fd("configType"),e.urls?{paths:{vs:e.urls.monacoBase}}:e}function N0(e,n){throw new Error(e[n]||e.default)}var U0={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},fd=D0(N0)(U0),z0={config:$0},G0=function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return function(c){return r.reduceRight(function(u,p){return p(u)},c)}};function gh(e,n){return Object.keys(n).forEach(function(r){n[r]instanceof Object&&e[r]&&Object.assign(n[r],gh(e[r],n[r]))}),cd(cd({},e),n)}var H0={type:"cancelation",msg:"operation is manually canceled"};function is(e){var n=!1,r=new Promise(function(o,c){e.then(function(u){return n?c(H0):o(u)}),e.catch(c)});return r.cancel=function(){return n=!0},r}var W0=["monaco"],q0=B0.create({config:F0,isInitialized:!1,resolve:null,reject:null,monaco:null}),mh=w0(q0,2),Jn=mh[0],zi=mh[1];function V0(e){var n=z0.config(e),r=n.monaco,o=g0(n,W0);zi(function(c){return{config:gh(c.config,o),monaco:r}})}function K0(){var e=Jn(function(n){var r=n.monaco,o=n.isInitialized,c=n.resolve;return{monaco:r,isInitialized:o,resolve:c}});if(!e.isInitialized){if(zi({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),is(as);if(window.monaco&&window.monaco.editor)return wh(window.monaco),e.resolve(window.monaco),is(as);G0(Z0,Y0)(J0)}return is(as)}function Z0(e){return document.body.appendChild(e)}function X0(e){var n=document.createElement("script");return e&&(n.src=e),n}function Y0(e){var n=Jn(function(o){var c=o.config,u=o.reject;return{config:c,reject:u}}),r=X0("".concat(n.config.paths.vs,"/loader.js"));return r.onload=function(){return e()},r.onerror=n.reject,r}function J0(){var e=Jn(function(r){var o=r.config,c=r.resolve,u=r.reject;return{config:o,resolve:c,reject:u}}),n=window.require;n.config(e.config),n(["vs/editor/editor.main"],function(r){var o=r.m||r;wh(o),e.resolve(o)},function(r){e.reject(r)})}function wh(e){Jn().monaco||zi({monaco:e})}function Q0(){return Jn(function(e){var n=e.monaco;return n})}var as=new Promise(function(e,n){return zi({resolve:e,reject:n})}),yh={config:V0,init:K0,__getMonacoInstance:Q0},eb={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},os=eb,tb={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},rb=tb;function nb({children:e}){return St.createElement("div",{style:rb.container},e)}var ib=nb,ab=ib;function ob({width:e,height:n,isEditorReady:r,loading:o,_ref:c,className:u,wrapperProps:p}){return St.createElement("section",{style:{...os.wrapper,width:e,height:n},...p},!r&&St.createElement(ab,null,o),St.createElement("div",{ref:c,style:{...os.fullWidth,...!r&&os.hide},className:u}))}var sb=ob,bh=fe.memo(sb);function cb(e){fe.useEffect(e,[])}var vh=cb;function lb(e,n,r=!0){let o=fe.useRef(!0);fe.useEffect(o.current||!r?()=>{o.current=!1}:e,n)}var Wt=lb;function Un(){}function rn(e,n,r,o){return ub(e,o)||fb(e,n,r,o)}function ub(e,n){return e.editor.getModel(xh(e,n))}function fb(e,n,r,o){return e.editor.createModel(n,r,o?xh(e,o):void 0)}function xh(e,n){return e.Uri.parse(n)}function db({original:e,modified:n,language:r,originalLanguage:o,modifiedLanguage:c,originalModelPath:u,modifiedModelPath:p,keepCurrentOriginalModel:f=!1,keepCurrentModifiedModel:h=!1,theme:x="light",loading:_="Loading...",options:y={},height:O="100%",width:R="100%",className:z,wrapperProps:N={},beforeMount:L=Un,onMount:D=Un}){let[U,G]=fe.useState(!1),[X,q]=fe.useState(!0),Y=fe.useRef(null),B=fe.useRef(null),K=fe.useRef(null),ce=fe.useRef(D),S=fe.useRef(L),ie=fe.useRef(!1);vh(()=>{let oe=yh.init();return oe.then(te=>(B.current=te)&&q(!1)).catch(te=>(te==null?void 0:te.type)!=="cancelation"&&void 0),()=>Y.current?W():oe.cancel()}),Wt(()=>{if(Y.current&&B.current){let oe=Y.current.getOriginalEditor(),te=rn(B.current,e||"",o||r||"text",u||"");te!==oe.getModel()&&oe.setModel(te)}},[u],U),Wt(()=>{if(Y.current&&B.current){let oe=Y.current.getModifiedEditor(),te=rn(B.current,n||"",c||r||"text",p||"");te!==oe.getModel()&&oe.setModel(te)}},[p],U),Wt(()=>{let oe=Y.current.getModifiedEditor();oe.getOption(B.current.editor.EditorOption.readOnly)?oe.setValue(n||""):n!==oe.getValue()&&(oe.executeEdits("",[{range:oe.getModel().getFullModelRange(),text:n||"",forceMoveMarkers:!0}]),oe.pushUndoStop())},[n],U),Wt(()=>{var oe,te;(te=(oe=Y.current)==null?void 0:oe.getModel())==null||te.original.setValue(e||"")},[e],U),Wt(()=>{let{original:oe,modified:te}=Y.current.getModel();B.current.editor.setModelLanguage(oe,o||r||"text"),B.current.editor.setModelLanguage(te,c||r||"text")},[r,o,c],U),Wt(()=>{var oe;(oe=B.current)==null||oe.editor.setTheme(x)},[x],U),Wt(()=>{var oe;(oe=Y.current)==null||oe.updateOptions(y)},[y],U);let Q=fe.useCallback(()=>{var re;if(!B.current)return;S.current(B.current);let oe=rn(B.current,e||"",o||r||"text",u||""),te=rn(B.current,n||"",c||r||"text",p||"");(re=Y.current)==null||re.setModel({original:oe,modified:te})},[r,n,c,e,o,u,p]),se=fe.useCallback(()=>{var oe;!ie.current&&K.current&&(Y.current=B.current.editor.createDiffEditor(K.current,{automaticLayout:!0,...y}),Q(),(oe=B.current)==null||oe.editor.setTheme(x),G(!0),ie.current=!0)},[y,x,Q]);fe.useEffect(()=>{U&&ce.current(Y.current,B.current)},[U]),fe.useEffect(()=>{!X&&!U&&se()},[X,U,se]);function W(){var te,re,le,me;let oe=(te=Y.current)==null?void 0:te.getModel();f||((re=oe==null?void 0:oe.original)==null||re.dispose()),h||((le=oe==null?void 0:oe.modified)==null||le.dispose()),(me=Y.current)==null||me.dispose()}return St.createElement(bh,{width:R,height:O,isEditorReady:U,loading:_,_ref:K,className:z,wrapperProps:N})}var hb=db,r1=fe.memo(hb);function pb(e){let n=fe.useRef();return fe.useEffect(()=>{n.current=e},[e]),n.current}var gb=pb,ki=new Map;function mb({defaultValue:e,defaultLanguage:n,defaultPath:r,value:o,language:c,path:u,theme:p="light",line:f,loading:h="Loading...",options:x={},overrideServices:_={},saveViewState:y=!0,keepCurrentModel:O=!1,width:R="100%",height:z="100%",className:N,wrapperProps:L={},beforeMount:D=Un,onMount:U=Un,onChange:G,onValidate:X=Un}){let[q,Y]=fe.useState(!1),[B,K]=fe.useState(!0),ce=fe.useRef(null),S=fe.useRef(null),ie=fe.useRef(null),Q=fe.useRef(U),se=fe.useRef(D),W=fe.useRef(),oe=fe.useRef(o),te=gb(u),re=fe.useRef(!1),le=fe.useRef(!1);vh(()=>{let ve=yh.init();return ve.then(Re=>(ce.current=Re)&&K(!1)).catch(Re=>(Re==null?void 0:Re.type)!=="cancelation"&&void 0),()=>S.current?Fe():ve.cancel()}),Wt(()=>{var Re,He,tt,it;let ve=rn(ce.current,e||o||"",n||c||"",u||r||"");ve!==((Re=S.current)==null?void 0:Re.getModel())&&(y&&ki.set(te,(He=S.current)==null?void 0:He.saveViewState()),(tt=S.current)==null||tt.setModel(ve),y&&((it=S.current)==null||it.restoreViewState(ki.get(u))))},[u],q),Wt(()=>{var ve;(ve=S.current)==null||ve.updateOptions(x)},[x],q),Wt(()=>{!S.current||o===void 0||(S.current.getOption(ce.current.editor.EditorOption.readOnly)?S.current.setValue(o):o!==S.current.getValue()&&(le.current=!0,S.current.executeEdits("",[{range:S.current.getModel().getFullModelRange(),text:o,forceMoveMarkers:!0}]),S.current.pushUndoStop(),le.current=!1))},[o],q),Wt(()=>{var Re,He;let ve=(Re=S.current)==null?void 0:Re.getModel();ve&&c&&((He=ce.current)==null||He.editor.setModelLanguage(ve,c))},[c],q),Wt(()=>{var ve;f!==void 0&&((ve=S.current)==null||ve.revealLine(f))},[f],q),Wt(()=>{var ve;(ve=ce.current)==null||ve.editor.setTheme(p)},[p],q);let me=fe.useCallback(()=>{var ve;if(!(!ie.current||!ce.current)&&!re.current){se.current(ce.current);let Re=u||r,He=rn(ce.current,o||e||"",n||c||"",Re||"");S.current=(ve=ce.current)==null?void 0:ve.editor.create(ie.current,{model:He,automaticLayout:!0,...x},_),y&&S.current.restoreViewState(ki.get(Re)),ce.current.editor.setTheme(p),f!==void 0&&S.current.revealLine(f),Y(!0),re.current=!0}},[e,n,r,o,c,u,x,_,y,p,f]);fe.useEffect(()=>{q&&Q.current(S.current,ce.current)},[q]),fe.useEffect(()=>{!B&&!q&&me()},[B,q,me]),oe.current=o,fe.useEffect(()=>{var ve,Re;q&&G&&((ve=W.current)==null||ve.dispose(),W.current=(Re=S.current)==null?void 0:Re.onDidChangeModelContent(He=>{le.current||G(S.current.getValue(),He)}))},[q,G]),fe.useEffect(()=>{if(q){let ve=ce.current.editor.onDidChangeMarkers(Re=>{var tt;let He=(tt=S.current.getModel())==null?void 0:tt.uri;if(He&&Re.find(it=>it.path===He.path)){let it=ce.current.editor.getModelMarkers({resource:He});X==null||X(it)}});return()=>{ve==null||ve.dispose()}}return()=>{}},[q,X]);function Fe(){var ve,Re;(ve=W.current)==null||ve.dispose(),O?y&&ki.set(u,S.current.saveViewState()):(Re=S.current.getModel())==null||Re.dispose(),S.current.dispose()}return St.createElement(bh,{width:R,height:z,isEditorReady:q,loading:h,_ref:ie,className:N,wrapperProps:L})}var wb=mb,yb=fe.memo(wb),bb=yb;function vb(e){const{savedSnippets:n}=je.getState();return n.filter(r=>r.language==="*"||r.language===e)}function xb(e,n){if(!e)return;const r=e.getContribution("snippetController2");if(r)r.insert(n);else{const o=n.replace(/\$\{?\d+(?::([^}]*))?\}?/g,"$1").replace(/\$0/g,""),c=e.getSelection();c&&e.executeEdits("snippet",[{range:c,text:o,forceMoveMarkers:!0}])}}function _b(e){return e.languages.registerCompletionItemProvider("*",{provideCompletionItems:(n,r)=>{const o=n.getLanguageId(),c=vb(o);if(c.length===0)return{suggestions:[]};const u=n.getWordUntilPosition(r),p={startLineNumber:r.lineNumber,endLineNumber:r.lineNumber,startColumn:u.startColumn,endColumn:u.endColumn};return{suggestions:c.map(h=>({label:h.prefix,kind:e.languages.CompletionItemKind.Snippet,documentation:h.description||h.name,insertText:h.body,insertTextRules:e.languages.CompletionItemInsertTextRule.InsertAsSnippet,detail:`Snippet: ${h.name}`,range:p}))}}})}let wr=null,ss=0;function Sb(e,n){const r=[];return r.push(e.languages.registerCompletionItemProvider("*",{provideCompletionItems:(o,c)=>{const{tabs:u}=je.getState(),p=o.getValue(),f=o.getWordUntilPosition(c),h={startLineNumber:c.lineNumber,endLineNumber:c.lineNumber,startColumn:f.startColumn,endColumn:f.endColumn},x=new Set,_=/\b[a-zA-Z_$][a-zA-Z0-9_$]{2,}\b/g,y=u.length;for(let R=0;R<y;R++){const z=u[R].content;if(z===p)continue;let N;for(_.lastIndex=0;(N=_.exec(z))!==null;)x.add(N[0])}return f.word&&x.delete(f.word),{suggestions:Array.from(x).map(R=>({label:R,kind:e.languages.CompletionItemKind.Text,detail:"from other tabs",insertText:R,range:h,sortText:"~"+R}))}}})),r.push(_b(e)),r.push(e.languages.registerCompletionItemProvider("*",{triggerCharacters:["/"],provideCompletionItems:(o,c)=>{if(!o.getLineContent(c.lineNumber).substring(0,c.column-1).match(/['".]\/[^'"]*$/))return{suggestions:[]};const{tabs:f,fileTree:h}=je.getState(),x=o.getWordUntilPosition(c),_={startLineNumber:c.lineNumber,endLineNumber:c.lineNumber,startColumn:x.startColumn,endColumn:x.endColumn},y=f.map(O=>({label:O.name,kind:e.languages.CompletionItemKind.File,detail:O.path||"open tab",insertText:O.name,range:_}));if(h){const O=(R,z)=>{for(const N of R)y.push({label:z+N.name,kind:N.isDirectory?e.languages.CompletionItemKind.Folder:e.languages.CompletionItemKind.File,detail:N.path,insertText:N.name,range:_}),N.children&&O(N.children,z+N.name+"/")};O(h,"")}return{suggestions:y}}})),r.push(kb(e)),r}function kb(e,n){return e.languages.registerInlineCompletionsProvider("*",{provideInlineCompletions:async(o,c,u,p)=>{const f=je.getState();if(!f.aiEnabled||!f.inlineSuggestionEnabled)return{items:[]};if(!f.aiSettings.inlineCompletionEnabled)return{items:[]};const h=f.GetActiveProvider();if(h===null)return{items:[]};const x=f.GetCredentialForProvider(h.id);if(x===null||x.apiKey.length===0)return{items:[]};wr!==null&&(clearTimeout(wr),wr=null);const _=++ss,y=f.aiSettings.inlineDebounceMs||Sd;if(!await new Promise(q=>{wr=setTimeout(()=>{wr=null,q(_===ss)},y),p.onCancellationRequested(()=>{wr!==null&&(clearTimeout(wr),wr=null),q(!1)})}))return{items:[]};const R=o.getOffsetAt(c),z=o.getValue(),N=z.substring(0,R),L=z.substring(R),D=N.length>wi?N.substring(N.length-wi):N,U=L.length>wi?L.substring(0,wi):L;if(D.trimEnd().length<5)return{items:[]};const X=o.getLanguageId()||"plaintext";try{const q=await Wm(D,U,X);if(_!==ss)return{items:[]};if(q.length===0)return{items:[]};let Y=q.trim();if(Y.startsWith("```")){const B=Y.split(`
`);B.shift(),0<B.length&&B[B.length-1].startsWith("```")&&B.pop(),Y=B.join(`
`)}return Y.length===0?{items:[]}:{items:[{insertText:Y,range:new e.Range(c.lineNumber,c.column,c.lineNumber,c.column)}]}}catch{return{items:[]}}},freeInlineCompletions:()=>{}})}const _h=new WeakMap;function Eb(e,n,r,o){return fe.useCallback((c,u)=>{Jm(u),u.editor.setTheme(n.editorMonacoTheme),o(!0),c.onDidChangeCursorPosition(f=>{r(e.id,{cursorLine:f.position.lineNumber,cursorColumn:f.position.column})}),c.onDidScrollChange(f=>{r(e.id,{scrollTop:f.scrollTop})}),c.addCommand(u.KeyMod.CtrlCmd|u.KeyCode.KeyD,()=>{var f;(f=c.getAction("editor.action.copyLinesDownAction"))==null||f.run()}),c.addCommand(u.KeyMod.CtrlCmd|u.KeyMod.Shift|u.KeyCode.KeyK,()=>{var f;(f=c.getAction("editor.action.deleteLines"))==null||f.run()}),c.addCommand(u.KeyMod.Alt|u.KeyCode.UpArrow,()=>{var f;(f=c.getAction("editor.action.moveLinesUpAction"))==null||f.run()}),c.addCommand(u.KeyMod.Alt|u.KeyCode.DownArrow,()=>{var f;(f=c.getAction("editor.action.moveLinesDownAction"))==null||f.run()}),c.addCommand(u.KeyMod.CtrlCmd|u.KeyCode.Slash,()=>{var f;(f=c.getAction("editor.action.commentLine"))==null||f.run()}),e.scrollTop&&c.setScrollTop(e.scrollTop),ew(c);const p=Sb(u);_h.set(c,p),c.focus()},[e.id,e.scrollTop,n.editorMonacoTheme,r,o])}function Ib(e){var r;if(!e)return;const n=_h.get(e);if(n)for(const o of n)(r=o==null?void 0:o.dispose)==null||r.call(o)}function Ab(e,n,r,o){const c=fe.useCallback(_=>{if(!e||!n)return;const{query:y,direction:O,isCaseSensitive:R,isWholeWord:z,isRegex:N}=_.detail;if(!y)return;const L=e.getModel();if(!L)return;const D=L.getValue(),U=e.getPosition(),G=U?L.getOffsetAt(U):0;let X="g";R||(X+="i");let q;N?q=y:q=y.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),z&&(q=`\\b${q}\\b`);let Y;try{Y=new RegExp(q,X)}catch{return}const B=[];let K;for(;(K=Y.exec(D))!==null;)B.push({start:K.index,end:K.index+K[0].length}),K[0].length===0&&Y.lastIndex++;if(B.length===0)return;let ce;O==="next"?ce=B.find(Q=>Q.start>=G)||B[0]:ce=[...B].reverse().find(Q=>Q.end<=G)||B[B.length-1];const S=L.getPositionAt(ce.start),ie=L.getPositionAt(ce.end);e.setSelection(new n.Range(S.lineNumber,S.column,ie.lineNumber,ie.column)),e.revealLineInCenter(S.lineNumber)},[e,n]),u=fe.useCallback(_=>{if(!e||!n)return;const{find:y,replace:O,all:R,isCaseSensitive:z,isWholeWord:N,isRegex:L}=_.detail;if(!y)return;const D=e.getModel();if(!D)return;let U="g";z||(U+="i");let G;L?G=y:G=y.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),N&&(G=`\\b${G}\\b`);let X;try{X=new RegExp(G,U)}catch{return}if(R){const q=D.getFullModelRange(),Y=D.getValue().replace(X,O);e.executeEdits("replace-all",[{range:q,text:Y}])}else{const q=e.getSelection();if(q&&!q.isEmpty()){const Y=D.getValueInRange(q),B=new RegExp(G,z?"":"i");B.test(Y)&&e.executeEdits("replace",[{range:q,text:Y.replace(B,O)}])}c(new CustomEvent("notemac-find",{detail:{query:y,direction:"next",isCaseSensitive:z,isWholeWord:N,isRegex:L}}))}},[e,n,c]),p=fe.useCallback(_=>{if(!e||!n)return;const{query:y,isCaseSensitive:O,isWholeWord:R,isRegex:z,style:N}=_.detail;if(!y)return;const L=e.getModel();if(!L)return;let D="g";O||(D+="i");let U=z?y:y.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");R&&(U=`\\b${U}\\b`);let G;try{G=new RegExp(U,D)}catch{return}const X=L.getValue(),q=[];let Y;for(;(Y=G.exec(X))!==null;){const K=L.getPositionAt(Y.index);q.push({line:K.lineNumber,column:K.column,length:Y[0].length,style:N||1}),Y[0].length===0&&G.lastIndex++}const B=r.marks||[];o(r.id,{marks:[...B,...q]})},[e,n,r.id,r.marks,o]),f=fe.useCallback(()=>{o(r.id,{marks:[]})},[r.id,o]),h=fe.useCallback(_=>{if(!e)return;const{line:y}=_.detail;y&&(e.setPosition({lineNumber:y,column:1}),e.revealLineInCenter(y),e.focus())},[e]),x=fe.useCallback(_=>{if(!e||!n)return;const{text:y,startLine:O,endLine:R,column:z}=_.detail,N=e.getModel();if(!N)return;const L=[],D=Math.min(R||N.getLineCount(),N.getLineCount());for(let U=O||1;U<=D;U++){const G=Math.min(z||1,N.getLineMaxColumn(U));L.push({range:new n.Range(U,G,U,G),text:y||""})}0<L.length&&e.executeEdits("column-edit",L)},[e,n]);fe.useEffect(()=>(document.addEventListener("notemac-find",c),document.addEventListener("notemac-replace",u),document.addEventListener("notemac-mark",p),document.addEventListener("notemac-clear-marks",f),document.addEventListener("notemac-goto-line",h),document.addEventListener("notemac-column-edit",x),()=>{document.removeEventListener("notemac-find",c),document.removeEventListener("notemac-replace",u),document.removeEventListener("notemac-mark",p),document.removeEventListener("notemac-clear-marks",f),document.removeEventListener("notemac-goto-line",h),document.removeEventListener("notemac-column-edit",x)}),[c,u,p,f,h,x])}function Qn(){return je.getState()}function Cb(e){return{id:vr(),role:"user",content:e,timestamp:Date.now(),codeBlocks:[]}}function Tb(e=""){const n=Fd(e);return{id:vr(),role:"assistant",content:e,timestamp:Date.now(),codeBlocks:n.map(r=>({language:r.language,code:r.code,action:"replace"}))}}function Rb(e){const n=Qn();return{id:vr(),title:e,messages:[],modelId:n.activeModelId,providerId:n.activeProviderId,createdAt:Date.now()}}async function Ob(e){const n=Qn();let r=n.activeConversationId;if(r===null){const _=e.length>50?e.substring(0,50)+"...":e,y=Rb(_);n.AddConversation(y),r=y.id}const o=Cb(e);n.AddMessageToConversation(r,o);const c=n.conversations.find(_=>_.id===r);if(!c)return;const u=Zm(n.aiContextItems),p=[];0<u.length&&p.push({role:"system",content:`Here is relevant context:

${u}`});const f=c.messages.length;for(let _=0;_<f;_++)p.push({role:c.messages[_].role,content:c.messages[_].content});const h=Tb();n.AddMessageToConversation(r,h),n.SetIsAiStreaming(!0),n.SetAiStreamContent(""),n.SetAiOperationError(null);let x="";try{await Ni(p,{temperature:n.aiSettings.chatTemperature},_=>{x+=_,n.SetAiStreamContent(x),n.UpdateLastMessage(r,x),Nn(Fr.AI_STREAM_CHUNK,{text:_})},_=>{n.UpdateLastMessage(r,_),Nn(Fr.AI_RESPONSE_COMPLETE,{conversationId:r,text:_})},_=>{n.SetAiOperationError(_),Nn(Fr.AI_ERROR,{error:_})})}catch(_){n.SetAiOperationError(_ instanceof Error?_.message:String(_))}finally{n.SetIsAiStreaming(!1),n.SetAiStreamContent(""),n.SaveAIState()}}async function ei(e,n,r){const o=Qn();o.SetIsAiStreaming(!0),o.SetAiOperationError(null);try{const c=await Ni([{role:"system",content:e},{role:"user",content:n}],{temperature:o.aiSettings.codeTemperature,stream:!1}),u=Fd(c);r(0<u.length?u[0].code:c)}catch(c){o.SetAiOperationError(c instanceof Error?c.message:String(c))}finally{o.SetIsAiStreaming(!1)}}async function Sh(e,n){Qn().setSidebarPanel("ai");const o=`Explain the following ${n} code in detail. What does it do, and why?

\`\`\`${n}
${e}
\`\`\``;await Ob(o)}async function kh(e,n,r){await ei("You are a code refactoring assistant. Refactor the given code to improve readability, performance, and maintainability. Return ONLY the refactored code in a single code block. No explanations before or after.",`Refactor this ${n} code:

\`\`\`${n}
${e}
\`\`\``,r)}async function Eh(e,n,r){await ei("You are a test generation assistant. Generate comprehensive unit tests for the given code. Return ONLY the test code in a single code block. Use appropriate testing framework for the language. No explanations.",`Generate unit tests for this ${n} code:

\`\`\`${n}
${e}
\`\`\``,r)}async function Ih(e,n,r){await ei("You are a documentation assistant. Add comprehensive documentation (JSDoc, docstrings, or appropriate format) to the given code. Return ONLY the fully documented code in a single code block. No explanations.",`Add documentation to this ${n} code:

\`\`\`${n}
${e}
\`\`\``,r)}async function Mb(e,n,r,o){await ei("You are a debugging assistant. Fix the error in the given code. Return ONLY the fixed code in a single code block. No explanations before or after.",`Fix this ${n} code.

Error: ${r}

Code:
\`\`\`${n}
${e}
\`\`\``,o)}async function Ah(e,n,r){await ei("You are a code simplification assistant. Simplify the given code while maintaining the same functionality. Return ONLY the simplified code in a single code block. No explanations.",`Simplify this ${n} code:

\`\`\`${n}
${e}
\`\`\``,r)}async function n1(e,n,r){const o=Qn();o.SetIsAiStreaming(!0),o.SetAiOperationError(null);const c=`You are a git commit message assistant. Write a clear, concise commit message following conventional commits style. First line should be a short summary (under ${em} chars). Optionally add a blank line and a longer description if the changes are complex. Output ONLY the commit message text, nothing else.`;let u="";try{return u=await Ni([{role:"system",content:c},{role:"user",content:`Generate a commit message for these changes:

${e}`}],{temperature:Qg,maxTokens:Jg},p=>{u+=p,o.SetCommitMessageDraft(u),n==null||n(p)},p=>{o.SetCommitMessageDraft(p),r==null||r(p)}),u}catch(p){return o.SetAiOperationError(p instanceof Error?p.message:String(p)),""}finally{o.SetIsAiStreaming(!1)}}function Pb(e,n,r,o,c,u,p,f){return fe.useCallback((x,_)=>{var O,R,z,N,L,D,U,G,X,q,Y,B,K,ce;if(!e||!n)return;const y=e.getModel();if(y)switch(x){case"cut":e.trigger("keyboard","editor.action.clipboardCutAction",null);break;case"copy":e.trigger("keyboard","editor.action.clipboardCopyAction",null);break;case"paste":{navigator.clipboard.readText().then(S=>{e.trigger("keyboard","paste",{text:S})}).catch(()=>{e.focus(),document.execCommand("paste")});break}case"undo":e.trigger("keyboard","undo",null);break;case"redo":e.trigger("keyboard","redo",null);break;case"select-all":e.setSelection(y.getFullModelRange());break;case"duplicate-line":(O=e.getAction("editor.action.copyLinesDownAction"))==null||O.run();break;case"delete-line":(R=e.getAction("editor.action.deleteLines"))==null||R.run();break;case"move-line-up":(z=e.getAction("editor.action.moveLinesUpAction"))==null||z.run();break;case"move-line-down":(N=e.getAction("editor.action.moveLinesDownAction"))==null||N.run();break;case"toggle-comment":(L=e.getAction("editor.action.commentLine"))==null||L.run();break;case"block-comment":(D=e.getAction("editor.action.blockComment"))==null||D.run();break;case"transpose-line":{const S=e.getPosition();if(!S||S.lineNumber<=1)break;const ie=y.getLineContent(S.lineNumber),Q=y.getLineContent(S.lineNumber-1);e.executeEdits("transpose",[{range:new n.Range(S.lineNumber-1,1,S.lineNumber,y.getLineMaxColumn(S.lineNumber)),text:ie+`
`+Q}]);break}case"split-lines":{const S=e.getSelection();if(S&&!S.isEmpty()){const ie=y.getValueInRange(S);e.executeEdits("split",[{range:S,text:ie.split("").join(`
`)}])}break}case"join-lines":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("join",[{range:S,text:y.getValueInRange(S).replace(/\n/g," ")}]);break}case"uppercase":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("uppercase",[{range:S,text:y.getValueInRange(S).toUpperCase()}]);break}case"lowercase":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("lowercase",[{range:S,text:y.getValueInRange(S).toLowerCase()}]);break}case"proper-case":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("proper",[{range:S,text:y.getValueInRange(S).replace(/\w\S*/g,ie=>ie.charAt(0).toUpperCase()+ie.substr(1).toLowerCase())}]);break}case"sentence-case":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("sentence",[{range:S,text:y.getValueInRange(S).toLowerCase().replace(/(^\s*\w|[.!?]\s+\w)/g,ie=>ie.toUpperCase())}]);break}case"invert-case":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("invert",[{range:S,text:y.getValueInRange(S).split("").map(ie=>ie===ie.toUpperCase()?ie.toLowerCase():ie.toUpperCase()).join("")}]);break}case"random-case":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("random",[{range:S,text:y.getValueInRange(S).split("").map(ie=>Math.random()>.5?ie.toUpperCase():ie.toLowerCase()).join("")}]);break}case"insert-datetime":{const S=e.getPosition();if(S){const Q=new Date().toISOString().replace("T"," ").replace(/\.\d+Z/,"");e.executeEdits("datetime",[{range:new n.Range(S.lineNumber,S.column,S.lineNumber,S.column),text:Q}])}break}case"sort-asc":case"sort-desc":case"sort-asc-ci":case"sort-desc-ci":case"sort-len-asc":case"sort-len-desc":{const S=y.getFullModelRange(),ie=y.getValue().split(`
`);x==="sort-asc"?ie.sort((Q,se)=>Q.localeCompare(se)):x==="sort-desc"?ie.sort((Q,se)=>se.localeCompare(Q)):x==="sort-asc-ci"?ie.sort((Q,se)=>Q.toLowerCase().localeCompare(se.toLowerCase())):x==="sort-desc-ci"?ie.sort((Q,se)=>se.toLowerCase().localeCompare(Q.toLowerCase())):x==="sort-len-asc"?ie.sort((Q,se)=>Q.length-se.length):x==="sort-len-desc"&&ie.sort((Q,se)=>se.length-Q.length),e.executeEdits("sort",[{range:S,text:ie.join(`
`)}]);break}case"remove-duplicates":{const S=y.getFullModelRange();e.executeEdits("remove-dup",[{range:S,text:[...new Set(y.getValue().split(`
`))].join(`
`)}]);break}case"remove-consecutive-duplicates":{const S=y.getFullModelRange(),ie=y.getValue().split(`
`);e.executeEdits("remove-consec-dup",[{range:S,text:ie.filter((Q,se)=>se===0||Q!==ie[se-1]).join(`
`)}]);break}case"remove-empty-lines":{e.executeEdits("remove-empty",[{range:y.getFullModelRange(),text:y.getValue().split(`
`).filter(S=>S.trim()!=="").join(`
`)}]);break}case"remove-blank-lines":{e.executeEdits("remove-blank",[{range:y.getFullModelRange(),text:y.getValue().split(`
`).filter(S=>S!=="").join(`
`)}]);break}case"trim-trailing":{e.executeEdits("trim",[{range:y.getFullModelRange(),text:y.getValue().split(`
`).map(S=>S.trimEnd()).join(`
`)}]);break}case"trim-leading":{e.executeEdits("trim-lead",[{range:y.getFullModelRange(),text:y.getValue().split(`
`).map(S=>S.trimStart()).join(`
`)}]);break}case"trim-both":{e.executeEdits("trim-both",[{range:y.getFullModelRange(),text:y.getValue().split(`
`).map(S=>S.trim()).join(`
`)}]);break}case"eol-to-space":{e.executeEdits("eol-space",[{range:y.getFullModelRange(),text:y.getValue().replace(/\n/g," ")}]);break}case"tab-to-space":{const S=" ".repeat(o.tabSize);e.executeEdits("tab-space",[{range:y.getFullModelRange(),text:y.getValue().replace(/\t/g,S)}]);break}case"space-to-tab-leading":{const S=o.tabSize,ie=new RegExp(`^( {${S}})+`,"gm");e.executeEdits("space-tab",[{range:y.getFullModelRange(),text:y.getValue().replace(ie,Q=>"	".repeat(Q.length/S))}]);break}case"space-to-tab-all":{const S=o.tabSize;e.executeEdits("space-tab-all",[{range:y.getFullModelRange(),text:y.getValue().split(" ".repeat(S)).join("	")}]);break}case"insert-blank-above":{const S=e.getPosition();S&&e.executeEdits("blank-above",[{range:new n.Range(S.lineNumber,1,S.lineNumber,1),text:`
`}]);break}case"insert-blank-below":{const S=e.getPosition();S&&e.executeEdits("blank-below",[{range:new n.Range(S.lineNumber,y.getLineMaxColumn(S.lineNumber),S.lineNumber,y.getLineMaxColumn(S.lineNumber)),text:`
`}]);break}case"reverse-lines":{e.executeEdits("reverse",[{range:y.getFullModelRange(),text:y.getValue().split(`
`).reverse().join(`
`)}]);break}case"fold-all":(U=e.getAction("editor.foldAll"))==null||U.run();break;case"unfold-all":(G=e.getAction("editor.unfoldAll"))==null||G.run();break;case"fold-level":{const S=_;(X=e.getAction(`editor.foldLevel${S}`))==null||X.run();break}case"select-to-bracket":(q=e.getAction("editor.action.selectToBracket"))==null||q.run();break;case"goto-bracket":(Y=e.getAction("editor.action.jumpToBracket"))==null||Y.run();break;case"toggle-bookmark":{const S=(B=e.getPosition())==null?void 0:B.lineNumber;if(S){const ie=[...r.bookmarks],Q=ie.indexOf(S);Q>=0?ie.splice(Q,1):ie.push(S),ie.sort((se,W)=>se-W),c(r.id,{bookmarks:ie})}break}case"next-bookmark":{const S=((K=e.getPosition())==null?void 0:K.lineNumber)||1,Q=r.bookmarks.find(se=>se>S)||r.bookmarks[0];Q&&e.setPosition({lineNumber:Q,column:1}),e.revealLineInCenter(Q||S);break}case"prev-bookmark":{const S=((ce=e.getPosition())==null?void 0:ce.lineNumber)||1,Q=[...r.bookmarks].reverse().find(se=>se<S)||r.bookmarks[r.bookmarks.length-1];Q&&e.setPosition({lineNumber:Q,column:1}),e.revealLineInCenter(Q||S);break}case"clear-bookmarks":{c(r.id,{bookmarks:[]});break}case"mark-style":{const S=e.getSelection();if(S&&!S.isEmpty()){const ie=[...r.marks||[]];ie.push({line:S.startLineNumber,column:S.startColumn,length:y.getValueInRange(S).length,style:_||1}),c(r.id,{marks:ie})}break}case"clear-marks":{c(r.id,{marks:[]});break}case"cut-marked-lines":case"copy-marked-lines":case"delete-marked-lines":case"delete-unmarked-lines":case"paste-marked-lines":case"inverse-marks":{const S=r.marks||[];if(S.length===0)break;const ie=new Set(S.map(W=>W.line)),Q=y.getValue().split(`
`),se=(W,oe)=>ie.has(oe+1);if(x==="cut-marked-lines"){const W=Q.filter((te,re)=>se(te,re));navigator.clipboard.writeText(W.join(`
`));const oe=Q.filter((te,re)=>!se(te,re));e.executeEdits("cut-marked",[{range:y.getFullModelRange(),text:oe.join(`
`)}])}else if(x==="copy-marked-lines")navigator.clipboard.writeText(Q.filter((W,oe)=>se(W,oe)).join(`
`));else if(x==="delete-marked-lines")e.executeEdits("del-marked",[{range:y.getFullModelRange(),text:Q.filter((W,oe)=>!se(W,oe)).join(`
`)}]);else if(x==="delete-unmarked-lines")e.executeEdits("del-unmarked",[{range:y.getFullModelRange(),text:Q.filter((W,oe)=>se(W,oe)).join(`
`)}]);else if(x==="paste-marked-lines")navigator.clipboard.readText().then(W=>{const oe=Q.map((te,re)=>se(te,re)?W:te);e.executeEdits("paste-marked",[{range:y.getFullModelRange(),text:oe.join(`
`)}])}).catch(()=>{});else if(x==="inverse-marks"){const W=Q.map((oe,te)=>te+1).filter(oe=>!ie.has(oe)).map(oe=>({line:oe,column:1,length:Q[oe-1].length,style:1}));c(r.id,{marks:W})}break}case"macro-playback":case"macro-run-multiple":case"macro-save":{f(x,_);break}case"hash-md5-file":case"hash-sha256-file":{const S=document.createElement("input");S.type="file",S.onchange=async()=>{var ie;try{const Q=(ie=S.files)==null?void 0:ie[0];if(!Q)return;const se=await Q.text(),W=x==="hash-md5-file"?"md5":"sha256",oe=await cs(W,se),te=e.getPosition();te&&e.executeEdits("hash-file",[{range:new n.Range(te.lineNumber,te.column,te.lineNumber,te.column),text:`
// ${W.toUpperCase()} (${Q.name}): ${oe}
`}])}catch{}},S.click();break}case"json-format":{try{e.executeEdits("json-fmt",[{range:y.getFullModelRange(),text:JSON.stringify(JSON.parse(y.getValue()),null,2)}])}catch{}break}case"json-minify":{try{e.executeEdits("json-min",[{range:y.getFullModelRange(),text:JSON.stringify(JSON.parse(y.getValue()))}])}catch{}break}case"hash-md5":case"hash-sha1":case"hash-sha256":case"hash-sha512":{const S=e.getSelection();let ie=S&&!S.isEmpty()?y.getValueInRange(S):y.getValue();cs(x.replace("hash-",""),ie).then(Q=>{const se=e.getPosition();se&&e.executeEdits("hash",[{range:new n.Range(se.lineNumber,se.column,se.lineNumber,se.column),text:`
// ${x.replace("hash-","").toUpperCase()}: ${Q}
`}])}).catch(()=>{});break}case"hash-md5-clipboard":case"hash-sha1-clipboard":case"hash-sha256-clipboard":case"hash-sha512-clipboard":{const S=e.getSelection();let ie=S&&!S.isEmpty()?y.getValueInRange(S):y.getValue();cs(x.replace("hash-","").replace("-clipboard",""),ie).then(Q=>navigator.clipboard.writeText(Q)).catch(()=>{});break}case"base64-encode":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("b64enc",[{range:S,text:btoa(y.getValueInRange(S))}]);break}case"base64-decode":{const S=e.getSelection();if(S&&!S.isEmpty())try{e.executeEdits("b64dec",[{range:S,text:atob(y.getValueInRange(S))}])}catch{}break}case"url-encode":{const S=e.getSelection();S&&!S.isEmpty()&&e.executeEdits("urlenc",[{range:S,text:encodeURIComponent(y.getValueInRange(S))}]);break}case"url-decode":{const S=e.getSelection();if(S&&!S.isEmpty())try{e.executeEdits("urldec",[{range:S,text:decodeURIComponent(y.getValueInRange(S))}])}catch{}break}case"copy-file-path":{r.path&&navigator.clipboard.writeText(r.path);break}case"copy-file-name":{navigator.clipboard.writeText(r.name);break}case"copy-file-dir":{r.path&&navigator.clipboard.writeText(r.path.substring(0,r.path.lastIndexOf("/")));break}case"toggle-readonly":{c(r.id,{isReadOnly:!r.isReadOnly});break}case"ai-explain":{const S=e.getSelection();S&&!S.isEmpty()&&Sh(y.getValueInRange(S),y.getLanguageId()||"plaintext");break}case"ai-refactor":{const S=e.getSelection();S&&!S.isEmpty()&&kh(y.getValueInRange(S),y.getLanguageId()||"plaintext",ie=>{e.executeEdits("ai-refactor",[{range:S,text:ie}])});break}case"ai-generate-tests":{const S=e.getSelection();S&&!S.isEmpty()&&Eh(y.getValueInRange(S),y.getLanguageId()||"plaintext",ie=>{const Q=y.getLineCount(),se=y.getLineMaxColumn(Q);e.executeEdits("ai-tests",[{range:new n.Range(Q,se,Q,se),text:`

`+ie}])});break}case"ai-generate-docs":{const S=e.getSelection();S&&!S.isEmpty()&&Ih(y.getValueInRange(S),y.getLanguageId()||"plaintext",ie=>{e.executeEdits("ai-docs",[{range:S,text:ie}])});break}case"ai-simplify":{const S=e.getSelection();S&&!S.isEmpty()&&Ah(y.getValueInRange(S),y.getLanguageId()||"plaintext",ie=>{e.executeEdits("ai-simplify",[{range:S,text:ie}])});break}}},[e,n,r.id,r.bookmarks,r.marks,r.path,r.name,r.isReadOnly,o.tabSize,c,f])}function jb(e){tw(e)}function Bb(){rw()}async function cs(e,n){const o=new TextEncoder().encode(n),c={md5:"MD5",sha1:"SHA-1",sha256:"SHA-256",sha512:"SHA-512"}[e];if(!c||e==="md5"){let u=0;for(let p=0;p<n.length;p++){const f=n.charCodeAt(p);u=(u<<5)-u+f,u=u&u}return Math.abs(u).toString(16).padStart(8,"0")}try{const u=await crypto.subtle.digest(c,o);return Array.from(new Uint8Array(u)).map(f=>f.toString(16).padStart(2,"0")).join("")}catch{return"error computing hash"}}function Fb(e){return fe.useCallback((n,r)=>{if(e)switch(n){case"macro-playback":{const c=je.getState().currentMacroActions;if(c.length===0)break;for(const u of c)u.type==="type"?e.trigger("keyboard","type",{text:u.data}):u.type==="command"&&e.trigger("keyboard",u.data,null);break}case"macro-run-multiple":{const o=prompt("Run macro how many times?","10");if(!o)break;const c=parseInt(o,10);if(isNaN(c)||c<1)break;const p=je.getState().currentMacroActions;if(p.length===0)break;for(let f=0;f<c;f++)for(const h of p)h.type==="type"?e.trigger("keyboard","type",{text:h.data}):h.type==="command"&&e.trigger("keyboard",h.data,null);break}case"macro-save":{const o=je.getState();if(o.currentMacroActions.length===0)break;const c=prompt("Save macro as:","My Macro");c&&o.saveMacro(c);break}}},[e])}function Db(e,n,r){e.addAction({id:"ai-explain",label:"AI: Explain Code",contextMenuGroupId:"9_ai",contextMenuOrder:1,run:o=>{const c=o.getSelection(),u=o.getModel();if(c&&!c.isEmpty()&&u){const p=u.getValueInRange(c);Sh(p,u.getLanguageId()||"plaintext")}}}),e.addAction({id:"ai-refactor",label:"AI: Refactor Code",contextMenuGroupId:"9_ai",contextMenuOrder:2,run:o=>{const c=o.getSelection(),u=o.getModel();if(c&&!c.isEmpty()&&u){const p=u.getValueInRange(c);kh(p,u.getLanguageId()||"plaintext",f=>{o.executeEdits("ai-refactor",[{range:c,text:f}])})}}}),e.addAction({id:"ai-generate-tests",label:"AI: Generate Tests",contextMenuGroupId:"9_ai",contextMenuOrder:3,run:o=>{const c=o.getSelection(),u=o.getModel();if(c&&!c.isEmpty()&&u){const p=u.getValueInRange(c);Eh(p,u.getLanguageId()||"plaintext",f=>{const h=u.getLineCount(),x=u.getLineMaxColumn(h);o.executeEdits("ai-tests",[{range:new n.Range(h,x,h,x),text:`

`+f}])})}}}),e.addAction({id:"ai-generate-docs",label:"AI: Generate Documentation",contextMenuGroupId:"9_ai",contextMenuOrder:4,run:o=>{const c=o.getSelection(),u=o.getModel();if(c&&!c.isEmpty()&&u){const p=u.getValueInRange(c);Ih(p,u.getLanguageId()||"plaintext",f=>{o.executeEdits("ai-docs",[{range:c,text:f}])})}}}),e.addAction({id:"ai-fix-error",label:"AI: Fix Error",contextMenuGroupId:"9_ai",contextMenuOrder:5,run:o=>{const c=o.getSelection(),u=o.getModel();if(c&&!c.isEmpty()&&u){const p=u.getValueInRange(c),f=prompt("Describe the error (or paste error message):")||"Fix any issues";Mb(p,u.getLanguageId()||"plaintext",f,h=>{o.executeEdits("ai-fix",[{range:c,text:h}])})}}}),e.addAction({id:"ai-simplify",label:"AI: Simplify Code",contextMenuGroupId:"9_ai",contextMenuOrder:6,run:o=>{const c=o.getSelection(),u=o.getModel();if(c&&!c.isEmpty()&&u){const p=u.getValueInRange(c);Ah(p,u.getLanguageId()||"plaintext",f=>{o.executeEdits("ai-simplify",[{range:c,text:f}])})}}})}function dd({tab:e,theme:n,settings:r,zoomLevel:o}){const c=fe.useRef(null),u=fe.useRef(null),{updateTabContent:p,updateTab:f}=je(),[h,x]=fe.useState(!1),_=Eb(e,n,f,x),y=fe.useCallback(N=>{N!==void 0&&p(e.id,N)},[e.id,p]),O=Fb(c.current),R=Pb(c.current,u.current,e,r,f,p,h,O);fe.useEffect(()=>{u.current&&u.current.editor.setTheme(n.editorMonacoTheme)},[n.editorMonacoTheme]),fe.useEffect(()=>{const N=L=>{c.current&&(L!=null&&L.body)&&(xb(c.current,L.body),c.current.focus())};return vy(Fr.INSERT_SNIPPET,N),()=>xy(Fr.INSERT_SNIPPET,N)},[]),fe.useEffect(()=>()=>{Ib(c.current)},[]),Ab(c.current,u.current,e,f),fe.useEffect(()=>{const N=c.current,L=u.current;if(!(!N||!L))return jb(R),Db(N,L),()=>{Bb()}},[h,e.id,e.bookmarks,e.marks,R,f]),fe.useEffect(()=>{const N=c.current,L=u.current;if(!N||!L||!h)return;const D=e.bookmarks.map(G=>({range:new L.Range(G,1,G,1),options:{isWholeLine:!0,linesDecorationsClassName:"bookmark-decoration",glyphMarginClassName:"bookmark-glyph",overviewRuler:{color:"#007acc",position:1}}})),U=N.deltaDecorations([],D);return()=>{N.deltaDecorations(U,[])}},[e.bookmarks,h]);const z=fe.useCallback((N,L)=>{c.current=N,u.current=L,_(N,L)},[_]);return E.jsx("div",{style:{flex:1,overflow:"hidden"},children:E.jsx(bb,{height:"100%",language:e.language,value:e.content,onChange:y,onMount:z,theme:n.editorMonacoTheme,options:{fontSize:r.fontSize+o,fontFamily:r.fontFamily,tabSize:r.tabSize,insertSpaces:r.insertSpaces,wordWrap:r.wordWrap?"on":"off",lineNumbers:r.showLineNumbers?"on":"off",minimap:{enabled:r.showMinimap,scale:1,showSlider:"mouseover"},renderWhitespace:r.renderWhitespace,guides:{indentation:r.showIndentGuides,bracketPairs:!0},cursorBlinking:r.cursorBlinking,cursorStyle:r.cursorStyle,smoothScrolling:r.smoothScrolling,bracketPairColorization:{enabled:!0},matchBrackets:r.matchBrackets?"always":"never",autoClosingBrackets:r.autoCloseBrackets?"always":"never",autoClosingQuotes:r.autoCloseQuotes?"always":"never",renderLineHighlight:r.highlightCurrentLine?"all":"none",folding:!0,foldingStrategy:"indentation",showFoldingControls:"mouseover",glyphMargin:!0,scrollBeyondLastLine:!1,automaticLayout:!0,contextmenu:!0,dragAndDrop:!0,links:!0,multiCursorModifier:"alt",inlineSuggest:{enabled:!0},snippetSuggestions:"top",suggestOnTriggerCharacters:!0,wordBasedSuggestions:"currentDocument",padding:{top:8},readOnly:e.isReadOnly,overviewRulerBorder:!1,hideCursorInOverviewRuler:!1,colorDecorators:!0,columnSelection:!0,copyWithSyntaxHighlighting:!0,emptySelectionClipboard:!0,find:{addExtraSpaceOnTop:!1,autoFindInSelection:"never",seedSearchStringFromSelection:"always"}},loading:E.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:n.textMuted},children:"Loading editor..."})})})}function Lb(e){return e.trim().split(/\s+/).filter(Boolean).length}function $b(e){return e?e.split(/\r\n|\r|\n/).length:0}function i1(e){return 1024>e?`${e} B`:1024*1024>e?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}function hd(e){return{plaintext:"Plain Text",javascript:"JavaScript",typescript:"TypeScript",python:"Python",ruby:"Ruby",go:"Go",rust:"Rust",c:"C",cpp:"C++",csharp:"C#",java:"Java",swift:"Swift",kotlin:"Kotlin",php:"PHP",html:"HTML",css:"CSS",scss:"SCSS",less:"LESS",json:"JSON",xml:"XML",yaml:"YAML",markdown:"Markdown",sql:"SQL",shell:"Shell",powershell:"PowerShell",r:"R",lua:"Lua",perl:"Perl",dart:"Dart",elixir:"Elixir",erlang:"Erlang",haskell:"Haskell",scala:"Scala",clojure:"Clojure",coffeescript:"CoffeeScript",bat:"Batch",ini:"INI",dockerfile:"Dockerfile",graphql:"GraphQL"}[e]||e}function Nb({theme:e}){const{tabs:n,activeTabId:r,settings:o,zoomLevel:c,isRecordingMacro:u,updateTab:p,updateSettings:f,isRepoInitialized:h,currentBranch:x,gitStatus:_,setSidebarPanel:y,aiEnabled:O,isAiStreaming:R,activeModelId:z,inlineSuggestionEnabled:N,SetShowAiSettings:L}=je(),D=n.find(re=>re.id===r),[U,G]=fe.useState(!1),[X,q]=fe.useState(!1),[Y,B]=fe.useState(!1),K=Ub(e);if(D===void 0)return null;const ce=$b(D.content),S=D.content.length,ie=Lb(D.content),Q=["plaintext","javascript","typescript","python","ruby","go","rust","c","cpp","csharp","java","swift","kotlin","php","html","css","scss","json","xml","yaml","markdown","sql","shell","lua","perl","r","dart","scala","haskell"],se=["utf-8","utf-8-bom","utf-16le","utf-16be","iso-8859-1","windows-1252"],W=[{value:"LF",label:"LF (Unix/Mac)"},{value:"CRLF",label:"CRLF (Windows)"},{value:"CR",label:"CR (Old Mac)"}],oe=St.memo(({children:re,onClick:le,title:me})=>{const[Fe,ve]=fe.useState(!1),Re=fe.useMemo(()=>({padding:"0 8px",cursor:le!==null?"pointer":"default",backgroundColor:Fe&&le!==null?"rgba(255,255,255,0.1)":"transparent",height:"100%",display:"flex",alignItems:"center",borderRadius:2,position:"relative"}),[le,Fe]);return E.jsx("div",{title:me,onClick:le,onMouseEnter:()=>ve(!0),onMouseLeave:()=>ve(!1),style:Re,children:re})});oe.displayName="StatusItem";const te=St.memo(({items:re,onSelect:le,onClose:me})=>{const Fe=fe.useMemo(()=>({overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:cm},dropdown:{position:"absolute",bottom:"100%",left:0,minWidth:180,maxHeight:om,overflowY:"auto",backgroundColor:e.menuBg,border:`1px solid ${e.border}`,borderRadius:6,padding:"4px 0",zIndex:lm,boxShadow:"0 -4px 16px rgba(0,0,0,0.3)"},item:{padding:"6px 16px",cursor:"pointer",fontSize:13,color:e.menuText,"--hover-bg":e.bgHover}}),[e]);return E.jsxs(E.Fragment,{children:[E.jsx("div",{style:Fe.overlay,onClick:me}),E.jsx("div",{style:Fe.dropdown,children:re.map(ve=>E.jsx("div",{onClick:()=>{le(ve.value),me()},className:"hover-bg hover-bg-reset",style:Fe.item,children:ve.label},ve.value))})]})});return te.displayName="Picker",E.jsxs("div",{style:K.container,children:[E.jsxs("div",{style:K.sectionLeft,children:[h===!0&&E.jsx(oe,{title:`Branch: ${x}${_!==null&&_.aheadBy!==void 0?` ${_.aheadBy}`:""}${_!==null&&_.behindBy!==void 0?` ${_.behindBy}`:""}`,onClick:()=>y("git"),children:E.jsxs("span",{style:K.branchContainer,children:[E.jsx("span",{style:K.branchIcon,children:""}),x,_!==null&&0<_.aheadBy&&E.jsxs("span",{style:K.gitAhead,children:["",_.aheadBy]}),_!==null&&0<_.behindBy&&E.jsxs("span",{style:K.gitBehind,children:["",_.behindBy]}),_!==null&&_.isRepoDirty===!0&&E.jsx("span",{style:K.gitDirty,children:""})]})}),u===!0&&E.jsx(oe,{children:E.jsxs("span",{className:"recording-indicator",style:K.recordingIndicator,children:[""," Recording"]})}),E.jsxs(oe,{title:"Cursor Position",children:["Ln ",D.cursorLine,", Col ",D.cursorColumn]}),E.jsxs(oe,{title:"Character Count",children:[S," chars"]}),E.jsxs(oe,{title:"Word Count",children:[ie," words"]}),E.jsxs(oe,{title:"Line Count",children:[ce," lines"]})]}),E.jsxs("div",{style:K.sectionRight,children:[E.jsxs(oe,{title:"Tab Size",onClick:()=>{const re=o.tabSize===4?2:4;f({tabSize:re})},children:[o.insertSpaces?"Spaces":"Tabs",": ",o.tabSize]}),E.jsxs(oe,{title:"Line Ending",onClick:()=>B(!Y),children:[D.lineEnding,Y&&E.jsx(te,{items:W.map(re=>({value:re.value,label:re.label})),onSelect:re=>p(D.id,{lineEnding:re}),onClose:()=>B(!1)})]}),E.jsxs(oe,{title:"Encoding",onClick:()=>q(!X),children:[D.encoding.toUpperCase(),X&&E.jsx(te,{items:se.map(re=>({value:re,label:re.toUpperCase()})),onSelect:re=>p(D.id,{encoding:re}),onClose:()=>q(!1)})]}),E.jsxs(oe,{title:"Language",onClick:()=>G(!U),children:[hd(D.language),U&&E.jsx(te,{items:Q.map(re=>({value:re,label:hd(re)})),onSelect:re=>p(D.id,{language:re}),onClose:()=>G(!1)})]}),O===!0&&E.jsx(oe,{title:`AI: ${z}${N===!0?" (Inline On)":""}`,onClick:()=>L(!0),children:E.jsx("span",{style:K.aiContainer,children:R===!0?E.jsxs("span",{style:K.aiGenerating,children:[""," Generating..."]}):E.jsxs("span",{style:K.aiIdle,children:[""," ",z||"No Model"]})})}),c!==0&&E.jsxs(oe,{title:"Zoom Level",children:[0<c?"+":"",c]})]})]})}function Ub(e){return fe.useMemo(()=>({container:{display:"flex",alignItems:"center",justifyContent:"space-between",height:24,backgroundColor:e.statusBarBg,color:e.statusBarText,fontSize:12,flexShrink:0,padding:"0 4px"},sectionLeft:{display:"flex",alignItems:"center",height:"100%"},sectionRight:{display:"flex",alignItems:"center",height:"100%"},branchContainer:{display:"flex",alignItems:"center",gap:4},branchIcon:{fontSize:11},gitAhead:{fontSize:10},gitBehind:{fontSize:10},gitDirty:{fontSize:10,color:"#f9e2af"},recordingIndicator:{color:"#ff4444"},aiContainer:{display:"flex",alignItems:"center",gap:4},aiGenerating:{color:"#a6e3a1",animation:"pulse 1s infinite"},aiIdle:{color:e.statusBarText,opacity:.8}}),[e])}const zb=fe.lazy(()=>ht(()=>import("./GitPanelViewPresenter-U97URLKD.js"),__vite__mapDeps([8,0,1,2,3,4,5])).then(e=>({default:e.GitPanelViewPresenter}))),Gb=fe.lazy(()=>ht(()=>import("./AIChatPanelViewPresenter-QQO-Pyw0.js"),__vite__mapDeps([9,1,2,3])).then(e=>({default:e.AIChatPanelViewPresenter})));function Hb({theme:e}){const{sidebarPanel:n,sidebarWidth:r,fileTree:o,workspacePath:c,tabs:u,activeTabId:p,setSidebarPanel:f,toggleTreeNode:h,addTab:x,setActiveTab:_,setFileTree:y,setWorkspacePath:O,GetChangedFileCount:R}=je(),[z,N]=fe.useState(!1),[L,D]=fe.useState(r),[U,G]=fe.useState(-1),X=fe.useRef(null),q=fe.useRef(null),Y=fe.useRef(null),B=fe.useCallback(W=>{W.preventDefault(),N(!0);const oe=W.clientX,te=L,re=me=>{const Fe=Math.max(tm,Math.min(rm,te+me.clientX-oe));D(Fe)},le=()=>{N(!1),X.current!==null&&document.removeEventListener("mousemove",X.current),q.current!==null&&document.removeEventListener("mouseup",q.current),X.current=null,q.current=null};X.current=re,q.current=le,document.addEventListener("mousemove",re),document.addEventListener("mouseup",le)},[L]);fe.useEffect(()=>()=>{X.current!==null&&document.removeEventListener("mousemove",X.current),q.current!==null&&document.removeEventListener("mouseup",q.current)},[]);const K=async()=>{if("showDirectoryPicker"in window)try{const W=await window.showDirectoryPicker(),oe=await Ch(W);y(oe),O(W.name),await uh(W)}catch{}},ce=(W,oe=[])=>{for(const te of W)oe.push(te),te.isDirectory&&te.isExpanded&&te.children&&ce(te.children,oe);return oe},S=async W=>{if(W.isDirectory){h(W.path);return}const oe=u.find(te=>te.path===W.path||te.name===W.name);if(oe){_(oe.id);return}if(window.electronAPI){const te=await window.electronAPI.readFile(W.path);x({name:W.name,path:W.path,content:te,language:sr(W.name),lineEnding:br(te)})}else if(W.handle)try{const re=await(await W.handle.getFile()).text();x({name:W.name,path:W.path,content:re,language:sr(W.name),lineEnding:br(re)})}catch{}},ie=W=>{if(n!=="explorer"||o.length===0)return;const oe=ce(o),te=U>=0?oe[U]:null,re=le=>{le>=0&&le<oe.length&&(G(le),setTimeout(()=>{var Fe;const me=(Fe=Y.current)==null?void 0:Fe.querySelector(`[data-tree-index="${le}"]`);me==null||me.focus()},0))};switch(W.key){case"ArrowDown":W.preventDefault();const le=U===-1?0:Math.min(U+1,oe.length-1);re(le);break;case"ArrowUp":W.preventDefault();const me=U===-1?oe.length-1:Math.max(U-1,0);re(me);break;case"ArrowRight":W.preventDefault(),te!=null&&te.isDirectory&&(te.isExpanded?te.children&&te.children.length>0&&re(U+1):h(te.path));break;case"ArrowLeft":W.preventDefault(),te!=null&&te.isDirectory&&te.isExpanded&&h(te.path);break;case"Enter":case" ":W.preventDefault(),te&&S(te);break;case"Home":W.preventDefault(),re(0);break;case"End":W.preventDefault(),re(oe.length-1);break}},Q=St.memo(({node:W,depth:oe=0,index:te})=>{var Re,He;const[re,le]=fe.useState(!1),me=W.isExpanded,Fe=((Re=u.find(tt=>tt.id===p))==null?void 0:Re.path)===W.path,ve=U===te;return E.jsxs("div",{children:[E.jsxs("div",{ref:ve?tt=>tt==null?void 0:tt.focus():null,"data-tree-index":te,role:"treeitem",tabIndex:ve?0:-1,"aria-expanded":W.isDirectory?W.isExpanded:void 0,onClick:()=>S(W),onMouseEnter:()=>le(!0),onMouseLeave:()=>le(!1),style:{display:"flex",alignItems:"center",gap:4,padding:"3px 8px",paddingLeft:8+oe*16,cursor:"pointer",backgroundColor:Fe?e.bgActive:ve||re?e.bgHover:"transparent",color:Fe?e.text:e.sidebarText,fontSize:13,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",outline:ve?`1px solid ${e.accent}`:"none",outlineOffset:"-1px"},children:[E.jsx("span",{style:{fontSize:10,width:16,textAlign:"center",flexShrink:0},children:W.isDirectory?me?"":"":""}),E.jsx("span",{style:{marginRight:4,flexShrink:0},children:W.isDirectory?me?"":"":Zb(W.name)}),E.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis"},children:W.name})]}),W.isDirectory&&me&&((He=W.children)==null?void 0:He.map((tt,it)=>{const Ge=ce(o).findIndex(We=>We.path===tt.path);return E.jsx(Q,{node:tt,depth:oe+1,index:Ge},tt.path||it)}))]})});Q.displayName="TreeNode";const se=St.memo(()=>{const W=u.find(te=>te.id===p);if(W===void 0)return null;const oe=Xb(W.content,W.language);return E.jsxs("div",{style:{padding:8},children:[E.jsx("div",{style:{fontSize:11,color:e.textMuted,marginBottom:8,textTransform:"uppercase",letterSpacing:1},children:"Functions"}),oe.length===0?E.jsx("div",{style:{color:e.textMuted,fontSize:12,padding:8},children:"No functions found"}):oe.map(te=>E.jsxs("div",{onClick:()=>{document.dispatchEvent(new CustomEvent("notemac-goto-line",{detail:{line:te.line}}))},className:"hover-bg hover-bg-reset",style:{padding:"4px 8px",cursor:"pointer",fontSize:13,color:e.sidebarText,borderRadius:4,"--hover-bg":e.bgHover},children:[E.jsx("span",{style:{color:e.accent,marginRight:4},children:"f"}),te.name,E.jsxs("span",{style:{color:e.textMuted,fontSize:11,marginLeft:8},children:[":",te.line]})]},`fn-${te.name}-${te.line}`))]})});return se.displayName="FunctionListPanel",E.jsxs("div",{style:{display:"flex",flexShrink:0},children:[E.jsx("div",{style:{width:40,backgroundColor:e.bgSecondary,borderRight:`1px solid ${e.border}`,display:"flex",flexDirection:"column",alignItems:"center",paddingTop:8,gap:4},children:[{panel:"explorer",icon:"",title:"Explorer"},{panel:"search",icon:"",title:"Search"},{panel:"functions",icon:"",title:"Function List"},{panel:"docList",icon:"",title:"Document List"},{panel:"project",icon:"",title:"Project"},{panel:"clipboardHistory",icon:"",title:"Clipboard History"},{panel:"charPanel",icon:"",title:"Character Panel"},{panel:"git",icon:"",title:"Source Control"},{panel:"ai",icon:"",title:"AI Assistant"}].map(({panel:W,icon:oe,title:te})=>{const re=W==="git"?R():0;return E.jsxs("button",{"aria-label":te,onClick:()=>f(n===W?null:W),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",borderRadius:6,fontSize:16,backgroundColor:n===W?e.bgHover:"transparent",borderLeft:n===W?`2px solid ${e.accent}`:"2px solid transparent",border:"none",padding:0,position:"relative",color:"inherit"},children:[oe,re>0&&E.jsx("span",{style:{position:"absolute",top:2,right:2,minWidth:14,height:14,borderRadius:7,backgroundColor:e.accent,color:e.accentText,fontSize:9,fontWeight:700,display:"flex",alignItems:"center",justifyContent:"center",padding:"0 3px"},children:re})]},W)})}),n!==null&&E.jsxs(E.Fragment,{children:[E.jsxs("div",{style:{width:L-40,backgroundColor:e.sidebarBg,borderRight:`1px solid ${e.border}`,overflow:"auto",display:"flex",flexDirection:"column"},children:[E.jsxs("div",{style:{padding:"8px 12px",fontSize:11,fontWeight:600,textTransform:"uppercase",letterSpacing:1,color:e.textSecondary,borderBottom:`1px solid ${e.border}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n==="explorer"?"Explorer":n==="search"?"Search":n==="functions"?"Functions":n==="docList"?"Document List":n==="project"?"Project":n==="clipboardHistory"?"Clipboard History":n==="charPanel"?"Character Panel":n==="git"?"Source Control":n==="ai"?"AI Assistant":"",E.jsx("button",{"aria-label":"Collapse panel",onClick:()=>f(null),className:"hover-bg-color",style:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",borderRadius:4,fontSize:12,color:e.textMuted,backgroundColor:"transparent",border:"none",padding:0,"--hover-bg":e.bgHover,"--hover-color":e.text},children:""})]}),E.jsxs("div",{style:{flex:1,overflow:"auto"},children:[n==="explorer"&&E.jsx(E.Fragment,{children:o.length>0?E.jsxs("div",{ref:Y,role:"tree",tabIndex:0,onKeyDown:ie,style:{paddingTop:4,outline:"none"},children:[c&&E.jsxs("div",{style:{padding:"6px 12px",fontSize:12,fontWeight:600,color:e.text,display:"flex",alignItems:"center",gap:6},children:[E.jsx("span",{children:""}),typeof c=="string"&&c.split("/").pop()||c]}),o.map((W,oe)=>{const re=ce(o).findIndex(le=>le.path===W.path);return E.jsx(Q,{node:W,index:re},W.path||oe)})]}):E.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:24,gap:12},children:[E.jsx("div",{style:{color:e.textMuted,fontSize:13,textAlign:"center"},children:"No folder opened"}),E.jsx("button",{onClick:K,style:{backgroundColor:e.accent,color:e.accentText,border:"none",borderRadius:6,padding:"8px 16px",cursor:"pointer",fontSize:13},children:"Open Folder"})]})}),n==="search"&&E.jsx("div",{style:{padding:12},children:E.jsx(Kb,{theme:e})}),n==="functions"&&E.jsx(se,{}),n==="docList"&&E.jsx(Wb,{theme:e}),n==="project"&&E.jsx("div",{style:{padding:16,color:e.textMuted,fontSize:13,textAlign:"center"},children:c?E.jsxs("div",{children:[E.jsxs("div",{style:{fontWeight:600,color:e.text,marginBottom:8},children:["Project: ",typeof c=="string"?c.split("/").pop():c]}),E.jsxs("div",{children:[o.length," items"]})]}):"No project opened. Open a folder to use the project panel."}),n==="clipboardHistory"&&E.jsx(qb,{theme:e}),n==="charPanel"&&E.jsx(Vb,{theme:e}),n==="git"&&E.jsx(fe.Suspense,{fallback:E.jsx("div",{style:{padding:16,color:e.textMuted,fontSize:12},children:"Loading..."}),children:E.jsx(zb,{theme:e})}),n==="ai"&&E.jsx(fe.Suspense,{fallback:E.jsx("div",{style:{padding:16,color:e.textMuted,fontSize:12},children:"Loading..."}),children:E.jsx(Gb,{theme:e})})]})]}),E.jsx("div",{className:`resizer ${z?"active":""}`,onMouseDown:B,style:{backgroundColor:z?e.accent:e.border}})]})]})}const Wb=St.memo(function({theme:n}){const{tabs:r,activeTabId:o,setActiveTab:c}=je();return E.jsx("div",{style:{padding:4},children:r.map(u=>E.jsxs("div",{onClick:()=>c(u.id),style:{display:"flex",alignItems:"center",gap:6,padding:"5px 8px",cursor:"pointer",borderRadius:4,fontSize:13,color:u.id===o?n.text:n.sidebarText,backgroundColor:u.id===o?n.bgActive:"transparent"},children:[E.jsx("span",{style:{fontSize:10,color:u.isModified?n.accent:"transparent"},children:""}),E.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:u.name}),u.isPinned&&E.jsx("span",{style:{fontSize:10},children:""}),u.isReadOnly&&E.jsx("span",{style:{fontSize:10},children:""})]},u.id))})}),qb=St.memo(function({theme:n}){const{clipboardHistory:r}=je();return E.jsxs("div",{style:{padding:8},children:[E.jsx("div",{style:{fontSize:11,color:n.textMuted,marginBottom:8,textTransform:"uppercase",letterSpacing:1},children:"Clipboard History"}),r.length===0?E.jsx("div",{style:{color:n.textMuted,fontSize:12,padding:8},children:"No clipboard entries yet"}):r.map(o=>E.jsxs("div",{onClick:()=>navigator.clipboard.writeText(o.text),style:{padding:"6px 8px",cursor:"pointer",fontSize:12,color:n.sidebarText,borderRadius:4,borderBottom:`1px solid ${n.border}`,marginBottom:2},title:"Click to copy",children:[E.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontFamily:"monospace"},children:o.text.slice(0,100)}),E.jsx("div",{style:{fontSize:10,color:n.textMuted,marginTop:2},children:new Date(o.timestamp).toLocaleTimeString()})]},`clipboard-${o.timestamp}`))]})}),Vb=St.memo(function({theme:n}){const{tabs:r,activeTabId:o}=je(),c=r.find(x=>x.id===o),[u,p]=fe.useState(65),f=[{label:"Common Symbols",chars:""},{label:"Currency",chars:"$"},{label:"Greek",chars:""},{label:"Math",chars:""},{label:"Box Drawing",chars:""}],h=x=>{const _=Ld();_!==null&&_("insert-text",x)};return E.jsxs("div",{style:{padding:8},children:[E.jsx("div",{style:{fontSize:11,color:n.textMuted,marginBottom:8,textTransform:"uppercase",letterSpacing:1},children:"Character Panel"}),c!==void 0&&E.jsxs("div",{style:{fontSize:12,color:n.textSecondary,marginBottom:8,padding:"4px 0",borderBottom:`1px solid ${n.border}`},children:["Cursor pos: Ln ",c.cursorLine,", Col ",c.cursorColumn]}),E.jsxs("div",{style:{display:"flex",gap:4,marginBottom:8},children:[E.jsx("input",{type:"number",value:u,onChange:x=>p(parseInt(x.target.value)||0),style:{width:60,height:24,fontSize:12,backgroundColor:n.bg,color:n.text,border:`1px solid ${n.border}`,borderRadius:3,padding:"0 4px"}}),E.jsx("div",{style:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:n.bg,border:`1px solid ${n.border}`,borderRadius:3,fontFamily:"monospace",fontSize:14,color:n.accent},children:String.fromCharCode(u)}),E.jsx("button",{onClick:()=>h(String.fromCharCode(u)),style:{height:24,fontSize:11,backgroundColor:n.accent,color:n.accentText,border:"none",borderRadius:3,padding:"0 8px",cursor:"pointer"},children:"Insert"})]}),f.map(x=>E.jsxs("div",{style:{marginBottom:8},children:[E.jsx("div",{style:{fontSize:11,color:n.textMuted,marginBottom:4},children:x.label}),E.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:2},children:x.chars.split("").map(_=>E.jsx("div",{onClick:()=>h(_),title:`U+${_.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")}`,style:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",fontSize:13,fontFamily:"monospace",backgroundColor:n.bg,border:`1px solid ${n.border}`,borderRadius:2,cursor:"pointer",color:n.text},children:_},`char-${_}-${_.charCodeAt(0)}`))})]},`chargroup-${x.label}`))]})}),Kb=St.memo(function({theme:n}){const[r,o]=fe.useState(""),[c,u]=fe.useState([]),p=()=>{const f=je.getState().tabs,h=[];for(const x of f)x.content.split(`
`).forEach((y,O)=>{y.toLowerCase().includes(r.toLowerCase())&&h.push({file:x.name,line:O+1,text:y.trim()})});u(h)};return E.jsxs("div",{children:[E.jsx("div",{style:{display:"flex",gap:6},children:E.jsx("input",{type:"text",placeholder:"Search in files...",value:r,onChange:f=>o(f.target.value),onKeyDown:f=>f.key==="Enter"&&p(),style:{flex:1,height:28,backgroundColor:n.bg,color:n.text,border:`1px solid ${n.border}`,borderRadius:4,padding:"0 8px",fontSize:13}})}),0<c.length&&E.jsxs("div",{style:{marginTop:8},children:[E.jsxs("div",{style:{fontSize:12,color:n.textMuted,marginBottom:4},children:[c.length," results"]}),c.map(f=>E.jsxs("div",{className:"hover-bg hover-bg-reset",style:{padding:"4px 8px",fontSize:12,color:n.sidebarText,cursor:"pointer",borderRadius:4,"--hover-bg":n.bgHover},children:[E.jsxs("div",{style:{color:n.accent,fontSize:11},children:[f.file,":",f.line]}),E.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:f.text})]},`search-${f.file}-${f.line}`))]})]})});function Zb(e){var o;const n=(o=e.split(".").pop())==null?void 0:o.toLowerCase();return{js:"",jsx:"",ts:"",tsx:"",py:"",rb:"",go:"",rs:"",html:"",css:"",json:"",md:"",txt:"",svg:""}[n||""]||""}function Xb(e,n){const r=[],o=e.split(`
`),c={javascript:[/function\s+(\w+)/,/(?:const|let|var)\s+(\w+)\s*=\s*(?:async\s+)?(?:\([^)]*\)|(\w+))\s*=>/,/(\w+)\s*\([^)]*\)\s*\{/],typescript:[/function\s+(\w+)/,/(?:const|let|var)\s+(\w+)\s*=\s*(?:async\s+)?(?:\([^)]*\)|(\w+))\s*=>/,/(\w+)\s*\([^)]*\)\s*(?::\s*\w+)?\s*\{/],python:[/def\s+(\w+)/,/class\s+(\w+)/],ruby:[/def\s+(\w+)/,/class\s+(\w+)/],go:[/func\s+(?:\(\w+\s+\*?\w+\)\s+)?(\w+)/],rust:[/fn\s+(\w+)/,/struct\s+(\w+)/,/impl\s+(\w+)/],java:[/(?:public|private|protected|static|\s)+[\w<>\[\]]+\s+(\w+)\s*\(/],c:[/(?:void|int|char|float|double|long|short|unsigned|\w+)\s+(\w+)\s*\(/],cpp:[/(?:void|int|char|float|double|long|short|unsigned|\w+)\s+(\w+)\s*\(/],csharp:[/(?:public|private|protected|internal|static|\s)+[\w<>\[\]]+\s+(\w+)\s*\(/],swift:[/func\s+(\w+)/,/class\s+(\w+)/,/struct\s+(\w+)/],php:[/function\s+(\w+)/,/class\s+(\w+)/]},u=c[n]||c.javascript||[];return o.forEach((p,f)=>{for(const h of u){const x=p.match(h);if(x&&x[1]){const _=x[1];["if","else","for","while","switch","catch","return","new"].includes(_)||r.push({name:_,line:f+1});break}}}),r}async function Ch(e,n=0){if(n>sm)return[];const r=[];for await(const o of e.values()){if(o.name.startsWith(".")||o.name==="node_modules")continue;const c=o.kind==="file"?o:void 0,u=o.kind==="directory"?o:void 0,p={name:o.name,path:o.name,isDirectory:o.kind==="directory",isExpanded:!1,handle:c};u&&(p.children=await Ch(u,n+1)),r.push(p)}return r.sort((o,c)=>o.isDirectory&&!c.isDirectory?-1:!o.isDirectory&&c.isDirectory?1:o.name.localeCompare(c.name))}function Yb(e){return fe.useMemo(()=>({container:{display:"flex",flexDirection:"column",gap:6,padding:"8px 12px",background:e.bgSecondary,borderBottom:`1px solid ${e.border}`,fontSize:13},modesRow:{display:"flex",alignItems:"center",gap:4},modeTab:n=>({padding:"2px 8px",borderRadius:4,cursor:"pointer",fontSize:12,fontWeight:n?600:400,color:n?e.accent:e.textSecondary,background:n?e.bgHover:"transparent"}),spacer:{flex:1},closeButton:{background:"transparent",border:"none",color:e.textSecondary,cursor:"pointer",fontSize:16,padding:"0 4px",lineHeight:1},row:{display:"flex",alignItems:"center",gap:4},findInput:{flex:1,background:e.bg,color:e.text,border:`1px solid ${e.border}`,borderRadius:4,padding:"4px 8px",fontSize:13,outline:"none"},replaceInput:{flex:1,background:e.bg,color:e.text,border:`1px solid ${e.border}`,borderRadius:4,padding:"4px 8px",fontSize:13,outline:"none"},markRow:{display:"flex",alignItems:"center",gap:6},markLabel:{fontSize:12,color:e.textSecondary},markColor:(n,r)=>({width:20,height:20,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,fontWeight:600,cursor:"pointer",color:"#fff",background:eu[r]||"#888",border:n?"2px solid #fff":"2px solid transparent",boxShadow:n?`0 0 0 1px ${eu[r]}`:"none"}),optionsRow:{display:"flex",alignItems:"center",gap:12,fontSize:12,color:e.textSecondary},checkboxLabel:{display:"flex",alignItems:"center",gap:4,cursor:"pointer"},checkbox:{accentColor:e.accent}}),[e])}function Jb({theme:e}){const{findReplaceMode:n,searchOptions:r,updateSearchOptions:o,setShowFindReplace:c}=je(),u=Yb(e),p=fe.useRef(null),[f,h]=fe.useState(1);fe.useEffect(()=>{var q,Y;(q=p.current)==null||q.focus(),(Y=p.current)==null||Y.select()},[n]);const x=fe.useCallback(q=>{_(r.query,q,r)},[r]),_=(q,Y,B)=>{document.dispatchEvent(new CustomEvent("notemac-find",{detail:{query:q,direction:Y,isCaseSensitive:B.isCaseSensitive,isWholeWord:B.isWholeWord,isRegex:B.isRegex}}))},y=()=>x("next"),O=()=>x("prev"),R=()=>{document.dispatchEvent(new CustomEvent("notemac-replace",{detail:{find:r.query,replace:r.replaceText,all:!1,...r}}))},z=()=>{document.dispatchEvent(new CustomEvent("notemac-replace",{detail:{find:r.query,replace:r.replaceText,all:!0,...r}}))},N=()=>{document.dispatchEvent(new CustomEvent("notemac-mark",{detail:{...r,style:f}}))},L=()=>{document.dispatchEvent(new CustomEvent("notemac-clear-marks",{}))},D=q=>{q.key==="Enter"&&(q.preventDefault(),q.shiftKey?O():y()),q.key==="Escape"&&c(!1)},U=({active:q,onClick:Y,title:B,children:K})=>{const ce=fe.useMemo(()=>({background:q?e.accent:"transparent",color:q?e.accentText:e.textSecondary,border:`1px solid ${q?e.accent:e.border}`,borderRadius:4,padding:"2px 6px",cursor:"pointer",fontSize:12,fontWeight:q?600:400,minWidth:28,height:24,display:"flex",alignItems:"center",justifyContent:"center"}),[q,e]);return E.jsx("button",{title:B,"aria-label":B,onClick:Y,style:ce,children:K})},G=({onClick:q,title:Y,children:B,primary:K})=>{const ce=fe.useMemo(()=>({background:K?e.accent:"transparent",color:K?e.accentText:e.textSecondary,border:`1px solid ${K?e.accent:e.border}`,borderRadius:4,padding:"2px 8px",cursor:"pointer",fontSize:12,height:24,display:"flex",alignItems:"center",justifyContent:"center"}),[K,e]);return E.jsx("button",{title:Y,"aria-label":Y,onClick:q,style:ce,children:B})},X=[{key:"find",label:"Find"},{key:"replace",label:"Replace"},{key:"findInFiles",label:"Find in Files"},{key:"mark",label:"Mark"}];return E.jsxs("div",{style:u.container,children:[E.jsxs("div",{style:u.modesRow,children:[X.map(q=>E.jsx("span",{onClick:()=>je.getState().setShowFindReplace(!0,q.key),style:u.modeTab(n===q.key),children:q.label},q.key)),E.jsx("div",{style:u.spacer}),E.jsx("button",{"aria-label":"Close find and replace",onClick:()=>c(!1),style:u.closeButton,children:""})]}),E.jsxs("div",{style:u.row,children:[E.jsx("input",{ref:p,type:"text",placeholder:"Find...",value:r.query,onChange:q=>o({query:q.target.value}),onKeyDown:D,style:u.findInput}),E.jsx(U,{active:r.isCaseSensitive,onClick:()=>o({isCaseSensitive:!r.isCaseSensitive}),title:"Match Case",children:"Aa"}),E.jsx(U,{active:r.isWholeWord,onClick:()=>o({isWholeWord:!r.isWholeWord}),title:"Whole Word",children:"W"}),E.jsx(U,{active:r.isRegex,onClick:()=>o({isRegex:!r.isRegex}),title:"Use Regular Expression",children:".*"}),E.jsx(G,{onClick:O,title:"Previous Match (Shift+Enter)",children:""}),E.jsx(G,{onClick:y,title:"Next Match (Enter)",children:""})]}),(n==="replace"||n==="findInFiles")&&E.jsxs("div",{style:u.row,children:[E.jsx("input",{type:"text",placeholder:"Replace...",value:r.replaceText,onChange:q=>o({replaceText:q.target.value}),onKeyDown:D,style:u.replaceInput}),E.jsx(G,{onClick:R,title:"Replace",children:"Replace"}),E.jsx(G,{onClick:z,title:"Replace All",primary:!0,children:"Replace All"})]}),n==="mark"&&E.jsxs("div",{style:u.markRow,children:[E.jsx("span",{style:u.markLabel,children:"Style:"}),[1,2,3,4,5].map(q=>E.jsx("div",{onClick:()=>h(q),style:u.markColor(f===q,q),children:q},q)),E.jsx("div",{style:u.spacer}),E.jsx(G,{onClick:N,title:"Mark All",primary:!0,children:"Mark All"}),E.jsx(G,{onClick:L,title:"Clear All Marks",children:"Clear Marks"})]}),E.jsxs("div",{style:u.optionsRow,children:[E.jsxs("label",{style:u.checkboxLabel,children:[E.jsx("input",{type:"checkbox",checked:r.wrapAround,onChange:q=>o({wrapAround:q.target.checked}),style:u.checkbox}),"Wrap around"]}),E.jsxs("label",{style:u.checkboxLabel,children:[E.jsx("input",{type:"checkbox",checked:r.searchInSelection,onChange:q=>o({searchInSelection:q.target.checked}),style:u.checkbox}),"In selection"]})]})]})}function Qb({theme:e}){const{addTab:n,recentFiles:r}=je(),o=ev(e),u=navigator.platform.includes("Mac")?"":"Ctrl";return E.jsxs("div",{style:o.container,children:[E.jsxs("div",{style:o.headerWrapper,children:[E.jsx("div",{style:o.logo,children:"N++"}),E.jsx("h1",{style:o.title,children:"Notemac++"}),E.jsx("p",{style:o.subtitle,children:"A powerful text editor for Mac & Web"})]}),E.jsxs("div",{style:o.quickActionsSection,children:[E.jsx(ls,{theme:e,label:"New File",shortcut:`${u}N`,onClick:()=>n()}),E.jsx(ls,{theme:e,label:"Open File",shortcut:`${u}O`,onClick:()=>{window.electronAPI||tv().then(p=>{p&&n({name:p.name,content:p.content,language:sr(p.name),lineEnding:br(p.content)})})}}),E.jsx(ls,{theme:e,label:"Open Folder",onClick:async()=>{if("showDirectoryPicker"in window)try{await window.showDirectoryPicker(),je.getState().setSidebarPanel("explorer")}catch{}}})]}),E.jsxs("div",{style:o.shortcutsContainer,children:[E.jsx("div",{style:o.shortcutsTitle,children:"Keyboard Shortcuts"}),E.jsx("div",{style:o.shortcutsGrid,children:[[`${u}N`,"New file"],[`${u}O`,"Open file"],[`${u}S`,"Save"],[`${u}F`,"Find"],[`${u}H`,"Find & Replace"],[`${u}G`,"Go to line"],[`${u}D`,"Duplicate line"],[`${u}B`,"Toggle sidebar"],[`${u},`,"Preferences"]].map(([p,f])=>E.jsxs(St.Fragment,{children:[E.jsx("kbd",{style:o.shortcutKey,children:p}),E.jsx("span",{style:o.shortcutDesc,children:f})]},`shortcut-${p}`))})]}),r.length>0&&E.jsxs("div",{style:o.recentFilesWrapper,children:[E.jsx("div",{style:o.recentFilesTitle,children:"Recent Files"}),r.slice(0,5).map(p=>E.jsxs("div",{onClick:async()=>{if(window.electronAPI){const f=await window.electronAPI.readFile(p.path);n({name:p.name,path:p.path,content:f,language:sr(p.name),lineEnding:br(f)})}},className:"hover-bg hover-bg-reset",style:o.recentFileItem,children:[p.name,E.jsx("span",{style:o.recentFilePath,children:p.path})]},`recent-${p.path||p.name}`))]})]})}function ls({theme:e,label:n,shortcut:r,onClick:o}){const[c,u]=St.useState(!1),p=fe.useMemo(()=>({button:{display:"flex",flexDirection:"column",alignItems:"center",gap:6,padding:"12px 20px",backgroundColor:c?e.bgHover:e.bgSecondary,color:e.text,border:`1px solid ${e.border}`,borderRadius:8,cursor:"pointer",fontSize:13,transition:"background-color 0.15s ease",minWidth:110},shortcutLabel:{fontSize:11,color:e.textMuted}}),[c,e]);return E.jsxs("button",{onClick:o,onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),style:p.button,children:[E.jsx("span",{children:n}),r&&E.jsx("span",{style:p.shortcutLabel,children:r})]})}function ev(e){return fe.useMemo(()=>({container:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:e.editorBg,gap:24},headerWrapper:{textAlign:"center"},logo:{fontSize:64,fontWeight:200,color:e.textMuted,letterSpacing:-2,marginBottom:8},title:{fontSize:28,fontWeight:300,color:e.textSecondary,marginBottom:4},subtitle:{color:e.textMuted,fontSize:14},quickActionsSection:{display:"flex",gap:12,marginTop:8},shortcutsContainer:{marginTop:24,padding:24,backgroundColor:e.bgSecondary,borderRadius:12,border:`1px solid ${e.border}`,width:400},shortcutsTitle:{fontSize:12,fontWeight:600,color:e.textSecondary,textTransform:"uppercase",letterSpacing:1,marginBottom:12},shortcutsGrid:{display:"grid",gridTemplateColumns:"auto 1fr",gap:"8px 16px",fontSize:13},shortcutKey:{backgroundColor:e.bgTertiary,color:e.textSecondary,padding:"2px 8px",borderRadius:4,fontSize:12,fontFamily:"-apple-system, system-ui, sans-serif",border:`1px solid ${e.border}`,textAlign:"center",minWidth:60},shortcutDesc:{color:e.textSecondary},recentFilesWrapper:{marginTop:8},recentFilesTitle:{fontSize:12,fontWeight:600,color:e.textSecondary,textTransform:"uppercase",letterSpacing:1,marginBottom:8},recentFileItem:{padding:"6px 12px",cursor:"pointer",color:e.accent,fontSize:13,borderRadius:4,"--hover-bg":e.bgHover},recentFilePath:{color:e.textMuted,fontSize:11,marginLeft:8}}),[e])}async function tv(){if("showOpenFilePicker"in window)try{const[e]=await window.showOpenFilePicker({multiple:!1}),n=await e.getFile(),r=await n.text();return{name:n.name,content:r}}catch{return null}return new Promise(e=>{const n=document.createElement("input");n.type="file",n.onchange=async r=>{var u;const o=(u=r.target.files)==null?void 0:u[0];if(!o){e(null);return}const c=await o.text();e({name:o.name,content:c})},n.click()})}function rv(e,n,r){const o=fe.useRef(null);fe.useEffect(()=>{if(!n||!e.current)return;o.current=document.activeElement instanceof HTMLElement?document.activeElement:null;const c=e.current,u='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])',p=c.querySelector(u);p==null||p.focus();const f=h=>{if(h.key==="Escape"){h.preventDefault(),r==null||r();return}if(h.key!=="Tab")return;const x=c.querySelectorAll(u);if(x.length===0)return;const _=x[0],y=x[x.length-1];h.shiftKey?document.activeElement===_&&(h.preventDefault(),y.focus()):document.activeElement===y&&(h.preventDefault(),_.focus())};return c.addEventListener("keydown",f),()=>{var h;c.removeEventListener("keydown",f),(h=o.current)==null||h.focus()}},[n,e,r])}const nv=1200*1e3,pd="notemac_feedback_shown_version";function iv({theme:e}){const[n,r]=fe.useState(!1),[o,c]=fe.useState(null),u=fe.useRef(null);if(fe.useEffect(()=>{if(localStorage.getItem(pd)===Ql)return;const O=setTimeout(()=>{r(!0),localStorage.setItem(pd,Ql)},nv);return()=>clearTimeout(O)},[]),rv(u,n,()=>r(!1)),!n)return null;const p="I've been using Notemac++ and it's an awesome text editor for Mac & Web! Check it out:",f="https://sergioadevita.github.io/notemac-plus-plus/",h=encodeURIComponent("Check out Notemac++!"),x=encodeURIComponent(`Hey!

${p}
${f}

Give it a try!`),_=[{id:"github",label:"Open an issue",sublabel:"Report bugs or request features",icon:E.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:e.text,children:E.jsx("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})}),href:"https://github.com/sergioadevita/notemac-plus-plus/issues/new",color:e.bgTertiary,textColor:e.text,borderColor:e.border},{id:"twitter",label:"Share on X",sublabel:"Tell the world about it",icon:E.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"#fff",children:E.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),href:`https://twitter.com/intent/tweet?text=${encodeURIComponent(p)}&url=${encodeURIComponent(f)}`,color:"#000",textColor:"#fff",borderColor:"#333"},{id:"email",label:"Share via email",sublabel:"Send to a friend",icon:E.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:e.accent,children:E.jsx("path",{d:"M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})}),href:`mailto:?subject=${h}&body=${x}`,color:e.bgTertiary,textColor:e.text,borderColor:e.border},{id:"donate",label:"Buy me a coffee",sublabel:"Support development",icon:E.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"#fff",children:E.jsx("path",{d:"M23.881 8.948c-.773-4.085-4.859-4.593-4.859-4.593H.723c-.604 0-.679.798-.679.798s-.082 7.324-.022 11.822c.164 2.424 2.586 2.672 2.586 2.672s8.267-.023 11.966-.049c2.438-.426 2.683-2.566 2.658-3.734 4.352.24 7.422-2.831 6.649-6.916zm-11.062 3.511c-1.246 1.453-4.011 3.976-4.011 3.976s-.121.119-.31.023c-.076-.057-.108-.09-.108-.09-.443-.441-3.368-3.049-4.034-3.954-.709-.965-1.041-2.7-.091-3.71.951-1.01 3.005-1.086 4.363.407 0 0 1.565-1.782 3.468-.963 1.904.82 1.832 3.011.723 4.311zm6.173.478c-.928.116-1.682.028-1.682.028V7.284h1.77s1.971.551 1.971 2.638c0 1.913-.985 2.667-2.059 3.015z"})}),href:"https://ko-fi.com/sergioadevita",color:"#FF5E5B",textColor:"#fff",borderColor:"#FF5E5B"}];return E.jsx("div",{className:"dialog-overlay",onClick:()=>r(!1),style:{zIndex:Ed},children:E.jsxs("div",{ref:u,role:"dialog","aria-modal":"true","aria-labelledby":"feedback-title",onClick:y=>y.stopPropagation(),style:{backgroundColor:e.bgSecondary,border:`1px solid ${e.border}`,borderRadius:16,padding:32,width:440,boxShadow:"0 12px 48px rgba(0,0,0,0.5)",textAlign:"center",animation:"feedbackSlideIn 0.4s ease-out"},children:[E.jsx("style",{children:`
                    @keyframes feedbackSlideIn {
                        from { opacity: 0; transform: translateY(30px) scale(0.95); }
                        to { opacity: 1; transform: translateY(0) scale(1); }
                    }
                `}),E.jsx("div",{style:{fontSize:48,marginBottom:8},children:""}),E.jsx("h2",{id:"feedback-title",style:{color:e.text,fontSize:22,fontWeight:700,marginBottom:8},children:"Hey, you're still here!"}),E.jsxs("p",{style:{color:e.textSecondary,fontSize:14,lineHeight:1.6,marginBottom:8,padding:"0 8px"},children:["You've been coding for 20 minutes straight  that's either dedication or a really nasty bug. Either way, we're glad you're using ",E.jsx("span",{style:{color:e.accent,fontWeight:600},children:"Notemac++"}),"!"]}),E.jsx("p",{style:{color:e.textMuted,fontSize:13,marginBottom:24},children:"If this octopus has been helpful, here are some ways to spread the love:"}),E.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10,marginBottom:24},children:_.map(y=>{let O=o===y.id;return E.jsxs("a",{href:y.href,target:"_blank",rel:"noopener noreferrer",style:{display:"flex",alignItems:"center",gap:12,backgroundColor:y.color,color:y.textColor,border:`1px solid ${y.borderColor}`,borderRadius:10,padding:"10px 16px",textDecoration:"none",transition:"all 0.2s ease",transform:O?"translateX(4px)":"none",opacity:O?.9:1},onMouseEnter:()=>c(y.id),onMouseLeave:()=>c(null),children:[E.jsx("div",{style:{flexShrink:0},children:y.icon}),E.jsxs("div",{style:{textAlign:"left"},children:[E.jsx("div",{style:{fontWeight:600,fontSize:14},children:y.label}),E.jsx("div",{style:{fontSize:11,opacity:.7},children:y.sublabel})]})]},y.id)})}),E.jsx("button",{onClick:()=>r(!1),className:"hover-color",style:{backgroundColor:"transparent",color:e.textMuted,border:"none",cursor:"pointer",fontSize:13,padding:"6px 16px",transition:"color 0.2s","--hover-color":e.text},children:"Maybe later  I'm in the zone"})]})})}class Tt extends fe.Component{constructor(r){super(r);Dl(this,"handleRetry",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,o){}render(){var r;return this.state.hasError?E.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:32,gap:12,color:"#b0b0b0",fontFamily:"system-ui, sans-serif",fontSize:13,height:"100%"},children:[E.jsx("div",{style:{fontSize:18,fontWeight:600,color:"#e06c75"},children:this.props.fallbackMessage||"Something went wrong"}),E.jsx("div",{style:{maxWidth:400,textAlign:"center",lineHeight:1.5},children:((r=this.state.error)==null?void 0:r.message)||"An unexpected error occurred in this panel."}),E.jsx("button",{onClick:this.handleRetry,style:{marginTop:8,padding:"6px 16px",backgroundColor:"#3d3d3d",color:"#d4d4d4",border:"1px solid #555",borderRadius:4,cursor:"pointer",fontSize:12},children:"Retry"})]}):this.props.children}}const av=fe.lazy(()=>ht(()=>import("./SettingsDialogViewPresenter-DQWIDYnf.js"),__vite__mapDeps([10,1,2,3])).then(e=>({default:e.SettingsDialog}))),ov=fe.lazy(()=>ht(()=>import("./GoToLineDialogViewPresenter-DdsH5dtI.js"),__vite__mapDeps([11,1,2,3])).then(e=>({default:e.GoToLineDialog}))),sv=fe.lazy(()=>ht(()=>import("./AboutDialogViewPresenter-DhmC-Jro.js"),__vite__mapDeps([12,1,2,3])).then(e=>({default:e.AboutDialog}))),cv=fe.lazy(()=>ht(()=>import("./RunCommandDialogViewPresenter-BJSo9dcw.js"),__vite__mapDeps([13,1,2,3])).then(e=>({default:e.RunCommandDialog}))),lv=fe.lazy(()=>ht(()=>import("./ColumnEditorDialogViewPresenter-U1TwFX7v.js"),__vite__mapDeps([14,1,2,3])).then(e=>({default:e.ColumnEditorDialog}))),uv=fe.lazy(()=>ht(()=>import("./SummaryDialogViewPresenter-BnGX-acx.js"),__vite__mapDeps([15,1,2,3])).then(e=>({default:e.SummaryDialog}))),fv=fe.lazy(()=>ht(()=>import("./CharInRangeDialogViewPresenter-BLSEdTmA.js"),__vite__mapDeps([16,1,2,3])).then(e=>({default:e.CharInRangeDialog}))),dv=fe.lazy(()=>ht(()=>import("./ShortcutMapperDialogViewPresenter-T5E-Jq2W.js"),__vite__mapDeps([17,18,1,2,3])).then(e=>({default:e.ShortcutMapperDialog}))),hv=fe.lazy(()=>ht(()=>import("./CommandPaletteViewPresenter-D5P1hFUk.js"),__vite__mapDeps([19,18,20,1,2,3])).then(e=>({default:e.CommandPaletteViewPresenter}))),pv=fe.lazy(()=>ht(()=>import("./QuickOpenViewPresenter-C06pwhgD.js"),__vite__mapDeps([21,20,1,2,3])).then(e=>({default:e.QuickOpenViewPresenter}))),gv=fe.lazy(()=>ht(()=>import("./DiffViewerViewPresenter-FYk0Odf8.js"),__vite__mapDeps([22,5,1,2,3])).then(e=>({default:e.DiffViewerViewPresenter}))),mv=fe.lazy(()=>ht(()=>import("./SnippetManagerViewPresenter-DdqlM2Pj.js"),__vite__mapDeps([23,1,2,3])).then(e=>({default:e.SnippetManagerViewPresenter}))),wv=fe.lazy(()=>ht(()=>import("./TerminalPanelViewPresenter-DGli9hCS.js"),__vite__mapDeps([24,1,2,3])).then(e=>({default:e.TerminalPanelViewPresenter}))),yv=fe.lazy(()=>ht(()=>import("./CloneRepositoryViewPresenter-BbAa0Mt6.js"),__vite__mapDeps([25,2,3,1])).then(e=>({default:e.CloneRepositoryViewPresenter}))),bv=fe.lazy(()=>ht(()=>import("./GitSettingsViewPresenter-BGGbzp7U.js"),__vite__mapDeps([26,1,2,3])).then(e=>({default:e.GitSettingsViewPresenter}))),vv=fe.lazy(()=>ht(()=>import("./AISettingsViewPresenter-riVwtWzT.js"),__vite__mapDeps([27,1,2,3])).then(e=>({default:e.AISettingsViewPresenter})));function xv(){const e=je(te=>te.tabs),n=je(te=>te.activeTabId),r=je(te=>te.showStatusBar),o=je(te=>te.showToolbar),c=je(te=>te.settings),u=je(te=>te.showFindReplace),p=je(te=>te.showSettings),f=je(te=>te.showGoToLine),h=je(te=>te.showAbout),x=je(te=>te.showRunCommand),_=je(te=>te.showColumnEditor),y=je(te=>te.showSummary),O=je(te=>te.showCharInRange),R=je(te=>te.showShortcutMapper),z=je(te=>te.showCommandPalette),N=je(te=>te.showQuickOpen),L=je(te=>te.showDiffViewer),D=je(te=>te.showSnippetManager),U=je(te=>te.showTerminalPanel),G=je(te=>te.showCloneDialog),X=je(te=>te.showGitSettings),q=je(te=>te.showAiSettings),Y=je(te=>te.splitView),B=je(te=>te.splitTabId),K=je(te=>te.addTab),ce=je(te=>te.zoomLevel),S=fe.useMemo(()=>Ym(c.theme),[c.theme]),ie=fe.useCallback(te=>{Qm(te,n,ce)},[n,ce]);fe.useEffect(()=>(window.addEventListener("keydown",ie),()=>window.removeEventListener("keydown",ie)),[ie]),fe.useEffect(()=>(document.addEventListener("dragover",nd),document.addEventListener("drop",id),()=>{document.removeEventListener("dragover",nd),document.removeEventListener("drop",id)}),[]),fe.useEffect(()=>{n0()},[]);const Q=fe.useCallback((te,re)=>{$d(te,n,e,ce,re)},[n,ce,e]);fe.useEffect(()=>{e.length===0&&K({name:"new 1",content:""})},[]),fe.useEffect(()=>{je.getState().LoadAIState()},[]);const se=e.find(te=>te.id===n),W=c.distractionFreeMode,oe=km();return E.jsxs("div",{className:"notemac-app",style:{backgroundColor:S.bg,color:S.text,fontSize:c.fontSize+ce},children:[oe&&!W&&E.jsx("div",{style:{height:38,backgroundColor:S.menuBg,borderBottom:`1px solid ${S.border}`,display:"flex",alignItems:"center",paddingLeft:78,flexShrink:0,WebkitAppRegion:"drag"},children:E.jsxs("span",{style:{fontWeight:600,fontSize:13,color:S.text,opacity:.7,WebkitAppRegion:"no-drag",userSelect:"none"},children:[se?se.name+(se.isModified?" ":"")+"  ":"","Notemac++"]})}),!W&&!oe&&E.jsx(c0,{theme:S,onAction:Q,isElectron:oe}),o&&!W&&E.jsx(l0,{theme:S,onAction:Q}),!W&&E.jsx(u0,{theme:S}),E.jsxs("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[!W&&E.jsx(Hb,{theme:S}),E.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[u&&E.jsx(Jb,{theme:S}),E.jsx("div",{style:{flex:1,display:"flex",flexDirection:Y==="horizontal"?"column":"row",overflow:"hidden"},children:se?E.jsxs(E.Fragment,{children:[E.jsx(Tt,{fallbackMessage:"Editor panel encountered an error",children:E.jsx(dd,{tab:se,theme:S,settings:c,zoomLevel:ce},se.id)}),Y!=="none"&&B&&E.jsxs(E.Fragment,{children:[E.jsx("div",{style:{width:Y==="vertical"?4:void 0,height:Y==="horizontal"?4:void 0,backgroundColor:S.border,cursor:Y==="vertical"?"col-resize":"row-resize"}}),E.jsx(Tt,{fallbackMessage:"Split editor panel encountered an error",children:E.jsx(dd,{tab:e.find(te=>te.id===B)||se,theme:S,settings:c,zoomLevel:ce},B+"-split")})]})]}):E.jsx(Qb,{theme:S})}),U&&E.jsx(Tt,{fallbackMessage:"Terminal panel failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(wv,{theme:S})})})]})]}),r&&!W&&E.jsx(Nb,{theme:S}),p&&E.jsx(Tt,{fallbackMessage:"Settings failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(av,{theme:S})})}),f&&E.jsx(Tt,{fallbackMessage:"Go to Line dialog failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(ov,{theme:S})})}),h&&E.jsx(Tt,{fallbackMessage:"About dialog failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(sv,{theme:S})})}),x&&E.jsx(Tt,{fallbackMessage:"Run Command dialog failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(cv,{theme:S})})}),_&&E.jsx(Tt,{fallbackMessage:"Column Editor dialog failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(lv,{theme:S})})}),y&&E.jsx(Tt,{fallbackMessage:"Summary dialog failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(uv,{theme:S})})}),O&&E.jsx(Tt,{fallbackMessage:"Char in Range dialog failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(fv,{theme:S})})}),R&&E.jsx(Tt,{fallbackMessage:"Shortcut Mapper dialog failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(dv,{theme:S})})}),z&&E.jsx(Tt,{fallbackMessage:"Command Palette failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(hv,{theme:S})})}),N&&E.jsx(Tt,{fallbackMessage:"Quick Open failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(pv,{theme:S})})}),L&&E.jsx(Tt,{fallbackMessage:"Diff Viewer failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(gv,{theme:S})})}),D&&E.jsx(Tt,{fallbackMessage:"Snippet Manager failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(mv,{theme:S})})}),G&&E.jsx(Tt,{fallbackMessage:"Clone Repository dialog failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(yv,{theme:S})})}),X&&E.jsx(Tt,{fallbackMessage:"Git Settings failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(bv,{theme:S})})}),q&&E.jsx(Tt,{fallbackMessage:"AI Settings failed to load",children:E.jsx(fe.Suspense,{fallback:null,children:E.jsx(vv,{theme:S})})}),E.jsx(iv,{theme:S})]})}ag.createRoot(document.getElementById("root")).render(E.jsx(St.StrictMode,{children:E.jsx(xv,{})}));export{Ql as A,lh as B,Rs as C,Nn as D,n1 as E,e1 as F,Av as G,$d as H,uh as I,Pv as J,jv as K,Bv as L,Fv as M,Fr as N,Ob as O,Ov as P,qm as Q,St as R,jn as S,$v as T,Rv as U,Ld as V,Nv as W,Ev as X,Qv as Y,rv as a,Ed as b,Lb as c,Tv as d,Cv as e,i1 as f,vr as g,t1 as h,ah as i,E as j,fr as k,Iv as l,gi as m,_d as n,Cs as o,by as p,xa as q,fe as r,ym as s,Mv as t,je as u,Dv as v,r1 as w,yi as x,Lv as y,Os as z};
