import{u as V,r as l,T as X,g as Y,v as q,j as t,x as G,y as J}from"./index-DshWawKp.js";import"./react-vendor-P8ZuH1e3.js";import"./monaco-editor-BYMRfcD5.js";function te({theme:n}){var M;const{providers:x,credentials:C,activeProviderId:S,activeModelId:R,aiSettings:i,SetActiveProvider:B,SetActiveModel:E,SetCredentialForProvider:$,RemoveCredentialForProvider:F,UpdateAISettings:c,AddProvider:K,RemoveProvider:D,SetShowAiSettings:k,SetAiEnabled:L}=V(),[p,U]=l.useState("providers"),[v,T]=l.useState({}),[g,W]=l.useState(()=>{const e={};for(const s of C)e[s.providerId]=s.apiKey;return e}),[y,N]=l.useState(()=>{const e={};for(const s of C)e[s.providerId]=s.rememberKey;return e}),I=l.useMemo(()=>x.filter(e=>!e.isBuiltIn),[x]),[h,z]=l.useState(""),[b,A]=l.useState(""),O=l.useCallback(e=>{const s=g[e]||"",d=y[e]??!0;0<s.length?($(e,s,d),L(!0)):F(e)},[g,y]),_=l.useCallback(async e=>{const s=x.find(u=>u.id===e),d=g[e];if(!s||!d)return;T(u=>({...u,[e]:{testing:!0}}));const m=await X(s,{providerId:e,apiKey:d,rememberKey:y[e]??!0});T(u=>({...u,[e]:{testing:!1,result:m.success?"Connected!":`Error: ${m.error}`}}))},[x,g,y]),H=l.useCallback(()=>{if(h.trim().length===0||b.trim().length===0)return;const e="custom-"+Y(),s=J("default","Default Model",e),d=q(e,h.trim(),b.trim(),[s]);K(d),z(""),A("")},[h,b]),a={width:"100%",height:28,backgroundColor:n.bg,color:n.text,border:`1px solid ${n.border}`,borderRadius:4,padding:"0 8px",fontSize:12,boxSizing:"border-box"},o={fontSize:11,color:n.textSecondary,marginBottom:4,display:"block"},r={marginBottom:16};return t.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:e=>{e.target===e.currentTarget&&k(!1)},children:t.jsxs("div",{style:{width:520,maxHeight:"80vh",backgroundColor:n.sidebarBg,borderRadius:10,border:`1px solid ${n.border}`,display:"flex",flexDirection:"column",overflow:"hidden"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderBottom:`1px solid ${n.border}`},children:[t.jsx("span",{style:{fontSize:14,fontWeight:600,color:n.text},children:"AI Settings"}),t.jsx("button",{onClick:()=>k(!1),style:{background:"none",border:"none",color:n.textMuted,cursor:"pointer",fontSize:16},children:"✕"})]}),t.jsx("div",{style:{display:"flex",borderBottom:`1px solid ${n.border}`,padding:"0 16px"},children:["providers","completion","chat","custom"].map(e=>t.jsx("button",{onClick:()=>U(e),style:{padding:"8px 12px",fontSize:12,color:p===e?n.accent:n.textMuted,background:"none",border:"none",borderBottom:`2px solid ${p===e?n.accent:"transparent"}`,cursor:"pointer",textTransform:"capitalize"},children:e},e))}),t.jsxs("div",{style:{flex:1,overflow:"auto",padding:16},children:[p==="providers"&&t.jsxs("div",{children:[t.jsxs("div",{style:r,children:[t.jsx("label",{style:o,children:"Active Provider"}),t.jsx("select",{value:S,onChange:e=>B(e.target.value),style:a,children:x.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))})]}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:o,children:"Active Model"}),t.jsx("select",{value:R,onChange:e=>E(e.target.value),style:a,children:(M=x.find(e=>e.id===S))==null?void 0:M.models.map(e=>t.jsx("option",{value:e.id,children:e.name},e.id))})]}),t.jsx("div",{style:{fontSize:12,fontWeight:600,color:n.text,marginBottom:8,marginTop:16},children:"API Keys"}),x.map(e=>{var s,d,m,u,P,w;return t.jsxs("div",{style:{marginBottom:12,padding:10,backgroundColor:n.bg,borderRadius:6,border:`1px solid ${n.border}`},children:[t.jsx("div",{style:{fontSize:12,fontWeight:600,color:n.text,marginBottom:6},children:e.name}),t.jsx("input",{type:"password",placeholder:`Enter ${e.name} API key...`,value:g[e.id]||"",onChange:j=>W(f=>({...f,[e.id]:j.target.value})),style:{...a,marginBottom:6}}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[t.jsxs("div",{children:[t.jsxs("label",{style:{fontSize:11,color:n.textMuted,display:"flex",alignItems:"center",gap:4,cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:y[e.id]??!1,onChange:j=>N(f=>({...f,[e.id]:j.target.checked}))}),"Remember key (encrypted)"]}),y[e.id]&&t.jsxs("div",{style:{marginTop:2,fontSize:10,color:"#f9e2af",backgroundColor:"#f9e2af15",padding:"2px 6px",borderRadius:3},children:["Key will be encrypted and stored locally. Expires after ",G,"h."]})]}),t.jsx("div",{style:{flex:1}}),t.jsx("button",{onClick:()=>_(e.id),disabled:!((s=g[e.id])!=null&&s.length),style:{height:24,padding:"0 8px",fontSize:11,border:`1px solid ${n.border}`,borderRadius:4,cursor:"pointer",backgroundColor:n.bgHover,color:n.text},children:(d=v[e.id])!=null&&d.testing?"Testing...":"Test"}),t.jsx("button",{onClick:()=>O(e.id),style:{height:24,padding:"0 8px",fontSize:11,border:"none",borderRadius:4,cursor:"pointer",backgroundColor:n.accent,color:n.accentText},children:"Save"})]}),((m=v[e.id])==null?void 0:m.result)&&t.jsx("div",{style:{marginTop:4,fontSize:11,color:(P=(u=v[e.id])==null?void 0:u.result)!=null&&P.startsWith("Connected")?"#4caf50":"#ff6b6b"},children:(w=v[e.id])==null?void 0:w.result})]},e.id)})]}),p==="completion"&&t.jsxs("div",{children:[t.jsx("div",{style:r,children:t.jsxs("label",{style:{...o,display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:i.inlineCompletionEnabled,onChange:e=>c({inlineCompletionEnabled:e.target.checked})}),"Enable inline code completions (ghost text)"]})}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:o,children:"Debounce delay (ms)"}),t.jsx("input",{type:"number",value:i.inlineDebounceMs,onChange:e=>c({inlineDebounceMs:parseInt(e.target.value)||500}),min:100,max:3e3,step:100,style:a})]}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:o,children:"Max inline tokens"}),t.jsx("input",{type:"number",value:i.inlineMaxTokens,onChange:e=>c({inlineMaxTokens:parseInt(e.target.value)||256}),min:32,max:1024,step:32,style:a})]}),t.jsxs("div",{style:r,children:[t.jsxs("label",{style:o,children:["Code temperature (",i.codeTemperature,")"]}),t.jsx("input",{type:"range",value:i.codeTemperature,onChange:e=>c({codeTemperature:parseFloat(e.target.value)}),min:0,max:1,step:.05,style:{width:"100%"}})]})]}),p==="chat"&&t.jsxs("div",{children:[t.jsxs("div",{style:r,children:[t.jsxs("label",{style:o,children:["Chat temperature (",i.chatTemperature,")"]}),t.jsx("input",{type:"range",value:i.chatTemperature,onChange:e=>c({chatTemperature:parseFloat(e.target.value)}),min:0,max:1,step:.05,style:{width:"100%"}})]}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:o,children:"Max context tokens"}),t.jsx("input",{type:"number",value:i.maxContextTokens,onChange:e=>c({maxContextTokens:parseInt(e.target.value)||8e3}),min:1e3,max:128e3,step:1e3,style:a})]}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:o,children:"Custom system prompt (optional)"}),t.jsx("textarea",{value:i.systemPrompt,onChange:e=>c({systemPrompt:e.target.value}),placeholder:"Leave empty for default",rows:4,style:{...a,height:"auto",resize:"vertical",fontFamily:"inherit",padding:"6px 8px"}})]}),t.jsx("div",{style:r,children:t.jsxs("label",{style:{...o,display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[t.jsx("input",{type:"checkbox",checked:i.showAiStatusIndicator,onChange:e=>c({showAiStatusIndicator:e.target.checked})}),"Show AI status indicator in status bar"]})})]}),p==="custom"&&t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:12,color:n.textMuted,marginBottom:12},children:"Add custom OpenAI-compatible providers (e.g., Ollama, LM Studio, vLLM)."}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:o,children:"Provider Name"}),t.jsx("input",{type:"text",value:h,onChange:e=>z(e.target.value),placeholder:"e.g., Ollama Local",style:a})]}),t.jsxs("div",{style:r,children:[t.jsx("label",{style:o,children:"Base URL"}),t.jsx("input",{type:"text",value:b,onChange:e=>A(e.target.value),placeholder:"e.g., http://localhost:11434",style:a})]}),t.jsx("button",{onClick:H,disabled:h.trim().length===0||b.trim().length===0,style:{height:30,padding:"0 16px",fontSize:12,border:"none",borderRadius:4,cursor:"pointer",backgroundColor:n.accent,color:n.accentText,marginBottom:16},children:"Add Provider"}),0<I.length&&t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:12,fontWeight:600,color:n.text,marginBottom:8},children:"Custom Providers"}),I.map(e=>t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 8px",backgroundColor:n.bg,borderRadius:4,marginBottom:4,border:`1px solid ${n.border}`},children:[t.jsxs("div",{children:[t.jsx("div",{style:{fontSize:12,color:n.text},children:e.name}),t.jsx("div",{style:{fontSize:10,color:n.textMuted},children:e.baseUrl})]}),t.jsx("button",{onClick:()=>D(e.id),style:{background:"none",border:"none",color:"#ff6b6b",cursor:"pointer",fontSize:12},children:"✕"})]},e.id))]})]})]})]})})}export{te as AISettingsViewPresenter};
